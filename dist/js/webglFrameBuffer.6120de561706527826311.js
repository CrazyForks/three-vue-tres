import{i as N,r as O,c as E,p as W,a as Y,l as z,m as X,d as H}from"./mat4.b13700a51706527826311.js";import{Z as k,a5 as q,o as V,c as j}from"./vendor.543c78401706527826311.js";const K={id:"canvaswebgl",style:{height:"500px",width:"500px"}},Z="\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\nuniform mat4 u_matrix;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = u_matrix * a_position;\n  v_texcoord = a_texcoord;\n}",J="\nprecision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nvoid main(){\n	gl_FragColor=texture2D(u_texture, v_texcoord.xy);\n}\n",te=k({__name:"webglFrameBuffer",setup(Q){const C=function(){var r=document.querySelector("#canvaswebgl"),e=r.getContext("webgl");if(!e)return;var s=N(e,Z,J),l=e.getAttribLocation(s,"a_position"),A=e.getAttribLocation(s,"a_texcoord"),y=e.getUniformLocation(s,"u_matrix"),I=e.getUniformLocation(s,"u_texture"),x=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,x),M(e);var d=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,d),h(e);var F=e.createTexture();e.bindTexture(e.TEXTURE_2D,F);{const a=e.RGBA,t=1,n=1,i=0,c=e.RGBA,T=e.UNSIGNED_BYTE,f=new Uint8Array([255,255,0,255]),m=1;e.pixelStorei(e.UNPACK_ALIGNMENT,m),e.texImage2D(e.TEXTURE_2D,0,a,t,n,i,c,T,f),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}const R=256,u=256,v=e.createTexture();e.bindTexture(e.TEXTURE_2D,v);{const a=e.RGBA,t=0,n=e.RGBA,i=e.UNSIGNED_BYTE,c=null;e.texImage2D(e.TEXTURE_2D,0,a,R,u,t,n,i,c),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}const U=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,U);const w=e.COLOR_ATTACHMENT0,S=0;e.framebufferTexture2D(e.FRAMEBUFFER,w,e.TEXTURE_2D,v,S);var b=H(0),p=0;requestAnimationFrame(D);function B(o){e.useProgram(s),e.enableVertexAttribArray(l),e.bindBuffer(e.ARRAY_BUFFER,x);var a=3,t=e.FLOAT,n=!1,i=0,c=0;e.vertexAttribPointer(l,a,t,n,i,c),e.enableVertexAttribArray(A),e.bindBuffer(e.ARRAY_BUFFER,d);var a=2,t=e.FLOAT,n=!1,i=0,c=0;e.vertexAttribPointer(A,a,t,n,i,c);var T=E();W(T,-30,o,.1,1e4);var f=[0,0,2],m=[0,1,0],G=[0,0,0];let _=E();_=Y(_,_,b,[0,1,0]);var g=E();z(g,f,G,m);let P=E();X(P,g,_);var L=E();X(L,T,P),e.uniformMatrix4fv(y,!1,L),e.uniform1i(I,0),e.drawArrays(e.TRIANGLES,0,36)}function D(o){o*=.001;var a=o-p;p=o,b+=-.4*a,O(e.canvas),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST);{e.bindFramebuffer(e.FRAMEBUFFER,U),e.bindTexture(e.TEXTURE_2D,F),e.viewport(0,0,R,u),e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const t=R/u;B(t)}{e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D,v),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const t=e.canvas.clientWidth/e.canvas.clientHeight;B(t)}requestAnimationFrame(D)}};q(()=>{C()});function M(r){var e=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW)}function h(r){r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1]),r.STATIC_DRAW)}return(r,e)=>(V(),j("canvas",K))}});export{te as default};
