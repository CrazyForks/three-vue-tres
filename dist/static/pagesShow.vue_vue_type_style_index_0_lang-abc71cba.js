import{a as gt,d as Dt,C as ve,D as $e,e as Ve,V as ue,I as Tt,F as Je,f as ze,g as ye,W as Bt,h as yt,U as Ce,i as Lt,j as Ie,k as vt,l as _t,m as Be,c as Ot,n as Pt,o as jt,E as Ze,B as Ut,S as Ft,N as Rt}from"./three.module-cbea6429.js";import{f as Nt,a as zt,l as kt,x as Ht}from"./trescientos-a922f233.js";import{g as Le}from"./_commonjsHelpers-725317a4.js";import{Y as We,j as wt,ae as bt,w as Vt,o as De,c as Ge,I as de,a9 as Qe,ak as Wt,s as Gt,B as Yt,aa as qt,U as be,a as je,ab as Kt,ac as Xt,C as $t,V as Jt,X as Zt}from"./vendor-19b019cc.js";const Qt=async()=>{const t=await Nt("./plugins/digitalCity/model/shanghai.FBX");let s=null,l=null;return t.traverse(o=>{o.name==="CITY_UNTRIANGULATED"&&(s=o),o.name==="LANDMASS"&&(l=o)}),{model:t,city:s,land:l}};function xe(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var St={exports:{}};(function(d,t){(function(s){d.exports=s()})(function(){return function s(l,o,m){function y(E,w){if(!o[E]){if(!l[E]){var P=typeof xe=="function"&&xe;if(!w&&P)return P(E,!0);if(A)return A(E,!0);throw new Error("Cannot find module '"+E+"'")}w=o[E]={exports:{}},l[E][0].call(w.exports,function(j){var O=l[E][1][j];return y(O||j)},w,w.exports,s,l,o,m)}return o[E].exports}for(var A=typeof xe=="function"&&xe,B=0;B<m.length;B++)y(m[B]);return y}({1:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){var b=s("crypto");function T(u,g){g=C(u,g);var r;return(r=g.algorithm!=="passthrough"?b.createHash(g.algorithm):new U).write===void 0&&(r.write=r.update,r.end=r.update),x(g,r).dispatch(u),r.update||r.end(""),r.digest?r.digest(g.encoding==="buffer"?void 0:g.encoding):(u=r.read(),g.encoding!=="buffer"?u.toString(g.encoding):u)}(o=l.exports=T).sha1=function(u){return T(u)},o.keys=function(u){return T(u,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},o.MD5=function(u){return T(u,{algorithm:"md5",encoding:"hex"})},o.keysMD5=function(u){return T(u,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var h=b.getHashes?b.getHashes().slice():["sha1","md5"],M=(h.push("passthrough"),["buffer","hex","binary","base64"]);function C(u,g){var r={};if(r.algorithm=(g=g||{}).algorithm||"sha1",r.encoding=g.encoding||"hex",r.excludeValues=!!g.excludeValues,r.algorithm=r.algorithm.toLowerCase(),r.encoding=r.encoding.toLowerCase(),r.ignoreUnknown=g.ignoreUnknown===!0,r.respectType=g.respectType!==!1,r.respectFunctionNames=g.respectFunctionNames!==!1,r.respectFunctionProperties=g.respectFunctionProperties!==!1,r.unorderedArrays=g.unorderedArrays===!0,r.unorderedSets=g.unorderedSets!==!1,r.unorderedObjects=g.unorderedObjects!==!1,r.replacer=g.replacer||void 0,r.excludeKeys=g.excludeKeys||void 0,u===void 0)throw new Error("Object argument required.");for(var a=0;a<h.length;++a)h[a].toLowerCase()===r.algorithm.toLowerCase()&&(r.algorithm=h[a]);if(h.indexOf(r.algorithm)===-1)throw new Error('Algorithm "'+r.algorithm+'"  not supported. supported values: '+h.join(", "));if(M.indexOf(r.encoding)===-1&&r.algorithm!=="passthrough")throw new Error('Encoding "'+r.encoding+'"  not supported. supported values: '+M.join(", "));return r}function v(u){if(typeof u=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(u))!=null}function x(u,g,r){r=r||[];function a(n){return g.update?g.update(n,"utf8"):g.write(n,"utf8")}return{dispatch:function(n){return this["_"+((n=u.replacer?u.replacer(n):n)===null?"null":typeof n)](n)},_object:function(n){var f,p=Object.prototype.toString.call(n),z=/\[object (.*)\]/i.exec(p);if(z=(z=z?z[1]:"unknown:["+p+"]").toLowerCase(),0<=(p=r.indexOf(n)))return this.dispatch("[CIRCULAR:"+p+"]");if(r.push(n),A!==void 0&&A.isBuffer&&A.isBuffer(n))return a("buffer:"),a(n);if(z==="object"||z==="function"||z==="asyncfunction")return p=Object.keys(n),u.unorderedObjects&&(p=p.sort()),u.respectType===!1||v(n)||p.splice(0,0,"prototype","__proto__","constructor"),u.excludeKeys&&(p=p.filter(function(F){return!u.excludeKeys(F)})),a("object:"+p.length+":"),f=this,p.forEach(function(F){f.dispatch(F),a(":"),u.excludeValues||f.dispatch(n[F]),a(",")});if(!this["_"+z]){if(u.ignoreUnknown)return a("["+z+"]");throw new Error('Unknown object type "'+z+'"')}this["_"+z](n)},_array:function(n,F){F=F!==void 0?F:u.unorderedArrays!==!1;var p=this;if(a("array:"+n.length+":"),!F||n.length<=1)return n.forEach(function(k){return p.dispatch(k)});var z=[],F=n.map(function(k){var L=new U,R=r.slice();return x(u,L,R).dispatch(k),z=z.concat(R.slice(r.length)),L.read().toString()});return r=r.concat(z),F.sort(),this._array(F,!1)},_date:function(n){return a("date:"+n.toJSON())},_symbol:function(n){return a("symbol:"+n.toString())},_error:function(n){return a("error:"+n.toString())},_boolean:function(n){return a("bool:"+n.toString())},_string:function(n){a("string:"+n.length+":"),a(n.toString())},_function:function(n){a("fn:"),v(n)?this.dispatch("[native]"):this.dispatch(n.toString()),u.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(n.name)),u.respectFunctionProperties&&this._object(n)},_number:function(n){return a("number:"+n.toString())},_xml:function(n){return a("xml:"+n.toString())},_null:function(){return a("Null")},_undefined:function(){return a("Undefined")},_regexp:function(n){return a("regex:"+n.toString())},_uint8array:function(n){return a("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){return a("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){return a("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){return a("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){return a("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){return a("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){return a("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){return a("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){return a("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){return a("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){return a("url:"+n.toString())},_map:function(n){return a("map:"),n=Array.from(n),this._array(n,u.unorderedSets!==!1)},_set:function(n){return a("set:"),n=Array.from(n),this._array(n,u.unorderedSets!==!1)},_file:function(n){return a("file:"),this.dispatch([n.name,n.size,n.type,n.lastModfied])},_blob:function(){if(u.ignoreUnknown)return a("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return a("domwindow")},_bigint:function(n){return a("bigint:"+n.toString())},_process:function(){return a("process")},_timer:function(){return a("timer")},_pipe:function(){return a("pipe")},_tcp:function(){return a("tcp")},_udp:function(){return a("udp")},_tty:function(){return a("tty")},_statwatcher:function(){return a("statwatcher")},_securecontext:function(){return a("securecontext")},_connection:function(){return a("connection")},_zlib:function(){return a("zlib")},_context:function(){return a("context")},_nodescript:function(){return a("nodescript")},_httpparser:function(){return a("httpparser")},_dataview:function(){return a("dataview")},_signal:function(){return a("signal")},_fsevent:function(){return a("fsevent")},_tlswrap:function(){return a("tlswrap")}}}function U(){return{buf:"",write:function(u){this.buf+=u},end:function(u){this.buf+=u},read:function(){return this.buf}}}o.writeToStream=function(u,g,r){return r===void 0&&(r=g,g={}),x(g=C(u,g),r).dispatch(u)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){(function(b){var T=typeof Uint8Array<"u"?Uint8Array:Array,h="+".charCodeAt(0),M="/".charCodeAt(0),C="0".charCodeAt(0),v="a".charCodeAt(0),x="A".charCodeAt(0),U="-".charCodeAt(0),u="_".charCodeAt(0);function g(r){return r=r.charCodeAt(0),r===h||r===U?62:r===M||r===u?63:r<C?-1:r<C+10?r-C+26+26:r<x+26?r-x:r<v+26?r-v+26:void 0}b.toByteArray=function(r){var a,n;if(0<r.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var f=r.length,f=r.charAt(f-2)==="="?2:r.charAt(f-1)==="="?1:0,p=new T(3*r.length/4-f),z=0<f?r.length-4:r.length,F=0;function k(L){p[F++]=L}for(a=0;a<z;a+=4,0)k((16711680&(n=g(r.charAt(a))<<18|g(r.charAt(a+1))<<12|g(r.charAt(a+2))<<6|g(r.charAt(a+3))))>>16),k((65280&n)>>8),k(255&n);return f==2?k(255&(n=g(r.charAt(a))<<2|g(r.charAt(a+1))>>4)):f==1&&(k((n=g(r.charAt(a))<<10|g(r.charAt(a+1))<<4|g(r.charAt(a+2))>>2)>>8&255),k(255&n)),p},b.fromByteArray=function(r){var a,n,f,p,z=r.length%3,F="";function k(L){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(L)}for(a=0,f=r.length-z;a<f;a+=3)n=(r[a]<<16)+(r[a+1]<<8)+r[a+2],F+=k((p=n)>>18&63)+k(p>>12&63)+k(p>>6&63)+k(63&p);switch(z){case 1:F=(F+=k((n=r[r.length-1])>>2))+k(n<<4&63)+"==";break;case 2:F=(F=(F+=k((n=(r[r.length-2]<<8)+r[r.length-1])>>10))+k(n>>4&63))+k(n<<2&63)+"="}return F}})(o===void 0?this.base64js={}:o)}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(s,l,o){(function(m,y,h,B,E,w,P,j,O){var b=s("base64-js"),T=s("ieee754");function h(e,i,c){if(!(this instanceof h))return new h(e,i,c);var S,_,D,H,q=typeof e;if(i==="base64"&&q=="string")for(e=(H=e).trim?H.trim():H.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if(q=="number")S=Y(e);else if(q=="string")S=h.byteLength(e,i);else{if(q!="object")throw new Error("First argument needs to be a number, array or string.");S=Y(e.length)}if(h._useTypedArrays?_=h._augment(new Uint8Array(S)):((_=this).length=S,_._isBuffer=!0),h._useTypedArrays&&typeof e.byteLength=="number")_._set(e);else if(G(H=e)||h.isBuffer(H)||H&&typeof H=="object"&&typeof H.length=="number")for(D=0;D<S;D++)h.isBuffer(e)?_[D]=e.readUInt8(D):_[D]=e[D];else if(q=="string")_.write(e,0,i);else if(q=="number"&&!h._useTypedArrays&&!c)for(D=0;D<S;D++)_[D]=0;return _}function M(e,i,c,S){return h._charsWritten=Se(function(_){for(var D=[],H=0;H<_.length;H++)D.push(255&_.charCodeAt(H));return D}(i),e,c,S)}function C(e,i,c,S){return h._charsWritten=Se(function(_){for(var D,H,q=[],X=0;X<_.length;X++)H=_.charCodeAt(X),D=H>>8,H=H%256,q.push(H),q.push(D);return q}(i),e,c,S)}function v(e,i,c){var S="";c=Math.min(e.length,c);for(var _=i;_<c;_++)S+=String.fromCharCode(e[_]);return S}function x(e,i,c,D){D||(I(typeof c=="boolean","missing or invalid endian"),I(i!=null,"missing offset"),I(i+1<e.length,"Trying to read beyond buffer length"));var _,D=e.length;if(!(D<=i))return c?(_=e[i],i+1<D&&(_|=e[i+1]<<8)):(_=e[i]<<8,i+1<D&&(_|=e[i+1])),_}function U(e,i,c,D){D||(I(typeof c=="boolean","missing or invalid endian"),I(i!=null,"missing offset"),I(i+3<e.length,"Trying to read beyond buffer length"));var _,D=e.length;if(!(D<=i))return c?(i+2<D&&(_=e[i+2]<<16),i+1<D&&(_|=e[i+1]<<8),_|=e[i],i+3<D&&(_+=e[i+3]<<24>>>0)):(i+1<D&&(_=e[i+1]<<16),i+2<D&&(_|=e[i+2]<<8),i+3<D&&(_|=e[i+3]),_+=e[i]<<24>>>0),_}function u(e,i,c,S){if(S||(I(typeof c=="boolean","missing or invalid endian"),I(i!=null,"missing offset"),I(i+1<e.length,"Trying to read beyond buffer length")),!(e.length<=i))return S=x(e,i,c,!0),32768&S?-1*(65535-S+1):S}function g(e,i,c,S){if(S||(I(typeof c=="boolean","missing or invalid endian"),I(i!=null,"missing offset"),I(i+3<e.length,"Trying to read beyond buffer length")),!(e.length<=i))return S=U(e,i,c,!0),2147483648&S?-1*(4294967295-S+1):S}function r(e,i,c,S){return S||(I(typeof c=="boolean","missing or invalid endian"),I(i+3<e.length,"Trying to read beyond buffer length")),T.read(e,i,c,23,4)}function a(e,i,c,S){return S||(I(typeof c=="boolean","missing or invalid endian"),I(i+7<e.length,"Trying to read beyond buffer length")),T.read(e,i,c,52,8)}function n(e,i,c,S,_){if(_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+1<e.length,"trying to write beyond buffer length"),Oe(i,65535)),_=e.length,!(_<=c))for(var D=0,H=Math.min(_-c,2);D<H;D++)e[c+D]=(i&255<<8*(S?D:1-D))>>>8*(S?D:1-D)}function f(e,i,c,S,_){if(_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+3<e.length,"trying to write beyond buffer length"),Oe(i,4294967295)),_=e.length,!(_<=c))for(var D=0,H=Math.min(_-c,4);D<H;D++)e[c+D]=i>>>8*(S?D:3-D)&255}function p(e,i,c,S,_){_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+1<e.length,"Trying to write beyond buffer length"),Pe(i,32767,-32768)),e.length<=c||n(e,0<=i?i:65535+i+1,c,S,_)}function z(e,i,c,S,_){_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+3<e.length,"Trying to write beyond buffer length"),Pe(i,2147483647,-2147483648)),e.length<=c||f(e,0<=i?i:4294967295+i+1,c,S,_)}function F(e,i,c,S,_){_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+3<e.length,"Trying to write beyond buffer length"),Ke(i,34028234663852886e22,-34028234663852886e22)),e.length<=c||T.write(e,i,c,S,23,4)}function k(e,i,c,S,_){_||(I(i!=null,"missing value"),I(typeof S=="boolean","missing or invalid endian"),I(c!=null,"missing offset"),I(c+7<e.length,"Trying to write beyond buffer length"),Ke(i,17976931348623157e292,-17976931348623157e292)),e.length<=c||T.write(e,i,c,S,52,8)}o.Buffer=h,o.SlowBuffer=h,o.INSPECT_MAX_BYTES=50,h.poolSize=8192,h._useTypedArrays=function(){try{var e=new ArrayBuffer(0),i=new Uint8Array(e);return i.foo=function(){return 42},i.foo()===42&&typeof i.subarray=="function"}catch(c){return!1}}(),h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.isBuffer=function(e){return!(e==null||!e._isBuffer)},h.byteLength=function(e,i){var c;switch(e+="",i||"utf8"){case"hex":c=e.length/2;break;case"utf8":case"utf-8":c=ce(e).length;break;case"ascii":case"binary":case"raw":c=e.length;break;case"base64":c=Ye(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*e.length;break;default:throw new Error("Unknown encoding")}return c},h.concat=function(e,i){if(I(G(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),e.length===0)return new h(0);if(e.length===1)return e[0];if(typeof i!="number")for(_=i=0;_<e.length;_++)i+=e[_].length;for(var c=new h(i),S=0,_=0;_<e.length;_++){var D=e[_];D.copy(c,S),S+=D.length}return c},h.prototype.write=function(e,i,c,S){isFinite(i)?isFinite(c)||(S=c,c=void 0):(X=S,S=i,i=c,c=X),i=Number(i)||0;var _,D,H,q,X=this.length-i;switch((!c||X<(c=Number(c)))&&(c=X),S=String(S||"utf8").toLowerCase()){case"hex":_=function(ie,ee,te,$){te=Number(te)||0;var K=ie.length-te;(!$||K<($=Number($)))&&($=K),I((K=ee.length)%2==0,"Invalid hex string"),K/2<$&&($=K/2);for(var he=0;he<$;he++){var Xe=parseInt(ee.substr(2*he,2),16);I(!isNaN(Xe),"Invalid hex string"),ie[te+he]=Xe}return h._charsWritten=2*he,he}(this,e,i,c);break;case"utf8":case"utf-8":D=this,H=i,q=c,_=h._charsWritten=Se(ce(e),D,H,q);break;case"ascii":case"binary":_=M(this,e,i,c);break;case"base64":D=this,H=i,q=c,_=h._charsWritten=Se(Ye(e),D,H,q);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":_=C(this,e,i,c);break;default:throw new Error("Unknown encoding")}return _},h.prototype.toString=function(e,i,c){var S,_,D,H,q=this;if(e=String(e||"utf8").toLowerCase(),i=Number(i)||0,(c=c!==void 0?Number(c):q.length)===i)return"";switch(e){case"hex":S=function(X,ie,ee){var te=X.length;(!ie||ie<0)&&(ie=0),(!ee||ee<0||te<ee)&&(ee=te);for(var $="",K=ie;K<ee;K++)$+=V(X[K]);return $}(q,i,c);break;case"utf8":case"utf-8":S=function(X,ie,ee){var te="",$="";ee=Math.min(X.length,ee);for(var K=ie;K<ee;K++)X[K]<=127?(te+=qe($)+String.fromCharCode(X[K]),$=""):$+="%"+X[K].toString(16);return te+qe($)}(q,i,c);break;case"ascii":case"binary":S=v(q,i,c);break;case"base64":_=q,H=c,S=(D=i)===0&&H===_.length?b.fromByteArray(_):b.fromByteArray(_.slice(D,H));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":S=function(X,ie,ee){for(var te=X.slice(ie,ee),$="",K=0;K<te.length;K+=2)$+=String.fromCharCode(te[K]+256*te[K+1]);return $}(q,i,c);break;default:throw new Error("Unknown encoding")}return S},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.copy=function(e,i,c,S){if(i=i||0,(S=S||S===0?S:this.length)!==(c=c||0)&&e.length!==0&&this.length!==0){I(c<=S,"sourceEnd < sourceStart"),I(0<=i&&i<e.length,"targetStart out of bounds"),I(0<=c&&c<this.length,"sourceStart out of bounds"),I(0<=S&&S<=this.length,"sourceEnd out of bounds"),S>this.length&&(S=this.length);var _=(S=e.length-i<S-c?e.length-i+c:S)-c;if(_<100||!h._useTypedArrays)for(var D=0;D<_;D++)e[D+i]=this[D+c];else e._set(this.subarray(c,c+_),i)}},h.prototype.slice=function(e,i){var c=this.length;if(e=R(e,c,0),i=R(i,c,c),h._useTypedArrays)return h._augment(this.subarray(e,i));for(var S=i-e,_=new h(S,void 0,!0),D=0;D<S;D++)_[D]=this[D+e];return _},h.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},h.prototype.set=function(e,i){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,i)},h.prototype.readUInt8=function(e,i){if(i||(I(e!=null,"missing offset"),I(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},h.prototype.readUInt16LE=function(e,i){return x(this,e,!0,i)},h.prototype.readUInt16BE=function(e,i){return x(this,e,!1,i)},h.prototype.readUInt32LE=function(e,i){return U(this,e,!0,i)},h.prototype.readUInt32BE=function(e,i){return U(this,e,!1,i)},h.prototype.readInt8=function(e,i){if(i||(I(e!=null,"missing offset"),I(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,i){return u(this,e,!0,i)},h.prototype.readInt16BE=function(e,i){return u(this,e,!1,i)},h.prototype.readInt32LE=function(e,i){return g(this,e,!0,i)},h.prototype.readInt32BE=function(e,i){return g(this,e,!1,i)},h.prototype.readFloatLE=function(e,i){return r(this,e,!0,i)},h.prototype.readFloatBE=function(e,i){return r(this,e,!1,i)},h.prototype.readDoubleLE=function(e,i){return a(this,e,!0,i)},h.prototype.readDoubleBE=function(e,i){return a(this,e,!1,i)},h.prototype.writeUInt8=function(e,i,c){c||(I(e!=null,"missing value"),I(i!=null,"missing offset"),I(i<this.length,"trying to write beyond buffer length"),Oe(e,255)),i>=this.length||(this[i]=e)},h.prototype.writeUInt16LE=function(e,i,c){n(this,e,i,!0,c)},h.prototype.writeUInt16BE=function(e,i,c){n(this,e,i,!1,c)},h.prototype.writeUInt32LE=function(e,i,c){f(this,e,i,!0,c)},h.prototype.writeUInt32BE=function(e,i,c){f(this,e,i,!1,c)},h.prototype.writeInt8=function(e,i,c){c||(I(e!=null,"missing value"),I(i!=null,"missing offset"),I(i<this.length,"Trying to write beyond buffer length"),Pe(e,127,-128)),i>=this.length||(0<=e?this.writeUInt8(e,i,c):this.writeUInt8(255+e+1,i,c))},h.prototype.writeInt16LE=function(e,i,c){p(this,e,i,!0,c)},h.prototype.writeInt16BE=function(e,i,c){p(this,e,i,!1,c)},h.prototype.writeInt32LE=function(e,i,c){z(this,e,i,!0,c)},h.prototype.writeInt32BE=function(e,i,c){z(this,e,i,!1,c)},h.prototype.writeFloatLE=function(e,i,c){F(this,e,i,!0,c)},h.prototype.writeFloatBE=function(e,i,c){F(this,e,i,!1,c)},h.prototype.writeDoubleLE=function(e,i,c){k(this,e,i,!0,c)},h.prototype.writeDoubleBE=function(e,i,c){k(this,e,i,!1,c)},h.prototype.fill=function(e,i,c){if(i=i||0,c=c||this.length,I(typeof(e=typeof(e=e||0)=="string"?e.charCodeAt(0):e)=="number"&&!isNaN(e),"value is not a number"),I(i<=c,"end < start"),c!==i&&this.length!==0){I(0<=i&&i<this.length,"start out of bounds"),I(0<=c&&c<=this.length,"end out of bounds");for(var S=i;S<c;S++)this[S]=e}},h.prototype.inspect=function(){for(var e=[],i=this.length,c=0;c<i;c++)if(e[c]=V(this[c]),c===o.INSPECT_MAX_BYTES){e[c+1]="...";break}return"<Buffer "+e.join(" ")+">"},h.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(h._useTypedArrays)return new h(this).buffer;for(var e=new Uint8Array(this.length),i=0,c=e.length;i<c;i+=1)e[i]=this[i];return e.buffer};var L=h.prototype;function R(e,i,c){return typeof e!="number"?c:i<=(e=~~e)?i:0<=e||0<=(e+=i)?e:0}function Y(e){return(e=~~Math.ceil(+e))<0?0:e}function G(e){return(Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"})(e)}function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function ce(e){for(var i=[],c=0;c<e.length;c++){var S=e.charCodeAt(c);if(S<=127)i.push(e.charCodeAt(c));else for(var _=c,D=(55296<=S&&S<=57343&&c++,encodeURIComponent(e.slice(_,c+1)).substr(1).split("%")),H=0;H<D.length;H++)i.push(parseInt(D[H],16))}return i}function Ye(e){return b.toByteArray(e)}function Se(e,i,c,S){for(var _=0;_<S&&!(_+c>=i.length||_>=e.length);_++)i[_+c]=e[_];return _}function qe(e){try{return decodeURIComponent(e)}catch(i){return String.fromCharCode(65533)}}function Oe(e,i){I(typeof e=="number","cannot write a non-number as a number"),I(0<=e,"specified a negative value for writing an unsigned value"),I(e<=i,"value is larger than maximum value for type"),I(Math.floor(e)===e,"value has a fractional component")}function Pe(e,i,c){I(typeof e=="number","cannot write a non-number as a number"),I(e<=i,"value larger than maximum allowed value"),I(c<=e,"value smaller than minimum allowed value"),I(Math.floor(e)===e,"value has a fractional component")}function Ke(e,i,c){I(typeof e=="number","cannot write a non-number as a number"),I(e<=i,"value larger than maximum allowed value"),I(c<=e,"value smaller than minimum allowed value")}function I(e,i){if(!e)throw new Error(i||"Failed assertion")}h._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=L.get,e.set=L.set,e.write=L.write,e.toString=L.toString,e.toLocaleString=L.toString,e.toJSON=L.toJSON,e.copy=L.copy,e.slice=L.slice,e.readUInt8=L.readUInt8,e.readUInt16LE=L.readUInt16LE,e.readUInt16BE=L.readUInt16BE,e.readUInt32LE=L.readUInt32LE,e.readUInt32BE=L.readUInt32BE,e.readInt8=L.readInt8,e.readInt16LE=L.readInt16LE,e.readInt16BE=L.readInt16BE,e.readInt32LE=L.readInt32LE,e.readInt32BE=L.readInt32BE,e.readFloatLE=L.readFloatLE,e.readFloatBE=L.readFloatBE,e.readDoubleLE=L.readDoubleLE,e.readDoubleBE=L.readDoubleBE,e.writeUInt8=L.writeUInt8,e.writeUInt16LE=L.writeUInt16LE,e.writeUInt16BE=L.writeUInt16BE,e.writeUInt32LE=L.writeUInt32LE,e.writeUInt32BE=L.writeUInt32BE,e.writeInt8=L.writeInt8,e.writeInt16LE=L.writeInt16LE,e.writeInt16BE=L.writeInt16BE,e.writeInt32LE=L.writeInt32LE,e.writeInt32BE=L.writeInt32BE,e.writeFloatLE=L.writeFloatLE,e.writeFloatBE=L.writeFloatBE,e.writeDoubleLE=L.writeDoubleLE,e.writeDoubleBE=L.writeDoubleBE,e.fill=L.fill,e.inspect=L.inspect,e.toArrayBuffer=L.toArrayBuffer,e}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(s,l,o){(function(m,y,b,B,E,w,P,j,O){var b=s("buffer").Buffer,T=4,h=new b(T);h.fill(0),l.exports={hash:function(M,C,v,x){for(var U=C(function(n,f){n.length%T!=0&&(p=n.length+(T-n.length%T),n=b.concat([n,h],p));for(var p,z=[],F=f?n.readInt32BE:n.readInt32LE,k=0;k<n.length;k+=T)z.push(F.call(n,k));return z}(M=b.isBuffer(M)?M:new b(M),x),8*M.length),C=x,u=new b(v),g=C?u.writeInt32BE:u.writeInt32LE,r=0;r<U.length;r++)g.call(u,U[r],4*r,!0);return u}}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(s,l,o){(function(m,y,b,B,E,w,P,j,O){var b=s("buffer").Buffer,T=s("./sha"),h=s("./sha256"),M=s("./rng"),C={sha1:T,sha256:h,md5:s("./md5")},v=64,x=new b(v);function U(n,f){var p=C[n=n||"sha1"],z=[];return p||u("algorithm:",n,"is not yet supported"),{update:function(F){return b.isBuffer(F)||(F=new b(F)),z.push(F),F.length,this},digest:function(F){var k=b.concat(z),k=f?function(L,R,Y){b.isBuffer(R)||(R=new b(R)),b.isBuffer(Y)||(Y=new b(Y)),R.length>v?R=L(R):R.length<v&&(R=b.concat([R,x],v));for(var G=new b(v),V=new b(v),ce=0;ce<v;ce++)G[ce]=54^R[ce],V[ce]=92^R[ce];return Y=L(b.concat([G,Y])),L(b.concat([V,Y]))}(p,f,k):p(k);return z=null,F?k.toString(F):k}}}function u(){var n=[].slice.call(arguments).join(" ");throw new Error([n,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}x.fill(0),o.createHash=function(n){return U(n)},o.createHmac=U,o.randomBytes=function(n,f){if(!f||!f.call)return new b(M(n));try{f.call(this,void 0,new b(M(n)))}catch(p){f(p)}};var g,r=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],a=function(n){o[n]=function(){u("sorry,",n,"is not implemented yet")}};for(g in r)a(r[g])}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){var b=s("./helpers");function T(u,g){u[g>>5]|=128<<g%32,u[14+(g+64>>>9<<4)]=g;for(var r=1732584193,a=-271733879,n=-1732584194,f=271733878,p=0;p<u.length;p+=16){var z=r,F=a,k=n,L=f,r=M(r,a,n,f,u[p+0],7,-680876936),f=M(f,r,a,n,u[p+1],12,-389564586),n=M(n,f,r,a,u[p+2],17,606105819),a=M(a,n,f,r,u[p+3],22,-1044525330);r=M(r,a,n,f,u[p+4],7,-176418897),f=M(f,r,a,n,u[p+5],12,1200080426),n=M(n,f,r,a,u[p+6],17,-1473231341),a=M(a,n,f,r,u[p+7],22,-45705983),r=M(r,a,n,f,u[p+8],7,1770035416),f=M(f,r,a,n,u[p+9],12,-1958414417),n=M(n,f,r,a,u[p+10],17,-42063),a=M(a,n,f,r,u[p+11],22,-1990404162),r=M(r,a,n,f,u[p+12],7,1804603682),f=M(f,r,a,n,u[p+13],12,-40341101),n=M(n,f,r,a,u[p+14],17,-1502002290),r=C(r,a=M(a,n,f,r,u[p+15],22,1236535329),n,f,u[p+1],5,-165796510),f=C(f,r,a,n,u[p+6],9,-1069501632),n=C(n,f,r,a,u[p+11],14,643717713),a=C(a,n,f,r,u[p+0],20,-373897302),r=C(r,a,n,f,u[p+5],5,-701558691),f=C(f,r,a,n,u[p+10],9,38016083),n=C(n,f,r,a,u[p+15],14,-660478335),a=C(a,n,f,r,u[p+4],20,-405537848),r=C(r,a,n,f,u[p+9],5,568446438),f=C(f,r,a,n,u[p+14],9,-1019803690),n=C(n,f,r,a,u[p+3],14,-187363961),a=C(a,n,f,r,u[p+8],20,1163531501),r=C(r,a,n,f,u[p+13],5,-1444681467),f=C(f,r,a,n,u[p+2],9,-51403784),n=C(n,f,r,a,u[p+7],14,1735328473),r=v(r,a=C(a,n,f,r,u[p+12],20,-1926607734),n,f,u[p+5],4,-378558),f=v(f,r,a,n,u[p+8],11,-2022574463),n=v(n,f,r,a,u[p+11],16,1839030562),a=v(a,n,f,r,u[p+14],23,-35309556),r=v(r,a,n,f,u[p+1],4,-1530992060),f=v(f,r,a,n,u[p+4],11,1272893353),n=v(n,f,r,a,u[p+7],16,-155497632),a=v(a,n,f,r,u[p+10],23,-1094730640),r=v(r,a,n,f,u[p+13],4,681279174),f=v(f,r,a,n,u[p+0],11,-358537222),n=v(n,f,r,a,u[p+3],16,-722521979),a=v(a,n,f,r,u[p+6],23,76029189),r=v(r,a,n,f,u[p+9],4,-640364487),f=v(f,r,a,n,u[p+12],11,-421815835),n=v(n,f,r,a,u[p+15],16,530742520),r=x(r,a=v(a,n,f,r,u[p+2],23,-995338651),n,f,u[p+0],6,-198630844),f=x(f,r,a,n,u[p+7],10,1126891415),n=x(n,f,r,a,u[p+14],15,-1416354905),a=x(a,n,f,r,u[p+5],21,-57434055),r=x(r,a,n,f,u[p+12],6,1700485571),f=x(f,r,a,n,u[p+3],10,-1894986606),n=x(n,f,r,a,u[p+10],15,-1051523),a=x(a,n,f,r,u[p+1],21,-2054922799),r=x(r,a,n,f,u[p+8],6,1873313359),f=x(f,r,a,n,u[p+15],10,-30611744),n=x(n,f,r,a,u[p+6],15,-1560198380),a=x(a,n,f,r,u[p+13],21,1309151649),r=x(r,a,n,f,u[p+4],6,-145523070),f=x(f,r,a,n,u[p+11],10,-1120210379),n=x(n,f,r,a,u[p+2],15,718787259),a=x(a,n,f,r,u[p+9],21,-343485551),r=U(r,z),a=U(a,F),n=U(n,k),f=U(f,L)}return Array(r,a,n,f)}function h(u,g,r,a,n,f){return U((g=U(U(g,u),U(a,f)))<<n|g>>>32-n,r)}function M(u,g,r,a,n,f,p){return h(g&r|~g&a,u,g,n,f,p)}function C(u,g,r,a,n,f,p){return h(g&a|r&~a,u,g,n,f,p)}function v(u,g,r,a,n,f,p){return h(g^r^a,u,g,n,f,p)}function x(u,g,r,a,n,f,p){return h(r^(g|~a),u,g,n,f,p)}function U(u,g){var r=(65535&u)+(65535&g);return(u>>16)+(g>>16)+(r>>16)<<16|65535&r}l.exports=function(u){return b.hash(u,T,16)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){l.exports=function(b){for(var T,h=new Array(b),M=0;M<b;M++)!(3&M)&&(T=4294967296*Math.random()),h[M]=T>>>((3&M)<<3)&255;return h}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){var b=s("./helpers");function T(C,v){C[v>>5]|=128<<24-v%32,C[15+(v+64>>9<<4)]=v;for(var x,U,u,g=Array(80),r=1732584193,a=-271733879,n=-1732584194,f=271733878,p=-1009589776,z=0;z<C.length;z+=16){for(var F=r,k=a,L=n,R=f,Y=p,G=0;G<80;G++){g[G]=G<16?C[z+G]:M(g[G-3]^g[G-8]^g[G-14]^g[G-16],1);var V=h(h(M(r,5),(V=a,U=n,u=f,(x=G)<20?V&U|~V&u:!(x<40)&&x<60?V&U|V&u|U&u:V^U^u)),h(h(p,g[G]),(x=G)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),p=f,f=n,n=M(a,30),a=r,r=V}r=h(r,F),a=h(a,k),n=h(n,L),f=h(f,R),p=h(p,Y)}return Array(r,a,n,f,p)}function h(C,v){var x=(65535&C)+(65535&v);return(C>>16)+(v>>16)+(x>>16)<<16|65535&x}function M(C,v){return C<<v|C>>>32-v}l.exports=function(C){return b.hash(C,T,20,!0)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){function b(v,x){var U=(65535&v)+(65535&x);return(v>>16)+(x>>16)+(U>>16)<<16|65535&U}function T(v,x){var U,u=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),r=new Array(64);v[x>>5]|=128<<24-x%32,v[15+(x+64>>9<<4)]=x;for(var a,n,f=0;f<v.length;f+=16){for(var p=g[0],z=g[1],F=g[2],k=g[3],L=g[4],R=g[5],Y=g[6],G=g[7],V=0;V<64;V++)r[V]=V<16?v[V+f]:b(b(b((n=r[V-2],M(n,17)^M(n,19)^C(n,10)),r[V-7]),(n=r[V-15],M(n,7)^M(n,18)^C(n,3))),r[V-16]),U=b(b(b(b(G,M(n=L,6)^M(n,11)^M(n,25)),L&R^~L&Y),u[V]),r[V]),a=b(M(a=p,2)^M(a,13)^M(a,22),p&z^p&F^z&F),G=Y,Y=R,R=L,L=b(k,U),k=F,F=z,z=p,p=b(U,a);g[0]=b(p,g[0]),g[1]=b(z,g[1]),g[2]=b(F,g[2]),g[3]=b(k,g[3]),g[4]=b(L,g[4]),g[5]=b(R,g[5]),g[6]=b(Y,g[6]),g[7]=b(G,g[7])}return g}var h=s("./helpers"),M=function(v,x){return v>>>x|v<<32-x},C=function(v,x){return v>>>x};l.exports=function(v){return h.hash(v,T,32,!0)}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){o.read=function(b,T,h,M,f){var v,x,U=8*f-M-1,u=(1<<U)-1,g=u>>1,r=-7,a=h?f-1:0,n=h?-1:1,f=b[T+a];for(a+=n,v=f&(1<<-r)-1,f>>=-r,r+=U;0<r;v=256*v+b[T+a],a+=n,r-=8);for(x=v&(1<<-r)-1,v>>=-r,r+=M;0<r;x=256*x+b[T+a],a+=n,r-=8);if(v===0)v=1-g;else{if(v===u)return x?NaN:1/0*(f?-1:1);x+=Math.pow(2,M),v-=g}return(f?-1:1)*x*Math.pow(2,v-M)},o.write=function(b,T,h,M,C,p){var x,U,u=8*p-C-1,g=(1<<u)-1,r=g>>1,a=C===23?Math.pow(2,-24)-Math.pow(2,-77):0,n=M?0:p-1,f=M?1:-1,p=T<0||T===0&&1/T<0?1:0;for(T=Math.abs(T),isNaN(T)||T===1/0?(U=isNaN(T)?1:0,x=g):(x=Math.floor(Math.log(T)/Math.LN2),T*(M=Math.pow(2,-x))<1&&(x--,M*=2),2<=(T+=1<=x+r?a/M:a*Math.pow(2,1-r))*M&&(x++,M/=2),g<=x+r?(U=0,x=g):1<=x+r?(U=(T*M-1)*Math.pow(2,C),x+=r):(U=T*Math.pow(2,r-1)*Math.pow(2,C),x=0));8<=C;b[h+n]=255&U,n+=f,U/=256,C-=8);for(x=x<<C|U,u+=C;0<u;b[h+n]=255&x,n+=f,x/=256,u-=8);b[h+n-f]|=128*p}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(s,l,o){(function(m,y,A,B,E,w,P,j,O){var b,T,h;function M(){}(m=l.exports={}).nextTick=(T=typeof window<"u"&&window.setImmediate,h=typeof window<"u"&&window.postMessage&&window.addEventListener,T?function(C){return window.setImmediate(C)}:h?(b=[],window.addEventListener("message",function(C){var v=C.source;v!==window&&v!==null||C.data!=="process-tick"||(C.stopPropagation(),0<b.length&&b.shift()())},!0),function(C){b.push(C),window.postMessage("process-tick","*")}):function(C){setTimeout(C,0)}),m.title="browser",m.browser=!0,m.env={},m.argv=[],m.on=M,m.addListener=M,m.once=M,m.off=M,m.removeListener=M,m.removeAllListeners=M,m.emit=M,m.binding=function(C){throw new Error("process.binding is not supported")},m.cwd=function(){return"/"},m.chdir=function(C){throw new Error("process.chdir is not supported")}}).call(this,s("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},s("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(St);var en=St.exports;const tn=Le(en);var xt=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"],nn=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"],Mt=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],rn=xt,on=rn.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"]),ke=Mt;ke=ke.slice().filter(function(d){return!/^(gl\_|texture)/.test(d)});var an=ke.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]),sn=yn,ln=xt,et=nn,cn=Mt,un=on,fn=an,oe=999,tt=9999,Ue=0,Fe=1,nt=2,rt=3,it=4,_e=5,dn=6,pn=7,hn=8,ot=9,mn=10,at=11,gn=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function yn(d){var t=0,s=0,l=oe,o,m,y=[],A=[],B=1,E=0,w=0,P=!1,j=!1,O="",b;d=d||{};var T=cn,h=ln;d.version==="300 es"&&(T=fn,h=un);for(var M={},C={},t=0;t<T.length;t++)M[T[t]]=!0;for(var t=0;t<h.length;t++)C[h[t]]=!0;return function(R){return A=[],R!==null?x(R):U()};function v(R){R.length&&A.push({type:gn[l],data:R,position:w,line:B,column:E})}function x(R){t=0,R.toString&&(R=R.toString()),O+=R.replace(/\r\n/g,"\n"),b=O.length;for(var Y;o=O[t],t<b;){switch(Y=t,l){case Ue:t=n();break;case Fe:t=a();break;case nt:t=r();break;case rt:t=f();break;case it:t=F();break;case at:t=z();break;case _e:t=k();break;case tt:t=L();break;case ot:t=g();break;case oe:t=u();break}if(Y!==t)switch(O[Y]){case"\n":E=0,++B;break;default:++E;break}}return s+=t,O=O.slice(t),A}function U(R){return y.length&&v(y.join("")),l=mn,v("(eof)"),A}function u(){return y=y.length?[]:y,m==="/"&&o==="*"?(w=s+t-1,l=Ue,m=o,t+1):m==="/"&&o==="/"?(w=s+t-1,l=Fe,m=o,t+1):o==="#"?(l=nt,w=s+t,t):/\s/.test(o)?(l=ot,w=s+t,t):(P=/\d/.test(o),j=/[^\w_]/.test(o),w=s+t,l=P?it:j?rt:tt,t)}function g(){return/[^\s]/g.test(o)?(v(y.join("")),l=oe,t):(y.push(o),m=o,t+1)}function r(){return(o==="\r"||o==="\n")&&m!=="\\"?(v(y.join("")),l=oe,t):(y.push(o),m=o,t+1)}function a(){return r()}function n(){return o==="/"&&m==="*"?(y.push(o),v(y.join("")),l=oe,t+1):(y.push(o),m=o,t+1)}function f(){if(m==="."&&/\d/.test(o))return l=_e,t;if(m==="/"&&o==="*")return l=Ue,t;if(m==="/"&&o==="/")return l=Fe,t;if(o==="."&&y.length){for(;p(y););return l=_e,t}if(o===";"||o===")"||o==="("){if(y.length)for(;p(y););return v(o),l=oe,t+1}var R=y.length===2&&o!=="=";if(/[\w_\d\s]/.test(o)||R){for(;p(y););return l=oe,t}return y.push(o),m=o,t+1}function p(R){var Y=0,G,V;do{if(G=et.indexOf(R.slice(0,R.length+Y).join("")),V=et[G],G===-1){if(Y--+R.length>0)continue;V=R.slice(0,1).join("")}return v(V),w+=V.length,y=y.slice(V.length),y.length}while(1)}function z(){return/[^a-fA-F0-9]/.test(o)?(v(y.join("")),l=oe,t):(y.push(o),m=o,t+1)}function F(){return o==="."||/[eE]/.test(o)?(y.push(o),l=_e,m=o,t+1):o==="x"&&y.length===1&&y[0]==="0"?(l=at,y.push(o),m=o,t+1):/[^\d]/.test(o)?(v(y.join("")),l=oe,t):(y.push(o),m=o,t+1)}function k(){return o==="f"&&(y.push(o),m=o,t+=1),/[eE]/.test(o)||(o==="-"||o==="+")&&/[eE]/.test(m)?(y.push(o),m=o,t+1):/[^\d]/.test(o)?(v(y.join("")),l=oe,t):(y.push(o),m=o,t+1)}function L(){if(/[^\d\w_]/.test(o)){var R=y.join("");return C[R]?l=hn:M[R]?l=pn:l=dn,v(y.join("")),l=oe,t}return y.push(o),m=o,t+1}}var vn=sn,_n=wn;function wn(d,t){var s=vn(t),l=[];return l=l.concat(s(d)),l=l.concat(s(null)),l}const bn=Le(_n);var Sn=xn;function xn(d){for(var t=[],s=0;s<d.length;s++)d[s].type!=="eof"&&t.push(d[s].data);return t.join("")}const st=Le(Sn);var Mn=En;function En(d){var t=null,s=null,l=0,o=0,m=0,y=0,A=0,B=[],E,w,P;for(E=0,w;E<d.length;E++)if(P=d[E],P.data==="{"){if(l&&l++||(w=O(E,fe(")"),fe()),w<0)||(y=w,w=O(w,fe("("),fe(")")),w<0)||(A=w,w=O(w,we),w<0)||d[w].type!=="ident"||(s=d[w].data,w=O(w,we),w<0))continue;l=1,o=E,t=d[w].data,m=w;var j=O(w,we);switch(d[j]&&d[j].data){case"lowp":case"highp":case"mediump":m=j}}else if(l&&P.data==="}"){if(--l)continue;B.push({name:s,type:t,body:[o+1,E],args:[A,y+1],outer:[m,E+1]})}for(E=0;E<d.length;E++)if(P=d[E],P.data===";"){if(w=O(E,fe(")"),fe()),w<0||(y=w,w=O(w,fe("("),fe(")")),w<0)||(A=w,w=O(w,we),w<0)||d[w].type!=="ident"||(s=d[w].data,w=O(w,we),w<0)||d[w].type==="operator"||d[w].data==="return")continue;t=d[w].data,B.push({name:s,type:t,body:!1,args:[A,y+1],outer:[w,E+1]})}return B.sort(function(b,T){return b.outer[0]-T.outer[0]});function O(b,T,h){for(var M=b-1;M>=0;M--){if(T(d[M]))return M;if(h&&h(d[M]))return-1}return-1}}function fe(d){return function(t){return t.type==="operator"&&(!d||t.data===d)}}function we(d){return d.type!=="whitespace"}const An=Le(Mn);function Cn(d,t){if(typeof d!="object"||d===null)return d;var s=d[Symbol.toPrimitive];if(s!==void 0){var l=s.call(d,t||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(d)}function Et(d){var t=Cn(d,"string");return typeof t=="symbol"?t:String(t)}function W(d,t,s){return t=Et(t),t in d?Object.defineProperty(d,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):d[t]=s,d}function lt(d,t){var s=Object.keys(d);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(d);t&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(d,o).enumerable})),s.push.apply(s,l)}return s}function me(d){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?lt(Object(s),!0).forEach(function(l){W(d,l,s[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(s)):lt(Object(s)).forEach(function(l){Object.defineProperty(d,l,Object.getOwnPropertyDescriptor(s,l))})}return d}function In(d,t){if(d==null)return{};var s={},l=Object.keys(d),o,m;for(m=0;m<l.length;m++)o=l[m],!(t.indexOf(o)>=0)&&(s[o]=d[o]);return s}function Dn(d,t){if(d==null)return{};var s=In(d,t),l,o;if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);for(o=0;o<m.length;o++)l=m[o],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(d,l)&&(s[l]=d[l])}return s}function Tn(d,t){if(!(d instanceof t))throw new TypeError("Cannot call a class as a function")}function ct(d,t){for(var s=0;s<t.length;s++){var l=t[s];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(d,Et(l.key),l)}}function Bn(d,t,s){return t&&ct(d.prototype,t),s&&ct(d,s),Object.defineProperty(d,"prototype",{writable:!1}),d}function At(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function He(d,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,o){return l.__proto__=o,l},He(d,t)}function Ln(d,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(t&&t.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),Object.defineProperty(d,"prototype",{writable:!1}),t&&He(d,t)}function Te(d){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},Te(d)}function On(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(d){return!1}}function Pn(d,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return At(d)}function jn(d){var t=On();return function(){var l=Te(d),o;if(t){var m=Te(this).constructor;o=Reflect.construct(l,arguments,m)}else o=l.apply(this,arguments);return Pn(this,o)}}var N={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},ne,ge,Un=(ne={},W(ne,"".concat(N.normal),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(N.normal,";\n    #ifdef USE_TANGENT\n	    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),W(ne,"".concat(N.position),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(N.position,";\n  ")}),W(ne,"".concat(N.positionRaw),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(N.positionRaw,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),W(ne,"".concat(N.pointSize),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(N.pointSize,";\n    ")}),W(ne,"".concat(N.diffuseColor),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(N.diffuseColor,";\n  ")}),W(ne,"".concat(N.fragColor),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(N.fragColor,";\n  ")}),W(ne,"".concat(N.emissive),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(N.emissive,";\n    ")}),W(ne,"".concat(N.roughness),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(N.roughness,";\n    ")}),W(ne,"".concat(N.metalness),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(N.metalness,";\n    ")}),W(ne,"".concat(N.ao),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(N.ao,";\n    ")}),W(ne,"".concat(N.bump),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(N.bump," - (dot(").concat(N.bump,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),W(ne,"".concat(N.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(N.depthAlpha," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(N.depthAlpha,";\n    ")}),ne),Fn=(ge={},W(ge,"".concat(N.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(N.position,", 1.0 );\n  ")}),W(ge,"".concat(N.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(N.position,";\n  ")}),W(ge,"".concat(N.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(N.diffuseColor,";\n  ")}),W(ge,"".concat(N.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(N.fragColor,";\n  ")}),ge),Rn="\n\n#ifdef IS_VERTEX\n    // csm_Position & csm_PositionRaw\n    #ifdef IS_UNKNOWN\n        vec3 csm_Position = vec3(0.0);\n        vec4 csm_PositionRaw = vec4(0.0);\n        vec3 csm_Normal = vec3(0.0);\n    #else\n        vec3 csm_Position = position;\n        vec4 csm_PositionRaw = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n        vec3 csm_Normal = normal;\n    #endif\n\n    // csm_PointSize\n    #ifdef IS_POINTSMATERIAL\n        float csm_PointSize = size;\n    #endif\n#else\n    // csm_DiffuseColor & csm_FragColor\n    #if defined IS_UNKNOWN || defined IS_SHADERMATERIAL || defined IS_MESHDEPTHMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_SHADOWMATERIAL\n        vec4 csm_DiffuseColor = vec4(1.0, 0.0, 1.0, 1.0);\n        vec4 csm_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n    #else\n        #ifdef USE_MAP\n            vec4 _csm_sampledDiffuseColor = texture2D(map, vMapUv);\n\n            #ifdef DECODE_VIDEO_TEXTURE\n            // inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)\n            _csm_sampledDiffuseColor = vec4(mix(pow(_csm_sampledDiffuseColor.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), _csm_sampledDiffuseColor.rgb * 0.0773993808, vec3(lessThanEqual(_csm_sampledDiffuseColor.rgb, vec3(0.04045)))), _csm_sampledDiffuseColor.w);\n            #endif\n\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n            vec4 csm_FragColor = vec4(diffuse, opacity) * _csm_sampledDiffuseColor;\n        #else\n            vec4 csm_DiffuseColor = vec4(diffuse, opacity);\n            vec4 csm_FragColor = vec4(diffuse, opacity);\n        #endif\n    #endif\n\n    // csm_Emissive, csm_Roughness, csm_Metalness\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL\n        vec3 csm_Emissive = emissive;\n        float csm_Roughness = roughness;\n        float csm_Metalness = metalness;\n    #endif\n\n    // csm_AO\n    #if defined IS_MESHSTANDARDMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHBASICMATERIAL || defined IS_MESHLAMBERTMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHTOONMATERIAL\n        float csm_AO = 0.0;\n    #endif\n\n    // csm_Bump\n    #if defined IS_MESHLAMBERTMATERIAL || defined IS_MESHMATCAPMATERIAL || defined IS_MESHNORMALMATERIAL || defined IS_MESHPHONGMATERIAL || defined IS_MESHPHYSICALMATERIAL || defined IS_MESHSTANDARDMATERIAL || defined IS_MESHTOONMATERIAL || defined IS_SHADOWMATERIAL \n        vec3 csm_Bump = vec3(0.0);\n    #endif\n\n    float csm_DepthAlpha = 1.0;\n#endif\n",Nn="\n    varying mat4 csm_internal_vModelViewMatrix;\n",zn="\n    csm_internal_vModelViewMatrix = modelViewMatrix;\n",kn="\n    varying mat4 csm_internal_vModelViewMatrix;\n",Hn="\n    \n",re,Vn=(re={},W(re,"".concat(N.position),"*"),W(re,"".concat(N.positionRaw),"*"),W(re,"".concat(N.normal),"*"),W(re,"".concat(N.pointSize),["PointsMaterial"]),W(re,"".concat(N.diffuseColor),"*"),W(re,"".concat(N.fragColor),"*"),W(re,"".concat(N.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(N.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(N.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),W(re,"".concat(N.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),W(re,"".concat(N.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),W(re,"".concat(N.depthAlpha),"*"),re),Wn=["baseMaterial","fragmentShader","vertexShader","uniforms","patchMap","cacheKey","silent"],Gn=function(t,s,l){return t.split(s).join(l)},Yn=function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},qn=function(t,s){return new RegExp("\\b".concat(Yn(s),"\\b")).test(t)};function Kn(d){try{new d}catch(t){if(t.message.indexOf("is not a constructor")>=0)return!1}return!0}function Xn(d,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Object.assign(d,t);var l=Object.getPrototypeOf(t);Object.entries(Object.getOwnPropertyDescriptors(l)).filter(function(o){var m=typeof o[1].get=="function",y=typeof o[1].set=="function",A=typeof o[1].value=="function",B=o[0]==="constructor";return(m||y||A)&&!B}).forEach(function(o){if(typeof d[o[0]]=="function"){s||console.warn("Function ".concat(o[0]," already exists on CSM, renaming to base_").concat(o[0]));var m="base_".concat(o[0]);d[m]=o[1].value.bind(d);return}Object.defineProperty(d,o[0],o[1])})}function $n(d){var t=d.toString().trim(),s=t.substring(t.indexOf("{")+1,t.lastIndexOf("}"));return s.trim().length===0}function ut(d){return d.replace(/\s/g,"")}function Jn(d,t,s){var l=d.lastIndexOf(t);return l===-1?d:d.substring(0,l)+s+d.substring(l+t.length)}var Zn=function(d){Ln(s,d);var t=jn(s);function s(l){var o,m=l.baseMaterial,y=l.fragmentShader,A=l.vertexShader,B=l.uniforms,E=l.patchMap,w=l.cacheKey,P=l.silent,j=Dn(l,Wn);Tn(this,s);var O;if(Kn(m)?O=new m(j):(O=m,Object.assign(O,j)),O.type==="RawShaderMaterial")throw new Error("CustomShaderMaterial does not support RawShaderMaterial");o=t.call(this),Xn(At(o),O,P),o.__csm={patchMap:E||{},fragmentShader:y||"",vertexShader:A||"",cacheKey:w,baseMaterial:m,instanceID:gt.generateUUID(),type:O.type,isAlreadyExtended:!$n(O.onBeforeCompile),cacheHash:"",silent:P},o.uniforms=me(me({},o.uniforms||{}),B||{});{var b=o.__csm,T=b.fragmentShader,h=b.vertexShader,M=o.uniforms;o.__csm.cacheHash=o.getCacheHash(),o.generateMaterial(T,h,M)}return o}return Bn(s,[{key:"update",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.uniforms=o.uniforms||this.uniforms,Object.assign(this.__csm,o);var m=this.__csm,y=m.fragmentShader,A=m.vertexShader,B=this.uniforms,E=this.getCacheHash();this.__csm.cacheHash=E,this.generateMaterial(y,A,B)}},{key:"clone",value:function(){var o={baseMaterial:this.__csm.baseMaterial,fragmentShader:this.__csm.fragmentShader,vertexShader:this.__csm.vertexShader,uniforms:this.uniforms,silent:this.__csm.silent,patchMap:this.__csm.patchMap,cacheKey:this.__csm.cacheKey},m=new this.constructor(o);return Object.assign(this,m),m}},{key:"getCacheHash",value:function(){var o=this.__csm,m=o.fragmentShader,y=o.vertexShader,A=this.uniforms,B=Object.values(A).reduce(function(w,P){var j=P.value;return w+JSON.stringify(j)},""),E=ut(m)+ut(y)+B;return E.trim().length>0?tn(E):this.customProgramCacheKey()}},{key:"generateMaterial",value:function(o,m,y){var A=this,B=this.parseShader(o),E=this.parseShader(m);this.uniforms=y||{},this.customProgramCacheKey=function(){return A.__csm.cacheHash};var w=function(O){try{if(B){var b=A.patchShader(B,O.fragmentShader,!0);O.fragmentShader=A.getMaterialDefine()+b}if(E){var T=A.patchShader(E,O.vertexShader);O.vertexShader="#define IS_VERTEX;\n"+T,O.vertexShader=A.getMaterialDefine()+O.vertexShader}O.uniforms=me(me({},O.uniforms),A.uniforms),A.uniforms=O.uniforms}catch(h){console.error(h)}};if(this.__csm.isAlreadyExtended){var P=this.onBeforeCompile;this.onBeforeCompile=function(j,O){P(j,O),w(j)}}else this.onBeforeCompile=w;this.needsUpdate=!0}},{key:"patchShader",value:function(o,m,y){var A=this,B=m,E=me(me({},this.getPatchMapForMaterial()),this.__csm.patchMap);Object.keys(E).forEach(function(j){Object.keys(E[j]).forEach(function(O){var b=Vn[j],T=A.__csm.type;if(j==="*"||qn(o.main,j))if(!b||Array.isArray(b)&&b.includes(T)||b==="*")B=Gn(B,O,E[j][O]);else throw new Error("CSM: ".concat(j," is not available in ").concat(T,". Shader cannot compile."))})}),B=B.replace("void main() {","\n        #ifndef CSM_IS_HEAD_DEFAULTS_DEFINED\n          ".concat(y?kn:Nn,"\n          #define CSM_IS_HEAD_DEFAULTS_DEFINED 1\n        #endif\n\n        ").concat(o.header,"\n        \n        void main() {\n          #ifndef CSM_IS_DEFAULTS_DEFINED\n            ").concat(Rn,"\n            #define CSM_IS_DEFAULTS_DEFINED 1\n          #endif\n          \n          #ifndef CSM_IS_MAIN_DEFAULTS_DEFINED\n            ").concat(y?Hn:zn,"\n            #define CSM_IS_MAIN_DEFAULTS_DEFINED 1\n          #endif\n\n          // CSM_START\n      "));var w=this.__csm.isAlreadyExtended,P=B.includes("// CSM_END");return w&&P?B=Jn(B,"// CSM_END","\n          // CSM_END\n          ".concat(o.main,"\n          // CSM_END\n        ")):B=B.replace("// CSM_START","\n        // CSM_START\n        ".concat(o.main,"\n        // CSM_END\n          ")),B=o.defines+B,B}},{key:"parseShader",value:function(o){if(o){var m=o.replace(/\/\*\*(.*?)\*\/|\/\/(.*?)\n/gm,""),y=bn(m),A=An(y),B=A.map(function(P){return P.name}).indexOf("main"),E=st(y.slice(0,B>=0?A[B].outer[0]:void 0)),w=B>=0?this.getShaderFromIndex(y,A[B].body):"";return{defines:"",header:E,main:w}}}},{key:"getMaterialDefine",value:function(){var o=this.__csm.type;return o?"#define IS_".concat(o.toUpperCase(),";\n"):"#define IS_UNKNOWN;\n"}},{key:"getPatchMapForMaterial",value:function(){switch(this.__csm.type){case"ShaderMaterial":return Fn;default:return Un}}},{key:"getShaderFromIndex",value:function(o,m){return st(o.slice(m[0],m[1]))}}]),s}(Dt);const Qn=["object"],er=We({__name:"buildingsModelCustomShader",props:{model:{},bulidingsColor:{default:"#e523ff"},landColor:{default:"#112233"},opacity:{default:.9},gradient:{type:Boolean,default:!0}},setup(d){const t=d,s=wt(0),l=t.model.city;l.renderOrder=1001;const o=t.model.land,m=(E,w)=>{let P;E==="cu"||E==="land"&&(P=Array.isArray(o.material)?o.material:[o.material],P.forEach(j=>{j[w].setStyle(t.landColor),j.side=$e}))};(()=>{const{geometry:E}=l;E.computeBoundingBox(),E.computeBoundingSphere();const{max:w,min:P}=E.boundingBox;if(l.material.__csm)return;const j=new Zn({baseMaterial:l.material,vertexShader:"\n		varying vec4 vPosition;\n		void main() {\n			vPosition = modelMatrix * vec4(position,1.0);\n			csm_Position = position * vec3(1.0);\n		}\n		",fragmentShader:"\n		uniform mat4 modelMatrix;\n		varying vec4 vPosition;\n		uniform vec3 uMax; \n		uniform vec3 uMin; \n		uniform float uOpacity;  \n		uniform float uBorderWidth; \n		uniform vec3 uLightColor;\n		uniform vec3 uColor;\n		uniform float uCircleTime; \n		uniform float uTime; \n		uniform vec3 uTopColor;					//顶部颜色\n		uniform bool uGradient;\n		vec4 uMax_world;\n		vec4 uMin_world;\n		void main() {\n			// 转世界坐标\n			uMax_world =  modelMatrix * vec4(uMax,1.0);\n			uMin_world =  modelMatrix * vec4(uMin,1.0);\n			vec3 distColor = uColor;\n			float residue = uTime - floor(uTime / uCircleTime) * uCircleTime;\n			float rate = residue / uCircleTime;\n			float lightOffset = rate * (uMax_world.y - uMin_world.y);\n\n			if (uMin_world.y + lightOffset < vPosition.y && uMin_world.y + lightOffset + uBorderWidth > vPosition.y) {\n				csm_DiffuseColor = vec4(uLightColor, uOpacity);\n			} else {\n				csm_DiffuseColor = vec4(distColor, uOpacity);\n			}\n\n			//根据高度计算颜色\n			if(uGradient){\n				float rateHight = (vPosition.y - uMin_world.y) / (uMax_world.y - uMin_world.y); \n				vec3 outColor = mix(distColor, uTopColor, rateHight*2.0);\n				csm_DiffuseColor = vec4(outColor, uOpacity);\n			}\n    }\n		",silent:!0,uniforms:{uMax:{value:w},uMin:{value:P},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new ve(t.bulidingsColor)},uOpacity:{value:t.opacity},uLightColor:{value:new ve("#ffffff")},uTopColor:{value:new ve("#ffff00")},uTime:s,uGradient:{value:t.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:$e});l.material.dispose(),l.material=j})();const{onLoop:A}=zt();A(({delta:E})=>{s.value+=E}),bt(()=>{t.bulidingsColor&&l.material.uniforms.uColor.value.setStyle(t.bulidingsColor),t.landColor&&m("land","color"),t.opacity&&(l.material.uniforms.uOpacity.value=t.opacity)}),Vt(t,(E,w)=>{l.material.uniforms.uGradient.value=E.gradient});const B=t.model.model.clone();return(E,w)=>(De(),Ge("primitive",{object:de(B)},null,8,Qn))}}),ft=new Ve,Me=new ue;class Ct extends Tt{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const t=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],s=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],l=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(l),this.setAttribute("position",new Je(t,3)),this.setAttribute("uv",new Je(s,2))}applyMatrix4(t){const s=this.attributes.instanceStart,l=this.attributes.instanceEnd;return s!==void 0&&(s.applyMatrix4(t),l.applyMatrix4(t),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(t){let s;t instanceof Float32Array?s=t:Array.isArray(t)&&(s=new Float32Array(t));const l=new ze(s,6,1);return this.setAttribute("instanceStart",new ye(l,3,0)),this.setAttribute("instanceEnd",new ye(l,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let s;t instanceof Float32Array?s=t:Array.isArray(t)&&(s=new Float32Array(t));const l=new ze(s,6,1);return this.setAttribute("instanceColorStart",new ye(l,3,0)),this.setAttribute("instanceColorEnd",new ye(l,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new Bt(t.geometry)),this}fromLineSegments(t){const s=t.geometry;return this.setPositions(s.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ve);const t=this.attributes.instanceStart,s=this.attributes.instanceEnd;t!==void 0&&s!==void 0&&(this.boundingBox.setFromBufferAttribute(t),ft.setFromBufferAttribute(s),this.boundingBox.union(ft))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new yt),this.boundingBox===null&&this.computeBoundingBox();const t=this.attributes.instanceStart,s=this.attributes.instanceEnd;if(t!==void 0&&s!==void 0){const l=this.boundingSphere.center;this.boundingBox.getCenter(l);let o=0;for(let m=0,y=t.count;m<y;m++)Me.fromBufferAttribute(t,m),o=Math.max(o,l.distanceToSquared(Me)),Me.fromBufferAttribute(s,m),o=Math.max(o,l.distanceToSquared(Me));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}}Ce.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Lt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Ie.line={uniforms:vt.merge([Ce.common,Ce.fog,Ce.line]),vertexShader:"\n		#include <common>\n		#include <color_pars_vertex>\n		#include <fog_pars_vertex>\n		#include <logdepthbuf_pars_vertex>\n		#include <clipping_planes_pars_vertex>\n\n		uniform float linewidth;\n		uniform vec2 resolution;\n\n		attribute vec3 instanceStart;\n		attribute vec3 instanceEnd;\n\n		attribute vec3 instanceColorStart;\n		attribute vec3 instanceColorEnd;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#ifdef USE_DASH\n\n			uniform float dashScale;\n			attribute float instanceDistanceStart;\n			attribute float instanceDistanceEnd;\n			varying float vLineDistance;\n\n		#endif\n\n		void trimSegment( const in vec4 start, inout vec4 end ) {\n\n			// trim end segment so it terminates between the camera plane and the near plane\n\n			// conservative estimate of the near plane\n			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n			float nearEstimate = - 0.5 * b / a;\n\n			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n			end.xyz = mix( start.xyz, end.xyz, alpha );\n\n		}\n\n		void main() {\n\n			#ifdef USE_COLOR\n\n				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n			#endif\n\n			#ifdef USE_DASH\n\n				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n				vUv = uv;\n\n			#endif\n\n			float aspect = resolution.x / resolution.y;\n\n			// camera space\n			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n			#ifdef WORLD_UNITS\n\n				worldStart = start.xyz;\n				worldEnd = end.xyz;\n\n			#else\n\n				vUv = uv;\n\n			#endif\n\n			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n			// perhaps there is a more elegant solution -- WestLangley\n\n			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n			if ( perspective ) {\n\n				if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n					trimSegment( start, end );\n\n				} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n					trimSegment( end, start );\n\n				}\n\n			}\n\n			// clip space\n			vec4 clipStart = projectionMatrix * start;\n			vec4 clipEnd = projectionMatrix * end;\n\n			// ndc space\n			vec3 ndcStart = clipStart.xyz / clipStart.w;\n			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n			// direction\n			vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n			// account for clip-space aspect ratio\n			dir.x *= aspect;\n			dir = normalize( dir );\n\n			#ifdef WORLD_UNITS\n\n				// get the offset direction as perpendicular to the view vector\n				vec3 worldDir = normalize( end.xyz - start.xyz );\n				vec3 offset;\n				if ( position.y < 0.5 ) {\n\n					offset = normalize( cross( start.xyz, worldDir ) );\n\n				} else {\n\n					offset = normalize( cross( end.xyz, worldDir ) );\n\n				}\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n				// don't extend the line if we're rendering dashes because we\n				// won't be rendering the endcaps\n				#ifndef USE_DASH\n\n					// extend the line bounds to encompass  endcaps\n					start.xyz += - worldDir * linewidth * 0.5;\n					end.xyz += worldDir * linewidth * 0.5;\n\n					// shift the position of the quad so it hugs the forward edge of the line\n					offset.xy -= dir * forwardOffset;\n					offset.z += 0.5;\n\n				#endif\n\n				// endcaps\n				if ( position.y > 1.0 || position.y < 0.0 ) {\n\n					offset.xy += dir * 2.0 * forwardOffset;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth * 0.5;\n\n				// set the world position\n				worldPos = ( position.y < 0.5 ) ? start : end;\n				worldPos.xyz += offset;\n\n				// project the worldpos\n				vec4 clip = projectionMatrix * worldPos;\n\n				// shift the depth of the projected points so the line\n				// segments overlap neatly\n				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n				clip.z = clipPose.z * clip.w;\n\n			#else\n\n				vec2 offset = vec2( dir.y, - dir.x );\n				// undo aspect ratio adjustment\n				dir.x /= aspect;\n				offset.x /= aspect;\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				// endcaps\n				if ( position.y < 0.0 ) {\n\n					offset += - dir;\n\n				} else if ( position.y > 1.0 ) {\n\n					offset += dir;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth;\n\n				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n				offset /= resolution.y;\n\n				// select end\n				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n				// back to clip space\n				offset *= clip.w;\n\n				clip.xy += offset;\n\n			#endif\n\n			gl_Position = clip;\n\n			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n			#include <logdepthbuf_vertex>\n			#include <clipping_planes_vertex>\n			#include <fog_vertex>\n\n		}\n		",fragmentShader:"\n		uniform vec3 diffuse;\n		uniform float opacity;\n		uniform float linewidth;\n\n		#ifdef USE_DASH\n\n			uniform float dashOffset;\n			uniform float dashSize;\n			uniform float gapSize;\n\n		#endif\n\n		varying float vLineDistance;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#include <common>\n		#include <color_pars_fragment>\n		#include <fog_pars_fragment>\n		#include <logdepthbuf_pars_fragment>\n		#include <clipping_planes_pars_fragment>\n\n		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n			float mua;\n			float mub;\n\n			vec3 p13 = p1 - p3;\n			vec3 p43 = p4 - p3;\n\n			vec3 p21 = p2 - p1;\n\n			float d1343 = dot( p13, p43 );\n			float d4321 = dot( p43, p21 );\n			float d1321 = dot( p13, p21 );\n			float d4343 = dot( p43, p43 );\n			float d2121 = dot( p21, p21 );\n\n			float denom = d2121 * d4343 - d4321 * d4321;\n\n			float numer = d1343 * d4321 - d1321 * d4343;\n\n			mua = numer / denom;\n			mua = clamp( mua, 0.0, 1.0 );\n			mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n			mub = clamp( mub, 0.0, 1.0 );\n\n			return vec2( mua, mub );\n\n		}\n\n		void main() {\n\n			#include <clipping_planes_fragment>\n\n			#ifdef USE_DASH\n\n				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n			#endif\n\n			float alpha = opacity;\n\n			#ifdef WORLD_UNITS\n\n				// Find the closest points on the view ray and the line segment\n				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n				vec3 lineDir = worldEnd - worldStart;\n				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n				vec3 p1 = worldStart + lineDir * params.x;\n				vec3 p2 = rayEnd * params.y;\n				vec3 delta = p1 - p2;\n				float len = length( delta );\n				float norm = len / linewidth;\n\n				#ifndef USE_DASH\n\n					#ifdef USE_ALPHA_TO_COVERAGE\n\n						float dnorm = fwidth( norm );\n						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n					#else\n\n						if ( norm > 0.5 ) {\n\n							discard;\n\n						}\n\n					#endif\n\n				#endif\n\n			#else\n\n				#ifdef USE_ALPHA_TO_COVERAGE\n\n					// artifacts appear on some hardware if a derivative is taken within a conditional\n					float a = vUv.x;\n					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n					float len2 = a * a + b * b;\n					float dlen = fwidth( len2 );\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n					}\n\n				#else\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						float a = vUv.x;\n						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n						float len2 = a * a + b * b;\n\n						if ( len2 > 1.0 ) discard;\n\n					}\n\n				#endif\n\n			#endif\n\n			vec4 diffuseColor = vec4( diffuse, alpha );\n\n			#include <logdepthbuf_fragment>\n			#include <color_fragment>\n\n			gl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n			#include <tonemapping_fragment>\n			#include <colorspace_fragment>\n			#include <fog_fragment>\n			#include <premultiplied_alpha_fragment>\n\n		}\n		"};class It extends _t{constructor(t){super({type:"LineMaterial",uniforms:vt.clone(Ie.line.uniforms),vertexShader:Ie.line.vertexShader,fragmentShader:Ie.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(t)}get color(){return this.uniforms.diffuse.value}set color(t){this.uniforms.diffuse.value=t}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(t){this.uniforms.linewidth&&(this.uniforms.linewidth.value=t)}get dashed(){return"USE_DASH"in this.defines}set dashed(t){t===!0!==this.dashed&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(t){this.uniforms.dashScale.value=t}get dashSize(){return this.uniforms.dashSize.value}set dashSize(t){this.uniforms.dashSize.value=t}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(t){this.uniforms.dashOffset.value=t}get gapSize(){return this.uniforms.gapSize.value}set gapSize(t){this.uniforms.gapSize.value=t}get opacity(){return this.uniforms.opacity.value}set opacity(t){this.uniforms&&(this.uniforms.opacity.value=t)}get resolution(){return this.uniforms.resolution.value}set resolution(t){this.uniforms.resolution.value.copy(t)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(t){this.defines&&(t===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const dt=new ue,pt=new ue,J=new Be,Z=new Be,ae=new Be,Re=new ue,Ne=new Ot,Q=new Pt,ht=new ue,Ee=new Ve,Ae=new yt,se=new Be;let le,pe;function mt(d,t,s){return se.set(0,0,-t,1).applyMatrix4(d.projectionMatrix),se.multiplyScalar(1/se.w),se.x=pe/s.width,se.y=pe/s.height,se.applyMatrix4(d.projectionMatrixInverse),se.multiplyScalar(1/se.w),Math.abs(Math.max(se.x,se.y))}function tr(d,t){const s=d.matrixWorld,l=d.geometry,o=l.attributes.instanceStart,m=l.attributes.instanceEnd,y=Math.min(l.instanceCount,o.count);for(let A=0,B=y;A<B;A++){Q.start.fromBufferAttribute(o,A),Q.end.fromBufferAttribute(m,A),Q.applyMatrix4(s);const E=new ue,w=new ue;le.distanceSqToSegment(Q.start,Q.end,w,E),w.distanceTo(E)<pe*.5&&t.push({point:w,pointOnLine:E,distance:le.origin.distanceTo(w),object:d,face:null,faceIndex:A,uv:null,uv1:null})}}function nr(d,t,s){const l=t.projectionMatrix,m=d.material.resolution,y=d.matrixWorld,A=d.geometry,B=A.attributes.instanceStart,E=A.attributes.instanceEnd,w=Math.min(A.instanceCount,B.count),P=-t.near;le.at(1,ae),ae.w=1,ae.applyMatrix4(t.matrixWorldInverse),ae.applyMatrix4(l),ae.multiplyScalar(1/ae.w),ae.x*=m.x/2,ae.y*=m.y/2,ae.z=0,Re.copy(ae),Ne.multiplyMatrices(t.matrixWorldInverse,y);for(let j=0,O=w;j<O;j++){if(J.fromBufferAttribute(B,j),Z.fromBufferAttribute(E,j),J.w=1,Z.w=1,J.applyMatrix4(Ne),Z.applyMatrix4(Ne),J.z>P&&Z.z>P)continue;if(J.z>P){const v=J.z-Z.z,x=(J.z-P)/v;J.lerp(Z,x)}else if(Z.z>P){const v=Z.z-J.z,x=(Z.z-P)/v;Z.lerp(J,x)}J.applyMatrix4(l),Z.applyMatrix4(l),J.multiplyScalar(1/J.w),Z.multiplyScalar(1/Z.w),J.x*=m.x/2,J.y*=m.y/2,Z.x*=m.x/2,Z.y*=m.y/2,Q.start.copy(J),Q.start.z=0,Q.end.copy(Z),Q.end.z=0;const T=Q.closestPointToPointParameter(Re,!0);Q.at(T,ht);const h=gt.lerp(J.z,Z.z,T),M=h>=-1&&h<=1,C=Re.distanceTo(ht)<pe*.5;if(M&&C){Q.start.fromBufferAttribute(B,j),Q.end.fromBufferAttribute(E,j),Q.start.applyMatrix4(y),Q.end.applyMatrix4(y);const v=new ue,x=new ue;le.distanceSqToSegment(Q.start,Q.end,x,v),s.push({point:x,pointOnLine:v,distance:le.origin.distanceTo(x),object:d,face:null,faceIndex:j,uv:null,uv1:null})}}}class rr extends jt{constructor(t=new Ct,s=new It({color:Math.random()*16777215})){super(t,s),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,s=t.attributes.instanceStart,l=t.attributes.instanceEnd,o=new Float32Array(2*s.count);for(let y=0,A=0,B=s.count;y<B;y++,A+=2)dt.fromBufferAttribute(s,y),pt.fromBufferAttribute(l,y),o[A]=A===0?0:o[A-1],o[A+1]=o[A]+dt.distanceTo(pt);const m=new ze(o,2,1);return t.setAttribute("instanceDistanceStart",new ye(m,1,0)),t.setAttribute("instanceDistanceEnd",new ye(m,1,1)),this}raycast(t,s){const l=this.material.worldUnits,o=t.camera;o===null&&!l&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const m=t.params.Line2!==void 0&&t.params.Line2.threshold||0;le=t.ray;const y=this.matrixWorld,A=this.geometry,B=this.material;pe=B.linewidth+m,A.boundingSphere===null&&A.computeBoundingSphere(),Ae.copy(A.boundingSphere).applyMatrix4(y);let E;if(l)E=pe*.5;else{const P=Math.max(o.near,Ae.distanceToPoint(le.origin));E=mt(o,P,B.resolution)}if(Ae.radius+=E,le.intersectsSphere(Ae)===!1)return;A.boundingBox===null&&A.computeBoundingBox(),Ee.copy(A.boundingBox).applyMatrix4(y);let w;if(l)w=pe*.5;else{const P=Math.max(o.near,Ee.distanceToPoint(le.origin));w=mt(o,P,B.resolution)}Ee.expandByScalar(w),le.intersectsBox(Ee)!==!1&&(l?tr(this,s):nr(this,o,s))}}const ir=["object"],or=We({__name:"buildingsLines",props:{builds:{},width:{default:1},color:{default:"#FFF"},opacity:{default:1},style:{default:"Wireframe"}},setup(d){const t=d;let s=null,l=null;if(t.style==="Wireframe"){const o=new Ze(t.builds.geometry);let y=new Ct().fromEdgesGeometry(o),A=new It({color:t.color,linewidth:t.width,opacity:t.opacity,transparent:!0,depthWrite:!0,depthTest:!0});A.resolution.set(window.innerWidth,window.innerHeight),s=new rr(y,A),s.applyMatrix4(t.builds.matrix.clone())}else{l={transparent:!0,uniforms:{uColor:{value:new ve(t.color)},uOpacity:{value:t.opacity}},vertexShader:"\n       void main() {\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:" \n        uniform vec3 uColor;\n				uniform float uOpacity;\n        void main() {\n          gl_FragColor = vec4(uColor, uOpacity);\n        }\n      "};const o=new Ze(t.builds.geometry),m=new _t(l);s=new LineSegments(o,m),s.applyMatrix4(t.builds.matrix.clone()),s.material.linewidth=t.width,s.renderOrder=1e3}return bt(()=>{t.style==="Shader"&&(t.color&&(l.uniforms.uColor.value=new ve(t.color)),t.opacity&&(l.uniforms.uOpacity.value=t.opacity)),t.style==="Wireframe"&&(t.color&&(s.material.color=new ve(t.color)),t.opacity&&(s.material.opacity=t.opacity)),t.width&&(s.material.linewidth=t.width)}),(o,m)=>(De(),Ge("primitive",{object:de(s)},null,8,ir))}}),ar=be("TresAmbientLight",{color:"#ffffff"},null,-1),sr=be("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1),lr=be("TresAxesHelper",{args:[1e3],position:[0,19,0]},null,-1),cr=be("TresGridHelper",{args:[6e3,100],position:[0,19,0]},null,-1),hr=We({__name:"pagesShow",props:{showBuildings:{type:Boolean,default:!0},autoRotate:{type:Boolean,default:!0}},async setup(d){let t,s;const l=d,o=Qe({clearColor:"#000000",shadows:!0,alpha:!1,useLegacyLights:!0,shadowMapType:Ut,outputColorSpace:Ft,toneMapping:Rt}),m=Qe({autoRotate:l.autoRotate,enableDamping:!0});let y=null;l.showBuildings&&(y=([t,s]=Wt(()=>Qt()),t=await t,s(),t));const A=wt();return(B,E)=>(De(),Gt(de(kt),qt(o,{"window-size":""}),{default:Yt(()=>[be("TresPerspectiveCamera",{ref_key:"perspectiveCameraRef",ref:A,position:[600,750,-1221],fov:45,near:1,far:1e4},null,512),je(de(Ht),Kt(Xt(m)),null,16),ar,sr,l.showBuildings&&de(y)?(De(),Ge($t,{key:0},[je(er,{model:de(y)},null,8,["model"]),je(or,{builds:de(y).city,color:"#000"},null,8,["builds"])],64)):Jt("",!0),Zt(B.$slots,"ability"),lr,cr]),_:3},16))}});export{Zn as C,hr as _,er as a,or as b,Qt as l};
