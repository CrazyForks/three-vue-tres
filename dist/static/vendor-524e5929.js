var $P=Object.defineProperty,jP=Object.defineProperties;var XP=Object.getOwnPropertyDescriptors;var td=Object.getOwnPropertySymbols;var hb=Object.prototype.hasOwnProperty,db=Object.prototype.propertyIsEnumerable;var ub=(n,e,t)=>e in n?$P(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ft=(n,e)=>{for(var t in e||(e={}))hb.call(e,t)&&ub(n,t,e[t]);if(td)for(var t of td(e))db.call(e,t)&&ub(n,t,e[t]);return n},ti=(n,e)=>jP(n,XP(e));var nd=(n,e)=>{var t={};for(var i in n)hb.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&td)for(var i of td(n))e.indexOf(i)<0&&db.call(n,i)&&(t[i]=n[i]);return t};function N0(n,e){const t=Object.create(null),i=n.split(",");for(let r=0;r<i.length;r++)t[i[r]]=!0;return e?r=>!!t[r.toLowerCase()]:r=>!!t[r]}const Gt={},Ul=[],yr=()=>{},YP=()=>!1,qP=/^on[^a-z]/,mp=n=>qP.test(n),F0=n=>n.startsWith("onUpdate:"),vn=Object.assign,k0=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},KP=Object.prototype.hasOwnProperty,St=(n,e)=>KP.call(n,e),We=Array.isArray,Nl=n=>Ph(n)==="[object Map]",ME=n=>Ph(n)==="[object Set]",ZP=n=>Ph(n)==="[object RegExp]",st=n=>typeof n=="function",Zt=n=>typeof n=="string",B0=n=>typeof n=="symbol",Vt=n=>n!==null&&typeof n=="object",z0=n=>Vt(n)&&st(n.then)&&st(n.catch),EE=Object.prototype.toString,Ph=n=>EE.call(n),JP=n=>Ph(n).slice(8,-1),SE=n=>Ph(n)==="[object Object]",V0=n=>Zt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,wf=N0(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gp=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},QP=/-(\w)/g,Wr=gp(n=>n.replace(QP,(e,t)=>t?t.toUpperCase():"")),e3=/\B([A-Z])/g,fc=gp(n=>n.replace(e3,"-$1").toLowerCase()),vp=gp(n=>n.charAt(0).toUpperCase()+n.slice(1)),Lm=gp(n=>n?"on".concat(vp(n)):""),Fu=(n,e)=>!Object.is(n,e),gu=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},zf=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},t3=n=>{const e=parseFloat(n);return isNaN(e)?n:e},TE=n=>{const e=Zt(n)?Number(n):NaN;return isNaN(e)?n:e};let fb;const sv=()=>fb||(fb=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Dn(n){if(We(n)){const e={};for(let t=0;t<n.length;t++){const i=n[t],r=Zt(i)?s3(i):Dn(i);if(r)for(const s in r)e[s]=r[s]}return e}else{if(Zt(n))return n;if(Vt(n))return n}}const n3=/;(?![^(]*\))/g,i3=/:([^]+)/,r3=/\/\*[^]*?\*\//g;function s3(n){const e={};return n.replace(r3,"").split(n3).forEach(t=>{if(t){const i=t.split(i3);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Wt(n){let e="";if(Zt(n))e=n;else if(We(n))for(let t=0;t<n.length;t++){const i=Wt(n[t]);i&&(e+=i+" ")}else if(Vt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function Xq(n){if(!n)return null;let{class:e,style:t}=n;return e&&!Zt(e)&&(n.class=Wt(e)),t&&(n.style=Dn(t)),n}const o3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",a3=N0(o3);function AE(n){return!!n||n===""}const l3=n=>Zt(n)?n:n==null?"":We(n)||Vt(n)&&(n.toString===EE||!st(n.toString))?JSON.stringify(n,CE,2):String(n),CE=(n,e)=>e&&e.__v_isRef?CE(n,e.value):Nl(e)?{["Map(".concat(e.size,")")]:[...e.entries()].reduce((t,[i,r])=>(t["".concat(i," =>")]=r,t),{})}:ME(e)?{["Set(".concat(e.size,")")]:[...e.values()]}:Vt(e)&&!We(e)&&!SE(e)?String(e):e;let Li;class PE{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Li,!e&&Li&&(this.index=(Li.scopes||(Li.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=Li;try{return Li=this,e()}finally{Li=t}}}on(){Li=this}off(){Li=this.parent}stop(e){if(this._active){let t,i;for(t=0,i=this.effects.length;t<i;t++)this.effects[t].stop();for(t=0,i=this.cleanups.length;t<i;t++)this.cleanups[t]();if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function c3(n){return new PE(n)}function u3(n,e=Li){e&&e.active&&e.effects.push(n)}function _p(){return Li}function H0(n){Li&&Li.cleanups.push(n)}const G0=n=>{const e=new Set(n);return e.w=0,e.n=0,e},RE=n=>(n.w&bo)>0,LE=n=>(n.n&bo)>0,h3=({deps:n})=>{if(n.length)for(let e=0;e<n.length;e++)n[e].w|=bo},d3=n=>{const{deps:e}=n;if(e.length){let t=0;for(let i=0;i<e.length;i++){const r=e[i];RE(r)&&!LE(r)?r.delete(n):e[t++]=r,r.w&=~bo,r.n&=~bo}e.length=t}},Vf=new WeakMap;let uu=0,bo=1;const ov=30;let gr;const pa=Symbol(""),av=Symbol("");class W0{constructor(e,t=null,i){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,u3(this,i)}run(){if(!this.active)return this.fn();let e=gr,t=ho;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=gr,gr=this,ho=!0,bo=1<<++uu,uu<=ov?h3(this):pb(this),this.fn()}finally{uu<=ov&&d3(this),bo=1<<--uu,gr=this.parent,ho=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){gr===this?this.deferStop=!0:this.active&&(pb(this),this.onStop&&this.onStop(),this.active=!1)}}function pb(n){const{deps:e}=n;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(n);e.length=0}}let ho=!0;const OE=[];function pc(){OE.push(ho),ho=!1}function mc(){const n=OE.pop();ho=n===void 0?!0:n}function xi(n,e,t){if(ho&&gr){let i=Vf.get(n);i||Vf.set(n,i=new Map);let r=i.get(t);r||i.set(t,r=G0()),IE(r)}}function IE(n,e){let t=!1;uu<=ov?LE(n)||(n.n|=bo,t=!RE(n)):t=!n.has(gr),t&&(n.add(gr),gr.deps.push(n))}function Es(n,e,t,i,r,s){const o=Vf.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&We(n)){const l=Number(i);o.forEach((c,u)=>{(u==="length"||u>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":We(n)?V0(t)&&a.push(o.get("length")):(a.push(o.get(pa)),Nl(n)&&a.push(o.get(av)));break;case"delete":We(n)||(a.push(o.get(pa)),Nl(n)&&a.push(o.get(av)));break;case"set":Nl(n)&&a.push(o.get(pa));break}if(a.length===1)a[0]&&lv(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);lv(G0(l))}}function lv(n,e){const t=We(n)?n:[...n];for(const i of t)i.computed&&mb(i);for(const i of t)i.computed||mb(i)}function mb(n,e){(n!==gr||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}function f3(n,e){var t;return(t=Vf.get(n))==null?void 0:t.get(e)}const p3=N0("__proto__,__v_isRef,__isVue"),DE=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(B0)),m3=$0(),g3=$0(!1,!0),v3=$0(!0),gb=_3();function _3(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const i=Et(this);for(let s=0,o=this.length;s<o;s++)xi(i,"get",s+"");const r=i[e](...t);return r===-1||r===!1?i[e](...t.map(Et)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){pc();const i=Et(this)[e].apply(this,t);return mc(),i}}),n}function y3(n){const e=Et(this);return xi(e,"has",n),e.hasOwnProperty(n)}function $0(n=!1,e=!1){return function(i,r,s){if(r==="__v_isReactive")return!n;if(r==="__v_isReadonly")return n;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&s===(n?e?U3:BE:e?kE:FE).get(i))return i;const o=We(i);if(!n){if(o&&St(gb,r))return Reflect.get(gb,r,s);if(r==="hasOwnProperty")return y3}const a=Reflect.get(i,r,s);return(B0(r)?DE.has(r):p3(r))||(n||xi(i,"get",r),e)?a:gn(a)?o&&V0(r)?a:a.value:Vt(a)?n?bp(a):li(a):a}}const b3=UE(),x3=UE(!0);function UE(n=!1){return function(t,i,r,s){let o=t[i];if(Zl(o)&&gn(o)&&!gn(r))return!1;if(!n&&(!Hf(r)&&!Zl(r)&&(o=Et(o),r=Et(r)),!We(t)&&gn(o)&&!gn(r)))return o.value=r,!0;const a=We(t)&&V0(i)?Number(i)<t.length:St(t,i),l=Reflect.set(t,i,r,s);return t===Et(s)&&(a?Fu(r,o)&&Es(t,"set",i,r):Es(t,"add",i,r)),l}}function w3(n,e){const t=St(n,e);n[e];const i=Reflect.deleteProperty(n,e);return i&&t&&Es(n,"delete",e,void 0),i}function M3(n,e){const t=Reflect.has(n,e);return(!B0(e)||!DE.has(e))&&xi(n,"has",e),t}function E3(n){return xi(n,"iterate",We(n)?"length":pa),Reflect.ownKeys(n)}const NE={get:m3,set:b3,deleteProperty:w3,has:M3,ownKeys:E3},S3={get:v3,set(n,e){return!0},deleteProperty(n,e){return!0}},T3=vn({},NE,{get:g3,set:x3}),j0=n=>n,yp=n=>Reflect.getPrototypeOf(n);function id(n,e,t=!1,i=!1){n=n.__v_raw;const r=Et(n),s=Et(e);t||(e!==s&&xi(r,"get",e),xi(r,"get",s));const{has:o}=yp(r),a=i?j0:t?q0:ku;if(o.call(r,e))return a(n.get(e));if(o.call(r,s))return a(n.get(s));n!==r&&n.get(e)}function rd(n,e=!1){const t=this.__v_raw,i=Et(t),r=Et(n);return e||(n!==r&&xi(i,"has",n),xi(i,"has",r)),n===r?t.has(n):t.has(n)||t.has(r)}function sd(n,e=!1){return n=n.__v_raw,!e&&xi(Et(n),"iterate",pa),Reflect.get(n,"size",n)}function vb(n){n=Et(n);const e=Et(this);return yp(e).has.call(e,n)||(e.add(n),Es(e,"add",n,n)),this}function _b(n,e){e=Et(e);const t=Et(this),{has:i,get:r}=yp(t);let s=i.call(t,n);s||(n=Et(n),s=i.call(t,n));const o=r.call(t,n);return t.set(n,e),s?Fu(e,o)&&Es(t,"set",n,e):Es(t,"add",n,e),this}function yb(n){const e=Et(this),{has:t,get:i}=yp(e);let r=t.call(e,n);r||(n=Et(n),r=t.call(e,n)),i&&i.call(e,n);const s=e.delete(n);return r&&Es(e,"delete",n,void 0),s}function bb(){const n=Et(this),e=n.size!==0,t=n.clear();return e&&Es(n,"clear",void 0,void 0),t}function od(n,e){return function(i,r){const s=this,o=s.__v_raw,a=Et(o),l=e?j0:n?q0:ku;return!n&&xi(a,"iterate",pa),o.forEach((c,u)=>i.call(r,l(c),l(u),s))}}function ad(n,e,t){return function(...i){const r=this.__v_raw,s=Et(r),o=Nl(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=r[n](...i),u=t?j0:e?q0:ku;return!e&&xi(s,"iterate",l?av:pa),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function Fs(n){return function(...e){return n==="delete"?!1:this}}function A3(){const n={get(s){return id(this,s)},get size(){return sd(this)},has:rd,add:vb,set:_b,delete:yb,clear:bb,forEach:od(!1,!1)},e={get(s){return id(this,s,!1,!0)},get size(){return sd(this)},has:rd,add:vb,set:_b,delete:yb,clear:bb,forEach:od(!1,!0)},t={get(s){return id(this,s,!0)},get size(){return sd(this,!0)},has(s){return rd.call(this,s,!0)},add:Fs("add"),set:Fs("set"),delete:Fs("delete"),clear:Fs("clear"),forEach:od(!0,!1)},i={get(s){return id(this,s,!0,!0)},get size(){return sd(this,!0)},has(s){return rd.call(this,s,!0)},add:Fs("add"),set:Fs("set"),delete:Fs("delete"),clear:Fs("clear"),forEach:od(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=ad(s,!1,!1),t[s]=ad(s,!0,!1),e[s]=ad(s,!1,!0),i[s]=ad(s,!0,!0)}),[n,t,e,i]}const[C3,P3,R3,L3]=A3();function X0(n,e){const t=e?n?L3:R3:n?P3:C3;return(i,r,s)=>r==="__v_isReactive"?!n:r==="__v_isReadonly"?n:r==="__v_raw"?i:Reflect.get(St(t,r)&&r in i?t:i,r,s)}const O3={get:X0(!1,!1)},I3={get:X0(!1,!0)},D3={get:X0(!0,!1)},FE=new WeakMap,kE=new WeakMap,BE=new WeakMap,U3=new WeakMap;function N3(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function F3(n){return n.__v_skip||!Object.isExtensible(n)?0:N3(JP(n))}function li(n){return Zl(n)?n:Y0(n,!1,NE,O3,FE)}function zE(n){return Y0(n,!1,T3,I3,kE)}function bp(n){return Y0(n,!0,S3,D3,BE)}function Y0(n,e,t,i,r){if(!Vt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=r.get(n);if(s)return s;const o=F3(n);if(o===0)return n;const a=new Proxy(n,o===2?i:t);return r.set(n,a),a}function Fl(n){return Zl(n)?Fl(n.__v_raw):!!(n&&n.__v_isReactive)}function Zl(n){return!!(n&&n.__v_isReadonly)}function Hf(n){return!!(n&&n.__v_isShallow)}function VE(n){return Fl(n)||Zl(n)}function Et(n){const e=n&&n.__v_raw;return e?Et(e):n}function HE(n){return zf(n,"__v_skip",!0),n}const ku=n=>Vt(n)?li(n):n,q0=n=>Vt(n)?bp(n):n;function K0(n){ho&&gr&&(n=Et(n),IE(n.dep||(n.dep=G0())))}function Z0(n,e){n=Et(n);const t=n.dep;t&&lv(t)}function gn(n){return!!(n&&n.__v_isRef===!0)}function be(n){return GE(n,!1)}function qn(n){return GE(n,!0)}function GE(n,e){return gn(n)?n:new k3(n,e)}class k3{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Et(e),this._value=t?e:ku(e)}get value(){return K0(this),this._value}set value(e){const t=this.__v_isShallow||Hf(e)||Zl(e);e=t?e:Et(e),Fu(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:ku(e),Z0(this))}}function we(n){return gn(n)?n.value:n}const B3={get:(n,e,t)=>we(Reflect.get(n,e,t)),set:(n,e,t,i)=>{const r=n[e];return gn(r)&&!gn(t)?(r.value=t,!0):Reflect.set(n,e,t,i)}};function WE(n){return Fl(n)?n:new Proxy(n,B3)}class z3{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:i}=e(()=>K0(this),()=>Z0(this));this._get=t,this._set=i}get value(){return this._get()}set value(e){this._set(e)}}function V3(n){return new z3(n)}function Ar(n){const e=We(n)?new Array(n.length):{};for(const t in n)e[t]=$E(n,t);return e}class H3{constructor(e,t,i){this._object=e,this._key=t,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return f3(Et(this._object),this._key)}}class G3{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function xb(n,e,t){return gn(n)?n:st(n)?new G3(n):Vt(n)&&arguments.length>1?$E(n,e,t):be(n)}function $E(n,e,t){const i=n[e];return gn(i)?i:new H3(n,e,t)}class W3{constructor(e,t,i,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new W0(e,()=>{this._dirty||(this._dirty=!0,Z0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=Et(this);return K0(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function $3(n,e,t=!1){let i,r;const s=st(n);return s?(i=n,r=yr):(i=n.get,r=n.set),new W3(i,r,s||!r,t)}function fo(n,e,t,i){let r;try{r=i?n(...i):n()}catch(s){Rh(s,e,t)}return r}function ir(n,e,t,i){if(st(n)){const s=fo(n,e,t,i);return s&&z0(s)&&s.catch(o=>{Rh(o,e,t)}),s}const r=[];for(let s=0;s<n.length;s++)r.push(ir(n[s],e,t,i));return r}function Rh(n,e,t,i=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=t;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](n,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){fo(l,null,10,[n,o,a]);return}}j3(n,t,r,i)}function j3(n,e,t,i=!0){console.error(n)}let Bu=!1,cv=!1;const $n=[];let kr=0;const kl=[];let ps=null,na=0;const jE=Promise.resolve();let J0=null;function $r(n){const e=J0||jE;return n?e.then(this?n.bind(this):n):e}function X3(n){let e=kr+1,t=$n.length;for(;e<t;){const i=e+t>>>1;zu($n[i])<n?e=i+1:t=i}return e}function Q0(n){(!$n.length||!$n.includes(n,Bu&&n.allowRecurse?kr+1:kr))&&(n.id==null?$n.push(n):$n.splice(X3(n.id),0,n),XE())}function XE(){!Bu&&!cv&&(cv=!0,J0=jE.then(KE))}function Y3(n){const e=$n.indexOf(n);e>kr&&$n.splice(e,1)}function YE(n){We(n)?kl.push(...n):(!ps||!ps.includes(n,n.allowRecurse?na+1:na))&&kl.push(n),XE()}function wb(n,e=Bu?kr+1:0){for(;e<$n.length;e++){const t=$n[e];t&&t.pre&&($n.splice(e,1),e--,t())}}function qE(n){if(kl.length){const e=[...new Set(kl)];if(kl.length=0,ps){ps.push(...e);return}for(ps=e,ps.sort((t,i)=>zu(t)-zu(i)),na=0;na<ps.length;na++)ps[na]();ps=null,na=0}}const zu=n=>n.id==null?1/0:n.id,q3=(n,e)=>{const t=zu(n)-zu(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function KE(n){cv=!1,Bu=!0,$n.sort(q3);const e=yr;try{for(kr=0;kr<$n.length;kr++){const t=$n[kr];t&&t.active!==!1&&fo(t,null,14)}}finally{kr=0,$n.length=0,qE(),Bu=!1,J0=null,($n.length||kl.length)&&KE()}}function K3(n,e,...t){if(n.isUnmounted)return;const i=n.vnode.props||Gt;let r=t;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in i){const u="".concat(o==="modelValue"?"model":o,"Modifiers"),{number:h,trim:d}=i[u]||Gt;d&&(r=t.map(f=>Zt(f)?f.trim():f)),h&&(r=t.map(t3))}let a,l=i[a=Lm(e)]||i[a=Lm(Wr(e))];!l&&s&&(l=i[a=Lm(fc(e))]),l&&ir(l,n,6,r);const c=i[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,ir(c,n,6,r)}}function ZE(n,e,t=!1){const i=e.emitsCache,r=i.get(n);if(r!==void 0)return r;const s=n.emits;let o={},a=!1;if(!st(n)){const l=c=>{const u=ZE(c,e,!0);u&&(a=!0,vn(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(Vt(n)&&i.set(n,null),null):(We(s)?s.forEach(l=>o[l]=null):vn(o,s),Vt(n)&&i.set(n,o),o)}function xp(n,e){return!n||!mp(e)?!1:(e=e.slice(2).replace(/Once$/,""),St(n,e[0].toLowerCase()+e.slice(1))||St(n,fc(e))||St(n,e))}let zn=null,wp=null;function Gf(n){const e=zn;return zn=n,wp=n&&n.type.__scopeId||null,e}function Yq(n){wp=n}function qq(){wp=null}function Mp(n,e=zn,t){if(!e||n._n)return n;const i=(...r)=>{i._d&&Nb(-1);const s=Gf(e);let o;try{o=n(...r)}finally{Gf(s),i._d&&Nb(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function Om(n){const{type:e,vnode:t,proxy:i,withProxy:r,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:v}=n;let m,g;const b=Gf(n);try{if(t.shapeFlag&4){const _=r||i;m=pr(u.call(_,_,h,s,f,d,p)),g=l}else{const _=e;m=pr(_.length>1?_(s,{attrs:l,slots:a,emit:c}):_(s,null)),g=e.props?l:J3(l)}}catch(_){bu.length=0,Rh(_,n,1),m=ne(oi)}let y=m;if(g&&v!==!1){const _=Object.keys(g),{shapeFlag:T}=y;_.length&&T&7&&(o&&_.some(F0)&&(g=Q3(g,o)),y=xr(y,g))}return t.dirs&&(y=xr(y),y.dirs=y.dirs?y.dirs.concat(t.dirs):t.dirs),t.transition&&(y.transition=t.transition),m=y,Gf(b),m}function Z3(n){let e;for(let t=0;t<n.length;t++){const i=n[t];if(xa(i)){if(i.type!==oi||i.children==="v-if"){if(e)return;e=i}}else return}return e}const J3=n=>{let e;for(const t in n)(t==="class"||t==="style"||mp(t))&&((e||(e={}))[t]=n[t]);return e},Q3=(n,e)=>{const t={};for(const i in n)(!F0(i)||!(i.slice(9)in e))&&(t[i]=n[i]);return t};function eR(n,e,t){const{props:i,children:r,component:s}=n,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return i?Mb(i,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==i[d]&&!xp(c,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Mb(i,o,c):!0:!!o;return!1}function Mb(n,e,t){const i=Object.keys(e);if(i.length!==Object.keys(n).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(e[s]!==n[s]&&!xp(t,s))return!0}return!1}function e_({vnode:n,parent:e},t){for(;e&&e.subTree===n;)(n=e.vnode).el=t,e=e.parent}const JE=n=>n.__isSuspense,tR={name:"Suspense",__isSuspense:!0,process(n,e,t,i,r,s,o,a,l,c){n==null?nR(e,t,i,r,s,o,a,l,c):iR(n,e,t,i,r,o,a,l,c)},hydrate:rR,create:t_,normalize:sR},Kq=tR;function Vu(n,e){const t=n.props&&n.props[e];st(t)&&t()}function nR(n,e,t,i,r,s,o,a,l){const{p:c,o:{createElement:u}}=l,h=u("div"),d=n.suspense=t_(n,r,i,e,h,t,s,o,a,l);c(null,d.pendingBranch=n.ssContent,h,null,i,d,s,o),d.deps>0?(Vu(n,"onPending"),Vu(n,"onFallback"),c(null,n.ssFallback,e,t,i,null,s,o),Bl(d,n.ssFallback)):d.resolve(!1,!0)}function iR(n,e,t,i,r,s,o,a,{p:l,um:c,o:{createElement:u}}){const h=e.suspense=n.suspense;h.vnode=e,e.el=n.el;const d=e.ssContent,f=e.ssFallback,{activeBranch:p,pendingBranch:v,isInFallback:m,isHydrating:g}=h;if(v)h.pendingBranch=d,vr(d,v)?(l(v,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0?h.resolve():m&&(l(p,f,t,i,r,null,s,o,a),Bl(h,f))):(h.pendingId++,g?(h.isHydrating=!1,h.activeBranch=v):c(v,r,h),h.deps=0,h.effects.length=0,h.hiddenContainer=u("div"),m?(l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0?h.resolve():(l(p,f,t,i,r,null,s,o,a),Bl(h,f))):p&&vr(d,p)?(l(p,d,t,i,r,h,s,o,a),h.resolve(!0)):(l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0&&h.resolve()));else if(p&&vr(d,p))l(p,d,t,i,r,h,s,o,a),Bl(h,d);else if(Vu(e,"onPending"),h.pendingBranch=d,h.pendingId++,l(null,d,h.hiddenContainer,null,r,h,s,o,a),h.deps<=0)h.resolve();else{const{timeout:b,pendingId:y}=h;b>0?setTimeout(()=>{h.pendingId===y&&h.fallback(f)},b):b===0&&h.fallback(f)}}function t_(n,e,t,i,r,s,o,a,l,c,u=!1){const{p:h,m:d,um:f,n:p,o:{parentNode:v,remove:m}}=c;let g;const b=aR(n);b&&e!=null&&e.pendingBranch&&(g=e.pendingId,e.deps++);const y=n.props?TE(n.props.timeout):void 0,_={vnode:n,parent:e,parentComponent:t,isSVG:o,container:i,hiddenContainer:r,anchor:s,deps:0,pendingId:0,timeout:typeof y=="number"?y:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:u,isUnmounted:!1,effects:[],resolve(T=!1,w=!1){const{vnode:S,activeBranch:x,pendingBranch:M,pendingId:E,effects:C,parentComponent:O,container:$}=_;if(_.isHydrating)_.isHydrating=!1;else if(!T){const W=x&&M.transition&&M.transition.mode==="out-in";W&&(x.transition.afterLeave=()=>{E===_.pendingId&&d(M,$,q,0)});let{anchor:q}=_;x&&(q=p(x),f(x,O,_,!0)),W||d(M,$,q,0)}Bl(_,M),_.pendingBranch=null,_.isInFallback=!1;let U=_.parent,j=!1;for(;U;){if(U.pendingBranch){U.effects.push(...C),j=!0;break}U=U.parent}j||YE(C),_.effects=[],b&&e&&e.pendingBranch&&g===e.pendingId&&(e.deps--,e.deps===0&&!w&&e.resolve()),Vu(S,"onResolve")},fallback(T){if(!_.pendingBranch)return;const{vnode:w,activeBranch:S,parentComponent:x,container:M,isSVG:E}=_;Vu(w,"onFallback");const C=p(S),O=()=>{_.isInFallback&&(h(null,T,M,C,x,null,E,a,l),Bl(_,T))},$=T.transition&&T.transition.mode==="out-in";$&&(S.transition.afterLeave=O),_.isInFallback=!0,f(S,x,null,!0),$||O()},move(T,w,S){_.activeBranch&&d(_.activeBranch,T,w,S),_.container=T},next(){return _.activeBranch&&p(_.activeBranch)},registerDep(T,w){const S=!!_.pendingBranch;S&&_.deps++;const x=T.vnode.el;T.asyncDep.catch(M=>{Rh(M,T,0)}).then(M=>{if(T.isUnmounted||_.isUnmounted||_.pendingId!==T.suspenseId)return;T.asyncResolved=!0;const{vnode:E}=T;gv(T,M,!1),x&&(E.el=x);const C=!x&&T.subTree.el;w(T,E,v(x||T.subTree.el),x?null:p(T.subTree),_,o,l),C&&m(C),e_(T,E.el),S&&--_.deps===0&&_.resolve()})},unmount(T,w){_.isUnmounted=!0,_.activeBranch&&f(_.activeBranch,t,T,w),_.pendingBranch&&f(_.pendingBranch,t,T,w)}};return _}function rR(n,e,t,i,r,s,o,a,l){const c=e.suspense=t_(e,i,t,n.parentNode,document.createElement("div"),null,r,s,o,a,!0),u=l(n,c.pendingBranch=e.ssContent,t,c,s,o);return c.deps===0&&c.resolve(!1,!0),u}function sR(n){const{shapeFlag:e,children:t}=n,i=e&32;n.ssContent=Eb(i?t.default:t),n.ssFallback=i?Eb(t.fallback):ne(oi)}function Eb(n){let e;if(st(n)){const t=Ql&&n._c;t&&(n._d=!1,rt()),n=n(),t&&(n._d=!0,e=er,yS())}return We(n)&&(n=Z3(n)),n=pr(n),e&&!n.dynamicChildren&&(n.dynamicChildren=e.filter(t=>t!==n)),n}function oR(n,e){e&&e.pendingBranch?We(n)?e.effects.push(...n):e.effects.push(n):YE(n)}function Bl(n,e){n.activeBranch=e;const{vnode:t,parentComponent:i}=n,r=t.el=e.el;i&&i.subTree===t&&(i.vnode.el=r,e_(i,r))}function aR(n){var e;return((e=n.props)==null?void 0:e.suspensible)!=null&&n.props.suspensible!==!1}function rr(n,e){return n_(n,null,e)}const ld={};function ft(n,e,t){return n_(n,e,t)}function n_(n,e,{immediate:t,deep:i,flush:r,onTrack:s,onTrigger:o}=Gt){var a;const l=_p()===((a=Un)==null?void 0:a.scope)?Un:null;let c,u=!1,h=!1;if(gn(n)?(c=()=>n.value,u=Hf(n)):Fl(n)?(c=()=>n,i=!0):We(n)?(h=!0,u=n.some(_=>Fl(_)||Hf(_)),c=()=>n.map(_=>{if(gn(_))return _.value;if(Fl(_))return aa(_);if(st(_))return fo(_,l,2)})):st(n)?e?c=()=>fo(n,l,2):c=()=>{if(!(l&&l.isUnmounted))return d&&d(),ir(n,l,3,[f])}:c=yr,e&&i){const _=c;c=()=>aa(_())}let d,f=_=>{d=b.onStop=()=>{fo(_,l,4)}},p;if(Wu)if(f=yr,e?t&&ir(e,l,3,[c(),h?[]:void 0,f]):c(),r==="sync"){const _=JR();p=_.__watcherHandles||(_.__watcherHandles=[])}else return yr;let v=h?new Array(n.length).fill(ld):ld;const m=()=>{if(b.active)if(e){const _=b.run();(i||u||(h?_.some((T,w)=>Fu(T,v[w])):Fu(_,v)))&&(d&&d(),ir(e,l,3,[_,v===ld?void 0:h&&v[0]===ld?[]:v,f]),v=_)}else b.run()};m.allowRecurse=!!e;let g;r==="sync"?g=m:r==="post"?g=()=>Fn(m,l&&l.suspense):(m.pre=!0,l&&(m.id=l.uid),g=()=>Q0(m));const b=new W0(c,g);e?t?m():v=b.run():r==="post"?Fn(b.run.bind(b),l&&l.suspense):b.run();const y=()=>{b.stop(),l&&l.scope&&k0(l.scope.effects,b)};return p&&p.push(y),y}function lR(n,e,t){const i=this.proxy,r=Zt(n)?n.includes(".")?QE(i,n):()=>i[n]:n.bind(i,i);let s;st(e)?s=e:(s=e.handler,t=e);const o=Un;xo(this);const a=n_(r,s.bind(i),t);return o?xo(o):po(),a}function QE(n,e){const t=e.split(".");return()=>{let i=n;for(let r=0;r<t.length&&i;r++)i=i[t[r]];return i}}function aa(n,e){if(!Vt(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),gn(n))aa(n.value,e);else if(We(n))for(let t=0;t<n.length;t++)aa(n[t],e);else if(ME(n)||Nl(n))n.forEach(t=>{aa(t,e)});else if(SE(n))for(const t in n)aa(n[t],e);return n}function Hu(n,e){const t=zn;if(t===null)return n;const i=Cp(t)||t.proxy,r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,c=Gt]=e[s];o&&(st(o)&&(o={mounted:o,updated:o}),o.deep&&aa(a),r.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:c}))}return n}function No(n,e,t,i){const r=n.dirs,s=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);let l=a.dir[i];l&&(pc(),ir(l,t,8,[n.el,a,n,e]),mc())}}function eS(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return _n(()=>{n.isMounted=!0}),Cr(()=>{n.isUnmounting=!0}),n}const Gi=[Function,Array],tS={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Gi,onEnter:Gi,onAfterEnter:Gi,onEnterCancelled:Gi,onBeforeLeave:Gi,onLeave:Gi,onAfterLeave:Gi,onLeaveCancelled:Gi,onBeforeAppear:Gi,onAppear:Gi,onAfterAppear:Gi,onAppearCancelled:Gi},cR={name:"BaseTransition",props:tS,setup(n,{slots:e}){const t=En(),i=eS();let r;return()=>{const s=e.default&&i_(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const v of s)if(v.type!==oi){o=v;break}}const a=Et(n),{mode:l}=a;if(i.isLeaving)return Im(o);const c=Sb(o);if(!c)return Im(o);const u=Gu(c,a,i,t);Jl(c,u);const h=t.subTree,d=h&&Sb(h);let f=!1;const{getTransitionKey:p}=c.type;if(p){const v=p();r===void 0?r=v:v!==r&&(r=v,f=!0)}if(d&&d.type!==oi&&(!vr(c,d)||f)){const v=Gu(d,a,i,t);if(Jl(d,v),l==="out-in")return i.isLeaving=!0,v.afterLeave=()=>{i.isLeaving=!1,t.update.active!==!1&&t.update()},Im(o);l==="in-out"&&c.type!==oi&&(v.delayLeave=(m,g,b)=>{const y=nS(i,d);y[String(d.key)]=d,m._leaveCb=()=>{g(),m._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=b})}return o}}},uR=cR;function nS(n,e){const{leavingVNodes:t}=n;let i=t.get(e.type);return i||(i=Object.create(null),t.set(e.type,i)),i}function Gu(n,e,t,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:v,onAppear:m,onAfterAppear:g,onAppearCancelled:b}=e,y=String(n.key),_=nS(t,n),T=(x,M)=>{x&&ir(x,i,9,M)},w=(x,M)=>{const E=M[1];T(x,M),We(x)?x.every(C=>C.length<=1)&&E():x.length<=1&&E()},S={mode:s,persisted:o,beforeEnter(x){let M=a;if(!t.isMounted)if(r)M=v||a;else return;x._leaveCb&&x._leaveCb(!0);const E=_[y];E&&vr(n,E)&&E.el._leaveCb&&E.el._leaveCb(),T(M,[x])},enter(x){let M=l,E=c,C=u;if(!t.isMounted)if(r)M=m||l,E=g||c,C=b||u;else return;let O=!1;const $=x._enterCb=U=>{O||(O=!0,U?T(C,[x]):T(E,[x]),S.delayedLeave&&S.delayedLeave(),x._enterCb=void 0)};M?w(M,[x,$]):$()},leave(x,M){const E=String(n.key);if(x._enterCb&&x._enterCb(!0),t.isUnmounting)return M();T(h,[x]);let C=!1;const O=x._leaveCb=$=>{C||(C=!0,M(),$?T(p,[x]):T(f,[x]),x._leaveCb=void 0,_[E]===n&&delete _[E])};_[E]=n,d?w(d,[x,O]):O()},clone(x){return Gu(x,e,t,i)}};return S}function Im(n){if(Ep(n))return n=xr(n),n.children=null,n}function Sb(n){return Ep(n)?n.children?n.children[0]:void 0:n}function Jl(n,e){n.shapeFlag&6&&n.component?Jl(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function i_(n,e=!1,t){let i=[],r=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Kt?(o.patchFlag&128&&r++,i=i.concat(i_(o.children,e,a))):(e||o.type!==oi)&&i.push(a!=null?xr(o,{key:a}):o)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function qe(n,e){return st(n)?(()=>vn({name:n.name},e,{setup:n}))():n}const zl=n=>!!n.type.__asyncLoader,Ep=n=>n.type.__isKeepAlive,hR={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:e}){const t=En(),i=t.ctx;if(!i.renderer)return()=>{const b=e.default&&e.default();return b&&b.length===1?b[0]:b};const r=new Map,s=new Set;let o=null;const a=t.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:h}}}=i,d=h("div");i.activate=(b,y,_,T,w)=>{const S=b.component;c(b,y,_,0,a),l(S.vnode,b,y,_,S,a,T,b.slotScopeIds,w),Fn(()=>{S.isDeactivated=!1,S.a&&gu(S.a);const x=b.props&&b.props.onVnodeMounted;x&&Yi(x,S.parent,b)},a)},i.deactivate=b=>{const y=b.component;c(b,d,null,1,a),Fn(()=>{y.da&&gu(y.da);const _=b.props&&b.props.onVnodeUnmounted;_&&Yi(_,y.parent,b),y.isDeactivated=!0},a)};function f(b){Dm(b),u(b,t,a,!0)}function p(b){r.forEach((y,_)=>{const T=vv(y.type);T&&(!b||!b(T))&&v(_)})}function v(b){const y=r.get(b);!o||!vr(y,o)?f(y):o&&Dm(o),r.delete(b),s.delete(b)}ft(()=>[n.include,n.exclude],([b,y])=>{b&&p(_=>hu(b,_)),y&&p(_=>!hu(y,_))},{flush:"post",deep:!0});let m=null;const g=()=>{m!=null&&r.set(m,Um(t.subTree))};return _n(g),r_(g),Cr(()=>{r.forEach(b=>{const{subTree:y,suspense:_}=t,T=Um(y);if(b.type===T.type&&b.key===T.key){Dm(T);const w=T.component.da;w&&Fn(w,_);return}f(b)})}),()=>{if(m=null,!e.default)return null;const b=e.default(),y=b[0];if(b.length>1)return o=null,b;if(!xa(y)||!(y.shapeFlag&4)&&!(y.shapeFlag&128))return o=null,y;let _=Um(y);const T=_.type,w=vv(zl(_)?_.type.__asyncResolved||{}:T),{include:S,exclude:x,max:M}=n;if(S&&(!w||!hu(S,w))||x&&w&&hu(x,w))return o=_,y;const E=_.key==null?T:_.key,C=r.get(E);return _.el&&(_=xr(_),y.shapeFlag&128&&(y.ssContent=_)),m=E,C?(_.el=C.el,_.component=C.component,_.transition&&Jl(_,_.transition),_.shapeFlag|=512,s.delete(E),s.add(E)):(s.add(E),M&&s.size>parseInt(M,10)&&v(s.values().next().value)),_.shapeFlag|=256,o=_,JE(y.type)?y:_}}},dR=hR;function hu(n,e){return We(n)?n.some(t=>hu(t,e)):Zt(n)?n.split(",").includes(e):ZP(n)?n.test(e):!1}function iS(n,e){rS(n,"a",e)}function fR(n,e){rS(n,"da",e)}function rS(n,e,t=Un){const i=n.__wdc||(n.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return n()});if(Sp(e,i,t),t){let r=t.parent;for(;r&&r.parent;)Ep(r.parent.vnode)&&pR(i,e,t,r),r=r.parent}}function pR(n,e,t,i){const r=Sp(e,n,i,!0);Si(()=>{k0(i[e],r)},t)}function Dm(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Um(n){return n.shapeFlag&128?n.ssContent:n}function Sp(n,e,t=Un,i=!1){if(t){const r=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;pc(),xo(t);const a=ir(e,t,n,o);return po(),mc(),a});return i?r.unshift(s):r.push(s),s}}const Is=n=>(e,t=Un)=>(!Wu||n==="sp")&&Sp(n,(...i)=>e(...i),t),mR=Is("bm"),_n=Is("m"),gR=Is("bu"),r_=Is("u"),Cr=Is("bum"),Si=Is("um"),vR=Is("sp"),_R=Is("rtg"),yR=Is("rtc");function bR(n,e=Un){Sp("ec",n,e)}const s_="components";function vu(n,e){return oS(s_,n,!0,e)||n}const sS=Symbol.for("v-ndc");function xR(n){return Zt(n)?oS(s_,n,!1)||n:n||sS}function oS(n,e,t=!0,i=!1){const r=zn||Un;if(r){const s=r.type;if(n===s_){const a=vv(s,!1);if(a&&(a===e||a===Wr(e)||a===vp(Wr(e))))return s}const o=Tb(r[n]||s[n],e)||Tb(r.appContext[n],e);return!o&&i?s:o}}function Tb(n,e){return n&&(n[e]||n[Wr(e)]||n[vp(Wr(e))])}function Zq(n,e,t,i){let r;const s=t&&t[i];if(We(n)||Zt(n)){r=new Array(n.length);for(let o=0,a=n.length;o<a;o++)r[o]=e(n[o],o,void 0,s&&s[o])}else if(typeof n=="number"){r=new Array(n);for(let o=0;o<n;o++)r[o]=e(o+1,o,void 0,s&&s[o])}else if(Vt(n))if(n[Symbol.iterator])r=Array.from(n,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(n);r=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];r[a]=e(n[c],c,a,s&&s[a])}}else r=[];return t&&(t[i]=r),r}function wi(n,e,t={},i,r){if(zn.isCE||zn.parent&&zl(zn.parent)&&zn.parent.isCE)return e!=="default"&&(t.name=e),ne("slot",t,i&&i());let s=n[e];s&&s._c&&(s._d=!1),rt();const o=s&&aS(s(t)),a=Br(Kt,{key:t.key||o&&o.key||"_".concat(e)},o||(i?i():[]),o&&n._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),s&&s._c&&(s._d=!0),a}function aS(n){return n.some(e=>xa(e)?!(e.type===oi||e.type===Kt&&!aS(e.children)):!0)?n:null}const uv=n=>n?wS(n)?Cp(n)||n.proxy:uv(n.parent):null,_u=vn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>uv(n.parent),$root:n=>uv(n.root),$emit:n=>n.emit,$options:n=>o_(n),$forceUpdate:n=>n.f||(n.f=()=>Q0(n.update)),$nextTick:n=>n.n||(n.n=$r.bind(n.proxy)),$watch:n=>lR.bind(n)}),Nm=(n,e)=>n!==Gt&&!n.__isScriptSetup&&St(n,e),wR={get({_:n},e){const{ctx:t,setupState:i,data:r,props:s,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(Nm(i,e))return o[e]=1,i[e];if(r!==Gt&&St(r,e))return o[e]=2,r[e];if((c=n.propsOptions[0])&&St(c,e))return o[e]=3,s[e];if(t!==Gt&&St(t,e))return o[e]=4,t[e];hv&&(o[e]=0)}}const u=_u[e];let h,d;if(u)return e==="$attrs"&&xi(n,"get",e),u(n);if((h=a.__cssModules)&&(h=h[e]))return h;if(t!==Gt&&St(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,St(d,e))return d[e]},set({_:n},e,t){const{data:i,setupState:r,ctx:s}=n;return Nm(r,e)?(r[e]=t,!0):i!==Gt&&St(i,e)?(i[e]=t,!0):St(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:i,appContext:r,propsOptions:s}},o){let a;return!!t[o]||n!==Gt&&St(n,o)||Nm(e,o)||(a=s[0])&&St(a,o)||St(i,o)||St(_u,o)||St(r.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:St(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function lS(){return cS().slots}function MR(){return cS().attrs}function cS(){const n=En();return n.setupContext||(n.setupContext=ES(n))}function Ab(n){return We(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}function Jq(n){const e=En();let t=n();return po(),z0(t)&&(t=t.catch(i=>{throw xo(e),i})),[t,()=>xo(e)]}let hv=!0;function ER(n){const e=o_(n),t=n.proxy,i=n.ctx;hv=!1,e.beforeCreate&&Cb(e.beforeCreate,n,"bc");const{data:r,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:v,deactivated:m,beforeDestroy:g,beforeUnmount:b,destroyed:y,unmounted:_,render:T,renderTracked:w,renderTriggered:S,errorCaptured:x,serverPrefetch:M,expose:E,inheritAttrs:C,components:O,directives:$,filters:U}=e;if(c&&SR(c,i,null),o)for(const q in o){const ie=o[q];st(ie)&&(i[q]=ie.bind(t))}if(r){const q=r.call(t,t);Vt(q)&&(n.data=li(q))}if(hv=!0,s)for(const q in s){const ie=s[q],Z=st(ie)?ie.bind(t,t):st(ie.get)?ie.get.bind(t,t):yr,te=!st(ie)&&st(ie.set)?ie.set.bind(t):yr,X=Te({get:Z,set:te});Object.defineProperty(i,q,{enumerable:!0,configurable:!0,get:()=>X.value,set:se=>X.value=se})}if(a)for(const q in a)uS(a[q],i,t,q);if(l){const q=st(l)?l.call(t):l;Reflect.ownKeys(q).forEach(ie=>{bi(ie,q[ie])})}u&&Cb(u,n,"c");function W(q,ie){We(ie)?ie.forEach(Z=>q(Z.bind(t))):ie&&q(ie.bind(t))}if(W(mR,h),W(_n,d),W(gR,f),W(r_,p),W(iS,v),W(fR,m),W(bR,x),W(yR,w),W(_R,S),W(Cr,b),W(Si,_),W(vR,M),We(E))if(E.length){const q=n.exposed||(n.exposed={});E.forEach(ie=>{Object.defineProperty(q,ie,{get:()=>t[ie],set:Z=>t[ie]=Z})})}else n.exposed||(n.exposed={});T&&n.render===yr&&(n.render=T),C!=null&&(n.inheritAttrs=C),O&&(n.components=O),$&&(n.directives=$)}function SR(n,e,t=yr){We(n)&&(n=dv(n));for(const i in n){const r=n[i];let s;Vt(r)?"default"in r?s=Xt(r.from||i,r.default,!0):s=Xt(r.from||i):s=Xt(r),gn(s)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[i]=s}}function Cb(n,e,t){ir(We(n)?n.map(i=>i.bind(e.proxy)):n.bind(e.proxy),e,t)}function uS(n,e,t,i){const r=i.includes(".")?QE(t,i):()=>t[i];if(Zt(n)){const s=e[n];st(s)&&ft(r,s)}else if(st(n))ft(r,n.bind(t));else if(Vt(n))if(We(n))n.forEach(s=>uS(s,e,t,i));else{const s=st(n.handler)?n.handler.bind(t):e[n.handler];st(s)&&ft(r,s,n)}}function o_(n){const e=n.type,{mixins:t,extends:i}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!r.length&&!t&&!i?l=e:(l={},r.length&&r.forEach(c=>Wf(l,c,o,!0)),Wf(l,e,o)),Vt(e)&&s.set(e,l),l}function Wf(n,e,t,i=!1){const{mixins:r,extends:s}=e;s&&Wf(n,s,t,!0),r&&r.forEach(o=>Wf(n,o,t,!0));for(const o in e)if(!(i&&o==="expose")){const a=TR[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const TR={data:Pb,props:Rb,emits:Rb,methods:du,computed:du,beforeCreate:ii,created:ii,beforeMount:ii,mounted:ii,beforeUpdate:ii,updated:ii,beforeDestroy:ii,beforeUnmount:ii,destroyed:ii,unmounted:ii,activated:ii,deactivated:ii,errorCaptured:ii,serverPrefetch:ii,components:du,directives:du,watch:CR,provide:Pb,inject:AR};function Pb(n,e){return e?n?function(){return vn(st(n)?n.call(this,this):n,st(e)?e.call(this,this):e)}:e:n}function AR(n,e){return du(dv(n),dv(e))}function dv(n){if(We(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function ii(n,e){return n?[...new Set([].concat(n,e))]:e}function du(n,e){return n?vn(Object.create(null),n,e):e}function Rb(n,e){return n?We(n)&&We(e)?[...new Set([...n,...e])]:vn(Object.create(null),Ab(n),Ab(e!=null?e:{})):e}function CR(n,e){if(!n)return e;if(!e)return n;const t=vn(Object.create(null),n);for(const i in e)t[i]=ii(n[i],e[i]);return t}function hS(){return{app:null,config:{isNativeTag:YP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let PR=0;function RR(n,e){return function(i,r=null){st(i)||(i=vn({},i)),r!=null&&!Vt(r)&&(r=null);const s=hS(),o=new Set;let a=!1;const l=s.app={_uid:PR++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:QR,get config(){return s.config},set config(c){},use(c,...u){return o.has(c)||(c&&st(c.install)?(o.add(c),c.install(l,...u)):st(c)&&(o.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!a){const d=ne(i,r);return d.appContext=s,u&&e?e(d,c):n(d,c,h),a=!0,l._container=c,c.__vue_app__=l,Cp(d.component)||d.component.proxy}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l},runWithContext(c){$f=l;try{return c()}finally{$f=null}}};return l}}let $f=null;function bi(n,e){if(Un){let t=Un.provides;const i=Un.parent&&Un.parent.provides;i===t&&(t=Un.provides=Object.create(i)),t[n]=e}}function Xt(n,e,t=!1){const i=Un||zn;if(i||$f){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:$f._context.provides;if(r&&n in r)return r[n];if(arguments.length>1)return t&&st(e)?e.call(i&&i.proxy):e}}function LR(n,e,t,i=!1){const r={},s={};zf(s,Ap,1),n.propsDefaults=Object.create(null),dS(n,e,r,s);for(const o in n.propsOptions[0])o in r||(r[o]=void 0);t?n.props=i?r:zE(r):n.type.props?n.props=r:n.props=s,n.attrs=s}function OR(n,e,t,i){const{props:r,attrs:s,vnode:{patchFlag:o}}=n,a=Et(r),[l]=n.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(xp(n.emitsOptions,d))continue;const f=e[d];if(l)if(St(s,d))f!==s[d]&&(s[d]=f,c=!0);else{const p=Wr(d);r[p]=fv(l,a,p,f,n,!1)}else f!==s[d]&&(s[d]=f,c=!0)}}}else{dS(n,e,r,s)&&(c=!0);let u;for(const h in a)(!e||!St(e,h)&&((u=fc(h))===h||!St(e,u)))&&(l?t&&(t[h]!==void 0||t[u]!==void 0)&&(r[h]=fv(l,a,h,void 0,n,!0)):delete r[h]);if(s!==a)for(const h in s)(!e||!St(e,h))&&(delete s[h],c=!0)}c&&Es(n,"set","$attrs")}function dS(n,e,t,i){const[r,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(wf(l))continue;const c=e[l];let u;r&&St(r,u=Wr(l))?!s||!s.includes(u)?t[u]=c:(a||(a={}))[u]=c:xp(n.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(s){const l=Et(t),c=a||Gt;for(let u=0;u<s.length;u++){const h=s[u];t[h]=fv(r,l,h,c[h],n,!St(c,h))}}return o}function fv(n,e,t,i,r,s){const o=n[t];if(o!=null){const a=St(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&st(l)){const{propsDefaults:c}=r;t in c?i=c[t]:(xo(r),i=c[t]=l.call(null,e),po())}else i=l}o[0]&&(s&&!a?i=!1:o[1]&&(i===""||i===fc(t))&&(i=!0))}return i}function fS(n,e,t=!1){const i=e.propsCache,r=i.get(n);if(r)return r;const s=n.props,o={},a=[];let l=!1;if(!st(n)){const u=h=>{l=!0;const[d,f]=fS(h,e,!0);vn(o,d),f&&a.push(...f)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!s&&!l)return Vt(n)&&i.set(n,Ul),Ul;if(We(s))for(let u=0;u<s.length;u++){const h=Wr(s[u]);Lb(h)&&(o[h]=Gt)}else if(s)for(const u in s){const h=Wr(u);if(Lb(h)){const d=s[u],f=o[h]=We(d)||st(d)?{type:d}:vn({},d);if(f){const p=Db(Boolean,f.type),v=Db(String,f.type);f[0]=p>-1,f[1]=v<0||p<v,(p>-1||St(f,"default"))&&a.push(h)}}}const c=[o,a];return Vt(n)&&i.set(n,c),c}function Lb(n){return n[0]!=="$"}function Ob(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function Ib(n,e){return Ob(n)===Ob(e)}function Db(n,e){return We(e)?e.findIndex(t=>Ib(t,n)):st(e)&&Ib(e,n)?0:-1}const pS=n=>n[0]==="_"||n==="$stable",a_=n=>We(n)?n.map(pr):[pr(n)],IR=(n,e,t)=>{if(e._n)return e;const i=Mp((...r)=>a_(e(...r)),t);return i._c=!1,i},mS=(n,e,t)=>{const i=n._ctx;for(const r in n){if(pS(r))continue;const s=n[r];if(st(s))e[r]=IR(r,s,i);else if(s!=null){const o=a_(s);e[r]=()=>o}}},gS=(n,e)=>{const t=a_(e);n.slots.default=()=>t},DR=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=Et(e),zf(e,"_",t)):mS(e,n.slots={})}else n.slots={},e&&gS(n,e);zf(n.slots,Ap,1)},UR=(n,e,t)=>{const{vnode:i,slots:r}=n;let s=!0,o=Gt;if(i.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:(vn(r,e),!t&&a===1&&delete r._):(s=!e.$stable,mS(e,r)),o=e}else e&&(gS(n,e),o={default:1});if(s)for(const a in r)!pS(a)&&!(a in o)&&delete r[a]};function pv(n,e,t,i,r=!1){if(We(n)){n.forEach((d,f)=>pv(d,e&&(We(e)?e[f]:e),t,i,r));return}if(zl(i)&&!r)return;const s=i.shapeFlag&4?Cp(i.component)||i.component.proxy:i.el,o=r?null:s,{i:a,r:l}=n,c=e&&e.r,u=a.refs===Gt?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(Zt(c)?(u[c]=null,St(h,c)&&(h[c]=null)):gn(c)&&(c.value=null)),st(l))fo(l,a,12,[o,u]);else{const d=Zt(l),f=gn(l);if(d||f){const p=()=>{if(n.f){const v=d?St(h,l)?h[l]:u[l]:l.value;r?We(v)&&k0(v,s):We(v)?v.includes(s)||v.push(s):d?(u[l]=[s],St(h,l)&&(h[l]=u[l])):(l.value=[s],n.k&&(u[n.k]=l.value))}else d?(u[l]=o,St(h,l)&&(h[l]=o)):f&&(l.value=o,n.k&&(u[n.k]=o))};o?(p.id=-1,Fn(p,t)):p()}}}const Fn=oR;function vS(n){return NR(n)}function NR(n,e){const t=sv();t.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=yr,insertStaticContent:p}=n,v=(A,R,I,V=null,H=null,ee=null,oe=!1,re=null,ue=!!R.dynamicChildren)=>{if(A===R)return;A&&!vr(A,R)&&(V=Q(A),se(A,H,ee,!0),A=null),R.patchFlag===-2&&(ue=!1,R.dynamicChildren=null);const{type:ae,ref:Ee,shapeFlag:N}=R;switch(ae){case Tp:m(A,R,I,V);break;case oi:g(A,R,I,V);break;case Mf:A==null&&b(R,I,V,oe);break;case Kt:O(A,R,I,V,H,ee,oe,re,ue);break;default:N&1?T(A,R,I,V,H,ee,oe,re,ue):N&6?$(A,R,I,V,H,ee,oe,re,ue):(N&64||N&128)&&ae.process(A,R,I,V,H,ee,oe,re,ue,P)}Ee!=null&&H&&pv(Ee,A&&A.ref,ee,R||A,!R)},m=(A,R,I,V)=>{if(A==null)i(R.el=a(R.children),I,V);else{const H=R.el=A.el;R.children!==A.children&&c(H,R.children)}},g=(A,R,I,V)=>{A==null?i(R.el=l(R.children||""),I,V):R.el=A.el},b=(A,R,I,V)=>{[A.el,A.anchor]=p(A.children,R,I,V,A.el,A.anchor)},y=({el:A,anchor:R},I,V)=>{let H;for(;A&&A!==R;)H=d(A),i(A,I,V),A=H;i(R,I,V)},_=({el:A,anchor:R})=>{let I;for(;A&&A!==R;)I=d(A),r(A),A=I;r(R)},T=(A,R,I,V,H,ee,oe,re,ue)=>{oe=oe||R.type==="svg",A==null?w(R,I,V,H,ee,oe,re,ue):M(A,R,H,ee,oe,re,ue)},w=(A,R,I,V,H,ee,oe,re)=>{let ue,ae;const{type:Ee,props:N,shapeFlag:L,transition:J,dirs:pe}=A;if(ue=A.el=o(A.type,ee,N&&N.is,N),L&8?u(ue,A.children):L&16&&x(A.children,ue,null,V,H,ee&&Ee!=="foreignObject",oe,re),pe&&No(A,null,V,"created"),S(ue,A,A.scopeId,oe,V),N){for(const ye in N)ye!=="value"&&!wf(ye)&&s(ue,ye,null,N[ye],ee,A.children,V,H,Ie);"value"in N&&s(ue,"value",null,N.value),(ae=N.onVnodeBeforeMount)&&Yi(ae,V,A)}pe&&No(A,null,V,"beforeMount");const he=(!H||H&&!H.pendingBranch)&&J&&!J.persisted;he&&J.beforeEnter(ue),i(ue,R,I),((ae=N&&N.onVnodeMounted)||he||pe)&&Fn(()=>{ae&&Yi(ae,V,A),he&&J.enter(ue),pe&&No(A,null,V,"mounted")},H)},S=(A,R,I,V,H)=>{if(I&&f(A,I),V)for(let ee=0;ee<V.length;ee++)f(A,V[ee]);if(H){let ee=H.subTree;if(R===ee){const oe=H.vnode;S(A,oe,oe.scopeId,oe.slotScopeIds,H.parent)}}},x=(A,R,I,V,H,ee,oe,re,ue=0)=>{for(let ae=ue;ae<A.length;ae++){const Ee=A[ae]=re?io(A[ae]):pr(A[ae]);v(null,Ee,R,I,V,H,ee,oe,re)}},M=(A,R,I,V,H,ee,oe)=>{const re=R.el=A.el;let{patchFlag:ue,dynamicChildren:ae,dirs:Ee}=R;ue|=A.patchFlag&16;const N=A.props||Gt,L=R.props||Gt;let J;I&&Fo(I,!1),(J=L.onVnodeBeforeUpdate)&&Yi(J,I,R,A),Ee&&No(R,A,I,"beforeUpdate"),I&&Fo(I,!0);const pe=H&&R.type!=="foreignObject";if(ae?E(A.dynamicChildren,ae,re,I,V,pe,ee):oe||ie(A,R,re,null,I,V,pe,ee,!1),ue>0){if(ue&16)C(re,R,N,L,I,V,H);else if(ue&2&&N.class!==L.class&&s(re,"class",null,L.class,H),ue&4&&s(re,"style",N.style,L.style,H),ue&8){const he=R.dynamicProps;for(let ye=0;ye<he.length;ye++){const Ue=he[ye],Ae=N[Ue],Ne=L[Ue];(Ne!==Ae||Ue==="value")&&s(re,Ue,Ae,Ne,H,A.children,I,V,Ie)}}ue&1&&A.children!==R.children&&u(re,R.children)}else!oe&&ae==null&&C(re,R,N,L,I,V,H);((J=L.onVnodeUpdated)||Ee)&&Fn(()=>{J&&Yi(J,I,R,A),Ee&&No(R,A,I,"updated")},V)},E=(A,R,I,V,H,ee,oe)=>{for(let re=0;re<R.length;re++){const ue=A[re],ae=R[re],Ee=ue.el&&(ue.type===Kt||!vr(ue,ae)||ue.shapeFlag&70)?h(ue.el):I;v(ue,ae,Ee,null,V,H,ee,oe,!0)}},C=(A,R,I,V,H,ee,oe)=>{if(I!==V){if(I!==Gt)for(const re in I)!wf(re)&&!(re in V)&&s(A,re,I[re],null,oe,R.children,H,ee,Ie);for(const re in V){if(wf(re))continue;const ue=V[re],ae=I[re];ue!==ae&&re!=="value"&&s(A,re,ae,ue,oe,R.children,H,ee,Ie)}"value"in V&&s(A,"value",I.value,V.value)}},O=(A,R,I,V,H,ee,oe,re,ue)=>{const ae=R.el=A?A.el:a(""),Ee=R.anchor=A?A.anchor:a("");let{patchFlag:N,dynamicChildren:L,slotScopeIds:J}=R;J&&(re=re?re.concat(J):J),A==null?(i(ae,I,V),i(Ee,I,V),x(R.children,I,Ee,H,ee,oe,re,ue)):N>0&&N&64&&L&&A.dynamicChildren?(E(A.dynamicChildren,L,I,H,ee,oe,re),(R.key!=null||H&&R===H.subTree)&&l_(A,R,!0)):ie(A,R,I,Ee,H,ee,oe,re,ue)},$=(A,R,I,V,H,ee,oe,re,ue)=>{R.slotScopeIds=re,A==null?R.shapeFlag&512?H.ctx.activate(R,I,V,oe,ue):U(R,I,V,H,ee,oe,ue):j(A,R,ue)},U=(A,R,I,V,H,ee,oe)=>{const re=A.component=jR(A,V,H);if(Ep(A)&&(re.ctx.renderer=P),XR(re),re.asyncDep){if(H&&H.registerDep(re,W),!A.el){const ue=re.subTree=ne(oi);g(null,ue,R,I)}return}W(re,A,R,I,H,ee,oe)},j=(A,R,I)=>{const V=R.component=A.component;if(eR(A,R,I))if(V.asyncDep&&!V.asyncResolved){q(V,R,I);return}else V.next=R,Y3(V.update),V.update();else R.el=A.el,V.vnode=R},W=(A,R,I,V,H,ee,oe)=>{const re=()=>{if(A.isMounted){let{next:Ee,bu:N,u:L,parent:J,vnode:pe}=A,he=Ee,ye;Fo(A,!1),Ee?(Ee.el=pe.el,q(A,Ee,oe)):Ee=pe,N&&gu(N),(ye=Ee.props&&Ee.props.onVnodeBeforeUpdate)&&Yi(ye,J,Ee,pe),Fo(A,!0);const Ue=Om(A),Ae=A.subTree;A.subTree=Ue,v(Ae,Ue,h(Ae.el),Q(Ae),A,H,ee),Ee.el=Ue.el,he===null&&e_(A,Ue.el),L&&Fn(L,H),(ye=Ee.props&&Ee.props.onVnodeUpdated)&&Fn(()=>Yi(ye,J,Ee,pe),H)}else{let Ee;const{el:N,props:L}=R,{bm:J,m:pe,parent:he}=A,ye=zl(R);if(Fo(A,!1),J&&gu(J),!ye&&(Ee=L&&L.onVnodeBeforeMount)&&Yi(Ee,he,R),Fo(A,!0),N&&k){const Ue=()=>{A.subTree=Om(A),k(N,A.subTree,A,H,null)};ye?R.type.__asyncLoader().then(()=>!A.isUnmounted&&Ue()):Ue()}else{const Ue=A.subTree=Om(A);v(null,Ue,I,V,A,H,ee),R.el=Ue.el}if(pe&&Fn(pe,H),!ye&&(Ee=L&&L.onVnodeMounted)){const Ue=R;Fn(()=>Yi(Ee,he,Ue),H)}(R.shapeFlag&256||he&&zl(he.vnode)&&he.vnode.shapeFlag&256)&&A.a&&Fn(A.a,H),A.isMounted=!0,R=I=V=null}},ue=A.effect=new W0(re,()=>Q0(ae),A.scope),ae=A.update=()=>ue.run();ae.id=A.uid,Fo(A,!0),ae()},q=(A,R,I)=>{R.component=A;const V=A.vnode.props;A.vnode=R,A.next=null,OR(A,R.props,V,I),UR(A,R.children,I),pc(),wb(),mc()},ie=(A,R,I,V,H,ee,oe,re,ue=!1)=>{const ae=A&&A.children,Ee=A?A.shapeFlag:0,N=R.children,{patchFlag:L,shapeFlag:J}=R;if(L>0){if(L&128){te(ae,N,I,V,H,ee,oe,re,ue);return}else if(L&256){Z(ae,N,I,V,H,ee,oe,re,ue);return}}J&8?(Ee&16&&Ie(ae,H,ee),N!==ae&&u(I,N)):Ee&16?J&16?te(ae,N,I,V,H,ee,oe,re,ue):Ie(ae,H,ee,!0):(Ee&8&&u(I,""),J&16&&x(N,I,V,H,ee,oe,re,ue))},Z=(A,R,I,V,H,ee,oe,re,ue)=>{A=A||Ul,R=R||Ul;const ae=A.length,Ee=R.length,N=Math.min(ae,Ee);let L;for(L=0;L<N;L++){const J=R[L]=ue?io(R[L]):pr(R[L]);v(A[L],J,I,null,H,ee,oe,re,ue)}ae>Ee?Ie(A,H,ee,!0,!1,N):x(R,I,V,H,ee,oe,re,ue,N)},te=(A,R,I,V,H,ee,oe,re,ue)=>{let ae=0;const Ee=R.length;let N=A.length-1,L=Ee-1;for(;ae<=N&&ae<=L;){const J=A[ae],pe=R[ae]=ue?io(R[ae]):pr(R[ae]);if(vr(J,pe))v(J,pe,I,null,H,ee,oe,re,ue);else break;ae++}for(;ae<=N&&ae<=L;){const J=A[N],pe=R[L]=ue?io(R[L]):pr(R[L]);if(vr(J,pe))v(J,pe,I,null,H,ee,oe,re,ue);else break;N--,L--}if(ae>N){if(ae<=L){const J=L+1,pe=J<Ee?R[J].el:V;for(;ae<=L;)v(null,R[ae]=ue?io(R[ae]):pr(R[ae]),I,pe,H,ee,oe,re,ue),ae++}}else if(ae>L)for(;ae<=N;)se(A[ae],H,ee,!0),ae++;else{const J=ae,pe=ae,he=new Map;for(ae=pe;ae<=L;ae++){const Je=R[ae]=ue?io(R[ae]):pr(R[ae]);Je.key!=null&&he.set(Je.key,ae)}let ye,Ue=0;const Ae=L-pe+1;let Ne=!1,$e=0;const ht=new Array(Ae);for(ae=0;ae<Ae;ae++)ht[ae]=0;for(ae=J;ae<=N;ae++){const Je=A[ae];if(Ue>=Ae){se(Je,H,ee,!0);continue}let Y;if(Je.key!=null)Y=he.get(Je.key);else for(ye=pe;ye<=L;ye++)if(ht[ye-pe]===0&&vr(Je,R[ye])){Y=ye;break}Y===void 0?se(Je,H,ee,!0):(ht[Y-pe]=ae+1,Y>=$e?$e=Y:Ne=!0,v(Je,R[Y],I,null,H,ee,oe,re,ue),Ue++)}const Le=Ne?FR(ht):Ul;for(ye=Le.length-1,ae=Ae-1;ae>=0;ae--){const Je=pe+ae,Y=R[Je],de=Je+1<Ee?R[Je+1].el:V;ht[ae]===0?v(null,Y,I,de,H,ee,oe,re,ue):Ne&&(ye<0||ae!==Le[ye]?X(Y,I,de,2):ye--)}}},X=(A,R,I,V,H=null)=>{const{el:ee,type:oe,transition:re,children:ue,shapeFlag:ae}=A;if(ae&6){X(A.component.subTree,R,I,V);return}if(ae&128){A.suspense.move(R,I,V);return}if(ae&64){oe.move(A,R,I,P);return}if(oe===Kt){i(ee,R,I);for(let N=0;N<ue.length;N++)X(ue[N],R,I,V);i(A.anchor,R,I);return}if(oe===Mf){y(A,R,I);return}if(V!==2&&ae&1&&re)if(V===0)re.beforeEnter(ee),i(ee,R,I),Fn(()=>re.enter(ee),H);else{const{leave:N,delayLeave:L,afterLeave:J}=re,pe=()=>i(ee,R,I),he=()=>{N(ee,()=>{pe(),J&&J()})};L?L(ee,pe,he):he()}else i(ee,R,I)},se=(A,R,I,V=!1,H=!1)=>{const{type:ee,props:oe,ref:re,children:ue,dynamicChildren:ae,shapeFlag:Ee,patchFlag:N,dirs:L}=A;if(re!=null&&pv(re,null,I,A,!0),Ee&256){R.ctx.deactivate(A);return}const J=Ee&1&&L,pe=!zl(A);let he;if(pe&&(he=oe&&oe.onVnodeBeforeUnmount)&&Yi(he,R,A),Ee&6)Re(A.component,I,V);else{if(Ee&128){A.suspense.unmount(I,V);return}J&&No(A,null,R,"beforeUnmount"),Ee&64?A.type.remove(A,R,I,H,P,V):ae&&(ee!==Kt||N>0&&N&64)?Ie(ae,R,I,!1,!0):(ee===Kt&&N&384||!H&&Ee&16)&&Ie(ue,R,I),V&&G(A)}(pe&&(he=oe&&oe.onVnodeUnmounted)||J)&&Fn(()=>{he&&Yi(he,R,A),J&&No(A,null,R,"unmounted")},I)},G=A=>{const{type:R,el:I,anchor:V,transition:H}=A;if(R===Kt){xe(I,V);return}if(R===Mf){_(A);return}const ee=()=>{r(I),H&&!H.persisted&&H.afterLeave&&H.afterLeave()};if(A.shapeFlag&1&&H&&!H.persisted){const{leave:oe,delayLeave:re}=H,ue=()=>oe(I,ee);re?re(A.el,ee,ue):ue()}else ee()},xe=(A,R)=>{let I;for(;A!==R;)I=d(A),r(A),A=I;r(R)},Re=(A,R,I)=>{const{bum:V,scope:H,update:ee,subTree:oe,um:re}=A;V&&gu(V),H.stop(),ee&&(ee.active=!1,se(oe,A,R,I)),re&&Fn(re,R),Fn(()=>{A.isUnmounted=!0},R),R&&R.pendingBranch&&!R.isUnmounted&&A.asyncDep&&!A.asyncResolved&&A.suspenseId===R.pendingId&&(R.deps--,R.deps===0&&R.resolve())},Ie=(A,R,I,V=!1,H=!1,ee=0)=>{for(let oe=ee;oe<A.length;oe++)se(A[oe],R,I,V,H)},Q=A=>A.shapeFlag&6?Q(A.component.subTree):A.shapeFlag&128?A.suspense.next():d(A.anchor||A.el),K=(A,R,I)=>{A==null?R._vnode&&se(R._vnode,null,null,!0):v(R._vnode||null,A,R,null,null,null,I),wb(),qE(),R._vnode=A},P={p:v,um:se,m:X,r:G,mt:U,mc:x,pc:ie,pbc:E,n:Q,o:n};let F,k;return e&&([F,k]=e(P)),{render:K,hydrate:F,createApp:RR(K,F)}}function Fo({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function l_(n,e,t=!1){const i=n.children,r=e.children;if(We(i)&&We(r))for(let s=0;s<i.length;s++){const o=i[s];let a=r[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[s]=io(r[s]),a.el=o.el),t||l_(o,a)),a.type===Tp&&(a.el=o.el)}}function FR(n){const e=n.slice(),t=[0];let i,r,s,o,a;const l=n.length;for(i=0;i<l;i++){const c=n[i];if(c!==0){if(r=t[t.length-1],n[r]<c){e[i]=r,t.push(i);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<c?s=a+1:o=a;c<n[t[s]]&&(s>0&&(e[i]=t[s-1]),t[s]=i)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}const kR=n=>n.__isTeleport,yu=n=>n&&(n.disabled||n.disabled===""),Ub=n=>typeof SVGElement<"u"&&n instanceof SVGElement,mv=(n,e)=>{const t=n&&n.to;return Zt(t)?e?e(t):null:t},BR={__isTeleport:!0,process(n,e,t,i,r,s,o,a,l,c){const{mc:u,pc:h,pbc:d,o:{insert:f,querySelector:p,createText:v,createComment:m}}=c,g=yu(e.props);let{shapeFlag:b,children:y,dynamicChildren:_}=e;if(n==null){const T=e.el=v(""),w=e.anchor=v("");f(T,t,i),f(w,t,i);const S=e.target=mv(e.props,p),x=e.targetAnchor=v("");S&&(f(x,S),o=o||Ub(S));const M=(E,C)=>{b&16&&u(y,E,C,r,s,o,a,l)};g?M(t,w):S&&M(S,x)}else{e.el=n.el;const T=e.anchor=n.anchor,w=e.target=n.target,S=e.targetAnchor=n.targetAnchor,x=yu(n.props),M=x?t:w,E=x?T:S;if(o=o||Ub(w),_?(d(n.dynamicChildren,_,M,r,s,o,a),l_(n,e,!0)):l||h(n,e,M,E,r,s,o,a,!1),g)x||cd(e,t,T,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const C=e.target=mv(e.props,p);C&&cd(e,C,null,c,0)}else x&&cd(e,w,S,c,1)}_S(e)},remove(n,e,t,i,{um:r,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:h,props:d}=n;if(h&&s(u),(o||!yu(d))&&(s(c),a&16))for(let f=0;f<l.length;f++){const p=l[f];r(p,e,t,!0,!!p.dynamicChildren)}},move:cd,hydrate:zR};function cd(n,e,t,{o:{insert:i},m:r},s=2){s===0&&i(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=n,h=s===2;if(h&&i(o,e,t),(!h||yu(u))&&l&16)for(let d=0;d<c.length;d++)r(c[d],e,t,2);h&&i(a,e,t)}function zR(n,e,t,i,r,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=mv(e.props,l);if(u){const h=u._lpa||u.firstChild;if(e.shapeFlag&16)if(yu(e.props))e.anchor=c(o(n),e,a(n),t,i,r,s),e.targetAnchor=h;else{e.anchor=o(n);let d=h;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(h,e,u,t,i,r,s)}_S(e)}return e.anchor&&o(e.anchor)}const VR=BR;function _S(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const Kt=Symbol.for("v-fgt"),Tp=Symbol.for("v-txt"),oi=Symbol.for("v-cmt"),Mf=Symbol.for("v-stc"),bu=[];let er=null;function rt(n=!1){bu.push(er=n?null:[])}function yS(){bu.pop(),er=bu[bu.length-1]||null}let Ql=1;function Nb(n){Ql+=n}function bS(n){return n.dynamicChildren=Ql>0?er||Ul:null,yS(),Ql>0&&er&&er.push(n),n}function Mt(n,e,t,i,r,s){return bS(Kn(n,e,t,i,r,s,!0))}function Br(n,e,t,i,r){return bS(ne(n,e,t,i,r,!0))}function xa(n){return n?n.__v_isVNode===!0:!1}function vr(n,e){return n.type===e.type&&n.key===e.key}const Ap="__vInternal",xS=({key:n})=>n!=null?n:null,Ef=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Zt(n)||gn(n)||st(n)?{i:zn,r:n,k:e,f:!!t}:n:null);function Kn(n,e=null,t=null,i=0,r=null,s=n===Kt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&xS(e),ref:e&&Ef(e),scopeId:wp,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:zn};return a?(u_(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=Zt(t)?8:16),Ql>0&&!o&&er&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&er.push(l),l}const ne=HR;function HR(n,e=null,t=null,i=0,r=null,s=!1){if((!n||n===sS)&&(n=oi),xa(n)){const a=xr(n,e,!0);return t&&u_(a,t),Ql>0&&!s&&er&&(a.shapeFlag&6?er[er.indexOf(n)]=a:er.push(a)),a.patchFlag|=-2,a}if(KR(n)&&(n=n.__vccOpts),e){e=GR(e);let{class:a,style:l}=e;a&&!Zt(a)&&(e.class=Wt(a)),Vt(l)&&(VE(l)&&!We(l)&&(l=vn({},l)),e.style=Dn(l))}const o=Zt(n)?1:JE(n)?128:kR(n)?64:Vt(n)?4:st(n)?2:0;return Kn(n,e,t,i,r,o,s,!0)}function GR(n){return n?VE(n)||Ap in n?vn({},n):n:null}function xr(n,e,t=!1){const{props:i,ref:r,patchFlag:s,children:o}=n,a=e?wr(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&xS(a),ref:e&&e.ref?t&&r?We(r)?r.concat(Ef(e)):[r,Ef(e)]:Ef(e):r,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Kt?s===-1?16:s|16:s,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&xr(n.ssContent),ssFallback:n.ssFallback&&xr(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function c_(n=" ",e=0){return ne(Tp,null,n,e)}function Qq(n,e){const t=ne(Mf,null,n);return t.staticCount=e,t}function Ii(n="",e=!1){return e?(rt(),Br(oi,null,n)):ne(oi,null,n)}function pr(n){return n==null||typeof n=="boolean"?ne(oi):We(n)?ne(Kt,null,n.slice()):typeof n=="object"?io(n):ne(Tp,null,String(n))}function io(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:xr(n)}function u_(n,e){let t=0;const{shapeFlag:i}=n;if(e==null)e=null;else if(We(e))t=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),u_(n,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!(Ap in e)?e._ctx=zn:r===3&&zn&&(zn.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else st(e)?(e={default:e,_ctx:zn},t=32):(e=String(e),i&64?(t=16,e=[c_(e)]):t=8);n.children=e,n.shapeFlag|=t}function wr(...n){const e={};for(let t=0;t<n.length;t++){const i=n[t];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=Wt([e.class,i.class]));else if(r==="style")e.style=Dn([e.style,i.style]);else if(mp(r)){const s=e[r],o=i[r];o&&s!==o&&!(We(s)&&s.includes(o))&&(e[r]=s?[].concat(s,o):o)}else r!==""&&(e[r]=i[r])}return e}function Yi(n,e,t,i=null){ir(n,e,7,[t,i])}const WR=hS();let $R=0;function jR(n,e,t){const i=n.type,r=(e?e.appContext:n.appContext)||WR,s={uid:$R++,vnode:n,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new PE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fS(i,r),emitsOptions:ZE(i,r),emit:null,emitted:null,propsDefaults:Gt,inheritAttrs:i.inheritAttrs,ctx:Gt,data:Gt,props:Gt,attrs:Gt,slots:Gt,refs:Gt,setupState:Gt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=K3.bind(null,s),n.ce&&n.ce(s),s}let Un=null;const En=()=>Un||zn;let h_,$a,Fb="__VUE_INSTANCE_SETTERS__";($a=sv()[Fb])||($a=sv()[Fb]=[]),$a.push(n=>Un=n),h_=n=>{$a.length>1?$a.forEach(e=>e(n)):$a[0](n)};const xo=n=>{h_(n),n.scope.on()},po=()=>{Un&&Un.scope.off(),h_(null)};function wS(n){return n.vnode.shapeFlag&4}let Wu=!1;function XR(n,e=!1){Wu=e;const{props:t,children:i}=n.vnode,r=wS(n);LR(n,t,r,e),DR(n,i);const s=r?YR(n,e):void 0;return Wu=!1,s}function YR(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=HE(new Proxy(n.ctx,wR));const{setup:i}=t;if(i){const r=n.setupContext=i.length>1?ES(n):null;xo(n),pc();const s=fo(i,n,0,[n.props,r]);if(mc(),po(),z0(s)){if(s.then(po,po),e)return s.then(o=>{gv(n,o,e)}).catch(o=>{Rh(o,n,0)});n.asyncDep=s}else gv(n,s,e)}else MS(n,e)}function gv(n,e,t){st(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Vt(e)&&(n.setupState=WE(e)),MS(n,t)}let kb;function MS(n,e,t){const i=n.type;if(!n.render){if(!e&&kb&&!i.render){const r=i.template||o_(n).template;if(r){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=i,c=vn(vn({isCustomElement:s,delimiters:a},o),l);i.render=kb(r,c)}}n.render=i.render||yr}xo(n),pc(),ER(n),mc(),po()}function qR(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,t){return xi(n,"get","$attrs"),e[t]}}))}function ES(n){const e=t=>{n.exposed=t||{}};return{get attrs(){return qR(n)},slots:n.slots,emit:n.emit,expose:e}}function Cp(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(WE(HE(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in _u)return _u[t](n)},has(e,t){return t in e||t in _u}}))}function vv(n,e=!0){return st(n)?n.displayName||n.name:n.name||e&&n.__name}function KR(n){return st(n)&&"__vccOpts"in n}const Te=(n,e)=>$3(n,e,Wu);function wo(n,e,t){const i=arguments.length;return i===2?Vt(e)&&!We(e)?xa(e)?ne(n,null,[e]):ne(n,e):ne(n,null,e):(i>3?t=Array.prototype.slice.call(arguments,2):i===3&&xa(t)&&(t=[t]),ne(n,e,t))}const ZR=Symbol.for("v-scx"),JR=()=>Xt(ZR),QR="3.3.4",eL="http://www.w3.org/2000/svg",ia=typeof document<"u"?document:null,Bb=ia&&ia.createElement("template"),tL={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,i)=>{const r=e?ia.createElementNS(eL,n):ia.createElement(n,t?{is:t}:void 0);return n==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:n=>ia.createTextNode(n),createComment:n=>ia.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ia.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,i,r,s){const o=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{Bb.innerHTML=i?"<svg>".concat(n,"</svg>"):n;const a=Bb.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function nL(n,e,t){const i=n._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}function iL(n,e,t){const i=n.style,r=Zt(t);if(t&&!r){if(e&&!Zt(e))for(const s in e)t[s]==null&&_v(i,s,"");for(const s in t)_v(i,s,t[s])}else{const s=i.display;r?e!==t&&(i.cssText=t):e&&n.removeAttribute("style"),"_vod"in n&&(i.display=s)}}const zb=/\s*!important$/;function _v(n,e,t){if(We(t))t.forEach(i=>_v(n,e,i));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const i=rL(n,e);zb.test(t)?n.setProperty(fc(i),t.replace(zb,""),"important"):n[i]=t}}const Vb=["Webkit","Moz","ms"],Fm={};function rL(n,e){const t=Fm[e];if(t)return t;let i=Wr(e);if(i!=="filter"&&i in n)return Fm[e]=i;i=vp(i);for(let r=0;r<Vb.length;r++){const s=Vb[r]+i;if(s in n)return Fm[e]=s}return e}const Hb="http://www.w3.org/1999/xlink";function sL(n,e,t,i,r){if(i&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(Hb,e.slice(6,e.length)):n.setAttributeNS(Hb,e,t);else{const s=a3(e);t==null||s&&!AE(t)?n.removeAttribute(e):n.setAttribute(e,s?"":t)}}function oL(n,e,t,i,r,s,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,r,s),n[e]=t==null?"":t;return}const a=n.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){n._value=t;const c=a==="OPTION"?n.getAttribute("value"):n.value,u=t==null?"":t;c!==u&&(n.value=u),t==null&&n.removeAttribute(e);return}let l=!1;if(t===""||t==null){const c=typeof n[e];c==="boolean"?t=AE(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{n[e]=t}catch(c){}l&&n.removeAttribute(e)}function aL(n,e,t,i){n.addEventListener(e,t,i)}function lL(n,e,t,i){n.removeEventListener(e,t,i)}function cL(n,e,t,i,r=null){const s=n._vei||(n._vei={}),o=s[e];if(i&&o)o.value=i;else{const[a,l]=uL(e);if(i){const c=s[e]=fL(i,r);aL(n,a,c,l)}else o&&(lL(n,a,o,l),s[e]=void 0)}}const Gb=/(?:Once|Passive|Capture)$/;function uL(n){let e;if(Gb.test(n)){e={};let i;for(;i=n.match(Gb);)n=n.slice(0,n.length-i[0].length),e[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):fc(n.slice(2)),e]}let km=0;const hL=Promise.resolve(),dL=()=>km||(hL.then(()=>km=0),km=Date.now());function fL(n,e){const t=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=t.attached)return;ir(pL(i,t.value),e,5,[i])};return t.value=n,t.attached=dL(),t}function pL(n,e){if(We(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const Wb=/^on[a-z]/,mL=(n,e,t,i,r=!1,s,o,a,l)=>{e==="class"?nL(n,i,r):e==="style"?iL(n,t,i):mp(e)?F0(e)||cL(n,e,t,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):gL(n,e,i,r))?oL(n,e,i,s,o,a,l):(e==="true-value"?n._trueValue=i:e==="false-value"&&(n._falseValue=i),sL(n,e,i,r))};function gL(n,e,t,i){return i?!!(e==="innerHTML"||e==="textContent"||e in n&&Wb.test(e)&&st(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA"||Wb.test(e)&&Zt(t)?!1:e in n}const ks="transition",Ic="animation",gc=(n,{slots:e})=>wo(uR,TS(n),e);gc.displayName="Transition";const SS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},vL=gc.props=vn({},tS,SS),ko=(n,e=[])=>{We(n)?n.forEach(t=>t(...e)):n&&n(...e)},$b=n=>n?We(n)?n.some(e=>e.length>1):n.length>1:!1;function TS(n){const e={};for(const O in n)O in SS||(e[O]=n[O]);if(n.css===!1)return e;const{name:t="v",type:i,duration:r,enterFromClass:s="".concat(t,"-enter-from"),enterActiveClass:o="".concat(t,"-enter-active"),enterToClass:a="".concat(t,"-enter-to"),appearFromClass:l=s,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:h="".concat(t,"-leave-from"),leaveActiveClass:d="".concat(t,"-leave-active"),leaveToClass:f="".concat(t,"-leave-to")}=n,p=_L(r),v=p&&p[0],m=p&&p[1],{onBeforeEnter:g,onEnter:b,onEnterCancelled:y,onLeave:_,onLeaveCancelled:T,onBeforeAppear:w=g,onAppear:S=b,onAppearCancelled:x=y}=e,M=(O,$,U)=>{eo(O,$?u:a),eo(O,$?c:o),U&&U()},E=(O,$)=>{O._isLeaving=!1,eo(O,h),eo(O,f),eo(O,d),$&&$()},C=O=>($,U)=>{const j=O?S:b,W=()=>M($,O,U);ko(j,[$,W]),jb(()=>{eo($,O?l:s),fs($,O?u:a),$b(j)||Xb($,i,v,W)})};return vn(e,{onBeforeEnter(O){ko(g,[O]),fs(O,s),fs(O,o)},onBeforeAppear(O){ko(w,[O]),fs(O,l),fs(O,c)},onEnter:C(!1),onAppear:C(!0),onLeave(O,$){O._isLeaving=!0;const U=()=>E(O,$);fs(O,h),CS(),fs(O,d),jb(()=>{O._isLeaving&&(eo(O,h),fs(O,f),$b(_)||Xb(O,i,m,U))}),ko(_,[O,U])},onEnterCancelled(O){M(O,!1),ko(y,[O])},onAppearCancelled(O){M(O,!0),ko(x,[O])},onLeaveCancelled(O){E(O),ko(T,[O])}})}function _L(n){if(n==null)return null;if(Vt(n))return[Bm(n.enter),Bm(n.leave)];{const e=Bm(n);return[e,e]}}function Bm(n){return TE(n)}function fs(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n._vtc||(n._vtc=new Set)).add(e)}function eo(n,e){e.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const{_vtc:t}=n;t&&(t.delete(e),t.size||(n._vtc=void 0))}function jb(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let yL=0;function Xb(n,e,t,i){const r=n._endId=++yL,s=()=>{r===n._endId&&i()};if(t)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=AS(n,e);if(!o)return i();const c=o+"end";let u=0;const h=()=>{n.removeEventListener(c,d),s()},d=f=>{f.target===n&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},a+1),n.addEventListener(c,d)}function AS(n,e){const t=window.getComputedStyle(n),i=p=>(t[p]||"").split(", "),r=i("".concat(ks,"Delay")),s=i("".concat(ks,"Duration")),o=Yb(r,s),a=i("".concat(Ic,"Delay")),l=i("".concat(Ic,"Duration")),c=Yb(a,l);let u=null,h=0,d=0;e===ks?o>0&&(u=ks,h=o,d=s.length):e===Ic?c>0&&(u=Ic,h=c,d=l.length):(h=Math.max(o,c),u=h>0?o>c?ks:Ic:null,d=u?u===ks?s.length:l.length:0);const f=u===ks&&/\b(transform|all)(,|$)/.test(i("".concat(ks,"Property")).toString());return{type:u,timeout:h,propCount:d,hasTransform:f}}function Yb(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,i)=>qb(t)+qb(n[i])))}function qb(n){return Number(n.slice(0,-1).replace(",","."))*1e3}function CS(){return document.body.offsetHeight}const PS=new WeakMap,RS=new WeakMap,LS={name:"TransitionGroup",props:vn({},vL,{tag:String,moveClass:String}),setup(n,{slots:e}){const t=En(),i=eS();let r,s;return r_(()=>{if(!r.length)return;const o=n.moveClass||"".concat(n.name||"v","-move");if(!EL(r[0].el,t.vnode.el,o))return;r.forEach(xL),r.forEach(wL);const a=r.filter(ML);CS(),a.forEach(l=>{const c=l.el,u=c.style;fs(c,o),u.transform=u.webkitTransform=u.transitionDuration="";const h=c._moveCb=d=>{d&&d.target!==c||(!d||/transform$/.test(d.propertyName))&&(c.removeEventListener("transitionend",h),c._moveCb=null,eo(c,o))};c.addEventListener("transitionend",h)})}),()=>{const o=Et(n),a=TS(o);let l=o.tag||Kt;r=s,s=e.default?i_(e.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&Jl(u,Gu(u,a,i,t))}if(r)for(let c=0;c<r.length;c++){const u=r[c];Jl(u,Gu(u,a,i,t)),PS.set(u,u.el.getBoundingClientRect())}return ne(l,null,s)}}},bL=n=>delete n.mode;LS.props;const d_=LS;function xL(n){const e=n.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function wL(n){RS.set(n,n.el.getBoundingClientRect())}function ML(n){const e=PS.get(n),t=RS.get(n),i=e.left-t.left,r=e.top-t.top;if(i||r){const s=n.el.style;return s.transform=s.webkitTransform="translate(".concat(i,"px,").concat(r,"px)"),s.transitionDuration="0s",n}}function EL(n,e,t){const i=n.cloneNode();n._vtc&&n._vtc.forEach(o=>{o.split(/\s+/).forEach(a=>a&&i.classList.remove(a))}),t.split(/\s+/).forEach(o=>o&&i.classList.add(o)),i.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(i);const{hasTransform:s}=AS(i);return r.removeChild(i),s}const SL=["ctrl","shift","alt","meta"],TL={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>SL.some(t=>n["".concat(t,"Key")]&&!e.includes(t))},Kb=(n,e)=>(t,...i)=>{for(let r=0;r<e.length;r++){const s=TL[e[r]];if(s&&s(t,e))return}return n(t,...i)},$u={beforeMount(n,{value:e},{transition:t}){n._vod=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):Dc(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:i}){!e!=!t&&(i?e?(i.beforeEnter(n),Dc(n,!0),i.enter(n)):i.leave(n,()=>{Dc(n,!1)}):Dc(n,e))},beforeUnmount(n,{value:e}){Dc(n,e)}};function Dc(n,e){n.style.display=e?n._vod:"none"}const AL=vn({patchProp:mL},tL);let Zb;function OS(){return Zb||(Zb=vS(AL))}const CL=(...n)=>{OS().render(...n)},IS=(...n)=>{const e=OS().createApp(...n),{mount:t}=e;return e.mount=i=>{const r=PL(i);if(!r)return;const s=e._component;!st(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const o=t(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function PL(n){return Zt(n)?document.querySelector(n):n}/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Cl=typeof window<"u";function RL(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const It=Object.assign;function zm(n,e){const t={};for(const i in e){const r=e[i];t[i]=Mr(r)?r.map(n):n(r)}return t}const xu=()=>{},Mr=Array.isArray,LL=/\/$/,OL=n=>n.replace(LL,"");function Vm(n,e,t="/"){let i,r={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(i=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),r=n(s)),a>-1&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=NL(i!=null?i:e,t),{fullPath:i+(s&&"?")+s+o,path:i,query:r,hash:o}}function IL(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Jb(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function DL(n,e,t){const i=e.matched.length-1,r=t.matched.length-1;return i>-1&&i===r&&ec(e.matched[i],t.matched[r])&&DS(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function ec(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function DS(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!UL(n[t],e[t]))return!1;return!0}function UL(n,e){return Mr(n)?Qb(n,e):Mr(e)?Qb(e,n):n===e}function Qb(n,e){return Mr(e)?n.length===e.length&&n.every((t,i)=>t===e[i]):n.length===1&&n[0]===e}function NL(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),i=n.split("/"),r=i[i.length-1];(r===".."||r===".")&&i.push("");let s=t.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+i.slice(o-(o===i.length?1:0)).join("/")}var ju;(function(n){n.pop="pop",n.push="push"})(ju||(ju={}));var wu;(function(n){n.back="back",n.forward="forward",n.unknown=""})(wu||(wu={}));function FL(n){if(!n)if(Cl){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),OL(n)}const kL=/^[^#]+#/;function BL(n,e){return n.replace(kL,"#")+e}function zL(n,e){const t=document.documentElement.getBoundingClientRect(),i=n.getBoundingClientRect();return{behavior:e.behavior,left:i.left-t.left-(e.left||0),top:i.top-t.top-(e.top||0)}}const Pp=()=>({left:window.pageXOffset,top:window.pageYOffset});function VL(n){let e;if("el"in n){const t=n.el,i=typeof t=="string"&&t.startsWith("#"),r=typeof t=="string"?i?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!r)return;e=zL(r,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function ex(n,e){return(history.state?history.state.position-e:-1)+n}const yv=new Map;function HL(n,e){yv.set(n,e)}function GL(n){const e=yv.get(n);return yv.delete(n),e}let WL=()=>location.protocol+"//"+location.host;function US(n,e){const{pathname:t,search:i,hash:r}=e,s=n.indexOf("#");if(s>-1){let a=r.includes(n.slice(s))?n.slice(s).length:1,l=r.slice(a);return l[0]!=="/"&&(l="/"+l),Jb(l,"")}return Jb(t,n)+i+r}function $L(n,e,t,i){let r=[],s=[],o=null;const a=({state:d})=>{const f=US(n,location),p=t.value,v=e.value;let m=0;if(d){if(t.value=f,e.value=d,o&&o===p){o=null;return}m=v?d.position-v.position:0}else i(f);r.forEach(g=>{g(t.value,p,{delta:m,type:ju.pop,direction:m?m>0?wu.forward:wu.back:wu.unknown})})};function l(){o=t.value}function c(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return s.push(f),f}function u(){const{history:d}=window;d.state&&d.replaceState(It({},d.state,{scroll:Pp()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:h}}function tx(n,e,t,i=!1,r=!1){return{back:n,current:e,forward:t,replaced:i,position:window.history.length,scroll:r?Pp():null}}function jL(n){const{history:e,location:t}=window,i={value:US(n,t)},r={value:e.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=n.indexOf("#"),d=h>-1?(t.host&&document.querySelector("base")?n:n.slice(h))+l:WL()+n+l;try{e[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(f){console.error(f),t[u?"replace":"assign"](d)}}function o(l,c){const u=It({},e.state,tx(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),i.value=l}function a(l,c){const u=It({},r.value,e.state,{forward:l,scroll:Pp()});s(u.current,u,!0);const h=It({},tx(i.value,l,null),{position:u.position+1},c);s(l,h,!1),i.value=l}return{location:i,state:r,push:a,replace:o}}function XL(n){n=FL(n);const e=jL(n),t=$L(n,e.state,e.location,e.replace);function i(s,o=!0){o||t.pauseListeners(),history.go(s)}const r=It({location:"",base:n,go:i,createHref:BL.bind(null,n)},e,t);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function YL(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),XL(n)}function qL(n){return typeof n=="string"||n&&typeof n=="object"}function NS(n){return typeof n=="string"||typeof n=="symbol"}const Bs={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},FS=Symbol("");var nx;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(nx||(nx={}));function tc(n,e){return It(new Error,{type:n,[FS]:!0},e)}function is(n,e){return n instanceof Error&&FS in n&&(e==null||!!(n.type&e))}const ix="[^/]+?",KL={sensitive:!1,strict:!1,start:!0,end:!0},ZL=/[.+*?^${}()[\]/\\]/g;function JL(n,e){const t=It({},KL,e),i=[];let r=t.start?"^":"";const s=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let f=40+(t.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(ZL,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:v,optional:m,regexp:g}=d;s.push({name:p,repeatable:v,optional:m});const b=g||ix;if(b!==ix){f+=10;try{new RegExp("(".concat(b,")"))}catch(_){throw new Error('Invalid custom RegExp for param "'.concat(p,'" (').concat(b,"): ")+_.message)}}let y=v?"((?:".concat(b,")(?:/(?:").concat(b,"))*)"):"(".concat(b,")");h||(y=m&&c.length<2?"(?:/".concat(y,")"):"/"+y),m&&(y+="?"),r+=y,f+=20,m&&(f+=-8),v&&(f+=-20),b===".*"&&(f+=-50)}u.push(f)}i.push(u)}if(t.strict&&t.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}t.strict||(r+="/?"),t.end?r+="$":t.strict&&(r+="(?:/|$)");const o=new RegExp(r,t.sensitive?"":"i");function a(c){const u=c.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=s[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function l(c){let u="",h=!1;for(const d of n){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:v,optional:m}=f,g=p in c?c[p]:"";if(Mr(g)&&!v)throw new Error('Provided param "'.concat(p,'" is an array but it is not repeatable (* or + modifiers)'));const b=Mr(g)?g.join("/"):g;if(!b)if(m)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error('Missing required param "'.concat(p,'"'));u+=b}}return u||"/"}return{re:o,score:i,keys:s,parse:a,stringify:l}}function QL(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=e[t]-n[t];if(i)return i;t++}return n.length<e.length?n.length===1&&n[0]===40+40?-1:1:n.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function eO(n,e){let t=0;const i=n.score,r=e.score;for(;t<i.length&&t<r.length;){const s=QL(i[t],r[t]);if(s)return s;t++}if(Math.abs(r.length-i.length)===1){if(rx(i))return 1;if(rx(r))return-1}return r.length-i.length}function rx(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const tO={type:0,value:""},nO=/[a-zA-Z0-9_]/;function iO(n){if(!n)return[[]];if(n==="/")return[[tO]];if(!n.startsWith("/"))throw new Error('Invalid path "'.concat(n,'"'));function e(f){throw new Error("ERR (".concat(t,')/"').concat(c,'": ').concat(f))}let t=0,i=t;const r=[];let s;function o(){s&&r.push(s),s=[]}let a=0,l,c="",u="";function h(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e("A repeatable param (".concat(c,") must be alone in its segment. eg: '/:ids+.")),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){i=t,t=4;continue}switch(t){case 0:l==="/"?(c&&h(),o()):l===":"?(h(),t=1):d();break;case 4:d(),t=i;break;case 1:l==="("?t=2:nO.test(l)?d():(h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:h(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e('Unfinished custom RegExp for param "'.concat(c,'"')),h(),o(),r}function rO(n,e,t){const i=JL(iO(n.path),t),r=It(i,{record:n,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function sO(n,e){const t=[],i=new Map;e=ax({strict:!1,end:!0,sensitive:!1},e);function r(u){return i.get(u)}function s(u,h,d){const f=!d,p=oO(u);p.aliasOf=d&&d.record;const v=ax(e,u),m=[p];if("alias"in u){const y=typeof u.alias=="string"?[u.alias]:u.alias;for(const _ of y)m.push(It({},p,{components:d?d.record.components:p.components,path:_,aliasOf:d?d.record:p}))}let g,b;for(const y of m){const{path:_}=y;if(h&&_[0]!=="/"){const T=h.record.path,w=T[T.length-1]==="/"?"":"/";y.path=h.record.path+(_&&w+_)}if(g=rO(y,h,v),d?d.alias.push(g):(b=b||g,b!==g&&b.alias.push(g),f&&u.name&&!ox(g)&&o(u.name)),p.children){const T=p.children;for(let w=0;w<T.length;w++)s(T[w],g,d&&d.children[w])}d=d||g,(g.record.components&&Object.keys(g.record.components).length||g.record.name||g.record.redirect)&&l(g)}return b?()=>{o(b)}:xu}function o(u){if(NS(u)){const h=i.get(u);h&&(i.delete(u),t.splice(t.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=t.indexOf(u);h>-1&&(t.splice(h,1),u.record.name&&i.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return t}function l(u){let h=0;for(;h<t.length&&eO(u,t[h])>=0&&(u.record.path!==t[h].record.path||!kS(u,t[h]));)h++;t.splice(h,0,u),u.record.name&&!ox(u)&&i.set(u.record.name,u)}function c(u,h){let d,f={},p,v;if("name"in u&&u.name){if(d=i.get(u.name),!d)throw tc(1,{location:u});v=d.record.name,f=It(sx(h.params,d.keys.filter(b=>!b.optional).map(b=>b.name)),u.params&&sx(u.params,d.keys.map(b=>b.name))),p=d.stringify(f)}else if("path"in u)p=u.path,d=t.find(b=>b.re.test(p)),d&&(f=d.parse(p),v=d.record.name);else{if(d=h.name?i.get(h.name):t.find(b=>b.re.test(h.path)),!d)throw tc(1,{location:u,currentLocation:h});v=d.record.name,f=It({},h.params,u.params),p=d.stringify(f)}const m=[];let g=d;for(;g;)m.unshift(g.record),g=g.parent;return{name:v,path:p,params:f,matched:m,meta:lO(m)}}return n.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function sx(n,e){const t={};for(const i of e)i in n&&(t[i]=n[i]);return t}function oO(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:aO(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function aO(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const i in n.components)e[i]=typeof t=="object"?t[i]:t;return e}function ox(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function lO(n){return n.reduce((e,t)=>It(e,t.meta),{})}function ax(n,e){const t={};for(const i in n)t[i]=i in e?e[i]:n[i];return t}function kS(n,e){return e.children.some(t=>t===n||kS(n,t))}const BS=/#/g,cO=/&/g,uO=/\//g,hO=/=/g,dO=/\?/g,zS=/\+/g,fO=/%5B/g,pO=/%5D/g,VS=/%5E/g,mO=/%60/g,HS=/%7B/g,gO=/%7C/g,GS=/%7D/g,vO=/%20/g;function f_(n){return encodeURI(""+n).replace(gO,"|").replace(fO,"[").replace(pO,"]")}function _O(n){return f_(n).replace(HS,"{").replace(GS,"}").replace(VS,"^")}function bv(n){return f_(n).replace(zS,"%2B").replace(vO,"+").replace(BS,"%23").replace(cO,"%26").replace(mO,"`").replace(HS,"{").replace(GS,"}").replace(VS,"^")}function yO(n){return bv(n).replace(hO,"%3D")}function bO(n){return f_(n).replace(BS,"%23").replace(dO,"%3F")}function xO(n){return n==null?"":bO(n).replace(uO,"%2F")}function jf(n){try{return decodeURIComponent(""+n)}catch(e){}return""+n}function wO(n){const e={};if(n===""||n==="?")return e;const i=(n[0]==="?"?n.slice(1):n).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(zS," "),o=s.indexOf("="),a=jf(o<0?s:s.slice(0,o)),l=o<0?null:jf(s.slice(o+1));if(a in e){let c=e[a];Mr(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function lx(n){let e="";for(let t in n){const i=n[t];if(t=yO(t),i==null){i!==void 0&&(e+=(e.length?"&":"")+t);continue}(Mr(i)?i.map(s=>s&&bv(s)):[i&&bv(i)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function MO(n){const e={};for(const t in n){const i=n[t];i!==void 0&&(e[t]=Mr(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}const EO=Symbol(""),cx=Symbol(""),Rp=Symbol(""),p_=Symbol(""),xv=Symbol("");function Uc(){let n=[];function e(i){return n.push(i),()=>{const r=n.indexOf(i);r>-1&&n.splice(r,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ro(n,e,t,i,r){const s=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const l=h=>{h===!1?a(tc(4,{from:t,to:e})):h instanceof Error?a(h):qL(h)?a(tc(2,{from:e,to:h})):(s&&i.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),o())},c=n.call(i&&i.instances[r],e,t,l);let u=Promise.resolve(c);n.length<3&&(u=u.then(l)),u.catch(h=>a(h))})}function Hm(n,e,t,i){const r=[];for(const s of n)for(const o in s.components){let a=s.components[o];if(!(e!=="beforeRouteEnter"&&!s.instances[o]))if(SO(a)){const c=(a.__vccOpts||a)[e];c&&r.push(ro(c,t,i,s,o))}else{let l=a();r.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error("Couldn't resolve component \"".concat(o,'" at "').concat(s.path,'"')));const u=RL(c)?c.default:c;s.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&ro(d,t,i,s,o)()}))}}return r}function SO(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function ux(n){const e=Xt(Rp),t=Xt(p_),i=Te(()=>e.resolve(we(n.to))),r=Te(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],h=t.matched;if(!u||!h.length)return-1;const d=h.findIndex(ec.bind(null,u));if(d>-1)return d;const f=hx(l[c-2]);return c>1&&hx(u)===f&&h[h.length-1].path!==f?h.findIndex(ec.bind(null,l[c-2])):d}),s=Te(()=>r.value>-1&&PO(t.params,i.value.params)),o=Te(()=>r.value>-1&&r.value===t.matched.length-1&&DS(t.params,i.value.params));function a(l={}){return CO(l)?e[we(n.replace)?"replace":"push"](we(n.to)).catch(xu):Promise.resolve()}return{route:i,href:Te(()=>i.value.href),isActive:s,isExactActive:o,navigate:a}}const TO=qe({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:ux,setup(n,{slots:e}){const t=li(ux(n)),{options:i}=Xt(Rp),r=Te(()=>({[dx(n.activeClass,i.linkActiveClass,"router-link-active")]:t.isActive,[dx(n.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return n.custom?s:wo("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:r.value},s)}}}),AO=TO;function CO(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function PO(n,e){for(const t in e){const i=e[t],r=n[t];if(typeof i=="string"){if(i!==r)return!1}else if(!Mr(r)||r.length!==i.length||i.some((s,o)=>s!==r[o]))return!1}return!0}function hx(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const dx=(n,e,t)=>n!=null?n:e!=null?e:t,RO=qe({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const i=Xt(xv),r=Te(()=>n.route||i.value),s=Xt(cx,0),o=Te(()=>{let c=we(s);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),a=Te(()=>r.value.matched[o.value]);bi(cx,Te(()=>o.value+1)),bi(EO,a),bi(xv,r);const l=be();return ft(()=>[l.value,a.value,n.name],([c,u,h],[d,f,p])=>{u&&(u.instances[h]=c,f&&f!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=f.leaveGuards),u.updateGuards.size||(u.updateGuards=f.updateGuards))),c&&u&&(!f||!ec(u,f)||!d)&&(u.enterCallbacks[h]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=r.value,u=n.name,h=a.value,d=h&&h.components[u];if(!d)return fx(t.default,{Component:d,route:c});const f=h.props[u],p=f?f===!0?c.params:typeof f=="function"?f(c):f:null,m=wo(d,It({},p,e,{onVnodeUnmounted:g=>{g.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return fx(t.default,{Component:m,route:c})||m}}});function fx(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const LO=RO;function OO(n){const e=sO(n.routes,n),t=n.parseQuery||wO,i=n.stringifyQuery||lx,r=n.history,s=Uc(),o=Uc(),a=Uc(),l=qn(Bs);let c=Bs;Cl&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=zm.bind(null,Q=>""+Q),h=zm.bind(null,xO),d=zm.bind(null,jf);function f(Q,K){let P,F;return NS(Q)?(P=e.getRecordMatcher(Q),F=K):F=Q,e.addRoute(F,P)}function p(Q){const K=e.getRecordMatcher(Q);K&&e.removeRoute(K)}function v(){return e.getRoutes().map(Q=>Q.record)}function m(Q){return!!e.getRecordMatcher(Q)}function g(Q,K){if(K=It({},K||l.value),typeof Q=="string"){const I=Vm(t,Q,K.path),V=e.resolve({path:I.path},K),H=r.createHref(I.fullPath);return It(I,V,{params:d(V.params),hash:jf(I.hash),redirectedFrom:void 0,href:H})}let P;if("path"in Q)P=It({},Q,{path:Vm(t,Q.path,K.path).path});else{const I=It({},Q.params);for(const V in I)I[V]==null&&delete I[V];P=It({},Q,{params:h(I)}),K.params=h(K.params)}const F=e.resolve(P,K),k=Q.hash||"";F.params=u(d(F.params));const A=IL(i,It({},Q,{hash:_O(k),path:F.path})),R=r.createHref(A);return It({fullPath:A,hash:k,query:i===lx?MO(Q.query):Q.query||{}},F,{redirectedFrom:void 0,href:R})}function b(Q){return typeof Q=="string"?Vm(t,Q,l.value.path):It({},Q)}function y(Q,K){if(c!==Q)return tc(8,{from:K,to:Q})}function _(Q){return S(Q)}function T(Q){return _(It(b(Q),{replace:!0}))}function w(Q){const K=Q.matched[Q.matched.length-1];if(K&&K.redirect){const{redirect:P}=K;let F=typeof P=="function"?P(Q):P;return typeof F=="string"&&(F=F.includes("?")||F.includes("#")?F=b(F):{path:F},F.params={}),It({query:Q.query,hash:Q.hash,params:"path"in F?{}:Q.params},F)}}function S(Q,K){const P=c=g(Q),F=l.value,k=Q.state,A=Q.force,R=Q.replace===!0,I=w(P);if(I)return S(It(b(I),{state:typeof I=="object"?It({},k,I.state):k,force:A,replace:R}),K||P);const V=P;V.redirectedFrom=K;let H;return!A&&DL(i,F,P)&&(H=tc(16,{to:V,from:F}),X(F,F,!0,!1)),(H?Promise.resolve(H):E(V,F)).catch(ee=>is(ee)?is(ee,2)?ee:te(ee):ie(ee,V,F)).then(ee=>{if(ee){if(is(ee,2))return S(It({replace:R},b(ee.to),{state:typeof ee.to=="object"?It({},k,ee.to.state):k,force:A}),K||V)}else ee=O(V,F,!0,R,k);return C(V,F,ee),ee})}function x(Q,K){const P=y(Q,K);return P?Promise.reject(P):Promise.resolve()}function M(Q){const K=xe.values().next().value;return K&&typeof K.runWithContext=="function"?K.runWithContext(Q):Q()}function E(Q,K){let P;const[F,k,A]=IO(Q,K);P=Hm(F.reverse(),"beforeRouteLeave",Q,K);for(const I of F)I.leaveGuards.forEach(V=>{P.push(ro(V,Q,K))});const R=x.bind(null,Q,K);return P.push(R),Ie(P).then(()=>{P=[];for(const I of s.list())P.push(ro(I,Q,K));return P.push(R),Ie(P)}).then(()=>{P=Hm(k,"beforeRouteUpdate",Q,K);for(const I of k)I.updateGuards.forEach(V=>{P.push(ro(V,Q,K))});return P.push(R),Ie(P)}).then(()=>{P=[];for(const I of A)if(I.beforeEnter)if(Mr(I.beforeEnter))for(const V of I.beforeEnter)P.push(ro(V,Q,K));else P.push(ro(I.beforeEnter,Q,K));return P.push(R),Ie(P)}).then(()=>(Q.matched.forEach(I=>I.enterCallbacks={}),P=Hm(A,"beforeRouteEnter",Q,K),P.push(R),Ie(P))).then(()=>{P=[];for(const I of o.list())P.push(ro(I,Q,K));return P.push(R),Ie(P)}).catch(I=>is(I,8)?I:Promise.reject(I))}function C(Q,K,P){a.list().forEach(F=>M(()=>F(Q,K,P)))}function O(Q,K,P,F,k){const A=y(Q,K);if(A)return A;const R=K===Bs,I=Cl?history.state:{};P&&(F||R?r.replace(Q.fullPath,It({scroll:R&&I&&I.scroll},k)):r.push(Q.fullPath,k)),l.value=Q,X(Q,K,P,R),te()}let $;function U(){$||($=r.listen((Q,K,P)=>{if(!Re.listening)return;const F=g(Q),k=w(F);if(k){S(It(k,{replace:!0}),F).catch(xu);return}c=F;const A=l.value;Cl&&HL(ex(A.fullPath,P.delta),Pp()),E(F,A).catch(R=>is(R,12)?R:is(R,2)?(S(R.to,F).then(I=>{is(I,20)&&!P.delta&&P.type===ju.pop&&r.go(-1,!1)}).catch(xu),Promise.reject()):(P.delta&&r.go(-P.delta,!1),ie(R,F,A))).then(R=>{R=R||O(F,A,!1),R&&(P.delta&&!is(R,8)?r.go(-P.delta,!1):P.type===ju.pop&&is(R,20)&&r.go(-1,!1)),C(F,A,R)}).catch(xu)}))}let j=Uc(),W=Uc(),q;function ie(Q,K,P){te(Q);const F=W.list();return F.length?F.forEach(k=>k(Q,K,P)):console.error(Q),Promise.reject(Q)}function Z(){return q&&l.value!==Bs?Promise.resolve():new Promise((Q,K)=>{j.add([Q,K])})}function te(Q){return q||(q=!Q,U(),j.list().forEach(([K,P])=>Q?P(Q):K()),j.reset()),Q}function X(Q,K,P,F){const{scrollBehavior:k}=n;if(!Cl||!k)return Promise.resolve();const A=!P&&GL(ex(Q.fullPath,0))||(F||!P)&&history.state&&history.state.scroll||null;return $r().then(()=>k(Q,K,A)).then(R=>R&&VL(R)).catch(R=>ie(R,Q,K))}const se=Q=>r.go(Q);let G;const xe=new Set,Re={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:m,getRoutes:v,resolve:g,options:n,push:_,replace:T,go:se,back:()=>se(-1),forward:()=>se(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:W.add,isReady:Z,install(Q){const K=this;Q.component("RouterLink",AO),Q.component("RouterView",LO),Q.config.globalProperties.$router=K,Object.defineProperty(Q.config.globalProperties,"$route",{enumerable:!0,get:()=>we(l)}),Cl&&!G&&l.value===Bs&&(G=!0,_(r.location).catch(k=>{}));const P={};for(const k in Bs)Object.defineProperty(P,k,{get:()=>l.value[k],enumerable:!0});Q.provide(Rp,K),Q.provide(p_,zE(P)),Q.provide(xv,l);const F=Q.unmount;xe.add(Q),Q.unmount=function(){xe.delete(Q),xe.size<1&&(c=Bs,$&&$(),$=null,l.value=Bs,G=!1,q=!1),F()}}};function Ie(Q){return Q.reduce((K,P)=>K.then(()=>M(P)),Promise.resolve())}return Re}function IO(n,e){const t=[],i=[],r=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(c=>ec(c,a))?i.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>ec(c,l))||r.push(l))}return[t,i,r]}function DO(){return Xt(Rp)}function UO(){return Xt(p_)}function zs(n,e){if(!n)throw new Error(e)}function px(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function ud(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?px(Object(t),!0).forEach(function(i){NO(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):px(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function NO(n,e,t){return e=FO(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function FO(n){var e=kO(n,"string");return typeof e=="symbol"?e:String(e)}function kO(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function mx(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){t(c);return}a.done?e(l):Promise.resolve(l).then(i,r)}function BO(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){mx(s,i,r,o,a,"next",l)}function a(l){mx(s,i,r,o,a,"throw",l)}o(void 0)})}}function zO({fns:n,args:e}){if(n.length===1)return n[0];const t=n.pop();return n.reduce((i,r)=>()=>r(i,e),t)}function Nc(n){return!!n&&typeof n=="object"&&typeof n.then=="function"}const oo={compose:"compose",event:"event",modify:"modify"};class VO{constructor(e){this.validKeys=(e==null?void 0:e.validKeys)||[],this.hooks={},this.shared={}}share(e,t){zs(!Object.keys(this.shared).includes(e),"share failed, key repeat"),this.shared[e]=t}getShared(e){return this.shared[e]}register(e){zs(!!e.apply,"register failed, plugin.apply must supplied"),zs(!!e.path,"register failed, plugin.path must supplied"),Object.keys(e.apply).forEach(t=>{zs(this.validKeys.indexOf(t)>-1,"register failed, invalid key ".concat(t," from plugin ").concat(e.path,".")),this.hooks[t]||(this.hooks[t]=[]),this.hooks[t]=this.hooks[t].concat(e.apply[t])})}getHooks(e){const[t,...i]=e.split(".");let r=this.hooks[t]||[];return i.length&&(r=r.map(s=>{try{let o=s;for(const a of i)o=o[a];return o}catch(o){return null}}).filter(Boolean)),r}applyPlugins({key:e,type:t,initialValue:i,args:r,async:s}){const o=this.getHooks(e)||[];switch(r&&zs(typeof r=="object","applyPlugins failed, args must be plain object."),t){case oo.modify:return s?o.reduce(function(){var a=BO(function*(l,c){if(zs(typeof c=="function"||typeof c=="object"||Nc(c),"applyPlugins failed, all hooks for key ".concat(e," must be function, plain object or Promise.")),Nc(l)&&(l=yield l),typeof c=="function"){const u=c(l,r);return Nc(u),u}return Nc(c)&&(c=yield c),ud(ud({},l),c)});return function(l,c){return a.apply(this,arguments)}}(),Nc(i)?i:Promise.resolve(i)):o.reduce((a,l)=>(zs(typeof l=="function"||typeof l=="object","applyPlugins failed, all hooks for key ".concat(e," must be function or plain object.")),typeof l=="function"?l(a,r):ud(ud({},a),l)),i);case oo.event:return o.forEach(a=>{zs(typeof a=="function","applyPlugins failed, all hooks for key ".concat(e," must be function.")),a(r)});case oo.compose:return()=>zO({fns:o.concat(i),args:r})();default:return null}}}const Fc=new VO({validKeys:["modifyClientRenderOpts","rootContainer","onAppCreated","render","patchRoutes","modifyCreateHistory","modifyRoute","beforeRender","onRouterCreated","access","layout"]}),WS=li({}),HO=n=>{Object.assign(WS,n)},gx="";let kc=null,hd=null;const eK=n=>{var r;const e=Fc.applyPlugins({key:"modifyCreateHistory",type:oo.modify,args:{base:gx},initialValue:YL});Fc.applyPlugins({key:"patchRoutes",type:oo.event,args:{routes:n}});const t=Fc.applyPlugins({key:"modifyRoute",type:oo.modify,initialValue:{base:gx,routes:n,createHistory:e}});hd=(r=t.createHistory)==null?void 0:r.call(t,t.base),kc=OO({history:hd,routes:t.routes});let i=!1;return kc.beforeEach(async(s,o,a)=>{if(i)return a();i=!0;const l=Fc.applyPlugins({key:"beforeRender",type:oo.modify,initialValue:{loading:null,action:null}});if(typeof l.action!="function")return a();const c=document.createElement("div");document.body.appendChild(c);const u=IS(l.loading);u.mount(c);try{const h=await l.action({router:kc,history:hd});HO(h||{}),a()}catch(h){a(!1),console.error("[fes] beforeRender执行出现异常："),console.error(h)}u.unmount(),u._container.innerHTML="",document.body.removeChild(c)}),Fc.applyPlugins({key:"onRouterCreated",type:oo.event,args:{router:kc,history:hd}}),kc},dd=new WeakMap,vx=(n,e)=>{e.value?n.style.display=n._display:n.style.display="none"};function GO(n){return{beforeMount(e){const t={};t.watch=i=>{e._display=e._display||e.style.display;const r=n(i);return vx(e,r),ft(r,()=>{vx(e,r)})},dd.set(e,t)},mounted(e,t){const i=dd.get(e);i.unwatch&&i.unwatch(),i.unwatch=i.watch(t.value)},updated(e,t){const i=dd.get(e);i.unwatch&&i.unwatch(),i.unwatch=i.watch(t.value)},beforeUnmount(e){const t=dd.get(e);t.unwatch&&t.unwatch()}}}function WO(n){return(e,{slots:t})=>!n(e.id).value||!t.default?null:t.default()}var $O=typeof global=="object"&&global&&global.Object===Object&&global;const $S=$O;var jO=typeof self=="object"&&self&&self.Object===Object&&self,XO=$S||jO||Function("return this")();const Pr=XO;var YO=Pr.Symbol;const Mo=YO;var jS=Object.prototype,qO=jS.hasOwnProperty,KO=jS.toString,Bc=Mo?Mo.toStringTag:void 0;function ZO(n){var e=qO.call(n,Bc),t=n[Bc];try{n[Bc]=void 0;var i=!0}catch(s){}var r=KO.call(n);return i&&(e?n[Bc]=t:delete n[Bc]),r}var JO=Object.prototype,QO=JO.toString;function eI(n){return QO.call(n)}var tI="[object Null]",nI="[object Undefined]",_x=Mo?Mo.toStringTag:void 0;function Ds(n){return n==null?n===void 0?nI:tI:_x&&_x in Object(n)?ZO(n):eI(n)}function Ss(n){return n!=null&&typeof n=="object"}var iI="[object Symbol]";function XS(n){return typeof n=="symbol"||Ss(n)&&Ds(n)==iI}function rI(n,e){for(var t=-1,i=n==null?0:n.length,r=Array(i);++t<i;)r[t]=e(n[t],t,n);return r}var sI=Array.isArray;const Ts=sI;var oI=1/0,yx=Mo?Mo.prototype:void 0,bx=yx?yx.toString:void 0;function YS(n){if(typeof n=="string")return n;if(Ts(n))return rI(n,YS)+"";if(XS(n))return bx?bx.call(n):"";var e=n+"";return e=="0"&&1/n==-oI?"-0":e}var aI=/\s/;function lI(n){for(var e=n.length;e--&&aI.test(n.charAt(e)););return e}var cI=/^\s+/;function uI(n){return n&&n.slice(0,lI(n)+1).replace(cI,"")}function wa(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var xx=0/0,hI=/^[-+]0x[0-9a-f]+$/i,dI=/^0b[01]+$/i,fI=/^0o[0-7]+$/i,pI=parseInt;function wx(n){if(typeof n=="number")return n;if(XS(n))return xx;if(wa(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=wa(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=uI(n);var t=dI.test(n);return t||fI.test(n)?pI(n.slice(2),t?2:8):hI.test(n)?xx:+n}var mI="[object AsyncFunction]",gI="[object Function]",vI="[object GeneratorFunction]",_I="[object Proxy]";function jr(n){if(!wa(n))return!1;var e=Ds(n);return e==gI||e==vI||e==mI||e==_I}var yI=Pr["__core-js_shared__"];const Gm=yI;var Mx=function(){var n=/[^.]+$/.exec(Gm&&Gm.keys&&Gm.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function bI(n){return!!Mx&&Mx in n}var xI=Function.prototype,wI=xI.toString;function Na(n){if(n!=null){try{return wI.call(n)}catch(e){}try{return n+""}catch(e){}}return""}var MI=/[\\^$.*+?()[\]{}|]/g,EI=/^\[object .+?Constructor\]$/,SI=Function.prototype,TI=Object.prototype,AI=SI.toString,CI=TI.hasOwnProperty,PI=RegExp("^"+AI.call(CI).replace(MI,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function RI(n){if(!wa(n)||bI(n))return!1;var e=jr(n)?PI:EI;return e.test(Na(n))}function LI(n,e){return n==null?void 0:n[e]}function vc(n,e){var t=LI(n,e);return RI(t)?t:void 0}var OI=vc(Pr,"WeakMap");const wv=OI;var II=9007199254740991,DI=/^(?:0|[1-9]\d*)$/;function UI(n,e){var t=typeof n;return e=e==null?II:e,!!e&&(t=="number"||t!="symbol"&&DI.test(n))&&n>-1&&n%1==0&&n<e}function qS(n,e){return n===e||n!==n&&e!==e}var NI=9007199254740991;function KS(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=NI}function FI(n){return n!=null&&KS(n.length)&&!jr(n)}var kI=Object.prototype;function BI(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||kI;return n===t}function zI(n,e){for(var t=-1,i=Array(n);++t<n;)i[t]=e(t);return i}var VI="[object Arguments]";function Ex(n){return Ss(n)&&Ds(n)==VI}var ZS=Object.prototype,HI=ZS.hasOwnProperty,GI=ZS.propertyIsEnumerable,WI=Ex(function(){return arguments}())?Ex:function(n){return Ss(n)&&HI.call(n,"callee")&&!GI.call(n,"callee")};const $I=WI;function jI(){return!1}var JS=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Sx=JS&&typeof module=="object"&&module&&!module.nodeType&&module,XI=Sx&&Sx.exports===JS,Tx=XI?Pr.Buffer:void 0,YI=Tx?Tx.isBuffer:void 0,qI=YI||jI;const Mv=qI;var KI="[object Arguments]",ZI="[object Array]",JI="[object Boolean]",QI="[object Date]",eD="[object Error]",tD="[object Function]",nD="[object Map]",iD="[object Number]",rD="[object Object]",sD="[object RegExp]",oD="[object Set]",aD="[object String]",lD="[object WeakMap]",cD="[object ArrayBuffer]",uD="[object DataView]",hD="[object Float32Array]",dD="[object Float64Array]",fD="[object Int8Array]",pD="[object Int16Array]",mD="[object Int32Array]",gD="[object Uint8Array]",vD="[object Uint8ClampedArray]",_D="[object Uint16Array]",yD="[object Uint32Array]",Ht={};Ht[hD]=Ht[dD]=Ht[fD]=Ht[pD]=Ht[mD]=Ht[gD]=Ht[vD]=Ht[_D]=Ht[yD]=!0;Ht[KI]=Ht[ZI]=Ht[cD]=Ht[JI]=Ht[uD]=Ht[QI]=Ht[eD]=Ht[tD]=Ht[nD]=Ht[iD]=Ht[rD]=Ht[sD]=Ht[oD]=Ht[aD]=Ht[lD]=!1;function bD(n){return Ss(n)&&KS(n.length)&&!!Ht[Ds(n)]}function xD(n){return function(e){return n(e)}}var QS=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Mu=QS&&typeof module=="object"&&module&&!module.nodeType&&module,wD=Mu&&Mu.exports===QS,Wm=wD&&$S.process,MD=function(){try{var n=Mu&&Mu.require&&Mu.require("util").types;return n||Wm&&Wm.binding&&Wm.binding("util")}catch(e){}}();const Ax=MD;var Cx=Ax&&Ax.isTypedArray,ED=Cx?xD(Cx):bD;const eT=ED;var SD=Object.prototype,TD=SD.hasOwnProperty;function AD(n,e){var t=Ts(n),i=!t&&$I(n),r=!t&&!i&&Mv(n),s=!t&&!i&&!r&&eT(n),o=t||i||r||s,a=o?zI(n.length,String):[],l=a.length;for(var c in n)(e||TD.call(n,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||UI(c,l)))&&a.push(c);return a}function tT(n,e){return function(t){return n(e(t))}}var CD=tT(Object.keys,Object);const PD=CD;var RD=Object.prototype,LD=RD.hasOwnProperty;function OD(n){if(!BI(n))return PD(n);var e=[];for(var t in Object(n))LD.call(n,t)&&t!="constructor"&&e.push(t);return e}function ID(n){return FI(n)?AD(n):OD(n)}var DD=vc(Object,"create");const Xu=DD;function UD(){this.__data__=Xu?Xu(null):{},this.size=0}function ND(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var FD="__lodash_hash_undefined__",kD=Object.prototype,BD=kD.hasOwnProperty;function zD(n){var e=this.__data__;if(Xu){var t=e[n];return t===FD?void 0:t}return BD.call(e,n)?e[n]:void 0}var VD=Object.prototype,HD=VD.hasOwnProperty;function GD(n){var e=this.__data__;return Xu?e[n]!==void 0:HD.call(e,n)}var WD="__lodash_hash_undefined__";function $D(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Xu&&e===void 0?WD:e,this}function Ma(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Ma.prototype.clear=UD;Ma.prototype.delete=ND;Ma.prototype.get=zD;Ma.prototype.has=GD;Ma.prototype.set=$D;function jD(){this.__data__=[],this.size=0}function Lp(n,e){for(var t=n.length;t--;)if(qS(n[t][0],e))return t;return-1}var XD=Array.prototype,YD=XD.splice;function qD(n){var e=this.__data__,t=Lp(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():YD.call(e,t,1),--this.size,!0}function KD(n){var e=this.__data__,t=Lp(e,n);return t<0?void 0:e[t][1]}function ZD(n){return Lp(this.__data__,n)>-1}function JD(n,e){var t=this.__data__,i=Lp(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}function Us(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Us.prototype.clear=jD;Us.prototype.delete=qD;Us.prototype.get=KD;Us.prototype.has=ZD;Us.prototype.set=JD;var QD=vc(Pr,"Map");const Yu=QD;function eU(){this.size=0,this.__data__={hash:new Ma,map:new(Yu||Us),string:new Ma}}function tU(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function Op(n,e){var t=n.__data__;return tU(e)?t[typeof e=="string"?"string":"hash"]:t.map}function nU(n){var e=Op(this,n).delete(n);return this.size-=e?1:0,e}function iU(n){return Op(this,n).get(n)}function rU(n){return Op(this,n).has(n)}function sU(n,e){var t=Op(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}function Fa(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}Fa.prototype.clear=eU;Fa.prototype.delete=nU;Fa.prototype.get=iU;Fa.prototype.has=rU;Fa.prototype.set=sU;function nT(n){return n==null?"":YS(n)}function oU(n,e){for(var t=-1,i=e.length,r=n.length;++t<i;)n[r+t]=e[t];return n}var aU=tT(Object.getPrototypeOf,Object);const lU=aU;var cU="[object Object]",uU=Function.prototype,hU=Object.prototype,iT=uU.toString,dU=hU.hasOwnProperty,fU=iT.call(Object);function rT(n){if(!Ss(n)||Ds(n)!=cU)return!1;var e=lU(n);if(e===null)return!0;var t=dU.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&iT.call(t)==fU}function pU(n,e,t,i){var r=-1,s=n==null?0:n.length;for(i&&s&&(t=n[++r]);++r<s;)t=e(t,n[r],r,n);return t}function mU(n){return function(e){return n==null?void 0:n[e]}}var gU={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},vU=mU(gU);const _U=vU;var yU=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bU="\\u0300-\\u036f",xU="\\ufe20-\\ufe2f",wU="\\u20d0-\\u20ff",MU=bU+xU+wU,EU="["+MU+"]",SU=RegExp(EU,"g");function TU(n){return n=nT(n),n&&n.replace(yU,_U).replace(SU,"")}var AU=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function CU(n){return n.match(AU)||[]}var PU=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function RU(n){return PU.test(n)}var sT="\\ud800-\\udfff",LU="\\u0300-\\u036f",OU="\\ufe20-\\ufe2f",IU="\\u20d0-\\u20ff",DU=LU+OU+IU,oT="\\u2700-\\u27bf",aT="a-z\\xdf-\\xf6\\xf8-\\xff",UU="\\xac\\xb1\\xd7\\xf7",NU="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",FU="\\u2000-\\u206f",kU=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",lT="A-Z\\xc0-\\xd6\\xd8-\\xde",BU="\\ufe0e\\ufe0f",cT=UU+NU+FU+kU,uT="['’]",Px="["+cT+"]",zU="["+DU+"]",hT="\\d+",VU="["+oT+"]",dT="["+aT+"]",fT="[^"+sT+cT+hT+oT+aT+lT+"]",HU="\\ud83c[\\udffb-\\udfff]",GU="(?:"+zU+"|"+HU+")",WU="[^"+sT+"]",pT="(?:\\ud83c[\\udde6-\\uddff]){2}",mT="[\\ud800-\\udbff][\\udc00-\\udfff]",Pl="["+lT+"]",$U="\\u200d",Rx="(?:"+dT+"|"+fT+")",jU="(?:"+Pl+"|"+fT+")",Lx="(?:"+uT+"(?:d|ll|m|re|s|t|ve))?",Ox="(?:"+uT+"(?:D|LL|M|RE|S|T|VE))?",gT=GU+"?",vT="["+BU+"]?",XU="(?:"+$U+"(?:"+[WU,pT,mT].join("|")+")"+vT+gT+")*",YU="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",qU="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",KU=vT+gT+XU,ZU="(?:"+[VU,pT,mT].join("|")+")"+KU,JU=RegExp([Pl+"?"+dT+"+"+Lx+"(?="+[Px,Pl,"$"].join("|")+")",jU+"+"+Ox+"(?="+[Px,Pl+Rx,"$"].join("|")+")",Pl+"?"+Rx+"+"+Lx,Pl+"+"+Ox,qU,YU,hT,ZU].join("|"),"g");function QU(n){return n.match(JU)||[]}function eN(n,e,t){return n=nT(n),e=t?void 0:e,e===void 0?RU(n)?QU(n):CU(n):n.match(e)||[]}var tN="['’]",nN=RegExp(tN,"g");function iN(n){return function(e){return pU(eN(TU(e).replace(nN,"")),n,"")}}function rN(){this.__data__=new Us,this.size=0}function sN(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function oN(n){return this.__data__.get(n)}function aN(n){return this.__data__.has(n)}var lN=200;function cN(n,e){var t=this.__data__;if(t instanceof Us){var i=t.__data__;if(!Yu||i.length<lN-1)return i.push([n,e]),this.size=++t.size,this;t=this.__data__=new Fa(i)}return t.set(n,e),this.size=t.size,this}function mo(n){var e=this.__data__=new Us(n);this.size=e.size}mo.prototype.clear=rN;mo.prototype.delete=sN;mo.prototype.get=oN;mo.prototype.has=aN;mo.prototype.set=cN;function uN(n,e){for(var t=-1,i=n==null?0:n.length,r=0,s=[];++t<i;){var o=n[t];e(o,t,n)&&(s[r++]=o)}return s}function hN(){return[]}var dN=Object.prototype,fN=dN.propertyIsEnumerable,Ix=Object.getOwnPropertySymbols,pN=Ix?function(n){return n==null?[]:(n=Object(n),uN(Ix(n),function(e){return fN.call(n,e)}))}:hN;const mN=pN;function gN(n,e,t){var i=e(n);return Ts(n)?i:oU(i,t(n))}function Dx(n){return gN(n,ID,mN)}var vN=vc(Pr,"DataView");const Ev=vN;var _N=vc(Pr,"Promise");const Sv=_N;var yN=vc(Pr,"Set");const Tv=yN;var Ux="[object Map]",bN="[object Object]",Nx="[object Promise]",Fx="[object Set]",kx="[object WeakMap]",Bx="[object DataView]",xN=Na(Ev),wN=Na(Yu),MN=Na(Sv),EN=Na(Tv),SN=Na(wv),ea=Ds;(Ev&&ea(new Ev(new ArrayBuffer(1)))!=Bx||Yu&&ea(new Yu)!=Ux||Sv&&ea(Sv.resolve())!=Nx||Tv&&ea(new Tv)!=Fx||wv&&ea(new wv)!=kx)&&(ea=function(n){var e=Ds(n),t=e==bN?n.constructor:void 0,i=t?Na(t):"";if(i)switch(i){case xN:return Bx;case wN:return Ux;case MN:return Nx;case EN:return Fx;case SN:return kx}return e});const zx=ea;var TN=Pr.Uint8Array;const Vx=TN;var AN="__lodash_hash_undefined__";function CN(n){return this.__data__.set(n,AN),this}function PN(n){return this.__data__.has(n)}function Xf(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Fa;++e<t;)this.add(n[e])}Xf.prototype.add=Xf.prototype.push=CN;Xf.prototype.has=PN;function RN(n,e){for(var t=-1,i=n==null?0:n.length;++t<i;)if(e(n[t],t,n))return!0;return!1}function LN(n,e){return n.has(e)}var ON=1,IN=2;function _T(n,e,t,i,r,s){var o=t&ON,a=n.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(n),u=s.get(e);if(c&&u)return c==e&&u==n;var h=-1,d=!0,f=t&IN?new Xf:void 0;for(s.set(n,e),s.set(e,n);++h<a;){var p=n[h],v=e[h];if(i)var m=o?i(v,p,h,e,n,s):i(p,v,h,n,e,s);if(m!==void 0){if(m)continue;d=!1;break}if(f){if(!RN(e,function(g,b){if(!LN(f,b)&&(p===g||r(p,g,t,i,s)))return f.push(b)})){d=!1;break}}else if(!(p===v||r(p,v,t,i,s))){d=!1;break}}return s.delete(n),s.delete(e),d}function DN(n){var e=-1,t=Array(n.size);return n.forEach(function(i,r){t[++e]=[r,i]}),t}function UN(n){var e=-1,t=Array(n.size);return n.forEach(function(i){t[++e]=i}),t}var NN=1,FN=2,kN="[object Boolean]",BN="[object Date]",zN="[object Error]",VN="[object Map]",HN="[object Number]",GN="[object RegExp]",WN="[object Set]",$N="[object String]",jN="[object Symbol]",XN="[object ArrayBuffer]",YN="[object DataView]",Hx=Mo?Mo.prototype:void 0,$m=Hx?Hx.valueOf:void 0;function qN(n,e,t,i,r,s,o){switch(t){case YN:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case XN:return!(n.byteLength!=e.byteLength||!s(new Vx(n),new Vx(e)));case kN:case BN:case HN:return qS(+n,+e);case zN:return n.name==e.name&&n.message==e.message;case GN:case $N:return n==e+"";case VN:var a=DN;case WN:var l=i&NN;if(a||(a=UN),n.size!=e.size&&!l)return!1;var c=o.get(n);if(c)return c==e;i|=FN,o.set(n,e);var u=_T(a(n),a(e),i,r,s,o);return o.delete(n),u;case jN:if($m)return $m.call(n)==$m.call(e)}return!1}var KN=1,ZN=Object.prototype,JN=ZN.hasOwnProperty;function QN(n,e,t,i,r,s){var o=t&KN,a=Dx(n),l=a.length,c=Dx(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var d=a[h];if(!(o?d in e:JN.call(e,d)))return!1}var f=s.get(n),p=s.get(e);if(f&&p)return f==e&&p==n;var v=!0;s.set(n,e),s.set(e,n);for(var m=o;++h<l;){d=a[h];var g=n[d],b=e[d];if(i)var y=o?i(b,g,d,e,n,s):i(g,b,d,n,e,s);if(!(y===void 0?g===b||r(g,b,t,i,s):y)){v=!1;break}m||(m=d=="constructor")}if(v&&!m){var _=n.constructor,T=e.constructor;_!=T&&"constructor"in n&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof T=="function"&&T instanceof T)&&(v=!1)}return s.delete(n),s.delete(e),v}var eF=1,Gx="[object Arguments]",Wx="[object Array]",fd="[object Object]",tF=Object.prototype,$x=tF.hasOwnProperty;function nF(n,e,t,i,r,s){var o=Ts(n),a=Ts(e),l=o?Wx:zx(n),c=a?Wx:zx(e);l=l==Gx?fd:l,c=c==Gx?fd:c;var u=l==fd,h=c==fd,d=l==c;if(d&&Mv(n)){if(!Mv(e))return!1;o=!0,u=!1}if(d&&!u)return s||(s=new mo),o||eT(n)?_T(n,e,t,i,r,s):qN(n,e,l,t,i,r,s);if(!(t&eF)){var f=u&&$x.call(n,"__wrapped__"),p=h&&$x.call(e,"__wrapped__");if(f||p){var v=f?n.value():n,m=p?e.value():e;return s||(s=new mo),r(v,m,t,i,s)}}return d?(s||(s=new mo),QN(n,e,t,i,r,s)):!1}function yT(n,e,t,i,r){return n===e?!0:n==null||e==null||!Ss(n)&&!Ss(e)?n!==n&&e!==e:nF(n,e,t,i,yT,r)}var iF=function(){return Pr.Date.now()};const jm=iF;var rF="Expected a function",sF=Math.max,oF=Math.min;function aF(n,e,t){var i,r,s,o,a,l,c=0,u=!1,h=!1,d=!0;if(typeof n!="function")throw new TypeError(rF);e=wx(e)||0,wa(t)&&(u=!!t.leading,h="maxWait"in t,s=h?sF(wx(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function f(w){var S=i,x=r;return i=r=void 0,c=w,o=n.apply(x,S),o}function p(w){return c=w,a=setTimeout(g,e),u?f(w):o}function v(w){var S=w-l,x=w-c,M=e-S;return h?oF(M,s-x):M}function m(w){var S=w-l,x=w-c;return l===void 0||S>=e||S<0||h&&x>=s}function g(){var w=jm();if(m(w))return b(w);a=setTimeout(g,v(w))}function b(w){return a=void 0,d&&i?f(w):(i=r=void 0,o)}function y(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function _(){return a===void 0?o:b(jm())}function T(){var w=jm(),S=m(w);if(i=arguments,r=this,l=w,S){if(a===void 0)return p(l);if(h)return clearTimeout(a),a=setTimeout(g,e),f(l)}return a===void 0&&(a=setTimeout(g,e)),o}return T.cancel=y,T.flush=_,T}var lF="[object String]";function bT(n){return typeof n=="string"||!Ts(n)&&Ss(n)&&Ds(n)==lF}var cF="[object Boolean]";function Yf(n){return n===!0||n===!1||Ss(n)&&Ds(n)==cF}function uF(n,e){return yT(n,e)}var hF=Pr.isFinite;function jx(n){return typeof n=="number"&&hF(n)}function m_(n){return n==null}function dF(n){return n===null}function xT(n){return n===void 0}var fF=iN(function(n,e,t){return n+(t?"-":"")+e.toLowerCase()});const pF=fF;var mF="Expected a function";function gF(n,e,t){var i=!0,r=!0;if(typeof n!="function")throw new TypeError(mF);return wa(t)&&(i="leading"in t?!!t.leading:i,r="trailing"in t?!!t.trailing:r),aF(n,e,{leading:i,maxWait:e,trailing:r})}function wT(n){return!!n&&(typeof n=="object"||typeof n=="function")&&typeof n.then=="function"}const la=li({roles:{admin:["*"],manager:["/"]},currentRoleId:"",currentAccessIds:[]}),Eu=[],Su=[],qu=()=>{const n=la.roles[la.currentRoleId];return Array.isArray(n)&&n.length>0?la.currentAccessIds.concat(n):la.currentAccessIds},vF=n=>{Su.push(n),n.then(e=>{g_(e)}).catch(e=>{console.error(e)}).then(()=>{const e=Su.indexOf(n);e!==-1&&Su.splice(e,1)})},g_=n=>{if(wT(n))return vF(n);if(rT(n)){n.accessIds&&g_(n.accessIds),n.roleId&&v_(n.roleId);return}if(!Array.isArray(n))throw new Error("[plugin-access]: argument to the setAccess() must be array or promise or object");la.currentAccessIds=n},_F=n=>{Eu.push(n),n.then(e=>{v_(e)}).catch(e=>{console.error(e)}).then(()=>{const e=Eu.indexOf(n);e!==-1&&Eu.splice(e,1)})},v_=async n=>{if(wT(n))return _F(n);if(typeof n!="string")throw new Error("[plugin-access]: argument to the setRole() must be string or promise");la.currentRoleId=n},Ku=(n,e)=>{if(n==null||!Array.isArray(e)||e.length===0)return!1;n=n.split("?")[0],n===""&&(n="/");const t=e.length;for(let i=0;i<t;i++)if(n===e[i]||new RegExp("^".concat(e[i].replace("*",".+"),"$")).test(n))return!0;return!1},MT=()=>Eu.length||Su.length,yF=async n=>(MT()&&await Promise.all(Eu.concat(Su)),Ku(n,qu())),tK=n=>{n.directive("access",GO(Xx)),n.component("Access",WO(Xx))},bF={hasAccess:yF,isDataReady:MT,setRole:v_,getRole:()=>la.currentRoleId,setAccess:g_,match:Ku,getAccess:qu},nK=n=>Ku(we(n),qu()),Xx=n=>{const e=Te(qu);return Te(()=>Ku(we(n),e.value))},Yx={status:[["0","无效的"],["1","有效的"]]};Object.keys(Yx).forEach(n=>{xF(n,Yx[n])});function xF(n,e,t={keyName:"",valueName:""}){if(!n)throw new Error("enums error: name must not be empty！");if(!Array.isArray(e))throw new Error("enums error: the ".concat(n,"'s enum must be array！"));let i=[];return e.forEach((r,s)=>{let o;if(Array.isArray(r))o={key:r[0],value:r[1]};else if(Object.prototype.toString.call(r)==="[object Object]")t.keyName||(t.keyName="key"),o={key:r[t.keyName],value:t.valueName?r[t.valueName]:r};else{console.warn("enums warn: the key ".concat(n," enum item[").concat(s,"] must be array or object！"));return}let a=i.filter(l=>l.key===o.key)[0];a?(console.warn("enums warn: the key ".concat(a.key," enum item already exists, cover!")),a.value=o.value):i.push(o)}),i}const wF=(n,e)=>{const t=n.__vccOpts||n;for(const[i,r]of e)t[i]=r;return t},MF=qe({props:{pageKey:{type:Function,default:()=>{}},isAllKeepAlive:{type:Boolean,default:!1}},setup(n){const e=UO(),t=DO();function i(l){var c,u;if(l.meta["keep-alive"]||n.isAllKeepAlive){const h=l.matched,d=h[h.length-1].components.default,f=(u=(c=l.meta)==null?void 0:c.name)!=null?u:l.name;if(f&&d)return d.name=f,f}}function r(){const l=i(e);return l?[l]:[]}const s=be(r());return t.afterEach(()=>{const l=i(e);l&&!s.value.includes(l)&&(s.value=[...s.value,l])}),{keepAlivePages:s,removeKeepAlive:l=>{const c=[...s.value],u=c.indexOf(l);u!==-1&&c.splice(u,1),s.value=c},removeAllAndSaveKeepAlive:l=>{s.value=[l]}}}});function EF(n,e,t,i,r,s){const o=vu("router-view");return rt(),Br(o,null,{default:Mp(({Component:a,route:l})=>[(rt(),Br(dR,{include:n.keepAlivePages},[(rt(),Br(xR(a),{key:n.pageKey(l)}))],1032,["include"]))]),_:1})}const iK=wF(MF,[["render",EF]]),ET=li(new Map),rK=n=>ET.get(n),sK=n=>ET.delete(n);function SF(){const n=li({userName:"11"});return{user:n,signin:()=>{const{setRole:i}=bF;n.userName="地虎降天龙",i("admin")},signout:()=>{}}}function TF(){return WS}const AF={"@@initialState":TF,user:SF},Xm=new Map,oK=n=>{const e=AF[n];if(e===void 0)throw new Error("[plugin-model]: useModel, name is undefined.");if(typeof e!="function")throw new Error("[plugin-model]: useModel is not a function.");return Xm.has(n)||Xm.set(n,e()),Xm.get(n)};function aK(n){return n}const As=()=>{},CF=()=>document.body,PF=(()=>{const n=function(e){return setTimeout(()=>{e==null||e()},10)};return typeof window<"u"&&window.requestAnimationFrame||n})(),qf=n=>{if(jx(n))return"".concat(n,"px");if(jx(Number(n)))return"".concat(Number(n),"px");if(!(xT(n)||dF(n)))return n};function RF(n){return n.nodeType===9?null:n.parentNode}function ST(n){if(n==null)return null;const e=RF(n);if(e===null)return null;if(e.nodeType===9)return document;if(e.nodeType===1){const{overflow:t,overflowX:i,overflowY:r}=getComputedStyle(e);if(/(auto|scroll|overlay)/.test(t+r+i))return e}return ST(e)}function LF(n,e){const t=n.length,i=e.length;n.length=t+i;for(let r=0;r<i;r++)n[t+r]=e[r];return n}function Rr(n,e,t){const i=n;if(i.install=r=>{for(const s of[n,...Object.values(e!=null?e:{})])r.component(s.name,s);if(t)for(const s of t)r.directive(s.name,s)},e)for(const[r,s]of Object.entries(e))i[r]=s;return i}function Co(n){const e=n;return e.install=As,e}const qx="fes";function qt(n){return n?"".concat(qx,"-").concat(n):qx}const Kx="fes-design-icon",OF={spin:Boolean,rotate:[String,Number],tabIndex:Number,size:Number,color:String};var Zn=qe({name:"FIconWrapper",props:OF,setup(n,e){let{slots:t,attrs:i}=e;const r=Te(()=>{let a=n.tabIndex;return a==null&&i.onClick&&(a=-1),a}),s=Te(()=>[n.rotate&&{transform:"rotate(".concat(n.rotate,"deg)")},!m_(n.size)&&{fontSize:"".concat(n.size,"px")},n.color&&{color:n.color}]),o=Te(()=>[{[Kx]:!0,["".concat(Kx,"--spin")]:!!n.spin}]);return()=>ne("span",{tabindex:r.value,role:"img",class:o.value,style:s.value,onClick:i.onClick||As},[t.default&&t.default()])}});var IF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 42.667C771.2 42.667 981.333 252.8 981.333 512S771.2 981.333 512 981.333 42.667 771.2 42.667 512 252.8 42.667 512 42.667zm0 64a405.333 405.333 0 1 0 0 810.666 405.333 405.333 0 0 0 0-810.666zm140.288 243.925 21.12 21.12a17.067 17.067 0 0 1 0 24.15L557.269 512l116.139 116.139a17.067 17.067 0 0 1 0 24.149l-21.12 21.12a17.067 17.067 0 0 1-24.15 0L512 557.269 395.861 673.408a17.067 17.067 0 0 1-24.149 0l-21.12-21.12a17.067 17.067 0 0 1 0-24.15L466.731 512 350.592 395.861a17.067 17.067 0 0 1 0-24.149l21.12-21.12a17.067 17.067 0 0 1 24.15 0L512 466.731l116.139-116.139a17.067 17.067 0 0 1 24.149 0z"},null)])]});const Ip="update:modelValue",Zx="change",Kf="close",Jx="ok",Qx="cancel",ew=Symbol("FFormItemKey");function DF(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function TT(n,e){if(n==null)return{};var t=DF(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}var lK=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M458.453 544.128a21.333 21.333 0 0 1 21.334 21.333v341.163a21.333 21.333 0 0 1-21.334 21.333h-341.12A21.333 21.333 0 0 1 96 906.624V565.461a21.333 21.333 0 0 1 21.333-21.333h341.12zm448.171 0a21.333 21.333 0 0 1 21.333 21.333v341.163a21.333 21.333 0 0 1-21.333 21.333H565.461a21.333 21.333 0 0 1-21.333-21.333V565.461a21.333 21.333 0 0 1 21.333-21.333h341.163zm-490.837 64H160v255.787h255.787V608.128zm448.17 0H608.128v255.787h255.83V608.128zM458.453 96a21.333 21.333 0 0 1 21.334 21.333v341.163a21.333 21.333 0 0 1-21.334 21.333h-341.12A21.333 21.333 0 0 1 96 458.496V117.333A21.333 21.333 0 0 1 117.333 96h341.12zm448.171 0a21.333 21.333 0 0 1 21.333 21.333v341.163a21.333 21.333 0 0 1-21.333 21.333H565.461a21.333 21.333 0 0 1-21.333-21.333V117.333A21.333 21.333 0 0 1 565.461 96h341.163zm-490.837 64H160v255.787h255.787V160zm448.17 0H608.128v255.787h255.83V160z"},null)])]}),UF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 42.667C771.2 42.667 981.333 252.8 981.333 512S771.2 981.333 512 981.333 42.667 771.2 42.667 512 252.8 42.667 512 42.667zm180.821 265.472a21.333 21.333 0 0 0-26.709 5.845l-220.16 283.733-88.064-113.493a21.333 21.333 0 0 0-29.91-3.755l-16.853 13.056a21.333 21.333 0 0 0-3.84 29.952l121.771 156.928a21.333 21.333 0 0 0 33.707 0l253.909-327.168a21.333 21.333 0 0 0-3.755-29.952l-16.853-13.056z"},null)])]}),NF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"m685.312 445.568-253.91 327.168a21.333 21.333 0 0 1-33.706 0L275.968 615.808a21.333 21.333 0 0 1 3.797-29.91L296.62 572.8a21.333 21.333 0 0 1 29.909 3.797l88.064 113.494 220.16-283.734a21.333 21.333 0 0 1 29.952-3.797l16.853 13.099a21.333 21.333 0 0 1 3.755 29.909zm158.72-204.757L431.445 772.65a21.333 21.333 0 0 1-33.706-.128L152.02 452.437a21.333 21.333 0 0 1 3.84-29.866l16.854-13.014a21.333 21.333 0 0 1 30.037 3.84l211.84 276.651L793.472 201.6a21.333 21.333 0 0 1 29.952-3.797l16.853 13.098a21.333 21.333 0 0 1 3.755 29.91z"},null)])]}),AT=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 42.667C771.2 42.667 981.333 252.8 981.333 512S771.2 981.333 512 981.333 42.667 771.2 42.667 512 252.8 42.667 512 42.667zm140.288 307.925a17.067 17.067 0 0 0-24.15 0L512 466.731 395.861 350.592a17.067 17.067 0 0 0-24.149 0l-21.12 21.12a17.067 17.067 0 0 0 0 24.15L466.731 512 350.592 628.139a17.067 17.067 0 0 0 0 24.149l21.12 21.12a17.067 17.067 0 0 0 24.15 0L512 557.227l116.139 116.181a17.067 17.067 0 0 0 24.149 0l21.12-21.12a17.067 17.067 0 0 0 0-24.15L557.227 512l116.181-116.139a17.067 17.067 0 0 0 0-24.149z"},null)])]}),cK=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M266.667 481.195a21.333 21.333 0 0 1 21.333 0l186.197 107.52a21.333 21.333 0 0 1 10.667 18.474v214.955a21.333 21.333 0 0 1-10.667 18.475L288 948.139a21.333 21.333 0 0 1-21.333 0L80.469 840.619a21.333 21.333 0 0 1-10.666-18.475V607.189a21.333 21.333 0 0 1 10.666-18.474zm469.333 0a21.333 21.333 0 0 1 21.333 0l186.198 107.52a21.333 21.333 0 0 1 10.666 18.474v214.955a21.333 21.333 0 0 1-10.666 18.475l-186.198 107.52a21.333 21.333 0 0 1-21.333 0l-186.197-107.52a21.333 21.333 0 0 1-10.667-18.475V607.189a21.333 21.333 0 0 1 10.667-18.474zm-458.667 67.754-143.53 82.859v165.675l143.53 82.858 143.488-82.816v-165.76L277.333 548.95zm469.334 0-143.531 82.859v165.675l143.53 82.858 143.489-82.816v-165.76L746.667 548.95zM501.333 65.195a21.333 21.333 0 0 1 21.334 0l186.197 107.52a21.333 21.333 0 0 1 10.667 18.474v214.955a21.333 21.333 0 0 1-10.667 18.475l-186.197 107.52a21.333 21.333 0 0 1-21.334 0l-186.197-107.52a21.333 21.333 0 0 1-10.667-18.475V191.189a21.333 21.333 0 0 1 10.667-18.474zM512 132.949l-143.53 82.859v165.675L512 464.34l143.488-82.816v-165.76L512 132.95z"},null)])]}),FF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"m158.464 314.581 336.64 434.048a21.333 21.333 0 0 0 33.75 0l336.682-434.048a21.333 21.333 0 0 0-3.755-29.952l-16.896-13.056a21.333 21.333 0 0 0-27.306.939l-2.603 2.859L512 665.984 209.067 275.371a21.333 21.333 0 0 0-26.71-5.888l-3.242 2.09-16.896 13.056a21.333 21.333 0 0 0-3.755 29.952z"},null)])]}),CT=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 42.667C771.2 42.667 981.333 252.8 981.333 512S771.2 981.333 512 981.333 42.667 771.2 42.667 512 252.8 42.667 512 42.667zm0 626.474a42.667 42.667 0 1 0 0 85.334 42.667 42.667 0 0 0 0-85.334zm10.667-417.365h-21.334A21.333 21.333 0 0 0 480 273.109v311.979a21.333 21.333 0 0 0 21.333 21.333h21.334A21.333 21.333 0 0 0 544 585.088V273.067a21.333 21.333 0 0 0-21.333-21.334z"},null)])]}),kF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 981.333C252.8 981.333 42.667 771.2 42.667 512S252.8 42.667 512 42.667 981.333 252.8 981.333 512 771.2 981.333 512 981.333zm0-626.474a42.667 42.667 0 1 0 0-85.334 42.667 42.667 0 0 0 0 85.334zm-10.667 417.365h21.334a21.333 21.333 0 0 0 20.992-17.493l.341-3.84V438.912a21.333 21.333 0 0 0-17.493-20.992l-3.84-.341h-21.334a21.333 21.333 0 0 0-20.992 17.493l-.341 3.84v312.021a21.333 21.333 0 0 0 17.493 20.992l3.84.342z"},null)])]}),BF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M709.419 865.536 275.37 528.896a21.333 21.333 0 0 1 0-33.75l434.048-336.682a21.333 21.333 0 0 1 29.952 3.755l13.056 16.896a21.333 21.333 0 0 1-.939 27.306l-2.859 2.603L358.016 512l390.613 302.933a21.333 21.333 0 0 1 5.888 26.71l-2.09 3.242-13.056 16.896a21.333 21.333 0 0 1-29.952 3.755z"},null)])]}),PT=n=>ne(Zn,wr(n,{spin:!0}),{default:()=>[ne("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200"},[ne("path",{d:"M512 42.453q42.667 0 42.667 42.667v128q0 42.667-42.667 42.667t-42.667-42.667v-128q0-42.667 42.667-42.667Z","fill-opacity":".7"},null),ne("path",{d:"M512 768.213q42.667 0 42.667 42.667v128q0 42.667-42.667 42.667t-42.667-42.667v-128q0-42.667 42.667-42.667Z","fill-opacity":".2"},null),ne("path",{d:"M42.667 511.787q0-42.667 42.666-42.667h128q42.667 0 42.667 42.667 0 42.666-42.667 42.666h-128q-42.666 0-42.666-42.666Z","fill-opacity":".4"},null),ne("path",{d:"M768 511.787q0-42.667 42.667-42.667h128q42.666 0 42.666 42.667 0 42.666-42.666 42.666h-128q-42.667 0-42.667-42.666Z"},null),ne("path",{d:"M179.978 179.978q30.17-30.17 60.34 0l90.51 90.51q30.17 30.17 0 60.34t-60.34 0l-90.51-90.51q-30.17-30.17 0-60.34Z","fill-opacity":".55"},null),ne("path",{d:"M693.173 693.172q30.17-30.17 60.34 0l90.51 90.51q30.169 30.17 0 60.34-30.17 30.17-60.34 0l-90.51-90.51q-30.17-30.17 0-60.34Z","fill-opacity":".1"},null),ne("path",{d:"M179.978 843.723q-30.17-30.17 0-60.34l90.51-90.51q30.17-30.169 60.34 0 30.17 30.17 0 60.34l-90.51 90.51q-30.17 30.17-60.34 0Z","fill-opacity":".3"},null),ne("path",{d:"M692.874 330.827q-30.17-30.17 0-60.34l90.51-90.51q30.17-30.169 60.34 0 30.17 30.17 0 60.34l-90.51 90.51q-30.17 30.17-60.34 0Z","fill-opacity":".85"},null)])]}),uK=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M756.224 512a55.979 55.979 0 1 1 112 0 55.979 55.979 0 0 1-112 0zm-300.245 0a56.021 56.021 0 1 1 112.042 0 56.021 56.021 0 0 1-112.042 0zm-300.203 0a56.021 56.021 0 1 1 112 0 56.021 56.021 0 0 1-112 0z"},null)])]}),hK=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M960 149.419a21.333 21.333 0 0 1 21.333 21.333v682.496A21.333 21.333 0 0 1 960 874.581H64a21.333 21.333 0 0 1-21.333-21.333V170.752A21.333 21.333 0 0 1 64 149.419h896zM670.464 475.86 438.869 748.245a21.333 21.333 0 0 1-32.682-.17l-140.075-168.96-159.488 187.861v43.563h810.71v-43.52L670.463 475.86zm246.87-262.4H106.666v454.571l143.616-169.088a21.333 21.333 0 0 1 32.682.213l139.99 168.918L654.25 396.16a21.333 21.333 0 0 1 32.512 0l230.57 271.83V213.418zM416 277.333a96 96 0 1 1 0 192 96 96 0 0 1 0-192zm0 64a32 32 0 1 0 0 64 32 32 0 0 0 0-64z"},null)])]}),zF=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M544 117.333v362.624l362.667.043A21.333 21.333 0 0 1 928 501.333v21.334A21.333 21.333 0 0 1 906.667 544H544v362.667A21.333 21.333 0 0 1 522.667 928h-21.334A21.333 21.333 0 0 1 480 906.667V544H117.333A21.333 21.333 0 0 1 96 522.667v-21.334A21.333 21.333 0 0 1 117.333 480L480 479.957V117.333A21.333 21.333 0 0 1 501.333 96h21.334A21.333 21.333 0 0 1 544 117.333z"},null)])]}),dK=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"M512 95.915a414.848 414.848 0 0 1 297.472 125.141V117.461a21.333 21.333 0 0 1 21.333-21.333h21.334a21.333 21.333 0 0 1 21.333 21.333v214.614a21.333 21.333 0 0 1-21.333 21.333H637.525a21.333 21.333 0 0 1-21.333-21.333V310.74a21.333 21.333 0 0 1 21.333-21.333h147.286A352.085 352.085 0 1 0 864.128 512l-.47-14.464-.34-5.845a21.333 21.333 0 0 1 16.085-22.102l4.48-.597h22.101a21.333 21.333 0 0 1 21.333 20.053l.726 18.176.042 4.779c0 229.803-186.282 416.085-416.085 416.085-229.803 0-416.085-186.282-416.085-416.085C95.915 282.197 282.197 95.915 512 95.915z"},null)])]}),RT=n=>ne(Zn,n,{default:()=>[ne("svg",{width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[ne("path",{d:"m314.581 865.536 434.048-336.64a21.333 21.333 0 0 0 0-33.75L314.581 158.465a21.333 21.333 0 0 0-29.952 3.755l-13.056 16.896a21.333 21.333 0 0 0 .939 27.306l2.859 2.603L665.984 512 275.371 814.933a21.333 21.333 0 0 0-5.888 26.71l2.09 3.242 13.056 16.896a21.333 21.333 0 0 0 29.952 3.755z"},null)])]}),tw;const LT=typeof window<"u",VF=n=>typeof n=="string",HF=()=>{};LT&&((tw=window==null?void 0:window.navigator)!=null&&tw.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function OT(n){return typeof n=="function"?n():we(n)}function GF(n){return n}function IT(n){return _p()?(H0(n),!0):!1}function WF(n){let e=0,t,i;const r=()=>{e-=1,i&&e<=0&&(i.stop(),t=void 0,i=void 0)};return(...s)=>(e+=1,t||(i=c3(!0),t=i.run(()=>n(...s))),IT(r),t)}function $F(n){var e;const t=OT(n);return(e=t==null?void 0:t.$el)!=null?e:t}const jF=LT?window:void 0;function zc(...n){let e,t,i,r;if(VF(n[0])||Array.isArray(n[0])?([t,i,r]=n,e=jF):[e,t,i,r]=n,!e)return HF;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=ft(()=>[$F(e),OT(r)],([u,h])=>{o(),u&&s.push(...t.flatMap(d=>i.map(f=>a(u,d,f,h))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return IT(c),c}const nw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},iw="__vueuse_ssr_handlers__";nw[iw]=nw[iw]||{};var rw;(function(n){n.UP="UP",n.RIGHT="RIGHT",n.DOWN="DOWN",n.LEFT="LEFT",n.NONE="NONE"})(rw||(rw={}));var XF=Object.defineProperty,sw=Object.getOwnPropertySymbols,YF=Object.prototype.hasOwnProperty,qF=Object.prototype.propertyIsEnumerable,ow=(n,e,t)=>e in n?XF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,KF=(n,e)=>{for(var t in e||(e={}))YF.call(e,t)&&ow(n,t,e[t]);if(sw)for(var t of sw(e))qF.call(e,t)&&ow(n,t,e[t]);return n};const ZF={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};KF({linear:GF},ZF);const JF=Symbol("ConfigProvider");function DT(){return En()?Xt(JF,{getContainer:be(CF)}):{}}function Zu(n){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(n)}function QF(n,e){if(Zu(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(Zu(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ek(n){var e=QF(n,"string");return Zu(e)==="symbol"?e:String(e)}function Er(n,e,t){return e=ek(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Sf(n,e){return Math.min(Math.max(n,0),e)}function aw(n){return"#".concat(n.map(e=>(e=Sf(Math.round(e),255),(e<16?"0":"")+e.toString(16))).join(""))}let Vl=class{constructor(e,t,i){Er(this,"alpha",0),Er(this,"value",""),Array.isArray(e)?this.rgb=e:e.length>=6?(this.rgb=[],e.match(/.{2}/g).forEach((r,s)=>{s<3?this.rgb.push(parseInt(r,16)):this.alpha=parseInt(r,16)/255})):(this.rgb=[],e.split("").forEach((r,s)=>{s<3?this.rgb.push(parseInt(r+r,16)):this.alpha=parseInt(r+r,16)/255})),this.alpha=this.alpha||(typeof t=="number"?t:1),typeof i<"u"&&(this.value=i)}toRGB(){return aw(this.rgb)}toCSS(e){let t,i="",r=[];const s=this.alpha;if(this.value)if(this.value.indexOf("rgb")===0)s<1&&(i="rgba");else if(this.value.indexOf("hsl")===0)s<1?i="hsla":i="hsl";else return this.value;else s<1&&(i="rgba");switch(i){case"rgba":r=this.rgb.map(o=>Sf(Math.round(o),255)).concat(Sf(s,1));break;case"hsla":r.push(Sf(s,1))}if(i)return"".concat(i,"(").concat(r.join(",".concat(e?"":" ")),")");if(t=this.toRGB(),e){const o=t.split("");o[1]===o[2]&&o[3]===o[4]&&o[5]===o[6]&&(t="#".concat(o[1]).concat(o[3]).concat(o[5]))}return t}toHex(){return aw(this.rgb)}toHSL(){const e=this.rgb[0]/255,t=this.rgb[1]/255,i=this.rgb[2]/255,r=this.alpha,s=Math.max(e,t,i),o=Math.min(e,t,i);let a=0,l;const c=(s+o)/2,u=s-o;if(s===o)a=l=0;else{switch(l=c>.5?u/(2-s-o):u/(s+o),s){case e:a=(t-i)/u+(t<i?6:0);break;case t:a=(i-e)/u+2;break;case i:a=(e-t)/u+4;break}a/=6}return{h:a*360,s:l,l:c,a:r}}};function Tf(n){return Math.min(1,Math.max(0,n))}function tk(n,e,t,i){let r,s;function o(l){return l=l<0?l+1:l>1?l-1:l,l*6<1?r+(s-r)*l*6:l*2<1?s:l*3<2?r+(s-r)*(2/3-l)*6:r}n=n%360/360,e=Tf(e),t=Tf(t),i=Tf(i),s=t<=.5?t*(e+1):t+e-t*e,r=t*2-s;const a=[o(n+1/3)*255,o(n)*255,o(n-1/3)*255];return new Vl(a,i,"hsla")}function nk(n,e){const t=tk(e.h,e.s,e.l,e.a);return n.value&&/^(rgb|hsl)/.test(n.value)?t.value=n.value:t.value="rgb",t}function ik(n,e,t,i){if(n instanceof Vl)return e?i=e:i=n.alpha,new Vl(n.rgb,i,"rgba");const r=[n,e,t];return new Vl(r,i,"rgba")}function UT(n,e,t){const r=ik(n,e,t,1);return r.value="rgb",r}function Av(n){if(n.toHSL)return n.toHSL();throw new Error("Argument cannot be evaluated to a color")}function NT(n,e,t){const i=t,r=i*2-1,s=Av(n).a-Av(e).a,o=((r*s===-1?r:(r+s)/(1+r*s))+1)/2,a=1-o,l=[n.rgb[0]*o+e.rgb[0]*a,n.rgb[1]*o+e.rgb[1]*a,n.rgb[2]*o+e.rgb[2]*a],c=n.alpha*i+e.alpha*(1-i);return new Vl(l,c).toHex()}function __(n){const e=n.match(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/);return new Vl(e[1],void 0,n)}function ca(n,e){const t=__(n),i=Av(t);return i.a=e,i.a=Tf(i.a),nk(t,i).toCSS()}function on(n,e){const t=__(n);return NT(UT(255,255,255),t,e)}function pd(n,e){const t=__(n);return NT(UT(0,0,0),t,e)}function lw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function cw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function rk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"#0f1222";return{primaryColor:"#5384ff",successColor:"#00cb91",dangerColor:"#ff4d4f",warningColor:"#f29360",tipColor:"#5384ff",white:"#fff",black:"#000",bodyBgColor:"#fff",fontColorBase:n,fontSizeBase:"14px",borderRadiusBase:"4px",borderRadiusSm:"2px",borderWidthBase:"1px",borderStyleBase:"solid",borderColorBase:on(n,.8),shadowColor:ca(n,.1),shadowColorSm:ca(n,.2),shadowRadius:"12px",shadowRadiusSm:"4px",maskColor:ca(n,.45),maskDarkColor:ca(n,.9),paddingLarge:"24px",paddingMiddle:"16px",paddingSmall:"12px",paddingXsmall:"8px"}}const FT=function(){var n;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Object.assign(rk((n=e.common)===null||n===void 0?void 0:n.fontColorBase),e.common);return cw(cw({},t),{},{linkColor:t.primaryColor,componentBgColor:on(t.fontColorBase,.97),hoverColorBase:on(t.primaryColor,.2),hoverColorLight:on(t.primaryColor,.94),hoverSuccessColor:on(t.successColor,.94),activeSuccessColor:pd(t.successColor,.06),hoverWarningColor:on(t.warningColor,.94),activeWarningColor:pd(t.warningColor,.06),hoverDangerColor:on(t.dangerColor,.94),activeDangerColor:pd(t.dangerColor,.06),activeColor:pd(t.primaryColor,.06),focusColor:t.primaryColor,focusShadowColor:on(t.primaryColor,.8),focusDangerShadowColor:on(t.dangerColor,.8),processingColor:on(t.primaryColor,.4),disabledColorBase:on(t.fontColorBase,.8),disabledColorLight:on(t.fontColorBase,.97),headColor:t.fontColorBase,subHeadColor:on(t.fontColorBase,.35),textColor:t.fontColorBase,textColorSecondary:on(t.fontColorBase,.55),textColorDisabled:on(t.fontColorBase,.7),textColorDisabledLight:on(t.fontColorBase,.8),textColorCaption:on(t.fontColorBase,.8),borderColorDisabled:on(t.fontColorBase,.8),borderColorSplit:on(t.fontColorBase,.94),borderColorInverse:t.white,borderBase:"".concat(t.borderWidthBase," ").concat(t.borderStyleBase," ").concat(t.borderColorBase),layoutInvertedBgColor:on(t.fontColorBase,.05),tooltipTextBgColor:on(t.fontColorBase,.3),selectTriggerIconColor:on(t.fontColorBase,.6),scrollbarBgColor:ca(t.fontColorBase,.25),scrollbarActiveColor:ca(t.fontColorBase,.65),carouselColor:t.shadowColorSm,carouselHoverColor:t.maskColor,carouselActiveColor:ca(t.fontColorBase,.65)},e.derivedColor)},sk="--f-";function ok(n,e,t){const i=FT(t),r=n||document.body;return Object.keys(i).forEach(s=>{r.style.setProperty("".concat(sk).concat(pF(s)),i[s])}),{themeVars:i}}function ak(){const n=DT(),e=be(FT());return ft([()=>{var t;return(t=n.getContainer)===null||t===void 0?void 0:t.value},()=>{var t;return(t=n.theme)===null||t===void 0?void 0:t.value},()=>{var t;return(t=n.themeOverrides)===null||t===void 0?void 0:t.value}],t=>{let[i,r,s]=t;if(!i)return;const{themeVars:o}=ok(i(),r,s);e.value=o},{immediate:!0}),{config:n,themeVars:e}}const ci=WF(ak);function kT(n){const e=Zf(n);return e.length===1?e[0]:(console.warn("getFirstSlotVNode","vNodes should have exactly one child"),null)}function Cv(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"default",t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const i=n[e];return i===void 0?(console.warn("getSlot","slot[".concat(e,"] is empty.")),null):i(t)}function Zf(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;return n.forEach(i=>{if(i!==null){if(typeof i!="object"){(typeof i=="string"||typeof i=="number")&&e.push(c_(String(i)));return}if(Array.isArray(i)){Zf(i,e);return}if(i.type===Kt){if(i.children===null)return;const r=t?"".concat(t,"_").concat(String(i.key)):String(i.key);Array.isArray(i.children)&&(i.children.forEach((s,o)=>{xa(s)&&(s.key===void 0||s.key===null)&&(s.key="".concat(r,"_").concat(o))}),Zf(i.children,e,r))}else i.type!==oi&&e.push(i)}}),e}const lk=["getContainer"];let ck=0;const uk=Date.now();function hk(){return"notice_manager_".concat(uk,"_").concat(ck++)}const dk=qe({props:{maxCount:Number,transitionName:String},setup(n){const e=be([]);function t(r){const s=e.value.findIndex(l=>l.key===r),o=e.value[s];if(o){var a;e.value.splice(s,1),(a=o.afterRemove)===null||a===void 0||a.call(o)}}function i(r){if(r.key||(r.key=hk()),n.maxCount&&e.value.length>=n.maxCount&&e.value.shift(),e.value.push(r),r.duration>0){const s=setTimeout(()=>{t(r.key),clearTimeout(s)},r.duration*1e3)}return r}return{notices:e,append:i,remove:t}},render(){const{notices:n,transitionName:e}=this,t=n.map(i=>{let r=typeof i.children=="function"?i.children():i.children;if(r=kT([r]),r)return xr(r,{key:i.key})});return ne(d_,{name:e,tag:"div"},{default:()=>[t]})}});function fk(n){return new Promise(e=>{const{getContainer:t}=n,i=TT(n,lk),r=document.createElement("div");if(t){const o=t();o==null||o.appendChild(r)}else document.body.appendChild(r);const s=IS({setup(){ci();const o=be(),a={append:l=>o.value.append(l),remove:l=>o.value.remove(l),destroy(){s.unmount(),r.parentNode&&r.parentNode.removeChild(r)},exited(){if(!t)return!0;try{if(!t())return a.destroy(),!1}catch(l){return a.destroy(),!1}return!0}};return _n(()=>e(a)),()=>ne(dk,wr({ref:o},i),null)}});s.mount(r)})}const uw={info:kF,success:UF,error:AT,warning:CT},Wi=qt("alert"),pk={message:String,description:String,showIcon:Boolean,closable:Boolean,center:Boolean,type:{type:String,default:"info"},beforeClose:{type:Function,default:()=>!0}};var mk=qe({name:"FAlert",props:pk,emits:[Kf],setup(n,e){ci();const t=be(!0);function i(o){var a;Promise.resolve((a=n.beforeClose)===null||a===void 0?void 0:a.call(n,o)).then(l=>{l&&(t.value=!1,e.emit(Kf))})}const r=Te(()=>["".concat(Wi,"-body"),n.showIcon&&!n.center&&"".concat(Wi,"-icon-padding")]),s=()=>{var o;return e.slots.icon?e.slots.icon():(o=uw[n.type])===null||o===void 0?void 0:o.call(uw)};return()=>{const{action:o,default:a,description:l}=e.slots,c=n.description||l?ne("div",{class:r.value},[l?l():n.description]):null;return ne(gc,{name:"".concat(Wi,"-fade-expand")},{default:()=>[t.value?ne("div",{class:"".concat(Wi," ").concat(n.center?"".concat(Wi,"-message-center"):""," ").concat(Wi,"-").concat(n.type)},[ne("div",{class:"".concat(Wi,"-head")},[ne("div",{class:"".concat(Wi,"-head-message")},[n.showIcon?ne("div",{class:"".concat(Wi,"-head-message-icon")},[s()]):null,ne("div",null,[a?a():n.message])]),ne("div",{class:"".concat(Wi,"-head-right")},[o?ne("div",{class:"".concat(Wi,"-head-right-action")},[o()]):null,n.closable?ne("div",{class:"".concat(Wi,"-head-right-close")},[ne(IF,{onClick:i},null)]):null])]),c]):null]})}}});function gk(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:300;const e=be(!1),t=Te(()=>e.value?"is-animate":""),i=gF(()=>{e.value||(e.value=!0),setTimeout(()=>{e.value=!1},n)},100);return{animating:e,handelAnimate:i,animateClassName:t}}var vk=n=>{const e=n==null?void 0:n.valueType,t=n==null?void 0:n.forbidChildValidate,{validate:i,isError:r,setRuleDefaultType:s,isFormDisabled:o}=Xt(ew,{validate:As,isError:be(!1),isFormDisabled:be(!1)});return s&&e&&(bT(e)?s(e):gn(e)?ft(e,()=>{e.value&&s(e.value)},{immediate:!0}):jr(e)&&s(e())),t&&bi(ew,{validate:As,isError:r,isFormDisabled:o}),{validate:i,isError:r,isFormDisabled:o}};const fu=qt("btn"),_k="".concat(fu,"-loading-icon"),yk={disabled:{type:Boolean,default:!1},htmlType:{type:String,default:"button"},size:{type:String,default:"middle"},loading:{type:Boolean,default:!1},long:{type:Boolean,default:!1},throttle:{type:Number,default:300},type:{type:String,default:"default"}};var Pv=qe({name:"FButton",props:yk,emits:["click"],setup(n,e){let{slots:t,emit:i}=e;const{animateClassName:r,handelAnimate:s}=gk(400),{isFormDisabled:o}=vk();ci();const a=be(!1),l=u=>{a.value||n.disabled||n.loading||o.value||(s(),a.value=!0,setTimeout(()=>{a.value=!1},n.throttle),i("click",u))},c=Te(()=>[fu,r.value,"".concat(fu,"-type-").concat(n.type),n.long&&"".concat(fu,"-long"),n.size!=="middle"&&"".concat(fu,"-").concat(n.size),n.loading&&"is-loading"]);return()=>{var u,h;return ne("button",{type:n.htmlType,disabled:n.disabled||o.value,class:c.value,onClick:l},[n.loading?ne(PT,{class:_k},null):(u=t.icon)===null||u===void 0?void 0:u.call(t),(h=t.default)===null||h===void 0?void 0:h.call(t)])}}});const pK=Rr(Pv);const bk={header:{type:String,default:""},divider:{type:Boolean,default:!0},bodyStyle:{type:Object,default:()=>({})},size:{type:String,default:"middle"},shadow:{type:String,default:"always"},bordered:{type:Boolean,default:!0}},Vc=qt("card");var y_=qe({name:"FCard",props:bk,setup(n){ci();const e=Te(()=>({[Vc]:!0,["".concat(Vc,"-size--").concat(n.size)]:n.size,["".concat(Vc,"-shadow--").concat(n.shadow)]:n.shadow,"is-bordered":n.bordered})),t=Te(()=>({["".concat(Vc,"__header")]:!0,"no-divider":!n.divider}));return{prefixCls:Vc,classes:e,headerClasses:t}}});function xk(n,e,t,i,r,s){return rt(),Mt("div",{class:Wt(n.classes)},[n.$slots.header||n.header?(rt(),Mt("div",{key:0,class:Wt(n.headerClasses)},[wi(n.$slots,"header",{},()=>[c_(l3(n.header),1)])],2)):Ii("v-if",!0),Kn("div",{class:Wt("".concat(n.prefixCls,"__body")),style:Dn(n.bodyStyle)},[wi(n.$slots,"default")],6)],2)}y_.render=xk;y_.__file="components/card/card.vue";const mK=Rr(y_);var ma=[],wk=function(){return ma.some(function(n){return n.activeTargets.length>0})},Mk=function(){return ma.some(function(n){return n.skippedTargets.length>0})},hw="ResizeObserver loop completed with undelivered notifications.",Ek=function(){var n;typeof ErrorEvent=="function"?n=new ErrorEvent("error",{message:hw}):(n=document.createEvent("Event"),n.initEvent("error",!1,!1),n.message=hw),window.dispatchEvent(n)},Ju;(function(n){n.BORDER_BOX="border-box",n.CONTENT_BOX="content-box",n.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Ju||(Ju={}));var ga=function(n){return Object.freeze(n)},Sk=function(){function n(e,t){this.inlineSize=e,this.blockSize=t,ga(this)}return n}(),BT=function(){function n(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,ga(this)}return n.prototype.toJSON=function(){var e=this,t=e.x,i=e.y,r=e.top,s=e.right,o=e.bottom,a=e.left,l=e.width,c=e.height;return{x:t,y:i,top:r,right:s,bottom:o,left:a,width:l,height:c}},n.fromRect=function(e){return new n(e.x,e.y,e.width,e.height)},n}(),b_=function(n){return n instanceof SVGElement&&"getBBox"in n},zT=function(n){if(b_(n)){var e=n.getBBox(),t=e.width,i=e.height;return!t&&!i}var r=n,s=r.offsetWidth,o=r.offsetHeight;return!(s||o||n.getClientRects().length)},dw=function(n){var e;if(n instanceof Element)return!0;var t=(e=n==null?void 0:n.ownerDocument)===null||e===void 0?void 0:e.defaultView;return!!(t&&n instanceof t.Element)},Tk=function(n){switch(n.tagName){case"INPUT":if(n.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},Tu=typeof window<"u"?window:{},md=new WeakMap,fw=/auto|scroll/,Ak=/^tb|vertical/,Ck=/msie|trident/i.test(Tu.navigator&&Tu.navigator.userAgent),Dr=function(n){return parseFloat(n||"0")},Hl=function(n,e,t){return n===void 0&&(n=0),e===void 0&&(e=0),t===void 0&&(t=!1),new Sk((t?e:n)||0,(t?n:e)||0)},pw=ga({devicePixelContentBoxSize:Hl(),borderBoxSize:Hl(),contentBoxSize:Hl(),contentRect:new BT(0,0,0,0)}),VT=function(n,e){if(e===void 0&&(e=!1),md.has(n)&&!e)return md.get(n);if(zT(n))return md.set(n,pw),pw;var t=getComputedStyle(n),i=b_(n)&&n.ownerSVGElement&&n.getBBox(),r=!Ck&&t.boxSizing==="border-box",s=Ak.test(t.writingMode||""),o=!i&&fw.test(t.overflowY||""),a=!i&&fw.test(t.overflowX||""),l=i?0:Dr(t.paddingTop),c=i?0:Dr(t.paddingRight),u=i?0:Dr(t.paddingBottom),h=i?0:Dr(t.paddingLeft),d=i?0:Dr(t.borderTopWidth),f=i?0:Dr(t.borderRightWidth),p=i?0:Dr(t.borderBottomWidth),v=i?0:Dr(t.borderLeftWidth),m=h+c,g=l+u,b=v+f,y=d+p,_=a?n.offsetHeight-y-n.clientHeight:0,T=o?n.offsetWidth-b-n.clientWidth:0,w=r?m+b:0,S=r?g+y:0,x=i?i.width:Dr(t.width)-w-T,M=i?i.height:Dr(t.height)-S-_,E=x+m+T+b,C=M+g+_+y,O=ga({devicePixelContentBoxSize:Hl(Math.round(x*devicePixelRatio),Math.round(M*devicePixelRatio),s),borderBoxSize:Hl(E,C,s),contentBoxSize:Hl(x,M,s),contentRect:new BT(h,l,x,M)});return md.set(n,O),O},HT=function(n,e,t){var i=VT(n,t),r=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(e){case Ju.DEVICE_PIXEL_CONTENT_BOX:return o;case Ju.BORDER_BOX:return r;default:return s}},Pk=function(){function n(e){var t=VT(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=ga([t.borderBoxSize]),this.contentBoxSize=ga([t.contentBoxSize]),this.devicePixelContentBoxSize=ga([t.devicePixelContentBoxSize])}return n}(),GT=function(n){if(zT(n))return 1/0;for(var e=0,t=n.parentNode;t;)e+=1,t=t.parentNode;return e},Rk=function(){var n=1/0,e=[];ma.forEach(function(o){if(o.activeTargets.length!==0){var a=[];o.activeTargets.forEach(function(c){var u=new Pk(c.target),h=GT(c.target);a.push(u),c.lastReportedSize=HT(c.target,c.observedBox),h<n&&(n=h)}),e.push(function(){o.callback.call(o.observer,a,o.observer)}),o.activeTargets.splice(0,o.activeTargets.length)}});for(var t=0,i=e;t<i.length;t++){var r=i[t];r()}return n},mw=function(n){ma.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(r){r.isActive()&&(GT(r.target)>n?t.activeTargets.push(r):t.skippedTargets.push(r))})})},Lk=function(){var n=0;for(mw(n);wk();)n=Rk(),mw(n);return Mk()&&Ek(),n>0},Ym,WT=[],Ok=function(){return WT.splice(0).forEach(function(n){return n()})},Ik=function(n){if(!Ym){var e=0,t=document.createTextNode(""),i={characterData:!0};new MutationObserver(function(){return Ok()}).observe(t,i),Ym=function(){t.textContent="".concat(e?e--:e++)}}WT.push(n),Ym()},Dk=function(n){Ik(function(){requestAnimationFrame(n)})},Af=0,Uk=function(){return!!Af},Nk=250,Fk={attributes:!0,characterData:!0,childList:!0,subtree:!0},gw=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],vw=function(n){return n===void 0&&(n=0),Date.now()+n},qm=!1,kk=function(){function n(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return n.prototype.run=function(e){var t=this;if(e===void 0&&(e=Nk),!qm){qm=!0;var i=vw(e);Dk(function(){var r=!1;try{r=Lk()}finally{if(qm=!1,e=i-vw(),!Uk())return;r?t.run(1e3):e>0?t.run(e):t.start()}})}},n.prototype.schedule=function(){this.stop(),this.run()},n.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,Fk)};document.body?t():Tu.addEventListener("DOMContentLoaded",t)},n.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),gw.forEach(function(t){return Tu.addEventListener(t,e.listener,!0)}))},n.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),gw.forEach(function(t){return Tu.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},n}(),Rv=new kk,_w=function(n){!Af&&n>0&&Rv.start(),Af+=n,!Af&&Rv.stop()},Bk=function(n){return!b_(n)&&!Tk(n)&&getComputedStyle(n).display==="inline"},zk=function(){function n(e,t){this.target=e,this.observedBox=t||Ju.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return n.prototype.isActive=function(){var e=HT(this.target,this.observedBox,!0);return Bk(this.target)&&(this.lastReportedSize=e),this.lastReportedSize.inlineSize!==e.inlineSize||this.lastReportedSize.blockSize!==e.blockSize},n}(),Vk=function(){function n(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}return n}(),gd=new WeakMap,yw=function(n,e){for(var t=0;t<n.length;t+=1)if(n[t].target===e)return t;return-1},vd=function(){function n(){}return n.connect=function(e,t){var i=new Vk(e,t);gd.set(e,i)},n.observe=function(e,t,i){var r=gd.get(e),s=r.observationTargets.length===0;yw(r.observationTargets,t)<0&&(s&&ma.push(r),r.observationTargets.push(new zk(t,i&&i.box)),_w(1),Rv.schedule())},n.unobserve=function(e,t){var i=gd.get(e),r=yw(i.observationTargets,t),s=i.observationTargets.length===1;r>=0&&(s&&ma.splice(ma.indexOf(i),1),i.observationTargets.splice(r,1),_w(-1))},n.disconnect=function(e){var t=this,i=gd.get(e);i.observationTargets.slice().forEach(function(r){return t.unobserve(e,r.target)}),i.activeTargets.splice(0,i.activeTargets.length)},n}(),Hk=function(){function n(e){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof e!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");vd.connect(this,e)}return n.prototype.observe=function(e,t){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!dw(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");vd.observe(this,e,t)},n.prototype.unobserve=function(e){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!dw(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");vd.unobserve(this,e)},n.prototype.disconnect=function(){vd.disconnect(this)},n.toString=function(){return"function ResizeObserver () { [polyfill code] }"},n}(),Jf=function(n,e,t){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;const r=Te(()=>we(t)),s=function(){if(!r.value){if(!i){i=!0;return}for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];e==null||e(...u)}},o=new Hk(s);let a=null;const l=c=>{a&&o.unobserve(a),c&&(o.observe(c),a=c)};_n(()=>{ft(n,()=>{$r(()=>{l(n.value)})},{immediate:!0})}),Cr(()=>{o.disconnect()})};function bw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Gk(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?bw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):bw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Wk={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},$k={shadow:{type:[Boolean,Object],default:!1}},jk=Gk({height:{type:[Number,String]},maxHeight:{type:[Number,String]},native:{type:Boolean,default:!1},containerClass:[Array,Object,String],containerStyle:[String,Array,Object],contentStyle:[String,Array,Object],horizontalRatioStyle:[String,Array,Object],verticalRatioStyle:[String,Array,Object],shadowStyle:[String,Array,Object],thumbStyle:[String,Array,Object],noresize:Boolean,always:{type:Boolean,default:!1},minSize:{type:Number,default:20}},$k),Xk=qt("scrollbar-track");function Yk(n){let{move:e,size:t,bar:i}=n;const r={},s="translate".concat(i.axis,"(").concat(e,"%)");return r[i.size]=t,r.transform=s,r}const qk={vertical:Boolean,size:String,move:Number,ratio:Number,always:Boolean,scrollbarRef:Array,containerRef:Object,thumbStyle:[String,Array,Object]};var x_=qe({name:"FBar",props:qk,setup(n){const e=Te(()=>n.containerRef),t=be({}),i=be(),r=be(),s=Te(()=>Wk[n.vertical?"vertical":"horizontal"]),o=Te(()=>[Yk({size:n.size,move:n.move,bar:s.value}),n.thumbStyle]),a=Te(()=>i.value[s.value.offset]**2/e.value[s.value.scrollSize]/n.ratio/r.value[s.value.offset]),l=be(!1),c=be(),u=be();let h=null;const d=_=>{if(u.value===!1)return;const T=t.value[s.value.axis];if(!T)return;const w=(i.value.getBoundingClientRect()[s.value.direction]-_[s.value.client])*-1,S=r.value[s.value.offset]-T,x=(w-S)*100*a.value/i.value[s.value.offset];e.value[s.value.scroll]=x*e.value[s.value.scrollSize]/100};let f;const p=()=>{var _;u.value=!1,t.value[s.value.axis]=0,(_=f)===null||_===void 0||_(),document.onselectstart=h,c.value&&(l.value=!1)},v=_=>{_.stopImmediatePropagation(),u.value=!0,f=zc(document,"mousemove",d),zc(document,"mouseup",p),h=document.onselectstart,document.onselectstart=()=>!1},m=()=>{c.value=!1,l.value=!!n.size},g=()=>{c.value=!0,l.value=u.value};return _n(()=>{$r(()=>{n.scrollbarRef.forEach(_=>{zc(_,"mouseenter",m),zc(_,"mousemove",m),zc(_,"mouseleave",g)})})}),{prefixCls:Xk,barRef:i,thumbRef:r,visible:l,cursorDown:u,barMap:s,thumbStyle:o,clickTrackHandler:_=>{const T=Math.abs(_.target.getBoundingClientRect()[s.value.direction]-_[s.value.client]),w=r.value[s.value.offset]/2,S=(T-w)*100*a.value/i.value[s.value.offset];e.value[s.value.scroll]=S*e.value[s.value.scrollSize]/100},clickThumbHandler:_=>{_.stopPropagation(),!(_.ctrlKey||[1,2].includes(_.button))&&(window.getSelection().removeAllRanges(),v(_),t.value[s.value.axis]=_.currentTarget[s.value.offset]-(_[s.value.client]-_.currentTarget.getBoundingClientRect()[s.value.direction]))}}}});function Kk(n,e,t,i,r,s){return rt(),Br(gc,{name:"".concat(n.prefixCls,"-fade"),persisted:""},{default:Mp(()=>[Hu(Kn("div",{ref:"barRef",class:Wt([n.prefixCls,"is-".concat(n.barMap.key),n.cursorDown&&"is-hovering"]),onMousedown:e[1]||(e[1]=Kb(function(){return n.clickTrackHandler&&n.clickTrackHandler(...arguments)},["stop","prevent"]))},[Kn("div",{ref:"thumbRef",class:Wt(["".concat(n.prefixCls,"-thumb")]),style:Dn(n.thumbStyle),onMousedown:e[0]||(e[0]=Kb(function(){return n.clickThumbHandler&&n.clickThumbHandler(...arguments)},["stop","prevent"]))},null,38)],34),[[$u,n.always||n.visible]])]),_:1},8,["name"])}x_.render=Kk;x_.__file="components/scrollbar/bar.vue";var Zk=n=>{const e=be(),t=be(1),i=be(1),r=be(0),s=be(0),o=be("0"),a=be("0"),l=be(!1),c=be(0),u=be(!1),h=be(0),d=4;return{containerRef:e,onUpdate:()=>{if(e.value){const v=e.value.offsetHeight-d,m=e.value.offsetWidth-d,g=v**2/e.value.scrollHeight,b=m**2/e.value.scrollWidth,y=Math.max(g,n.minSize),_=Math.max(b,n.minSize);i.value=g/(v-g)/(y/(v-y)),t.value=b/(m-b)/(_/(m-_)),o.value=y+d<v?qf(y):"",a.value=_+d<m?qf(_):""}},onScroll:()=>{const v=e.value;if(v){const m=v.offsetHeight-d,g=v.offsetWidth-d;s.value=v.scrollTop*100/m*i.value,r.value=v.scrollLeft*100/g*t.value,u.value=v.scrollHeight>v.offsetHeight,h.value=v.scrollTop/(v.scrollHeight-v.offsetHeight),l.value=v.scrollWidth>v.offsetWidth,c.value=v.scrollLeft/(v.scrollWidth-v.offsetWidth)}},ratioX:t,ratioY:i,thumbMoveX:r,thumbMoveY:s,sizeHeight:o,sizeWidth:a,scrollX:l,scrollXRatio:c,scrollY:u,scrollYRatio:h}};const _d=qt("scrollbar");var w_=qe({name:"FScrollbar",components:{FBar:x_},props:jk,emits:["scroll"],setup(n,e){let{emit:t}=e;ci();const{onUpdate:i,onScroll:r,containerRef:s,ratioX:o,ratioY:a,thumbMoveX:l,thumbMoveY:c,sizeHeight:u,sizeWidth:h,scrollX:d,scrollXRatio:f,scrollY:p,scrollYRatio:v}=Zk(n),m=be(),g=be(),b=Te(()=>typeof n.shadow=="boolean"?{x:n.shadow,y:n.shadow}:n.shadow),y=Te(()=>[n.containerStyle,{height:qf(n.height),maxHeight:qf(n.maxHeight)}]),_=Te(()=>[_d]),T=Te(()=>["".concat(_d,"-container"),n.containerClass,!n.native&&"".concat(_d,"-hidden-native-bar")]),w=C=>{r();const O=s.value;O&&t("scroll",C,O)};Jf(g,()=>{i(),r()},Te(()=>n.noresize),!1),Jf(m,()=>{i(),r()},Te(()=>n.noresize),!1),_n(()=>{n.native||setTimeout(i,0),setTimeout(r,0)});const S=(C,O,$)=>{if(!$||$<=0){s.value[C]=O;return}const j=(O-s.value[C])/$*10;PF(()=>{s.value[C]+=j,s.value[C]!==O&&S(C,O,$-10)})};return{scrollbarRef:m,containerRef:s,contentRef:g,style:y,prefixCls:_d,setScrollTop:(C,O)=>{S("scrollTop",C,O)},setScrollLeft:(C,O)=>{S("scrollLeft",C,O)},scrollToEnd:(C,O)=>{C==="bottom"?S("scrollTop",g.value.offsetHeight,O):(C==="right"||S("scrollTop",g.value.offsetHeight,O),S("scrollLeft",g.value.offsetWidth,O))},update:i,handleScroll:w,thumbMoveX:l,thumbMoveY:c,ratioX:o,ratioY:a,sizeHeight:u,sizeWidth:h,wrapperClassRef:_,containerClassRef:T,scrollX:d,scrollXRatio:f,scrollY:p,scrollYRatio:v,shadowRef:b}}});function Jk(n,e,t,i,r,s){const o=vu("FBar");return rt(),Mt("div",{ref:"scrollbarRef",class:Wt(n.wrapperClassRef)},[Kn("div",{ref:"containerRef",class:Wt(n.containerClassRef),style:Dn(n.style),onScroll:e[0]||(e[0]=function(){return n.handleScroll&&n.handleScroll(...arguments)})},[Kn("div",{ref:"contentRef",class:Wt("".concat(n.prefixCls,"-content")),style:Dn([n.scrollX&&{width:"fit-content"},n.contentStyle])},[wi(n.$slots,"default")],6)],38),n.native?Ii("v-if",!0):(rt(),Mt(Kt,{key:0},[ne(o,{thumbStyle:n.thumbStyle,scrollbarRef:[n.scrollbarRef],containerRef:n.containerRef,move:n.thumbMoveX,ratio:n.ratioX,size:n.sizeWidth,always:n.always,style:Dn(n.horizontalRatioStyle)},null,8,["thumbStyle","scrollbarRef","containerRef","move","ratio","size","always","style"]),ne(o,{thumbStyle:n.thumbStyle,scrollbarRef:[n.scrollbarRef],containerRef:n.containerRef,move:n.thumbMoveY,ratio:n.ratioY,size:n.sizeHeight,vertical:"",always:n.always,style:Dn(n.verticalRatioStyle)},null,8,["thumbStyle","scrollbarRef","containerRef","move","ratio","size","always","style"])],64)),n.shadowRef.x&&n.scrollX&&n.scrollXRatio<1?(rt(),Mt("div",{key:1,class:Wt("".concat(n.prefixCls,"-shadow-right")),style:Dn(n.shadowStyle)},null,6)):Ii("v-if",!0),n.shadowRef.x&&n.scrollX&&n.scrollXRatio>0?(rt(),Mt("div",{key:2,class:Wt("".concat(n.prefixCls,"-shadow-left")),style:Dn(n.shadowStyle)},null,6)):Ii("v-if",!0),n.shadowRef.y&&n.scrollY&&n.scrollYRatio<1?(rt(),Mt("div",{key:3,class:Wt("".concat(n.prefixCls,"-shadow-bottom")),style:Dn(n.shadowStyle)},null,6)):Ii("v-if",!0),n.shadowRef.y&&n.scrollY&&n.scrollYRatio>0?(rt(),Mt("div",{key:4,class:Wt("".concat(n.prefixCls,"-shadow-top")),style:Dn(n.shadowStyle)},null,6)):Ii("v-if",!0)],2)}w_.render=Jk;w_.__file="components/scrollbar/scrollbar.vue";const Qk=Rr(w_);function Qu(n){if(!n)return null;if(n instanceof Text||n instanceof HTMLElement)return n;if(typeof n=="object"&&!m_(n.$el))return n.$el;throw new Error("getElementFromVueInstance 传入的值不是 Text、HTMLElement 或 Vue 组件选项对象")}function xw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function ww(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const ka=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{prop:i="modelValue",deep:r=!1,isEqual:s=!1,defaultValue:o}=t,a=i,l=be(xT(n[a])?o:n[a]),c=h=>{h===l.value||s&&uF(h,l.value)||(l.value=h)},u=h=>{c(h),e("update:".concat(a),l.value)};return ft(()=>n[a],h=>{h!==l.value&&(l.value=h)},{deep:r}),[Te({get(){return l.value},set(h){u(h)}}),u]},eB=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const[i,r]=ka(n,e,ww(ww({},t),{},{defaultValue:[]}));return Ts(i.value)||(console.warn("[useArrayModel] 绑定值类型不匹配, 仅支持数组类型, value:",n[(t==null?void 0:t.prop)||"modelValue"]),r([])),[i,o=>{if(Ts(o)){r(o);return}const a=i.value,l=a.indexOf(o);l!==-1?a.splice(l,1):a.push(o),r(a)}]};var tB=qe({name:"LazyTeleport",props:{to:{type:[String,Object],default:void 0},disabled:Boolean,show:{type:Boolean,required:!0}},setup(n){const e=be(n.show);return ft(()=>n.show,t=>{t&&(e.value=!0)}),{showTeleport:e,mergedTo:Te(()=>{var t;return(t=n.to)!==null&&t!==void 0?t:"body"})}},render(){return this.showTeleport?this.disabled?Cv(this.$slots):wo(VR,{disabled:this.disabled,to:this.mergedTo},Cv(this.$slots)):null}});function nB(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Array.isArray(n)?n:[n];let r=!1;const s=be(t);function o(l){const c=l.target;i.every(u=>{const h=Qu(we(u));return h&&!h.contains(c)&&h!==c})&&(e==null||e())}const a=()=>{r&&(r=!1,window.removeEventListener("click",o,!0))};return ft(s,()=>{s.value?a():r||(r=!0,window.addEventListener("click",o,!0))},{immediate:!0}),Cr(a),a}const iB={click:["onClick"],hover:["onMouseenter","onMouseleave"],focus:["onFocus","onBlur"],contextmenu:["onContextmenu","onClick"]};function rB(n,e,t,i){let r=!1,s,o;const a=be({});function l(){clearTimeout(s),clearTimeout(o)}const c=()=>{t.onlyShowTrigger||Yf(t.disabled)&&t.disabled||jr(t.disabled)&&t.disabled()||(l(),t.hideAfter?o=setTimeout(()=>{e(!1)},t.hideAfter):e(!1))},u=()=>{Yf(t.disabled)&&t.disabled||jr(t.disabled)&&t.disabled()||(l(),t.showAfter?s=setTimeout(()=>{e(!0)},t.showAfter):e(!0))},h=()=>{n.value?c():u()},d=(m,g)=>{switch(m.stopPropagation(),m.type){case"click":{g==="contextmenu"?n.value&&(i(null),h()):r?r=!1:h();break}case"mouseenter":{u();break}case"mouseleave":{c();break}case"focus":{r=!0,u();break}case"blur":{r=!1,c();break}case"contextmenu":{i({x:m.clientX,y:m.clientY}),m.preventDefault(),u();break}}},f=m=>{const g={};iB[m].forEach(b=>{g[b]=y=>{d(y,m)}}),a.value=g};ft(()=>t.trigger,()=>{t.trigger&&f(t.trigger)},{immediate:!0});function p(){t.trigger!=="click"&&clearTimeout(o)}function v(){const{trigger:m}=t;m==="click"||m==="focus"||m==="contextmenu"||c()}return{events:a,onPopperMouseEnter:p,onPopperMouseLeave:v}}const eh=Math.min,Gl=Math.max,Qf=Math.round,Eo=n=>({x:n,y:n}),sB={left:"right",right:"left",bottom:"top",top:"bottom"},oB={start:"end",end:"start"};function Lv(n,e,t){return Gl(n,eh(e,t))}function Lh(n,e){return typeof n=="function"?n(e):n}function Ea(n){return n.split("-")[0]}function Oh(n){return n.split("-")[1]}function $T(n){return n==="x"?"y":"x"}function M_(n){return n==="y"?"height":"width"}function Dp(n){return["top","bottom"].includes(Ea(n))?"y":"x"}function E_(n){return $T(Dp(n))}function aB(n,e,t){t===void 0&&(t=!1);const i=Oh(n),r=E_(n),s=M_(r);let o=r==="x"?i===(t?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=ep(o)),[o,ep(o)]}function lB(n){const e=ep(n);return[Ov(n),e,Ov(e)]}function Ov(n){return n.replace(/start|end/g,e=>oB[e])}function cB(n,e,t){const i=["left","right"],r=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?r:i:e?i:r;case"left":case"right":return e?s:o;default:return[]}}function uB(n,e,t,i){const r=Oh(n);let s=cB(Ea(n),t==="start",i);return r&&(s=s.map(o=>o+"-"+r),e&&(s=s.concat(s.map(Ov)))),s}function ep(n){return n.replace(/left|right|bottom|top/g,e=>sB[e])}function hB(n){return Ft({top:0,right:0,bottom:0,left:0},n)}function jT(n){return typeof n!="number"?hB(n):{top:n,right:n,bottom:n,left:n}}function tp(n){return ti(Ft({},n),{top:n.y,left:n.x,right:n.x+n.width,bottom:n.y+n.height})}function Mw(n,e,t){let{reference:i,floating:r}=n;const s=Dp(e),o=E_(e),a=M_(o),l=Ea(e),c=s==="y",u=i.x+i.width/2-r.width/2,h=i.y+i.height/2-r.height/2,d=i[a]/2-r[a]/2;let f;switch(l){case"top":f={x:u,y:i.y-r.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:h};break;case"left":f={x:i.x-r.width,y:h};break;default:f={x:i.x,y:i.y}}switch(Oh(e)){case"start":f[o]-=d*(t&&c?-1:1);break;case"end":f[o]+=d*(t&&c?-1:1);break}return f}const dB=async(n,e,t)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:o}=t,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:n,floating:e,strategy:r}),{x:u,y:h}=Mw(c,i,l),d=i,f={},p=0;for(let v=0;v<a.length;v++){const{name:m,fn:g}=a[v],{x:b,y,data:_,reset:T}=await g({x:u,y:h,initialPlacement:i,placement:d,strategy:r,middlewareData:f,rects:c,platform:o,elements:{reference:n,floating:e}});if(u=b!=null?b:u,h=y!=null?y:h,f=ti(Ft({},f),{[m]:Ft(Ft({},f[m]),_)}),T&&p<=50){p++,typeof T=="object"&&(T.placement&&(d=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:r}):T.rects),{x:u,y:h}=Mw(c,d,l)),v=-1;continue}}return{x:u,y:h,placement:d,strategy:r,middlewareData:f}};async function XT(n,e){var t;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:o,elements:a,strategy:l}=n,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=Lh(e,n),p=jT(f),m=a[d?h==="floating"?"reference":"floating":h],g=tp(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(m)))==null||t?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),b=h==="floating"?ti(Ft({},o.floating),{x:i,y:r}):o.reference,y=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),_=await(s.isElement==null?void 0:s.isElement(y))?await(s.getScale==null?void 0:s.getScale(y))||{x:1,y:1}:{x:1,y:1},T=tp(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:y,strategy:l}):b);return{top:(g.top-T.top+p.top)/_.y,bottom:(T.bottom-g.bottom+p.bottom)/_.y,left:(g.left-T.left+p.left)/_.x,right:(T.right-g.right+p.right)/_.x}}const fB=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:i,placement:r,rects:s,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=Lh(n,e)||{};if(c==null)return{};const h=jT(u),d={x:t,y:i},f=E_(r),p=M_(f),v=await o.getDimensions(c),m=f==="y",g=m?"top":"left",b=m?"bottom":"right",y=m?"clientHeight":"clientWidth",_=s.reference[p]+s.reference[f]-d[f]-s.floating[p],T=d[f]-s.reference[f],w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let S=w?w[y]:0;(!S||!await(o.isElement==null?void 0:o.isElement(w)))&&(S=a.floating[y]||s.floating[p]);const x=_/2-T/2,M=S/2-v[p]/2-1,E=eh(h[g],M),C=eh(h[b],M),O=E,$=S-v[p]-C,U=S/2-v[p]/2+x,j=Lv(O,U,$),W=!l.arrow&&Oh(r)!=null&&U!=j&&s.reference[p]/2-(U<O?E:C)-v[p]/2<0,q=W?U<O?U-O:U-$:0;return{[f]:d[f]+q,data:Ft({[f]:j,centerOffset:U-j-q},W&&{alignmentOffset:q}),reset:W}}}),pB=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,i;const{placement:r,middlewareData:s,rects:o,initialPlacement:a,platform:l,elements:c}=e,O=Lh(n,e),{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:v=!0}=O,m=nd(O,["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"]);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const g=Ea(r),b=Ea(a)===a,y=await(l.isRTL==null?void 0:l.isRTL(c.floating)),_=d||(b||!v?[ep(a)]:lB(a));!d&&p!=="none"&&_.push(...uB(a,v,p,y));const T=[a,..._],w=await XT(e,m),S=[];let x=((i=s.flip)==null?void 0:i.overflows)||[];if(u&&S.push(w[g]),h){const $=aB(r,o,y);S.push(w[$[0]],w[$[1]])}if(x=[...x,{placement:r,overflows:S}],!S.every($=>$<=0)){var M,E;const $=(((M=s.flip)==null?void 0:M.index)||0)+1,U=T[$];if(U)return{data:{index:$,overflows:x},reset:{placement:U}};let j=(E=x.filter(W=>W.overflows[0]<=0).sort((W,q)=>W.overflows[1]-q.overflows[1])[0])==null?void 0:E.placement;if(!j)switch(f){case"bestFit":{var C;const W=(C=x.map(q=>[q.placement,q.overflows.filter(ie=>ie>0).reduce((ie,Z)=>ie+Z,0)]).sort((q,ie)=>q[1]-ie[1])[0])==null?void 0:C[0];W&&(j=W);break}case"initialPlacement":j=a;break}if(r!==j)return{reset:{placement:j}}}return{}}}};async function mB(n,e){const{placement:t,platform:i,elements:r}=n,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),o=Ea(t),a=Oh(t),l=Dp(t)==="y",c=["left","top"].includes(o)?-1:1,u=s&&l?-1:1,h=Lh(e,n);let{mainAxis:d,crossAxis:f,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:Ft({mainAxis:0,crossAxis:0,alignmentAxis:null},h);return a&&typeof p=="number"&&(f=a==="end"?p*-1:p),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const gB=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){const{x:t,y:i}=e,r=await mB(e,n);return{x:t+r.x,y:i+r.y,data:r}}}},vB=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:i,placement:r}=e,m=Lh(n,e),{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:g=>{let{x:b,y}=g;return{x:b,y}}}}=m,l=nd(m,["mainAxis","crossAxis","limiter"]),c={x:t,y:i},u=await XT(e,l),h=Dp(Ea(r)),d=$T(h);let f=c[d],p=c[h];if(s){const g=d==="y"?"top":"left",b=d==="y"?"bottom":"right",y=f+u[g],_=f-u[b];f=Lv(y,f,_)}if(o){const g=h==="y"?"top":"left",b=h==="y"?"bottom":"right",y=p+u[g],_=p-u[b];p=Lv(y,p,_)}const v=a.fn(ti(Ft({},e),{[d]:f,[h]:p}));return ti(Ft({},v),{data:{x:v.x-t,y:v.y-i}})}}};function So(n){return YT(n)?(n.nodeName||"").toLowerCase():"#document"}function Fi(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Po(n){var e;return(e=(YT(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function YT(n){return n instanceof Node||n instanceof Fi(n).Node}function Cs(n){return n instanceof Element||n instanceof Fi(n).Element}function Xr(n){return n instanceof HTMLElement||n instanceof Fi(n).HTMLElement}function Ew(n){return typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Fi(n).ShadowRoot}function Ih(n){const{overflow:e,overflowX:t,overflowY:i,display:r}=sr(n);return/auto|scroll|overlay|hidden|clip/.test(e+i+t)&&!["inline","contents"].includes(r)}function _B(n){return["table","td","th"].includes(So(n))}function S_(n){const e=T_(),t=sr(n);return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(t.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(t.contain||"").includes(i))}function yB(n){let e=nc(n);for(;Xr(e)&&!Up(e);){if(S_(e))return e;e=nc(e)}return null}function T_(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Up(n){return["html","body","#document"].includes(So(n))}function sr(n){return Fi(n).getComputedStyle(n)}function Np(n){return Cs(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.pageXOffset,scrollTop:n.pageYOffset}}function nc(n){if(So(n)==="html")return n;const e=n.assignedSlot||n.parentNode||Ew(n)&&n.host||Po(n);return Ew(e)?e.host:e}function qT(n){const e=nc(n);return Up(e)?n.ownerDocument?n.ownerDocument.body:n.body:Xr(e)&&Ih(e)?e:qT(e)}function Iv(n,e,t){var i;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=qT(n),s=r===((i=n.ownerDocument)==null?void 0:i.body),o=Fi(r);return s?e.concat(o,o.visualViewport||[],Ih(r)?r:[],o.frameElement&&t?Iv(o.frameElement):[]):e.concat(r,Iv(r,[],t))}function KT(n){const e=sr(n);let t=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Xr(n),s=r?n.offsetWidth:t,o=r?n.offsetHeight:i,a=Qf(t)!==s||Qf(i)!==o;return a&&(t=s,i=o),{width:t,height:i,$:a}}function ZT(n){return Cs(n)?n:n.contextElement}function Wl(n){const e=ZT(n);if(!Xr(e))return Eo(1);const t=e.getBoundingClientRect(),{width:i,height:r,$:s}=KT(e);let o=(s?Qf(t.width):t.width)/i,a=(s?Qf(t.height):t.height)/r;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const bB=Eo(0);function JT(n){const e=Fi(n);return!T_()||!e.visualViewport?bB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function xB(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Fi(n)?!1:e}function th(n,e,t,i){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=ZT(n);let o=Eo(1);e&&(i?Cs(i)&&(o=Wl(i)):o=Wl(n));const a=xB(s,t,i)?JT(s):Eo(0);let l=(r.left+a.x)/o.x,c=(r.top+a.y)/o.y,u=r.width/o.x,h=r.height/o.y;if(s){const d=Fi(s),f=i&&Cs(i)?Fi(i):i;let p=d.frameElement;for(;p&&i&&f!==d;){const v=Wl(p),m=p.getBoundingClientRect(),g=sr(p),b=m.left+(p.clientLeft+parseFloat(g.paddingLeft))*v.x,y=m.top+(p.clientTop+parseFloat(g.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,h*=v.y,l+=b,c+=y,p=Fi(p).frameElement}}return tp({width:u,height:h,x:l,y:c})}function wB(n){let{rect:e,offsetParent:t,strategy:i}=n;const r=Xr(t),s=Po(t);if(t===s)return e;let o={scrollLeft:0,scrollTop:0},a=Eo(1);const l=Eo(0);if((r||!r&&i!=="fixed")&&((So(t)!=="body"||Ih(s))&&(o=Np(t)),Xr(t))){const c=th(t);a=Wl(t),l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+l.x,y:e.y*a.y-o.scrollTop*a.y+l.y}}function MB(n){return Array.from(n.getClientRects())}function QT(n){return th(Po(n)).left+Np(n).scrollLeft}function EB(n){const e=Po(n),t=Np(n),i=n.ownerDocument.body,r=Gl(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Gl(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let o=-t.scrollLeft+QT(n);const a=-t.scrollTop;return sr(i).direction==="rtl"&&(o+=Gl(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:o,y:a}}function SB(n,e){const t=Fi(n),i=Po(n),r=t.visualViewport;let s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;const c=T_();(!c||c&&e==="fixed")&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a,y:l}}function TB(n,e){const t=th(n,!0,e==="fixed"),i=t.top+n.clientTop,r=t.left+n.clientLeft,s=Xr(n)?Wl(n):Eo(1),o=n.clientWidth*s.x,a=n.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:o,height:a,x:l,y:c}}function Sw(n,e,t){let i;if(e==="viewport")i=SB(n,t);else if(e==="document")i=EB(Po(n));else if(Cs(e))i=TB(e,t);else{const r=JT(n);i=ti(Ft({},e),{x:e.x-r.x,y:e.y-r.y})}return tp(i)}function eA(n,e){const t=nc(n);return t===e||!Cs(t)||Up(t)?!1:sr(t).position==="fixed"||eA(t,e)}function AB(n,e){const t=e.get(n);if(t)return t;let i=Iv(n,[],!1).filter(a=>Cs(a)&&So(a)!=="body"),r=null;const s=sr(n).position==="fixed";let o=s?nc(n):n;for(;Cs(o)&&!Up(o);){const a=sr(o),l=S_(o);!l&&a.position==="fixed"&&(r=null),(s?!l&&!r:!l&&a.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Ih(o)&&!l&&eA(n,o))?i=i.filter(u=>u!==o):r=a,o=nc(o)}return e.set(n,i),i}function CB(n){let{element:e,boundary:t,rootBoundary:i,strategy:r}=n;const o=[...t==="clippingAncestors"?AB(e,this._c):[].concat(t),i],a=o[0],l=o.reduce((c,u)=>{const h=Sw(e,u,r);return c.top=Gl(h.top,c.top),c.right=eh(h.right,c.right),c.bottom=eh(h.bottom,c.bottom),c.left=Gl(h.left,c.left),c},Sw(e,a,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function PB(n){return KT(n)}function RB(n,e,t){const i=Xr(e),r=Po(e),s=t==="fixed",o=th(n,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Eo(0);if(i||!i&&!s)if((So(e)!=="body"||Ih(r))&&(a=Np(e)),i){const c=th(e,!0,s,e);l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}else r&&(l.x=QT(r));return{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Tw(n,e){return!Xr(n)||sr(n).position==="fixed"?null:e?e(n):n.offsetParent}function tA(n,e){const t=Fi(n);if(!Xr(n))return t;let i=Tw(n,e);for(;i&&_B(i)&&sr(i).position==="static";)i=Tw(i,e);return i&&(So(i)==="html"||So(i)==="body"&&sr(i).position==="static"&&!S_(i))?t:i||yB(n)||t}const LB=async function(n){let{reference:e,floating:t,strategy:i}=n;const r=this.getOffsetParent||tA,s=this.getDimensions;return{reference:RB(e,await r(t),i),floating:Ft({x:0,y:0},await s(t))}};function OB(n){return sr(n).direction==="rtl"}const IB={convertOffsetParentRelativeRectToViewportRelativeRect:wB,getDocumentElement:Po,getClippingRect:CB,getOffsetParent:tA,getElementRects:LB,getClientRects:MB,getDimensions:PB,getScale:Wl,isElement:Cs,isRTL:OB},DB=(n,e,t)=>{const i=new Map,r=Ft({platform:IB},t),s=ti(Ft({},r.platform),{_c:i});return dB(n,e,ti(Ft({},r),{platform:s}))},nh={zIndex:2e3,nextZIndex(){return++nh.zIndex}},UB={bottom:"up",top:"down",left:"right",right:"left"};var NB=(n,e)=>{const[t,i]=ka(n,e),r=be(null),s=be(),o=be(),a=be(),l=li({zIndex:nh.nextZIndex()}),c=be(n.placement),u=be(!0),h=Te(()=>{const p=c.value;return"fes-slide-".concat(UB[p.split("-")[0]])}),d=()=>{Yf(n.disabled)&&n.disabled||jr(n.disabled)&&n.disabled()||t.value&&(l.zIndex=nh.nextZIndex(),$r(()=>{const p=r.value?{getBoundingClientRect:()=>r.value&&{width:0,height:0,top:r.value.y,right:r.value.x,bottom:r.value.y,left:r.value.x},contextElement:Qu(s.value)}:Qu(s.value),v=o.value;DB(p,v,{placement:n.placement,middleware:[gB(n.offset),pB(),vB(),n.arrow&&fB({element:a.value})].filter(Boolean)}).then(m=>{if(c.value!==m.placement){u.value=!1,$r(()=>{u.value=!0}),c.value=m.placement;return}if(c.value=m.placement,Object.assign(v.style,{left:"".concat(m.x,"px"),top:"".concat(m.y,"px")}),n.arrow){const{x:g,y:b}=m.middlewareData.arrow,y={top:"bottom",right:"left",bottom:"top",left:"right"}[m.placement.split("-")[0]];Object.assign(a.value.style,{left:g!=null?"".concat(g,"px"):"",top:b!=null?"".concat(b,"px"):"",right:"",bottom:"",[y]:"-3px"})}})}))},f=p=>{r.value=p};return ft(r,d),_n(d),iS(d),{visible:t,updateVisible:i,triggerRef:s,popperRef:o,arrowRef:a,popperStyle:l,computePopper:d,updateVirtualRect:f,cacheVisible:u,transitionName:h}};function FB(n,e){let t=[];const i=()=>{let s=n.value;for(;s=ST(s),s!==null;)t.push(s);for(const o of t)o.addEventListener("scroll",e,!0)},r=()=>{for(const s of t)s.removeEventListener("scroll",e,!0);t=[]};_n(()=>{i()}),Si(()=>{r()})}const A_={modelValue:{type:Boolean,default:!1},trigger:{type:String,default:"hover"},placement:{type:String,default:"bottom"},offset:{type:Number,default:6},disabled:{type:[Boolean,Function],default:!1},arrow:{type:Boolean,default:!1},appendToContainer:{type:Boolean,default:!0},popperClass:[String,Array,Object],showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},getContainer:{type:Function},lazy:{type:Boolean,default:!0},onlyShowTrigger:{type:Boolean}};function Aw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function kB(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Aw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Aw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Km=qt("popper");var C_=qe({name:"FPopper",props:A_,emits:[Ip],setup(n,e){let{slots:t,emit:i}=e;if(ci(),!t.trigger)throw new Error("[FPopper]: Trigger must be provided");const r=DT(),s=Te(()=>{var x;return n.getContainer||((x=r.getContainer)===null||x===void 0?void 0:x.value)}),{visible:o,updateVisible:a,triggerRef:l,popperRef:c,arrowRef:u,computePopper:h,popperStyle:d,updateVirtualRect:f,cacheVisible:p,transitionName:v}=NB(n,i),m=Te(()=>(Yf(n.disabled)?n.disabled:!1)||!o.value),g=Te(()=>{const x=Qu(l.value);if(x instanceof Text)throw TypeError("FPopper: trigger must be a Element, but get Text(".concat(x.nodeValue,")"));return x});FB(g,x=>{var M;m.value||jr(n.disabled)&&n.disabled()||n.appendToContainer&&x.target!==((M=s.value)===null||M===void 0?void 0:M.call(s))&&h()}),nB([l,c],()=>{a(!1)},m),Jf(g,h,m),Jf(Te(()=>Qu(c.value)),h,m);const{events:b,onPopperMouseEnter:y,onPopperMouseLeave:_}=rB(o,a,n,f),T=Te(()=>[Km,n.popperClass].filter(Boolean)),w=()=>{var x;const M=kT((x=t.trigger)===null||x===void 0?void 0:x.call(t));if(M)return xr(M,kB({ref:l},b.value),!0)},S=()=>{var x;return ne("div",{class:T.value},[(x=t.default)===null||x===void 0?void 0:x.call(t),n.arrow&&ne("div",{ref:u,class:"".concat(Km,"-arrow")},null)])};return()=>{var x;return ne(Kt,null,[w(),ne(tB,{to:(x=s.value)===null||x===void 0?void 0:x.call(s),disabled:!n.appendToContainer,show:!n.lazy||o.value},{default:()=>[ne("div",{ref:c,class:"".concat(Km,"-wrapper"),style:d,role:"tooltip",onMouseenter:y,onMouseleave:_},[ne(gc,{name:v.value,type:"animation",appear:!0,onBeforeEnter:h},{default:()=>[Hu(ne(S,null,null),[[$u,o.value&&p.value]])]})])]})])}}});function Cw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Au(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Bo=qt("tooltip"),nA={okText:"确定",cancelText:"取消",icon:ne(CT,null,null)},BB=Au(Au({},A_),{},{title:[Number,String],content:[Number,String],mode:{type:String,default:"text"},confirmOption:{type:Object,default:()=>nA},arrow:{type:Boolean,default:!0},offset:{type:Number,default:8}});var zB=qe({name:"FTooltip",props:BB,emits:[Jx,Qx,Ip],setup(n,e){ci();const[t,i]=ka(n,e.emit);function r(){return{trigger:e.slots.default}}function s(l,c){i(!1),e.emit(l,c)}function o(){var l,c,u,h,d,f;const p=(l=(c=e.slots)===null||c===void 0||(u=c.content)===null||u===void 0?void 0:u.call(c))!==null&&l!==void 0?l:n.content,v=(h=(d=e.slots)===null||d===void 0||(f=d.title)===null||f===void 0?void 0:f.call(d))!==null&&h!==void 0?h:n.title,m=n.mode==="confirm",g=n.mode==="popover";if(n.mode==="text")return p;if(m||g){const b=Au(Au({},nA),n.confirmOption),y=["".concat(Bo,"-modal-body"),m&&"is-confirm",v&&"has-header"].filter(Boolean).join(" ");return ne(Kt,null,[v&&ne("div",{class:"".concat(Bo,"-modal-header ").concat(m&&"is-confirm")},[m&&ne("div",{class:"".concat(Bo,"-modal-icon")},[b.icon]),v]),m_(p)?p:ne("div",{class:y},[p]),m&&ne(Kt,null,[ne(Pv,{class:"".concat(Bo,"-modal-btn"),onClick:_=>s(Jx,_),size:"small",type:"primary"},{default:()=>[b.okText]}),ne(Pv,{class:"".concat(Bo,"-modal-btn"),onClick:_=>s(Qx,_),size:"small"},{default:()=>[b.cancelText]})])])}}const a=Te(()=>{const l={};return Object.keys(A_).forEach(c=>{l[c]=n[c]}),n.mode==="confirm"&&(l.trigger="click"),l});return()=>ne(C_,wr(a.value,{modelValue:t.value,"onUpdate:modelValue":l=>t.value=l,popperClass:[Bo,"".concat(Bo,"-").concat(n.mode),a.value.popperClass]}),Au({default:()=>[o()]},r()))}});const Pw=Rr(zB),VB=qt("ellipsis"),HB={content:[Number,String],line:{type:[Number,String],default:1},tooltip:{type:[Boolean,Object],default:()=>({showAfter:500})},class:[String,Array,Object],style:{type:[String,Array,Object],default(){return{}}}};var ih=qe({name:"FEllipsis",components:{Tooltip:Pw},props:HB,setup(n,e){let{slots:t}=e;ci();const i=be(),r=be(),s=Te(()=>[VB,n.class].filter(Boolean)),o=Te(()=>Number(n.line)),a=Te(()=>{const d=o.value>1?{display:"-webkit-inline-box","-webkit-line-clamp":o.value,"-webkit-box-orient":"vertical"}:{"text-overflow":"ellipsis","white-space":"nowrap"};return[n.style,d]}),l=Te(()=>wa(n.tooltip)?n.tooltip:{}),c=()=>{let d=!0;const{value:f}=i;if(!f)return!0;const{offsetHeight:p,scrollHeight:v,offsetWidth:m}=f;if(p&&m)if(o.value>1)d=v>p;else{const{value:g}=r;d=g.getBoundingClientRect().width>f.getBoundingClientRect().width}return!d},u=()=>{var d,f,p,v;return ne("span",{ref:i,class:s.value,style:a.value},[o.value>1?(d=(f=t.default)===null||f===void 0?void 0:f.call(t))!==null&&d!==void 0?d:n.content:ne("span",{ref:r},[(p=(v=t.default)===null||v===void 0?void 0:v.call(t))!==null&&p!==void 0?p:n.content])])},h=()=>n.content;return()=>{var d,f;return n.tooltip?ne(Pw,wr({placement:"top",disabled:c},l.value),{default:()=>[u()],content:(d=(f=t.tooltip)!==null&&f!==void 0?f:t.default)!==null&&d!==void 0?d:h}):u()}}}),Rw=qe({name:"FadeInExpandTransition",props:{appear:Boolean,group:Boolean,mode:String,onLeave:Function,onAfterLeave:Function,onAfterEnter:Function,width:Boolean,reverse:Boolean},setup(n,e){let{slots:t}=e;function i(l){n.width?l.style.maxWidth="".concat(l.offsetWidth,"px"):l.style.maxHeight="".concat(l.offsetHeight,"px"),l.offsetWidth}function r(l){n.width?l.style.maxWidth="0":l.style.maxHeight="0",l.offsetWidth;const{onLeave:c}=n;c&&c()}function s(l){n.width?l.style.maxWidth="":l.style.maxHeight="";const{onAfterLeave:c}=n;c&&c()}function o(l){if(l.style.transition="none",n.width){const c=l.offsetWidth;l.style.maxWidth="0",l.offsetWidth,l.style.transition="",l.style.maxWidth="".concat(c,"px")}else if(n.reverse)l.style.maxHeight="".concat(l.offsetHeight,"px"),l.offsetHeight,l.style.transition="",l.style.maxHeight="0";else{const c=l.offsetHeight;l.style.maxHeight="0",l.offsetWidth,l.style.transition="",l.style.maxHeight="".concat(c,"px")}l.offsetWidth}function a(l){var c;n.width?l.style.maxWidth="":n.reverse||(l.style.maxHeight=""),(c=n.onAfterEnter)===null||c===void 0||c.call(n)}return()=>{const l=n.group?d_:gc;return wo(l,{name:n.width?"fes-fade-in-width-expand":"fes-fade-in-height-expand",mode:n.mode,appear:n.appear,onEnter:o,onAfterEnter:a,onBeforeLeave:i,onLeave:r,onAfterLeave:s},t)}}});const Lw=qt("divider"),GB={vertical:{type:Boolean,default:!1},titlePlacement:{type:String,default:"center"}};var WB=qe({name:"FDivider",props:GB,setup(n,e){let{slots:t}=e;ci();const i=Te(()=>[Lw,n.vertical&&"is-vertical"].filter(Boolean).join(" "));return()=>{var r;return ne("div",{class:i.value},[n.vertical?null:ne("div",{class:"".concat(Lw,"-text is-").concat(n.titlePlacement)},[(r=t.default)===null||r===void 0?void 0:r.call(t)])])}}});const gK=Rr(WB);const ja=qt("dropdown"),$B={visible:{type:Boolean,default:!1},appendToContainer:{type:Boolean,default:!0},getContainer:{type:Function},trigger:{type:String,default:"hover"},placement:{type:String,default:"bottom"},offset:{type:Number,default:6},options:{type:Array,default(){return[]}},disabled:{type:Boolean,default:!1},valueField:{type:String,default:"value"},labelField:{type:String,default:"label"},arrow:{type:Boolean,default:!1},showSelectedOption:{type:Boolean,default:!1}};var jB=qe({name:"FDropdown",props:$B,emits:["click","visibleChange","update:visible"],setup(n,e){let{slots:t,emit:i}=e;ci();const r=be(),[s,o]=ka(n,i,{prop:"visible"}),a=Te(()=>n.options.some(u=>u.icon)),l=(u,h)=>{if(h.stopPropagation(),u.disabled)return;const d=u[n.valueField];r.value=d,o(!1),i("click",d)};ft(s,()=>{i("visibleChange",s.value)});const c=()=>ne("div",{class:["".concat(ja,"-option-wrapper"),a.value?"has-icon":""]},[n.options.map(u=>{var h;const d=u[n.valueField],f=u[n.labelField],p=n.showSelectedOption&&r.value===d,v=["".concat(ja,"-option"),u.disabled&&"is-disabled",p&&"is-checked"].filter(Boolean);return ne("div",{class:v,onClick:m=>{l(u,m)}},[u.icon&&ne("span",{class:"".concat(ja,"-option-icon")},[(h=u.icon)===null||h===void 0?void 0:h.call(u)]),ne("span",{class:"".concat(ja,"-option-label")},[jr(f)?f(u):f]),p&&ne(NF,{class:"".concat(ja,"-checked-icon")},null)])})]);return()=>ne(C_,{modelValue:s.value,"onUpdate:modelValue":u=>s.value=u,trigger:n.trigger,placement:n.placement,popperClass:"".concat(ja,"-popper"),appendToContainer:n.appendToContainer,getContainer:n.getContainer,offset:n.offset,disabled:n.disabled,arrow:n.arrow},{default:c,trigger:t.default})}});const vK=Rr(jB);let $t=function(n){return n.LAYOUT="FLayout",n.HEADER="FHeader",n.FOOTER="FFooter",n.ASIDE="FAside",n.MAIN="FMain",n}({});const XB={embedded:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1},containerClass:[Array,Object,String],containerStyle:Object},ic=Symbol("FLayout");function Ow(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Iw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ow(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ow(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Zm=qt("layout");var P_=qe({name:$t.LAYOUT,props:XB,setup(n){ci();const e=be(!0),t=Xt(ic,null);t&&(e.value=!1,t.addChild({type:$t.LAYOUT}));const i=li([]),r=c=>{i.push(c)},s=Te(()=>i.length?i.some(c=>c.type===$t.ASIDE):!1),o=Te(()=>{if(i.length>0){if(i[0].type===$t.ASIDE)return"left";if(i[i.length-1].type===$t.ASIDE)return"right"}return""}),a=Te(()=>[Zm,s.value&&"is-horizontal",n.fixed&&"is-fixed",e.value&&"is-root"].filter(Boolean)),l=Te(()=>{const c="".concat(Zm,"-container");return rT(n.containerClass)?Iw({[c]:!0},n.containerClass):Ts(n.containerClass)?[c,...n.containerClass]:bT(n.containerClass)?[c,n.containerClass]:[c]});return bi(ic,Iw({addChild:r,asidePlacement:o},Ar(n))),{prefixCls:Zm,classList:a,containerClassRef:l}}});function YB(n,e,t,i,r,s){return rt(),Mt("section",{class:Wt(n.classList)},[Kn("div",{class:Wt(n.containerClassRef),style:Dn(n.containerStyle)},[wi(n.$slots,"default")],6)],2)}P_.render=YB;P_.__file="components/layout/layout.vue";const qB=qt("layout"),KB={inverted:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1}};var Fp=qe({name:$t.HEADER,props:KB,setup(n){const e=En();(!e.parent||!e.parent.type||e.parent.type.name!==$t.LAYOUT)&&console.warn("[".concat($t.HEADER,"] must be a child of ").concat($t.LAYOUT));const{addChild:t}=Xt(ic,{addChild:As});return t({type:$t.HEADER}),{classList:Te(()=>["".concat(qB,"-header"),n.fixed&&"is-fixed",n.inverted&&"is-inverted",n.bordered&&"is-bordered"].filter(Boolean))}}});function ZB(n,e,t,i,r,s){return rt(),Mt("header",{class:Wt(n.classList)},[wi(n.$slots,"default")],2)}Fp.render=ZB;Fp.__file="components/layout/header.vue";const JB=qt("layout"),QB={embedded:{type:Boolean,default:!1}};var kp=qe({name:$t.MAIN,props:QB,setup(n){const e=En();(!e.parent||!e.parent.type||e.parent.type.name!==$t.LAYOUT)&&console.warn("[".concat($t.MAIN,"] must be a child of ").concat($t.LAYOUT));const{addChild:t,embedded:i}=Xt(ic,{addChild:As,embedded:be(!1)});return t({type:$t.MAIN}),{classList:Te(()=>["".concat(JB,"-main"),(i.value||n.embedded)&&"is-embedded"].filter(Boolean))}}});function e4(n,e,t,i,r,s){return rt(),Mt("main",{class:Wt(n.classList)},[wi(n.$slots,"default")],2)}kp.render=e4;kp.__file="components/layout/main.vue";const Dw=qt("layout"),t4={collapsible:{type:Boolean,default:!1},collapsedWidth:{type:String,default:"48px"},width:{type:String,default:"200px"},fixed:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},showTrigger:{type:Boolean,default:!0}};var Bp=qe({name:$t.ASIDE,components:{FScrollbar:Qk,LeftOutlined:BF,RightOutlined:RT},props:t4,emits:["update:collapsed"],setup(n,e){let{emit:t}=e;const i=En();(!i.parent||!i.parent.type||i.parent.type.name!==$t.LAYOUT)&&console.warn("[".concat($t.ASIDE,"] must be a child of ").concat($t.LAYOUT));const{addChild:r,asidePlacement:s}=Xt(ic,{addChild:As,asidePlacement:be("")}),[o,a]=ka(n,t,{prop:"collapsed"}),l=Te(()=>["".concat(Dw,"-aside"),n.fixed&&"is-fixed",n.collapsible&&n.showTrigger&&"is-has-trigger",n.inverted&&"is-inverted",n.collapsible&&o.value&&"is-collapsed",s.value&&"is-placement-".concat(s.value),n.bordered&&"is-bordered"].filter(Boolean)),c=Te(()=>({width:n.collapsible&&o.value?n.collapsedWidth:n.width})),u=()=>{a(!o.value)};return r({type:$t.ASIDE}),{prefixCls:Dw,classList:l,style:c,handleTrigger:u,asidePlacement:s,currentCollapsed:o}}});function n4(n,e,t,i,r,s){const o=vu("FScrollbar"),a=vu("LeftOutlined"),l=vu("RightOutlined");return rt(),Mt("aside",{class:Wt(n.classList),style:Dn(n.style)},[ne(o,{style:Dn([n.collapsible&&n.showTrigger&&{height:"calc(100% - 48px)"}]),"thumb-style":[n.inverted&&{backgroundColor:"#fff"}]},{default:Mp(()=>[wi(n.$slots,"default")]),_:3},8,["style","thumb-style"]),n.collapsible&&n.showTrigger?(rt(),Mt("div",{key:0,class:Wt("".concat(n.prefixCls,"-aside-trigger")),onClick:e[0]||(e[0]=function(){return n.handleTrigger&&n.handleTrigger(...arguments)})},[n.asidePlacement==="left"?(rt(),Mt(Kt,{key:0},[n.currentCollapsed?(rt(),Br(l,{key:1})):(rt(),Br(a,{key:0}))],64)):(rt(),Mt(Kt,{key:1},[n.currentCollapsed?(rt(),Br(a,{key:0})):(rt(),Br(l,{key:1}))],64))],2)):Ii("v-if",!0)],6)}Bp.render=n4;Bp.__file="components/layout/aside.vue";const i4=qt("layout"),r4={embedded:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1}};var zp=qe({name:$t.FOOTER,props:r4,setup(n){const e=En();(!e.parent||!e.parent.type||e.parent.type.name!==$t.LAYOUT)&&console.warn("[".concat($t.FOOTER,"] must be a child of ").concat($t.LAYOUT));const{addChild:t,embedded:i}=Xt(ic,{addChild:As,embedded:be(!1)});return t({type:$t.FOOTER}),{classList:Te(()=>["".concat(i4,"-footer"),n.bordered&&"is-bordered",(i.value||n.embedded)&&"is-embedded",n.fixed&&"is-fixed"].filter(Boolean))}}});function s4(n,e,t,i,r,s){return rt(),Mt("footer",{class:Wt(n.classList)},[wi(n.$slots,"default")],2)}zp.render=s4;zp.__file="components/layout/footer.vue";const _K=Rr(P_,{Header:Fp,Main:kp,Aside:Bp,Footer:zp}),yK=Co(Fp),bK=Co(kp),xK=Co(Bp),wK=Co(zp);const o4=["horizontal","vertical"],mn={MENU:"FMenu",SUB_MENU:"FSubMenu",MENU_ITEM:"FMenuItem",MENU_GROUP:"FMenuGroup"},iA=Symbol("FMenuChildren"),rA=Symbol("SUB_MENU_KEY"),Uw=Symbol("FMenu"),a4={modelValue:{type:[String,Number]},mode:{type:String,default:o4[0]},collapsed:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},expandedKeys:{type:Array,default:()=>[]},accordion:{type:Boolean,default:!1},options:{type:Array,default(){return[]}}};var R_=()=>{const n=li([]);return bi(iA,{addChild:i=>{n.every(r=>r.uid!==i.uid)&&n.push(i)},removeChild:i=>{const r=n.findIndex(s=>s.uid===i.uid);r!==-1&&n.splice(r,1)}}),{children:n}},Vp=n=>{var e;n=(e=n)!==null&&e!==void 0?e:En();const t={name:n.type.name,uid:n.props.value||n.uid},{parentPath:i}=Xt(Uw,{parentPath:Te(()=>[])}),r=Te(()=>i.value.concat(t));return bi(Uw,{parentPath:r}),{indexPath:r}},L_=n=>{const e=Xt("rootMenu",null),t=Xt(iA,null),i=Te(()=>{if(e.renderWithPopper.value)return{};let o=16;const a=n.value.length;if(a>2)for(let l=a-2;l>=0;l--){const c=n.value[l];c.name===mn.SUB_MENU&&(o+=14),c.name===mn.MENU_GROUP&&(o+=8)}return{paddingLeft:"".concat(o,"px")}}),r=Te(()=>n.value.length<3),s=Te(()=>e.props.mode!=="vertical"?!1:r.value&&e.props.collapsed);return{rootMenu:e,parentMenu:t,paddingStyle:i,onlyIcon:s,isFirstLevel:r,indexPath:n}};const Nw=qt("menu-group"),l4={label:{type:String}};var O_=qe({name:mn.MENU_GROUP,props:l4,setup(n,e){let{slots:t}=e;const i=En(),{indexPath:r}=Vp(i),{rootMenu:s,parentMenu:o,paddingStyle:a}=L_(r);s||console.warn("[".concat(mn.MENU_GROUP,"] must be a child of ").concat(mn.MENU)),o||console.warn("[".concat(mn.MENU_GROUP,"] must be a child of ").concat(mn.MENU," or ").concat(mn.SUB_MENU));const{children:l}=R_(),c=Te(()=>l.some(d=>d==null?void 0:d.isActive)),u={uid:i.uid,type:"menuGroup",children:l,isActive:c};_n(()=>{o.addChild(u)}),Cr(()=>{o.removeChild(u)});const h=()=>{var d;return ne(ih,{class:"".concat(Nw,"-label"),style:a.value},{default:()=>[((d=t.label)===null||d===void 0?void 0:d.call(t))||n.label]})};return()=>{var d;return ne("div",{class:Nw},[h(),(d=t.default)===null||d===void 0?void 0:d.call(t)])}}});const yd=qt("menu-item");var I_=qe({name:mn.MENU_ITEM,components:{Ellipsis:ih},props:{value:{type:[String,Number],required:!0},label:String},setup(n,e){let{slots:t}=e;const i=En(),{indexPath:r}=Vp(i),{rootMenu:s,parentMenu:o,paddingStyle:a,onlyIcon:l}=L_(r),{handleItemClick:c}=Xt(rA,{handleItemClick:As});s||console.warn("[".concat(mn.MENU_ITEM,"] must be a child of ").concat(mn.MENU)),o||console.warn("[".concat(mn.MENU_ITEM,"] must be a child of ").concat(mn.MENU," or ").concat(mn.SUB_MENU));const u=Te(()=>s.currentValue.value===n.value),h={uid:i.uid,type:"menu",value:n.value,isActive:u};_n(()=>{o.addChild(h)}),Cr(()=>{o.removeChild(h)});const d=Te(()=>[yd,u.value&&"is-active"].filter(Boolean).join(" ")),f=()=>{s.clickMenuItem(n.value),c()},p=()=>{var m;return ne(ih,{class:"".concat(yd,"-label")},{default:()=>[((m=t.label)===null||m===void 0?void 0:m.call(t))||n.label]})},v=()=>t.icon?ne("span",{class:"".concat(yd,"-icon")},[t.icon()]):l.value?p():null;return()=>ne("div",{class:d.value,onClick:f},[ne("div",{class:"".concat(yd,"-wrapper"),style:a.value},[v(),l.value?null:p()])])}});const Vs=qt("sub-menu");var D_=qe({name:mn.SUB_MENU,components:{Ellipsis:ih,FadeInExpandTransition:Rw},props:{value:{type:[String,Number],default:null},label:String},setup(n,e){let{slots:t}=e;const i=En(),{indexPath:r}=Vp(i),s=be(null),{rootMenu:o,parentMenu:a,paddingStyle:l,isFirstLevel:c,onlyIcon:u}=L_(r);o||console.warn("[".concat(mn.SUB_MENU,"] must be a child of ").concat(mn.MENU)),a||console.warn("[".concat(mn.SUB_MENU,"] must be a child of ").concat(mn.MENU," or ").concat(mn.SUB_MENU));const{children:h}=R_(),d=be(!1),f=Te(()=>h.some(x=>x==null?void 0:x.isActive)),p={uid:i.uid,value:n.value,type:"subMenu",children:h,isOpened:d,isActive:f};_n(()=>{a.addChild(p)}),Cr(()=>{a.removeChild(p)}),bi(rA,{handleItemClick:()=>{o.renderWithPopper.value&&(d.value=!1)}});const v=Te(()=>o.props.mode==="horizontal"&&c.value?"bottom-start":"right-start"),m=Te(()=>[Vs,f.value&&"is-active"].filter(Boolean).join(" ")),g=()=>{d.value=!d.value,o.clickSubMenu(p,r)};ft(o.currentExpandedKeys,()=>{if(!o.renderWithPopper.value){const x=o.currentExpandedKeys.value.indexOf(n.value||i.uid);x===-1&&d.value?d.value=!1:x!==-1&&!d.value&&(d.value=!0)}},{immediate:!0});const b=()=>{var x;return ne(ih,{class:"".concat(Vs,"-label")},{default:()=>[((x=t.label)===null||x===void 0?void 0:x.call(t))||n.label]})},y=()=>t.icon?ne("div",{class:"".concat(Vs,"-icon")},[t.icon()]):u.value?b():null,_=()=>o.renderWithPopper.value&&!c.value?ne("span",{class:"".concat(Vs,"-arrow")},[ne(RT,null,null)]):ne("span",{class:["".concat(Vs,"-arrow"),d.value&&"is-opened"]},[ne(FF,null,null)]),T=x=>ne("div",{class:"".concat(Vs,"-wrapper"),style:l.value,onClick:()=>{x==="click"&&g()}},[y(),u.value?null:b(),u.value?null:_()]),w=()=>{var x;return(x=t.default)===null||x===void 0?void 0:x.call(t)},S=()=>o.renderWithPopper.value?ne(C_,{modelValue:d.value,"onUpdate:modelValue":x=>d.value=x,trigger:"hover",onlyShowTrigger:!0,placement:v.value,popperClass:"".concat(Vs,"-popper"),offset:1},{default:w,trigger:T}):ne(Kt,null,[T("click"),ne(Rw,null,{default:()=>[Hu(ne("div",{class:"".concat(Vs,"-children")},[w()]),[[$u,d.value]])]})]);return()=>ne("div",{class:m.value,ref:s},[S()])}});function Fw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function kw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Fw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const c4=qt("menu");var u4=qe({name:mn.MENU,props:a4,emits:["select",Ip,"update:expandedKeys"],setup(n,e){let{emit:t,slots:i}=e;ci(),Vp();const[r,s]=ka(n,t),[o,a]=eB(n,t,{prop:"expandedKeys"}),l=Te(()=>n.mode==="horizontal"?!0:n.collapsed),{children:c}=R_(),u=m=>{s(m),t("select",{value:m}),l.value&&c.forEach(g=>{g.type==="subMenu"&&(g.isOpened=!1)})},h=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).reduce((g,b)=>{var y;if(b.type==="subMenu"&&g.push(b.value||b.uid),(y=b.children)!==null&&y!==void 0&&y.length){const _=h(b.children);LF(g,_)}return g},[])};_n(()=>{if(n.defaultExpandAll&&o.value.length===0){const m=h(c);a(m)}}),bi("rootMenu",{props:n,currentValue:r,clickMenuItem:u,clickSubMenu:(m,g)=>{m.isOpened.value&&n.accordion&&a(o.value.filter(b=>g.value.some(y=>y.uid===b))),a(m.value||m.uid)},renderWithPopper:l,currentExpandedKeys:o,updateExpandedKeys:a});const f=Te(()=>[c4,"is-".concat(n.mode),n.inverted&&"is-inverted",n.mode==="vertical"&&n.collapsed&&"is-collapsed"].filter(Boolean)),p=m=>m.map(g=>{const b={};return jr(g.icon)&&(b.icon=g.icon),b.label=()=>jr(g.label)?g.label():g.label,g.children?g.isGroup?ne(O_,null,kw({default:()=>[p(g.children)]},b)):ne(D_,{value:g.value},kw({default:()=>[p(g.children)]},b)):ne(I_,{value:g.value},b)}),v=()=>{if(n.options.length===0){var m;return(m=i.default)===null||m===void 0?void 0:m.call(i)}return p(n.options)};return()=>ne("div",{class:f.value},[v()])}});const MK=Rr(u4,{MenuItem:I_,MenuGroup:O_,SubMenu:D_});Co(I_);Co(O_);Co(D_);function Bw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function zw(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Bw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Xa=qt("message"),sA={duration:3,getContainer:()=>document.body,top:"24px",colorful:!1};let Rl=sA,ao=null;const Vw=li({zIndex:0,top:Rl.top});function h4(n){var e,t;let{type:i,content:r,duration:s,icon:o,closable:a,afterClose:l,colorful:c}=n;Vw.zIndex=nh.nextZIndex();let u=null;function h(){var p,v;u&&((p=ao)===null||p===void 0||p.remove((v=u)===null||v===void 0?void 0:v.key)),u=null}function d(){var p,v;u&&((p=ao)===null||p===void 0||p.remove((v=u)===null||v===void 0?void 0:v.key)),u=null}function f(){const p=["".concat(Xa)];c||c!==!1&&Rl.colorful||p.push("".concat(Xa,"-no-colorful")),a&&p.push("".concat(Xa,"-close"));const v=typeof r=="function",g={default:v?r:null,icon:typeof o=="function"?o:null};u=ao.append({afterRemove:l,duration:s!=null&&s>=0?s:Rl.duration,style:{zIndex:nh.nextZIndex()},children:ne("div",{class:"".concat(Xa,"-item")},[ne(mk,{class:p,type:i,message:v?"":r,showIcon:!0,closable:a,onClose:h},g)])})}return(e=ao)!==null&&e!==void 0&&(t=e.exited)!==null&&t!==void 0&&t.call(e)?f():fk({getContainer:Rl.getContainer,transitionName:"".concat(Xa),class:"".concat(Xa,"-wrapper"),maxCount:Rl.maxCount,style:Vw}).then(p=>{ao=p,f()}),{destroy:d}}function Hc(n,e,t){const i={type:n};return typeof e=="string"?(i.content=e,i.duration=t):Object.assign(i,e),h4(i)}const EK={config(n){n&&(Rl=zw(zw({},sA),n))},info:(n,e)=>Hc("info",n,e),success:(n,e)=>Hc("success",n,e),warning:(n,e)=>Hc("warning",n,e),warn:(n,e)=>Hc("warning",n,e),error:(n,e)=>Hc("error",n,e),destroy(){ao&&ao.destroy(),ao=null}};const Gc=qt("spin"),d4={size:{type:String,default:"middle"},description:{type:String},stroke:{type:String},delay:{type:Number,default:0},show:{type:Boolean,default:!0}};var f4=qe({name:"FSpin",props:d4,setup(n,e){let{slots:t}=e;ci();const i=be(n.show);let r;function s(){clearTimeout(r)}const o=()=>{i.value=!1},a=()=>{n.delay?r=setTimeout(()=>{i.value=!0},n.delay):i.value=!0};ft(()=>n.show,f=>{s(),f?a():o()}),Cr(()=>{s()});const c=Te(()=>{const f={};return n.stroke&&(f.color=n.stroke),f}),u=()=>{var f;return((f=t.icon)===null||f===void 0?void 0:f.call(t))||ne(PT,null,null)},h=()=>{var f;return!t.description&&!n.description?null:ne("span",{class:"".concat(Gc,"-description")},[((f=t.description)===null||f===void 0?void 0:f.call(t))||n.description])},d=()=>ne("div",{class:"".concat(Gc," is-size-").concat(n.size),style:c.value},[u()]);return()=>{var f;return t.default?ne("div",{class:"".concat(Gc,"-container ").concat(i.value?"is-spinning":"")},[ne("div",{class:"".concat(Gc,"-content")},[(f=t.default)===null||f===void 0?void 0:f.call(t)]),ne("div",{class:"".concat(Gc,"-wrapper")},[d(),h()])]):i.value?d():null}}});const SK=Rr(f4);function p4(n){function e(i){const r=i.currentTarget;!r||!(r.offsetWidth<r.scrollWidth)||i.deltaY===0||(r.scrollLeft+=i.deltaY+i.deltaX,i.preventDefault())}function t(i){var r;(r=n.value)===null||r===void 0||r.scrollTo(i)}return _n(()=>{n.value.addEventListener("wheel",e)}),Cr(()=>{n.value.removeEventListener("wheel",e)}),{scrollTo:t}}const U_=Symbol("FTabs"),oA={key:[String,Number,Symbol],value:{type:[String,Number],required:!0},name:[String,Number],disabled:Boolean,closable:{type:Boolean,default:null},displayDirective:{type:String,default:"if"}};function m4(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top";const t={width:"0px",height:"0px",transform:""};if(!n||n.children.length<=0)return t;const i=n.parentElement.children[0].getBoundingClientRect(),r=n.children[0].getBoundingClientRect();switch(e){case"left":case"right":t.width="2px",t.height="".concat(r.height,"px"),t.transform="translate(0px, ".concat(r.top-i.top,"px)");break;case"top":case"bottom":t.width="".concat(r.width,"px"),t.height="2px",t.transform="translate(".concat(r.left-i.left,"px, 0px)");break}return t}const Ya=qt("tabs");var g4=qe({props:oA,setup(n,e){const{valueRef:t,tabsLength:i,closableRef:r,isCard:s,handleTabClick:o,handleClose:a,closeModeRef:l,setDefaultValue:c}=Xt(U_),u=Te(()=>{if(s.value)return typeof n.closable=="boolean"?n.closable:r.value});c(n.value);function h(){n.disabled||o(n.value)}function d(f){f.stopPropagation(),a(n.value)}return i.value=i.value+1,Cr(()=>{i.value=i.value-1}),()=>{const f=e.slots.default;return ne("div",{key:n.value,onClick:h,class:{["".concat(Ya,"-tab")]:!0,["".concat(Ya,"-tab-card")]:s.value,["".concat(Ya,"-tab-active")]:t.value===n.value,["".concat(Ya,"-tab-disabled")]:n.disabled,hover:l.value==="hover"}},[ne("div",{class:"".concat(Ya,"-tab-label")},[f?f():n.name]),u.value&&ne("div",{class:"".concat(Ya,"-tab-close")},[ne(AT,{onClick:d},null)])])}}});const v4=qt("tabs");var Dh=qe({name:"FTabPane",props:oA,setup(){return Xt(U_,null)?{prefixCls:v4}:console.error("[FTabPane]: FTabPane 必须搭配 FTabs 组件使用！")}});function _4(n,e,t,i,r,s){return rt(),Mt("div",{class:Wt("".concat(n.prefixCls,"-tab-pane"))},[wi(n.$slots,"default")],2)}Dh.render=_4;Dh.__file="components/tabs/tab-pane.vue";const y4=["render","renderTab"],On=qt("tabs"),Hw="add";function b4(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;const i=[];return n.forEach(r=>{const{value:s,"display-directive":o,displayDirective:a}=r.props;r.key||(r.key=s),r.props.key||(r.props.key=s);const l=s===e,c=o||a;c==="show"?i.push(Hu(r,[[$u,l]])):c==="show:lazy"&&(t[s]||l)?(t[s]=!0,i.push(Hu(r,[[$u,l]]))):l&&i.push(r)}),i}const x4={modelValue:[String,Number],position:{type:String,default:"top"},type:{type:String,default:"line"},closable:{type:Boolean,default:!1},closeMode:{type:String,default:"visible"},addable:{type:Boolean,default:!1},transition:{type:[String,Boolean],default:!0},panes:{type:Array,default:()=>[]}};var w4=qe({name:"FTabs",props:x4,emits:[Ip,Zx,Kf,Hw],setup(n,e){ci();const t={},i=be([]),r=be(!1),[s,o]=ka(n,e.emit),a=be(0),l=Te(()=>n.type==="card"),c=Te(()=>l.value?"top":n.position),u=be(!1),h=be(!1),d=be(null);_n(()=>{d.value&&p4(d)});const f=be({});function p(w,S){w&&(i.value[S]=w)}function v(w){o(w),e.emit(Zx,w)}function m(w){e.emit(Hw,w)}function g(w){e.emit(Kf,w)}function b(w){if(w==null||w.preventDefault(),!d.value||!r.value)return;const{scrollWidth:S,scrollHeight:x,scrollLeft:M,scrollTop:E,offsetWidth:C,offsetHeight:O}=d.value;u.value=M>0||E>0,h.value=M+C<S||E+O<x}function y(w){if(!d.value||!w||!r.value)return;const{scrollLeft:S,scrollTop:x,offsetWidth:M,offsetHeight:E}=d.value;["top","bottom"].includes(n.position)&&(S+M<w.offsetLeft+w.offsetWidth||w.offsetLeft<S)?d.value.scrollTo({left:w.offsetLeft-M+w.offsetWidth}):["left","right"].includes(n.position)&&(x+E<w.offsetTop+w.offsetHeight||w.offsetTop<x)&&d.value.scrollTo({top:w.offsetTop-E+w.offsetHeight}),b()}const _=w=>{!s.value&&s.value!==0&&o(w)};bi(U_,{valueRef:s,closableRef:xb(n,"closable"),closeModeRef:xb(n,"closeMode"),isCard:l,tabsLength:a,handleTabClick:v,handleClose:g,setDefaultValue:_}),ft(()=>[s.value,c.value],()=>{$r(()=>{const w=i.value.find(S=>S.value===s.value);l.value||(f.value=m4(w==null?void 0:w.$el,c.value)),y(w==null?void 0:w.$el)})},{immediate:!0}),ft(a,()=>{$r(()=>{if(!d.value)return;const{scrollWidth:w,offsetWidth:S,scrollHeight:x,offsetHeight:M}=d.value;(w>S||x>M)&&(r.value=!0)})});const T=()=>{var w;const S=e.slots.default&&Zf(e.slots.default()).filter(x=>x.type.name==="FTabPane")||[];return(w=n.panes)!==null&&w!==void 0&&w.length?S.concat(n.panes.map(x=>{const{render:M,renderTab:E}=x,C=TT(x,y4);M||console.warn("[FTab]: panes需要提供render");const O={default:()=>M==null?void 0:M(C),tab:E?()=>E(C):null};return ne(Dh,wr(C,{value:C.value}),O)})):S};return()=>{const w=T();return ne("div",{class:{["".concat(On)]:!0,["".concat(On,"-").concat(c.value)]:!0,["".concat(On,"-card")]:l.value}},[ne("div",{class:"".concat(On,"-nav")},[e.slots.prefix&&ne("div",{class:"".concat(On,"-nav-prefix")},[e.slots.prefix()]),ne("div",{class:{["".concat(On,"-nav-wrapper")]:!0,["".concat(On,"-nav-wrapper--before")]:u.value,["".concat(On,"-nav-wrapper--after")]:h.value}},[ne("div",{class:"".concat(On,"-nav-scroll"),onScroll:b,ref:d},[w.map((S,x)=>{var M;const E=(M=S.children)===null||M===void 0?void 0:M.tab;return ne(Kt,null,[x>0&&l.value&&ne("div",{class:"".concat(On,"-tab-pad")},null),ne(g4,wr(S.props,{ref:C=>p(C,x)}),{default:E})])}),!l.value&&ne("div",{class:"".concat(On,"-nav-bar"),style:f.value},null)])]),l.value&&n.addable&&ne(Kt,null,[ne("div",{class:"".concat(On,"-tab-pad")},null),ne("div",{onClick:m,class:"".concat(On,"-tab ").concat(On,"-tab-card addable")},[ne(zF,null,null)])]),e.slots.suffix?ne("div",{class:"".concat(On,"-nav-suffix")},[e.slots.suffix()]):l.value&&ne("div",{class:"".concat(On,"-tab-pad--last")},null)]),ne("div",{class:"".concat(On,"-tab-pane-wrapper")},[ne(d_,{name:n.transition?n.transition===!0?"".concat(On,"-slide-fade"):n.transition:null},{default:()=>[b4(w,s.value,t)]})])])}}});const TK=Rr(w4,{TabPane:Dh}),AK=Co(Dh);const M4={type:{type:String,default:"default"},size:{type:String,default:"middle"},strong:Boolean,italic:Boolean,tag:{type:String,default:"span"}};function Gw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function E4(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Gw(Object(t),!0).forEach(function(i){Er(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Gw(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const qa=qt("text");var S4=qe({name:"FText",components:{},props:E4({},M4),setup(n){ci();const e=Te(()=>({[qa]:!0,["".concat(qa,"-type--").concat(n.type)]:n.type,["".concat(qa,"-size--").concat(n.size)]:n.size,["".concat(qa,"-text--strong")]:n.strong,["".concat(qa,"-text--italic")]:n.italic}));return{prefixCls:qa,textClass:e}},render(){const n=Cv(this.$slots);return wo(this.tag||"span",{class:this.textClass},n)}});const CK=Rr(S4);/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const _c="157",ms={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},mr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},aA=0,Dv=1,lA=2,T4=3,A4=0,N_=1,F_=2,Fr=3,Yr=0,Yn=1,vi=2,C4=2,bs=0,va=1,np=2,Uv=3,Nv=4,cA=5,ra=100,uA=101,hA=102,Fv=103,kv=104,dA=200,fA=201,pA=202,mA=203,k_=204,B_=205,gA=206,vA=207,_A=208,yA=209,bA=210,xA=0,wA=1,MA=2,ip=3,EA=4,SA=5,TA=6,AA=7,Uh=0,CA=1,PA=2,xs=0,RA=1,LA=2,OA=3,z_=4,IA=5,Hp=300,Ps=301,To=302,rc=303,rh=304,yc=306,qr=1e3,An=1001,sc=1002,an=1003,sh=1004,P4=1004,$l=1005,R4=1005,Qt=1006,Gp=1007,L4=1007,Kr=1008,O4=1008,br=1009,DA=1010,UA=1011,Wp=1012,V_=1013,_s=1014,zr=1015,oc=1016,H_=1017,G_=1018,go=1020,NA=1021,Di=1023,FA=1024,kA=1025,vo=1026,Sa=1027,BA=1028,W_=1029,zA=1030,$_=1031,j_=1033,Cf=33776,Pf=33777,Rf=33778,Lf=33779,Bv=35840,zv=35841,Vv=35842,Hv=35843,VA=36196,Gv=37492,Wv=37496,$v=37808,jv=37809,Xv=37810,Yv=37811,qv=37812,Kv=37813,Zv=37814,Jv=37815,Qv=37816,e0=37817,t0=37818,n0=37819,i0=37820,r0=37821,Of=36492,s0=36494,o0=36495,HA=36283,a0=36284,l0=36285,c0=36286,GA=2200,WA=2201,$A=2202,ac=2300,Ta=2301,If=2302,ua=2400,ha=2401,oh=2402,$p=2500,X_=2501,jA=0,Y_=1,rp=2,q_=3e3,_o=3001,XA=3200,YA=3201,Ro=0,qA=1,Ui="",Mn="srgb",Zr="srgb-linear",jp="display-p3",Nh="display-p3-linear",ah="linear",Bt="srgb",lh="rec709",ch="p3",I4=0,Df=7680,D4=7681,U4=7682,N4=7683,F4=34055,k4=34056,B4=5386,z4=512,V4=513,H4=514,G4=515,W4=516,$4=517,j4=518,KA=519,ZA=512,JA=513,QA=514,eC=515,tC=516,nC=517,iC=518,rC=519,uh=35044,X4=35048,Y4=35040,q4=35045,K4=35049,Z4=35041,J4=35046,Q4=35050,e5=35042,t5="100",u0="300 es",sp=1035,Vr=2e3,hh=2001;class Lr{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Hn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ww=1234567;const _a=Math.PI/180,lc=180/Math.PI;function ki(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Hn[n&255]+Hn[n>>8&255]+Hn[n>>16&255]+Hn[n>>24&255]+"-"+Hn[e&255]+Hn[e>>8&255]+"-"+Hn[e>>16&15|64]+Hn[e>>24&255]+"-"+Hn[t&63|128]+Hn[t>>8&255]+"-"+Hn[t>>16&255]+Hn[t>>24&255]+Hn[i&255]+Hn[i>>8&255]+Hn[i>>16&255]+Hn[i>>24&255]).toLowerCase()}function ln(n,e,t){return Math.max(e,Math.min(t,n))}function K_(n,e){return(n%e+e)%e}function n5(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function i5(n,e,t){return n!==e?(t-n)/(e-n):0}function Cu(n,e,t){return(1-t)*n+t*e}function r5(n,e,t,i){return Cu(n,e,1-Math.exp(-t*i))}function s5(n,e=1){return e-Math.abs(K_(n,e*2)-e)}function o5(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function a5(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function l5(n,e){return n+Math.floor(Math.random()*(e-n+1))}function c5(n,e){return n+Math.random()*(e-n)}function u5(n){return n*(.5-Math.random())}function h5(n){n!==void 0&&(Ww=n);let e=Ww+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function d5(n){return n*_a}function f5(n){return n*lc}function h0(n){return(n&n-1)===0&&n!==0}function sC(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function op(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function p5(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":n.set(a*u,l*h,l*d,a*c);break;case"YZY":n.set(l*d,a*u,l*h,a*c);break;case"ZXZ":n.set(l*h,l*d,a*u,a*c);break;case"XZX":n.set(a*u,l*p,l*f,a*c);break;case"YXY":n.set(l*f,a*u,l*p,a*c);break;case"ZYZ":n.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function _i(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function ut(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const jn={DEG2RAD:_a,RAD2DEG:lc,generateUUID:ki,clamp:ln,euclideanModulo:K_,mapLinear:n5,inverseLerp:i5,lerp:Cu,damp:r5,pingpong:s5,smoothstep:o5,smootherstep:a5,randInt:l5,randFloat:c5,randFloatSpread:u5,seededRandom:h5,degToRad:d5,radToDeg:f5,isPowerOfTwo:h0,ceilPowerOfTwo:sC,floorPowerOfTwo:op,setQuaternionFromProperEuler:p5,normalize:ut,denormalize:_i};class me{constructor(e=0,t=0){me.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ln(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ct{constructor(e,t,i,r,s,o,a,l,c){ct.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],v=r[0],m=r[3],g=r[6],b=r[1],y=r[4],_=r[7],T=r[2],w=r[5],S=r[8];return s[0]=o*v+a*b+l*T,s[3]=o*m+a*y+l*w,s[6]=o*g+a*_+l*S,s[1]=c*v+u*b+h*T,s[4]=c*m+u*y+h*w,s[7]=c*g+u*_+h*S,s[2]=d*v+f*b+p*T,s[5]=d*m+f*y+p*w,s[8]=d*g+f*_+p*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=h*v,e[1]=(r*c-u*i)*v,e[2]=(a*i-r*o)*v,e[3]=d*v,e[4]=(u*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=f*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Jm.makeScale(e,t)),this}rotate(e){return this.premultiply(Jm.makeRotation(-e)),this}translate(e,t){return this.premultiply(Jm.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Jm=new ct;function oC(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const m5={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ll(n,e){return new m5[n](e)}function dh(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function aC(){const n=dh("canvas");return n.style.display="block",n}const $w={};function Pu(n){n in $w||($w[n]=!0,console.warn(n))}const jw=new ct().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Xw=new ct().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),bd={[Zr]:{transfer:ah,primaries:lh,toReference:n=>n,fromReference:n=>n},[Mn]:{transfer:Bt,primaries:lh,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Nh]:{transfer:ah,primaries:ch,toReference:n=>n.applyMatrix3(Xw),fromReference:n=>n.applyMatrix3(jw)},[jp]:{transfer:Bt,primaries:ch,toReference:n=>n.convertSRGBToLinear().applyMatrix3(Xw),fromReference:n=>n.applyMatrix3(jw).convertLinearToSRGB()}},g5=new Set([Zr,Nh]),Dt={enabled:!0,_workingColorSpace:Zr,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!g5.has(n))throw new Error('Unsupported working color space, "'.concat(n,'".'));this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=bd[e].toReference,r=bd[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return bd[n].primaries},getTransfer:function(n){return n===Ui?ah:bd[n].transfer}};function jl(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Qm(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Ka;class Z_{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ka===void 0&&(Ka=dh("canvas")),Ka.width=e.width,Ka.height=e.height;const i=Ka.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Ka}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=dh("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=jl(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(jl(t[i]/255)*255):t[i]=jl(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let v5=0;class da{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:v5++}),this.uuid=ki(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(eg(r[o].image)):s.push(eg(r[o]))}else s=eg(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function eg(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Z_.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _5=0;class Yt extends Lr{constructor(e=Yt.DEFAULT_IMAGE,t=Yt.DEFAULT_MAPPING,i=An,r=An,s=Qt,o=Kr,a=Di,l=br,c=Yt.DEFAULT_ANISOTROPY,u=Ui){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_5++}),this.uuid=ki(),this.name="",this.source=new da(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new me(0,0),this.repeat=new me(1,1),this.center=new me(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ct,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(Pu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===_o?Mn:Ui),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Hp)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case qr:e.x=e.x-Math.floor(e.x);break;case An:e.x=e.x<0?0:1;break;case sc:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case qr:e.y=e.y-Math.floor(e.y);break;case An:e.y=e.y<0?0:1;break;case sc:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Pu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Mn?_o:q_}set encoding(e){Pu("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===_o?Mn:Ui}}Yt.DEFAULT_IMAGE=null;Yt.DEFAULT_MAPPING=Hp;Yt.DEFAULT_ANISOTROPY=1;class gt{constructor(e=0,t=0,i=0,r=1){gt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],v=l[2],m=l[6],g=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-v)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+v)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const y=(c+1)/2,_=(f+1)/2,T=(g+1)/2,w=(u+d)/4,S=(h+v)/4,x=(p+m)/4;return y>_&&y>T?y<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(y),r=w/i,s=S/i):_>T?_<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(_),i=w/r,s=x/r):T<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(T),i=S/s,r=x/s),this.set(i,r,s,t),this}let b=Math.sqrt((m-p)*(m-p)+(h-v)*(h-v)+(d-u)*(d-u));return Math.abs(b)<.001&&(b=1),this.x=(m-p)/b,this.y=(h-v)/b,this.z=(d-u)/b,this.w=Math.acos((c+f+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class lC extends Lr{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new gt(0,0,e,t),this.scissorTest=!1,this.viewport=new gt(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(Pu("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===_o?Mn:Ui),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Qt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new Yt(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new da(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sr extends lC{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Xp extends Yt{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=an,this.minFilter=an,this.wrapR=An,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class y5 extends Sr{constructor(e=1,t=1,i=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Xp(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class J_ extends Yt{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=an,this.minFilter=an,this.wrapR=An,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class b5 extends Sr{constructor(e=1,t=1,i=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new J_(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class x5 extends Sr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class mt{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],c=i[r+1],u=i[r+2],h=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=f,e[t+2]=p,e[t+3]=v;return}if(h!==v||l!==d||c!==f||u!==p){let m=1-a;const g=l*d+c*f+u*p+h*v,b=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){const T=Math.sqrt(y),w=Math.atan2(T,g*b);m=Math.sin(m*w)/T,a=Math.sin(a*w)/T}const _=a*b;if(l=l*m+d*_,c=c*m+f*_,u=u*m+p*_,h=h*m+v*_,m===1-a){const T=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=T,c*=T,u*=T,h*=T}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],u=i[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),u=a(r/2),h=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=i+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>h){const f=2*Math.sqrt(1+i-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-i-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ln(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=i*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-i*c,this._z=s*u+o*c+i*l-r*a,this._w=o*u-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*i+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,t=0,i=0){D.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Yw.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Yw.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*i,u=l*i+a*t-s*r,h=l*r+s*i-o*t,d=-s*t-o*i-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return tg.copy(this).projectOnVector(e),this.sub(tg)}reflect(e){return this.sub(tg.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ln(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const tg=new D,Yw=new mt;class Ti{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(ss.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(ss.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=ss.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),Za.copy(e.boundingBox),Za.applyMatrix4(e.matrixWorld),this.union(Za);else{const r=e.geometry;if(r!==void 0)if(t&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)ss.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(ss)}else r.boundingBox===null&&r.computeBoundingBox(),Za.copy(r.boundingBox),Za.applyMatrix4(e.matrixWorld),this.union(Za)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ss),ss.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Wc),xd.subVectors(this.max,Wc),Ja.subVectors(e.a,Wc),Qa.subVectors(e.b,Wc),el.subVectors(e.c,Wc),Hs.subVectors(Qa,Ja),Gs.subVectors(el,Qa),zo.subVectors(Ja,el);let t=[0,-Hs.z,Hs.y,0,-Gs.z,Gs.y,0,-zo.z,zo.y,Hs.z,0,-Hs.x,Gs.z,0,-Gs.x,zo.z,0,-zo.x,-Hs.y,Hs.x,0,-Gs.y,Gs.x,0,-zo.y,zo.x,0];return!ng(t,Ja,Qa,el,xd)||(t=[1,0,0,0,1,0,0,0,1],!ng(t,Ja,Qa,el,xd))?!1:(wd.crossVectors(Hs,Gs),t=[wd.x,wd.y,wd.z],ng(t,Ja,Qa,el,xd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ss).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ss).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(rs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),rs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),rs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),rs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),rs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),rs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),rs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),rs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(rs),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const rs=[new D,new D,new D,new D,new D,new D,new D,new D],ss=new D,Za=new Ti,Ja=new D,Qa=new D,el=new D,Hs=new D,Gs=new D,zo=new D,Wc=new D,xd=new D,wd=new D,Vo=new D;function ng(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Vo.fromArray(n,s);const a=r.x*Math.abs(Vo.x)+r.y*Math.abs(Vo.y)+r.z*Math.abs(Vo.z),l=e.dot(Vo),c=t.dot(Vo),u=i.dot(Vo);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const w5=new Ti,$c=new D,ig=new D;class Ai{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):w5.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$c.subVectors(e,this.center);const t=$c.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector($c,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(ig.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($c.copy(e.center).add(ig)),this.expandByPoint($c.copy(e.center).sub(ig))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const os=new D,rg=new D,Md=new D,Ws=new D,sg=new D,Ed=new D,og=new D;class Ba{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,os)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=os.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(os.copy(this.origin).addScaledVector(this.direction,t),os.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){rg.copy(e).add(t).multiplyScalar(.5),Md.copy(t).sub(e).normalize(),Ws.copy(this.origin).sub(rg);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Md),a=Ws.dot(this.direction),l=-Ws.dot(Md),c=Ws.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const v=1/u;h*=v,d*=v,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(rg).addScaledVector(Md,d),f}intersectSphere(e,t){os.subVectors(e.center,this.origin);const i=os.dot(this.direction),r=os.dot(os)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,os)!==null}intersectTriangle(e,t,i,r,s){sg.subVectors(t,e),Ed.subVectors(i,e),og.crossVectors(sg,Ed);let o=this.direction.dot(og),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ws.subVectors(this.origin,e);const l=a*this.direction.dot(Ed.crossVectors(Ws,Ed));if(l<0)return null;const c=a*this.direction.dot(sg.cross(Ws));if(c<0||l+c>o)return null;const u=-a*Ws.dot(og);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Be{constructor(e,t,i,r,s,o,a,l,c,u,h,d,f,p,v,m){Be.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c,u,h,d,f,p,v,m)}set(e,t,i,r,s,o,a,l,c,u,h,d,f,p,v,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=l,g[2]=c,g[6]=u,g[10]=h,g[14]=d,g[3]=f,g[7]=p,g[11]=v,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Be().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/tl.setFromMatrixColumn(e,0).length(),s=1/tl.setFromMatrixColumn(e,1).length(),o=1/tl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=o*u,f=o*h,p=a*u,v=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-v*c,t[9]=-a*l,t[2]=v-d*c,t[6]=p+f*c,t[10]=o*l}else if(e.order==="YXZ"){const d=l*u,f=l*h,p=c*u,v=c*h;t[0]=d+v*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=v+d*a,t[10]=o*l}else if(e.order==="ZXY"){const d=l*u,f=l*h,p=c*u,v=c*h;t[0]=d-v*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=v-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const d=o*u,f=o*h,p=a*u,v=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+v,t[1]=l*h,t[5]=v*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*u,t[4]=v-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-v*h}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,v=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+v,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=v*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(M5,e,E5)}lookAt(e,t,i){const r=this.elements;return Pi.subVectors(e,t),Pi.lengthSq()===0&&(Pi.z=1),Pi.normalize(),$s.crossVectors(i,Pi),$s.lengthSq()===0&&(Math.abs(i.z)===1?Pi.x+=1e-4:Pi.z+=1e-4,Pi.normalize(),$s.crossVectors(i,Pi)),$s.normalize(),Sd.crossVectors(Pi,$s),r[0]=$s.x,r[4]=Sd.x,r[8]=Pi.x,r[1]=$s.y,r[5]=Sd.y,r[9]=Pi.y,r[2]=$s.z,r[6]=Sd.z,r[10]=Pi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],v=i[6],m=i[10],g=i[14],b=i[3],y=i[7],_=i[11],T=i[15],w=r[0],S=r[4],x=r[8],M=r[12],E=r[1],C=r[5],O=r[9],$=r[13],U=r[2],j=r[6],W=r[10],q=r[14],ie=r[3],Z=r[7],te=r[11],X=r[15];return s[0]=o*w+a*E+l*U+c*ie,s[4]=o*S+a*C+l*j+c*Z,s[8]=o*x+a*O+l*W+c*te,s[12]=o*M+a*$+l*q+c*X,s[1]=u*w+h*E+d*U+f*ie,s[5]=u*S+h*C+d*j+f*Z,s[9]=u*x+h*O+d*W+f*te,s[13]=u*M+h*$+d*q+f*X,s[2]=p*w+v*E+m*U+g*ie,s[6]=p*S+v*C+m*j+g*Z,s[10]=p*x+v*O+m*W+g*te,s[14]=p*M+v*$+m*q+g*X,s[3]=b*w+y*E+_*U+T*ie,s[7]=b*S+y*C+_*j+T*Z,s[11]=b*x+y*O+_*W+T*te,s[15]=b*M+y*$+_*q+T*X,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14],p=e[3],v=e[7],m=e[11],g=e[15];return p*(+s*l*h-r*c*h-s*a*d+i*c*d+r*a*f-i*l*f)+v*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+m*(+t*c*h-t*a*f-s*o*h+i*o*f+s*a*u-i*c*u)+g*(-r*a*u-t*l*h+t*a*d+r*o*h-i*o*d+i*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],v=e[13],m=e[14],g=e[15],b=h*m*c-v*d*c+v*l*f-a*m*f-h*l*g+a*d*g,y=p*d*c-u*m*c-p*l*f+o*m*f+u*l*g-o*d*g,_=u*v*c-p*h*c+p*a*f-o*v*f-u*a*g+o*h*g,T=p*h*l-u*v*l-p*a*d+o*v*d+u*a*m-o*h*m,w=t*b+i*y+r*_+s*T;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const S=1/w;return e[0]=b*S,e[1]=(v*d*s-h*m*s-v*r*f+i*m*f+h*r*g-i*d*g)*S,e[2]=(a*m*s-v*l*s+v*r*c-i*m*c-a*r*g+i*l*g)*S,e[3]=(h*l*s-a*d*s-h*r*c+i*d*c+a*r*f-i*l*f)*S,e[4]=y*S,e[5]=(u*m*s-p*d*s+p*r*f-t*m*f-u*r*g+t*d*g)*S,e[6]=(p*l*s-o*m*s-p*r*c+t*m*c+o*r*g-t*l*g)*S,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*S,e[8]=_*S,e[9]=(p*h*s-u*v*s-p*i*f+t*v*f+u*i*g-t*h*g)*S,e[10]=(o*v*s-p*a*s+p*i*c-t*v*c-o*i*g+t*a*g)*S,e[11]=(u*a*s-o*h*s-u*i*c+t*h*c+o*i*f-t*a*f)*S,e[12]=T*S,e[13]=(u*v*r-p*h*r+p*i*d-t*v*d-u*i*m+t*h*m)*S,e[14]=(p*a*r-o*v*r-p*i*l+t*v*l+o*i*m-t*a*m)*S,e[15]=(o*h*r-u*a*r+u*i*l-t*h*l-o*i*d+t*a*d)*S,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+i,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,v=o*u,m=o*h,g=a*h,b=l*c,y=l*u,_=l*h,T=i.x,w=i.y,S=i.z;return r[0]=(1-(v+g))*T,r[1]=(f+_)*T,r[2]=(p-y)*T,r[3]=0,r[4]=(f-_)*w,r[5]=(1-(d+g))*w,r[6]=(m+b)*w,r[7]=0,r[8]=(p+y)*S,r[9]=(m-b)*S,r[10]=(1-(d+v))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=tl.set(r[0],r[1],r[2]).length();const o=tl.set(r[4],r[5],r[6]).length(),a=tl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],cr.copy(this);const c=1/s,u=1/o,h=1/a;return cr.elements[0]*=c,cr.elements[1]*=c,cr.elements[2]*=c,cr.elements[4]*=u,cr.elements[5]*=u,cr.elements[6]*=u,cr.elements[8]*=h,cr.elements[9]*=h,cr.elements[10]*=h,t.setFromRotationMatrix(cr),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Vr){const l=this.elements,c=2*s/(t-e),u=2*s/(i-r),h=(t+e)/(t-e),d=(i+r)/(i-r);let f,p;if(a===Vr)f=-(o+s)/(o-s),p=-2*o*s/(o-s);else if(a===hh)f=-o/(o-s),p=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Vr){const l=this.elements,c=1/(t-e),u=1/(i-r),h=1/(o-s),d=(t+e)*c,f=(i+r)*u;let p,v;if(a===Vr)p=(o+s)*h,v=-2*h;else if(a===hh)p=s*h,v=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=v,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const tl=new D,cr=new Be,M5=new D(0,0,0),E5=new D(1,1,1),$s=new D,Sd=new D,Pi=new D,qw=new Be,Kw=new mt;class tr{constructor(e=0,t=0,i=0,r=tr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],f=r[10];switch(t){case"XYZ":this._y=Math.asin(ln(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-ln(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(ln(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-ln(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(ln(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-ln(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return qw.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qw,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Kw.setFromEuler(this),this.setFromQuaternion(Kw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}tr.DEFAULT_ORDER="XYZ";class Yp{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let S5=0;const Zw=new D,nl=new mt,as=new Be,Td=new D,jc=new D,T5=new D,A5=new mt,Jw=new D(1,0,0),Qw=new D(0,1,0),e1=new D(0,0,1),C5={type:"added"},P5={type:"removed"};class pt extends Lr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:S5++}),this.uuid=ki(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pt.DEFAULT_UP.clone();const e=new D,t=new tr,i=new mt,r=new D(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Be},normalMatrix:{value:new ct}}),this.matrix=new Be,this.matrixWorld=new Be,this.matrixAutoUpdate=pt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=pt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Yp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return nl.setFromAxisAngle(e,t),this.quaternion.multiply(nl),this}rotateOnWorldAxis(e,t){return nl.setFromAxisAngle(e,t),this.quaternion.premultiply(nl),this}rotateX(e){return this.rotateOnAxis(Jw,e)}rotateY(e){return this.rotateOnAxis(Qw,e)}rotateZ(e){return this.rotateOnAxis(e1,e)}translateOnAxis(e,t){return Zw.copy(e).applyQuaternion(this.quaternion),this.position.add(Zw.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Jw,e)}translateY(e){return this.translateOnAxis(Qw,e)}translateZ(e){return this.translateOnAxis(e1,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(as.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Td.copy(e):Td.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),jc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?as.lookAt(jc,Td,this.up):as.lookAt(Td,jc,this.up),this.quaternion.setFromRotationMatrix(as),r&&(as.extractRotation(r.matrixWorld),nl.setFromRotationMatrix(as),this.quaternion.premultiply(nl.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(C5)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(P5)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),as.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),as.multiply(e.parent.matrixWorld)),e.applyMatrix4(as),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,t);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jc,e,T5),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jc,A5,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}pt.DEFAULT_UP=new D(0,1,0);pt.DEFAULT_MATRIX_AUTO_UPDATE=!0;pt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ur=new D,ls=new D,ag=new D,cs=new D,il=new D,rl=new D,t1=new D,lg=new D,cg=new D,ug=new D;let Ad=!1;class gi{constructor(e=new D,t=new D,i=new D){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ur.subVectors(e,t),r.cross(ur);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ur.subVectors(r,t),ls.subVectors(i,t),ag.subVectors(e,t);const o=ur.dot(ur),a=ur.dot(ls),l=ur.dot(ag),c=ls.dot(ls),u=ls.dot(ag),h=o*c-a*a;if(h===0)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,cs),cs.x>=0&&cs.y>=0&&cs.x+cs.y<=1}static getUV(e,t,i,r,s,o,a,l){return Ad===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Ad=!0),this.getInterpolation(e,t,i,r,s,o,a,l)}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,cs),l.setScalar(0),l.addScaledVector(s,cs.x),l.addScaledVector(o,cs.y),l.addScaledVector(a,cs.z),l}static isFrontFacing(e,t,i,r){return ur.subVectors(i,t),ls.subVectors(e,t),ur.cross(ls).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ur.subVectors(this.c,this.b),ls.subVectors(this.a,this.b),ur.cross(ls).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return gi.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return gi.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Ad===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Ad=!0),gi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return gi.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return gi.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return gi.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;il.subVectors(r,i),rl.subVectors(s,i),lg.subVectors(e,i);const l=il.dot(lg),c=rl.dot(lg);if(l<=0&&c<=0)return t.copy(i);cg.subVectors(e,r);const u=il.dot(cg),h=rl.dot(cg);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(i).addScaledVector(il,o);ug.subVectors(e,s);const f=il.dot(ug),p=rl.dot(ug);if(p>=0&&f<=p)return t.copy(s);const v=f*c-l*p;if(v<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(i).addScaledVector(rl,a);const m=u*p-f*h;if(m<=0&&h-u>=0&&f-p>=0)return t1.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(t1,a);const g=1/(m+v+d);return o=v*g,a=d*g,t.copy(i).addScaledVector(il,o).addScaledVector(rl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let R5=0;class Pn extends Lr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:R5++}),this.uuid=ki(),this.name="",this.type="Material",this.blending=va,this.side=Yr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=k_,this.blendDst=B_,this.blendEquation=ra,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ip,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=KA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Df,this.stencilZFail=Df,this.stencilZPass=Df,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}const r=this[t];if(r===void 0){console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."));continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==va&&(i.blending=this.blending),this.side!==Yr&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const cC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},js={h:0,s:0,l:0},Cd={h:0,s:0,l:0};function hg(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class Oe{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Mn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Dt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Dt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Dt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Dt.workingColorSpace){if(e=K_(e,1),t=ln(t,0,1),i=ln(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=hg(o,s,e+1/3),this.g=hg(o,s,e),this.b=hg(o,s,e-1/3)}return Dt.toWorkingColorSpace(this,r),this}setStyle(e,t=Mn){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Mn){const i=cC[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=jl(e.r),this.g=jl(e.g),this.b=jl(e.b),this}copyLinearToSRGB(e){return this.r=Qm(e.r),this.g=Qm(e.g),this.b=Qm(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Mn){return Dt.fromWorkingColorSpace(Gn.copy(this),e),Math.round(ln(Gn.r*255,0,255))*65536+Math.round(ln(Gn.g*255,0,255))*256+Math.round(ln(Gn.b*255,0,255))}getHexString(e=Mn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Dt.workingColorSpace){Dt.fromWorkingColorSpace(Gn.copy(this),t);const i=Gn.r,r=Gn.g,s=Gn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Dt.workingColorSpace){return Dt.fromWorkingColorSpace(Gn.copy(this),t),e.r=Gn.r,e.g=Gn.g,e.b=Gn.b,e}getStyle(e=Mn){Dt.fromWorkingColorSpace(Gn.copy(this),e);const t=Gn.r,i=Gn.g,r=Gn.b;return e!==Mn?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(i.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(t*255),",").concat(Math.round(i*255),",").concat(Math.round(r*255),")")}offsetHSL(e,t,i){return this.getHSL(js),this.setHSL(js.h+e,js.s+t,js.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(js),e.getHSL(Cd);const i=Cu(js.h,Cd.h,t),r=Cu(js.s,Cd.s,t),s=Cu(js.l,Cd.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Gn=new Oe;Oe.NAMES=cC;class Xn extends Pn{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Oe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const vs=L5();function L5(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function pi(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=ln(n,-65504,65504),vs.floatView[0]=n;const e=vs.uint32View[0],t=e>>23&511;return vs.baseTable[t]+((e&8388607)>>vs.shiftTable[t])}function pu(n){const e=n>>10;return vs.uint32View[0]=vs.mantissaTable[vs.offsetTable[e]+(n&1023)]+vs.exponentTable[e],vs.floatView[0]}const O5={toHalfFloat:pi,fromHalfFloat:pu},xn=new D,Pd=new me;class Tt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=uh,this.updateRange={offset:0,count:-1},this.gpuType=zr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Pd.fromBufferAttribute(this,t),Pd.applyMatrix3(e),this.setXY(t,Pd.x,Pd.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyMatrix3(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyMatrix4(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.applyNormalMatrix(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xn.fromBufferAttribute(this,t),xn.transformDirection(e),this.setXYZ(t,xn.x,xn.y,xn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=_i(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=ut(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=_i(t,this.array)),t}setX(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=_i(t,this.array)),t}setY(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=_i(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=_i(t,this.array)),t}setW(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array),s=ut(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==uh&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class I5 extends Tt{constructor(e,t,i){super(new Int8Array(e),t,i)}}class D5 extends Tt{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class U5 extends Tt{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class N5 extends Tt{constructor(e,t,i){super(new Int16Array(e),t,i)}}class qp extends Tt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class F5 extends Tt{constructor(e,t,i){super(new Int32Array(e),t,i)}}class Q_ extends Tt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class k5 extends Tt{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=pu(this.array[e*this.itemSize]);return this.normalized&&(t=_i(t,this.array)),t}setX(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize]=pi(t),this}getY(e){let t=pu(this.array[e*this.itemSize+1]);return this.normalized&&(t=_i(t,this.array)),t}setY(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+1]=pi(t),this}getZ(e){let t=pu(this.array[e*this.itemSize+2]);return this.normalized&&(t=_i(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+2]=pi(t),this}getW(e){let t=pu(this.array[e*this.itemSize+3]);return this.normalized&&(t=_i(t,this.array)),t}setW(e,t){return this.normalized&&(t=ut(t,this.array)),this.array[e*this.itemSize+3]=pi(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array)),this.array[e+0]=pi(t),this.array[e+1]=pi(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array)),this.array[e+0]=pi(t),this.array[e+1]=pi(i),this.array[e+2]=pi(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array),s=ut(s,this.array)),this.array[e+0]=pi(t),this.array[e+1]=pi(i),this.array[e+2]=pi(r),this.array[e+3]=pi(s),this}}class Ve extends Tt{constructor(e,t,i){super(new Float32Array(e),t,i)}}class B5 extends Tt{constructor(e,t,i){super(new Float64Array(e),t,i)}}let z5=0;const $i=new Be,dg=new pt,sl=new D,Ri=new Ti,Xc=new Ti,In=new D;class Ye extends Lr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:z5++}),this.uuid=ki(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(oC(e)?Q_:qp)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new ct().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return $i.makeRotationFromQuaternion(e),this.applyMatrix4($i),this}rotateX(e){return $i.makeRotationX(e),this.applyMatrix4($i),this}rotateY(e){return $i.makeRotationY(e),this.applyMatrix4($i),this}rotateZ(e){return $i.makeRotationZ(e),this.applyMatrix4($i),this}translate(e,t,i){return $i.makeTranslation(e,t,i),this.applyMatrix4($i),this}scale(e,t,i){return $i.makeScale(e,t,i),this.applyMatrix4($i),this}lookAt(e){return dg.lookAt(e),dg.updateMatrix(),this.applyMatrix4(dg.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(sl).negate(),this.translate(sl.x,sl.y,sl.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Ve(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ti);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Ri.setFromBufferAttribute(s),this.morphTargetsRelative?(In.addVectors(this.boundingBox.min,Ri.min),this.boundingBox.expandByPoint(In),In.addVectors(this.boundingBox.max,Ri.max),this.boundingBox.expandByPoint(In)):(this.boundingBox.expandByPoint(Ri.min),this.boundingBox.expandByPoint(Ri.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ai);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new D,1/0);return}if(e){const i=this.boundingSphere.center;if(Ri.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Xc.setFromBufferAttribute(a),this.morphTargetsRelative?(In.addVectors(Ri.min,Xc.min),Ri.expandByPoint(In),In.addVectors(Ri.max,Xc.max),Ri.expandByPoint(In)):(Ri.expandByPoint(Xc.min),Ri.expandByPoint(Xc.max))}Ri.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)In.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(In));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)In.fromBufferAttribute(a,c),l&&(sl.fromBufferAttribute(e,c),In.add(sl)),r=Math.max(r,i.distanceToSquared(In))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Tt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let E=0;E<a;E++)c[E]=new D,u[E]=new D;const h=new D,d=new D,f=new D,p=new me,v=new me,m=new me,g=new D,b=new D;function y(E,C,O){h.fromArray(r,E*3),d.fromArray(r,C*3),f.fromArray(r,O*3),p.fromArray(o,E*2),v.fromArray(o,C*2),m.fromArray(o,O*2),d.sub(h),f.sub(h),v.sub(p),m.sub(p);const $=1/(v.x*m.y-m.x*v.y);isFinite($)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(f,-v.y).multiplyScalar($),b.copy(f).multiplyScalar(v.x).addScaledVector(d,-m.x).multiplyScalar($),c[E].add(g),c[C].add(g),c[O].add(g),u[E].add(b),u[C].add(b),u[O].add(b))}let _=this.groups;_.length===0&&(_=[{start:0,count:i.length}]);for(let E=0,C=_.length;E<C;++E){const O=_[E],$=O.start,U=O.count;for(let j=$,W=$+U;j<W;j+=3)y(i[j+0],i[j+1],i[j+2])}const T=new D,w=new D,S=new D,x=new D;function M(E){S.fromArray(s,E*3),x.copy(S);const C=c[E];T.copy(C),T.sub(S.multiplyScalar(S.dot(C))).normalize(),w.crossVectors(x,C);const $=w.dot(u[E])<0?-1:1;l[E*4]=T.x,l[E*4+1]=T.y,l[E*4+2]=T.z,l[E*4+3]=$}for(let E=0,C=_.length;E<C;++E){const O=_[E],$=O.start,U=O.count;for(let j=$,W=$+U;j<W;j+=3)M(i[j+0]),M(i[j+1]),M(i[j+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Tt(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new D,s=new D,o=new D,a=new D,l=new D,c=new D,u=new D,h=new D;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),v=e.getX(d+1),m=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,v),o.fromBufferAttribute(t,m),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,m),a.add(u),l.add(u),c.add(u),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(m,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)In.fromBufferAttribute(e,t),In.normalize(),e.setXYZ(t,In.x,In.y,In.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let v=0,m=l.length;v<m;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*u;for(let g=0;g<u;g++)d[p++]=c[f++]}return new Tt(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ye,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const d=c[u],f=e(d,i);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){const f=c[h];u.push(f.toJSON(e.data))}u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const n1=new Be,Ho=new Ba,Rd=new Ai,i1=new D,ol=new D,al=new D,ll=new D,fg=new D,Ld=new D,Od=new me,Id=new me,Dd=new me,r1=new D,s1=new D,o1=new D,Ud=new D,Nd=new D;class ke extends pt{constructor(e=new Ye,t=new Xn){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Ld.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],h=s[l];u!==0&&(fg.fromBufferAttribute(h,e),o?Ld.addScaledVector(fg,u):Ld.addScaledVector(fg.sub(t),u))}t.add(Ld)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Rd.copy(i.boundingSphere),Rd.applyMatrix4(s),Ho.copy(e.ray).recast(e.near),!(Rd.containsPoint(Ho.origin)===!1&&(Ho.intersectSphere(Rd,i1)===null||Ho.origin.distanceToSquared(i1)>(e.far-e.near)**2))&&(n1.copy(s).invert(),Ho.copy(e.ray).applyMatrix4(n1),!(i.boundingBox!==null&&Ho.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Ho)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let p=0,v=d.length;p<v;p++){const m=d[p],g=o[m.materialIndex],b=Math.max(m.start,f.start),y=Math.min(a.count,Math.min(m.start+m.count,f.start+f.count));for(let _=b,T=y;_<T;_+=3){const w=a.getX(_),S=a.getX(_+1),x=a.getX(_+2);r=Fd(this,g,e,i,c,u,h,w,S,x),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),v=Math.min(a.count,f.start+f.count);for(let m=p,g=v;m<g;m+=3){const b=a.getX(m),y=a.getX(m+1),_=a.getX(m+2);r=Fd(this,o,e,i,c,u,h,b,y,_),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let p=0,v=d.length;p<v;p++){const m=d[p],g=o[m.materialIndex],b=Math.max(m.start,f.start),y=Math.min(l.count,Math.min(m.start+m.count,f.start+f.count));for(let _=b,T=y;_<T;_+=3){const w=_,S=_+1,x=_+2;r=Fd(this,g,e,i,c,u,h,w,S,x),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{const p=Math.max(0,f.start),v=Math.min(l.count,f.start+f.count);for(let m=p,g=v;m<g;m+=3){const b=m,y=m+1,_=m+2;r=Fd(this,o,e,i,c,u,h,b,y,_),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}}function V5(n,e,t,i,r,s,o,a){let l;if(e.side===Yn?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Yr,a),l===null)return null;Nd.copy(a),Nd.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Nd);return c<t.near||c>t.far?null:{distance:c,point:Nd.clone(),object:n}}function Fd(n,e,t,i,r,s,o,a,l,c){n.getVertexPosition(a,ol),n.getVertexPosition(l,al),n.getVertexPosition(c,ll);const u=V5(n,e,t,i,ol,al,ll,Ud);if(u){r&&(Od.fromBufferAttribute(r,a),Id.fromBufferAttribute(r,l),Dd.fromBufferAttribute(r,c),u.uv=gi.getInterpolation(Ud,ol,al,ll,Od,Id,Dd,new me)),s&&(Od.fromBufferAttribute(s,a),Id.fromBufferAttribute(s,l),Dd.fromBufferAttribute(s,c),u.uv1=gi.getInterpolation(Ud,ol,al,ll,Od,Id,Dd,new me),u.uv2=u.uv1),o&&(r1.fromBufferAttribute(o,a),s1.fromBufferAttribute(o,l),o1.fromBufferAttribute(o,c),u.normal=gi.getInterpolation(Ud,ol,al,ll,r1,s1,o1,new D),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const h={a,b:l,c,normal:new D,materialIndex:0};gi.getNormal(ol,al,ll,h.normal),u.face=h}return u}class si extends Ye{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,i,t,e,o,s,0),p("z","y","x",1,-1,i,t,-e,o,s,1),p("x","z","y",1,1,e,i,t,r,o,2),p("x","z","y",1,-1,e,i,-t,r,o,3),p("x","y","z",1,-1,e,t,i,r,s,4),p("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new Ve(c,3)),this.setAttribute("normal",new Ve(u,3)),this.setAttribute("uv",new Ve(h,2));function p(v,m,g,b,y,_,T,w,S,x,M){const E=_/S,C=T/x,O=_/2,$=T/2,U=w/2,j=S+1,W=x+1;let q=0,ie=0;const Z=new D;for(let te=0;te<W;te++){const X=te*C-$;for(let se=0;se<j;se++){const G=se*E-O;Z[v]=G*b,Z[m]=X*y,Z[g]=U,c.push(Z.x,Z.y,Z.z),Z[v]=0,Z[m]=0,Z[g]=w>0?1:-1,u.push(Z.x,Z.y,Z.z),h.push(se/S),h.push(1-te/x),q+=1}}for(let te=0;te<x;te++)for(let X=0;X<S;X++){const se=d+X+j*te,G=d+X+j*(te+1),xe=d+(X+1)+j*(te+1),Re=d+(X+1)+j*te;l.push(se,G,Re),l.push(G,xe,Re),ie+=6}a.addGroup(f,ie,M),f+=ie,d+=q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new si(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cc(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function ri(n){const e={};for(let t=0;t<n.length;t++){const i=cc(n[t]);for(const r in i)e[r]=i[r]}return e}function H5(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function uC(n){return n.getRenderTarget()===null?n.outputColorSpace:Dt.workingColorSpace}const Kp={clone:cc,merge:ri};var G5="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",W5="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class or extends Pn{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=G5,this.fragmentShader=W5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cc(e.uniforms),this.uniformsGroups=H5(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class Fh extends pt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Be,this.projectionMatrix=new Be,this.projectionMatrixInverse=new Be,this.coordinateSystem=Vr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Nt extends Fh{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=lc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(_a*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return lc*2*Math.atan(Math.tan(_a*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(_a*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const cl=-90,ul=1;class hC extends pt{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Nt(cl,ul,e,t);r.layers=this.layers,this.add(r);const s=new Nt(cl,ul,e,t);s.layers=this.layers,this.add(s);const o=new Nt(cl,ul,e,t);o.layers=this.layers,this.add(o);const a=new Nt(cl,ul,e,t);a.layers=this.layers,this.add(a);const l=new Nt(cl,ul,e,t);l.layers=this.layers,this.add(l);const c=new Nt(cl,ul,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===Vr)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===hh)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const v=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,c),i.texture.generateMipmaps=v,e.setRenderTarget(i,5,r),e.render(t,u),e.setRenderTarget(h,d,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class kh extends Yt{constructor(e,t,i,r,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:Ps,super(e,t,i,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class dC extends Sr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(Pu("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===_o?Mn:Ui),this.texture=new kh(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Qt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n				varying vec3 vWorldDirection;\n\n				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n				}\n\n				void main() {\n\n					vWorldDirection = transformDirection( position, modelMatrix );\n\n					#include <begin_vertex>\n					#include <project_vertex>\n\n				}\n			",fragmentShader:"\n\n				uniform sampler2D tEquirect;\n\n				varying vec3 vWorldDirection;\n\n				#include <common>\n\n				void main() {\n\n					vec3 direction = normalize( vWorldDirection );\n\n					vec2 sampleUV = equirectUv( direction );\n\n					gl_FragColor = texture2D( tEquirect, sampleUV );\n\n				}\n			"},r=new si(5,5,5),s=new or({name:"CubemapFromEquirect",uniforms:cc(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Yn,blending:bs});s.uniforms.tEquirect.value=t;const o=new ke(r,s),a=t.minFilter;return t.minFilter===Kr&&(t.minFilter=Qt),new hC(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const pg=new D,$5=new D,j5=new ct;class gs{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=pg.subVectors(i,t).cross($5.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(pg),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||j5.getNormalMatrix(e),r=this.coplanarPoint(pg).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Go=new Ai,kd=new D;class Zp{constructor(e=new gs,t=new gs,i=new gs,r=new gs,s=new gs,o=new gs){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Vr){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],v=r[10],m=r[11],g=r[12],b=r[13],y=r[14],_=r[15];if(i[0].setComponents(l-s,d-c,m-f,_-g).normalize(),i[1].setComponents(l+s,d+c,m+f,_+g).normalize(),i[2].setComponents(l+o,d+u,m+p,_+b).normalize(),i[3].setComponents(l-o,d-u,m-p,_-b).normalize(),i[4].setComponents(l-a,d-h,m-v,_-y).normalize(),t===Vr)i[5].setComponents(l+a,d+h,m+v,_+y).normalize();else if(t===hh)i[5].setComponents(a,h,v,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Go.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Go.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Go)}intersectsSprite(e){return Go.center.set(0,0,0),Go.radius=.7071067811865476,Go.applyMatrix4(e.matrixWorld),this.intersectsSphere(Go)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(kd.x=r.normal.x>0?e.max.x:e.min.x,kd.y=r.normal.y>0?e.max.y:e.min.y,kd.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(kd)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function fC(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function X5(n,e){const t=e.isWebGL2,i=new WeakMap;function r(c,u){const h=c.array,d=c.usage,f=n.createBuffer();n.bindBuffer(u,f),n.bufferData(u,h,d),c.onUploadCallback();let p;if(h instanceof Float32Array)p=n.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)p=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)p=n.SHORT;else if(h instanceof Uint32Array)p=n.UNSIGNED_INT;else if(h instanceof Int32Array)p=n.INT;else if(h instanceof Int8Array)p=n.BYTE;else if(h instanceof Uint8Array)p=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)p=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){const d=u.array,f=u.updateRange;n.bindBuffer(h,c),f.count===-1?n.bufferSubData(h,0,d):(t?n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):n.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u&&(n.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h===void 0?i.set(c,r(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:o,remove:a,update:l}}class Oi extends Ye{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],v=[],m=[];for(let g=0;g<u;g++){const b=g*d-o;for(let y=0;y<c;y++){const _=y*h-s;p.push(_,-b,0),v.push(0,0,1),m.push(y/a),m.push(1-g/l)}}for(let g=0;g<l;g++)for(let b=0;b<a;b++){const y=b+c*g,_=b+c*(g+1),T=b+1+c*(g+1),w=b+1+c*g;f.push(y,_,w),f.push(_,T,w)}this.setIndex(f),this.setAttribute("position",new Ve(p,3)),this.setAttribute("normal",new Ve(v,3)),this.setAttribute("uv",new Ve(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Oi(e.width,e.height,e.widthSegments,e.heightSegments)}}var Y5="#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",q5="#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",K5="#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",Z5="#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",J5="#ifdef USE_ALPHATEST\n	if ( diffuseColor.a < alphaTest ) discard;\n#endif",Q5="#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",ez="#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",tz="#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",nz="vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",iz="vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",rz="float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",sz="#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",oz="#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = dFdx( surf_pos.xyz );\n		vec3 vSigmaY = dFdy( surf_pos.xyz );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",az="#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n		plane = clippingPlanes[ i ];\n		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n	}\n	#pragma unroll_loop_end\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		#pragma unroll_loop_start\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		#pragma unroll_loop_end\n		if ( clipped ) discard;\n	#endif\n#endif",lz="#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",cz="#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",uz="#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",hz="#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",dz="#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",fz="#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	varying vec3 vColor;\n#endif",pz="#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif",mz="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n	return dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",gz="#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_v0 0.339\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_v1 0.276\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_v4 0.046\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_v5 0.016\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_v6 0.0038\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",vz="vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",_z="#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",yz="#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",bz="#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",xz="#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",wz="gl_FragColor = linearToOutputTexel( gl_FragColor );",Mz="\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n	vec3( 0.8224621, 0.177538, 0.0 ),\n	vec3( 0.0331941, 0.9668058, 0.0 ),\n	vec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n	vec3( 1.2249401, - 0.2249404, 0.0 ),\n	vec3( - 0.0420569, 1.0420571, 0.0 ),\n	vec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n	return value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n	return value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n	return sRGBTransferOETF( value );\n}",Ez="#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",Sz="#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",Tz="#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",Az="#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",Cz="#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",Pz="#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",Rz="#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",Lz="#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",Oz="#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",Iz="#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",Dz="#ifdef USE_LIGHTMAP\n	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n	reflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",Uz="#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",Nz="LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",Fz="varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",kz="uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n	uniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	#if defined ( LEGACY_LIGHTS )\n		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n		}\n		return 1.0;\n	#else\n		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n		if ( cutoffDistance > 0.0 ) {\n			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n		}\n		return distanceFalloff;\n	#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",Bz="#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",zz="ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",Vz="varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",Hz="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",Gz="varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",Wz="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	anisotropyV /= material.anisotropy;\n	material.anisotropy = saturate( material.anisotropy );\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",$z="struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",jz="\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal;\n#ifdef USE_CLEARCOAT\n	geometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometryViewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometryPosition, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometryPosition, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#if defined( USE_LIGHT_PROBES )\n		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",Xz="#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometryNormal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",Yz="#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",qz="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",Kz="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",Zz="#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n		varying float vIsPerspective;\n	#else\n		uniform float logDepthBufFC;\n	#endif\n#endif",Jz="#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n	#else\n		if ( isPerspectiveMatrix( projectionMatrix ) ) {\n			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n			gl_Position.z *= gl_Position.w;\n		}\n	#endif\n#endif",Qz="#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n	\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",eV="#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",tV="#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",nV="#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",iV="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",rV="#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",sV="#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",oV="#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n		}\n	#else\n		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n	#endif\n#endif",aV="#ifdef USE_MORPHTARGETS\n	uniform float morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n		uniform sampler2DArray morphTargetsTexture;\n		uniform ivec2 morphTargetsTextureSize;\n		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n			int y = texelIndex / morphTargetsTextureSize.x;\n			int x = texelIndex - y * morphTargetsTextureSize.x;\n			ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n			return texelFetch( morphTargetsTexture, morphUV, 0 );\n		}\n	#else\n		#ifndef USE_MORPHNORMALS\n			uniform float morphTargetInfluences[ 8 ];\n		#else\n			uniform float morphTargetInfluences[ 4 ];\n		#endif\n	#endif\n#endif",lV="#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n		}\n	#else\n		transformed += morphTarget0 * morphTargetInfluences[ 0 ];\n		transformed += morphTarget1 * morphTargetInfluences[ 1 ];\n		transformed += morphTarget2 * morphTargetInfluences[ 2 ];\n		transformed += morphTarget3 * morphTargetInfluences[ 3 ];\n		#ifndef USE_MORPHNORMALS\n			transformed += morphTarget4 * morphTargetInfluences[ 4 ];\n			transformed += morphTarget5 * morphTargetInfluences[ 5 ];\n			transformed += morphTarget6 * morphTargetInfluences[ 6 ];\n			transformed += morphTarget7 * morphTargetInfluences[ 7 ];\n		#endif\n	#endif\n#endif",cV="float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 nonPerturbedNormal = normal;",uV="#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",hV="#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",dV="#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",fV="#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",pV="#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",mV="#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = nonPerturbedNormal;\n#endif",gV="#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",vV="#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",_V="#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",yV="#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",bV="vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n	return packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",xV="#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",wV="vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",MV="#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",EV="#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",SV="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",TV="#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",AV="#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return shadow;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;\n		vec3 bd3D = normalize( lightToPosition );\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif",CV="#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",PV="#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",RV="float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",LV="#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",OV="#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	uniform int boneTextureSize;\n	mat4 getBoneMatrix( const in float i ) {\n		float j = i * 4.0;\n		float x = mod( j, float( boneTextureSize ) );\n		float y = floor( j / float( boneTextureSize ) );\n		float dx = 1.0 / float( boneTextureSize );\n		float dy = 1.0 / float( boneTextureSize );\n		y = dy * ( y + 0.5 );\n		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n		mat4 bone = mat4( v1, v2, v3, v4 );\n		return bone;\n	}\n#endif",IV="#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",DV="#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",UV="float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",NV="#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",FV="#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",kV="#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",BV="#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",zV="#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n		vec3 refractedRayExit = position + transmissionRay;\n		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n		vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n		refractionCoords += 1.0;\n		refractionCoords /= 2.0;\n		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",VV="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",HV="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",GV="#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",WV="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif";const $V="varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",jV="uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",XV="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",YV="#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",qV="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",KV="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",ZV="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",JV="#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#endif\n}",QV="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",e6="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",t6="varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",n6="uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",i6="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",r6="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",s6="#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",o6="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",a6="#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",l6="#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",c6="#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",u6="#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",h6="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",d6="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",f6="#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",p6="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",m6="#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",g6="#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",v6="#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",_6="#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",y6="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",b6="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",x6="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",w6="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",M6="uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",E6="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",at={alphahash_fragment:Y5,alphahash_pars_fragment:q5,alphamap_fragment:K5,alphamap_pars_fragment:Z5,alphatest_fragment:J5,alphatest_pars_fragment:Q5,aomap_fragment:ez,aomap_pars_fragment:tz,begin_vertex:nz,beginnormal_vertex:iz,bsdfs:rz,iridescence_fragment:sz,bumpmap_pars_fragment:oz,clipping_planes_fragment:az,clipping_planes_pars_fragment:lz,clipping_planes_pars_vertex:cz,clipping_planes_vertex:uz,color_fragment:hz,color_pars_fragment:dz,color_pars_vertex:fz,color_vertex:pz,common:mz,cube_uv_reflection_fragment:gz,defaultnormal_vertex:vz,displacementmap_pars_vertex:_z,displacementmap_vertex:yz,emissivemap_fragment:bz,emissivemap_pars_fragment:xz,colorspace_fragment:wz,colorspace_pars_fragment:Mz,envmap_fragment:Ez,envmap_common_pars_fragment:Sz,envmap_pars_fragment:Tz,envmap_pars_vertex:Az,envmap_physical_pars_fragment:Bz,envmap_vertex:Cz,fog_vertex:Pz,fog_pars_vertex:Rz,fog_fragment:Lz,fog_pars_fragment:Oz,gradientmap_pars_fragment:Iz,lightmap_fragment:Dz,lightmap_pars_fragment:Uz,lights_lambert_fragment:Nz,lights_lambert_pars_fragment:Fz,lights_pars_begin:kz,lights_toon_fragment:zz,lights_toon_pars_fragment:Vz,lights_phong_fragment:Hz,lights_phong_pars_fragment:Gz,lights_physical_fragment:Wz,lights_physical_pars_fragment:$z,lights_fragment_begin:jz,lights_fragment_maps:Xz,lights_fragment_end:Yz,logdepthbuf_fragment:qz,logdepthbuf_pars_fragment:Kz,logdepthbuf_pars_vertex:Zz,logdepthbuf_vertex:Jz,map_fragment:Qz,map_pars_fragment:eV,map_particle_fragment:tV,map_particle_pars_fragment:nV,metalnessmap_fragment:iV,metalnessmap_pars_fragment:rV,morphcolor_vertex:sV,morphnormal_vertex:oV,morphtarget_pars_vertex:aV,morphtarget_vertex:lV,normal_fragment_begin:cV,normal_fragment_maps:uV,normal_pars_fragment:hV,normal_pars_vertex:dV,normal_vertex:fV,normalmap_pars_fragment:pV,clearcoat_normal_fragment_begin:mV,clearcoat_normal_fragment_maps:gV,clearcoat_pars_fragment:vV,iridescence_pars_fragment:_V,opaque_fragment:yV,packing:bV,premultiplied_alpha_fragment:xV,project_vertex:wV,dithering_fragment:MV,dithering_pars_fragment:EV,roughnessmap_fragment:SV,roughnessmap_pars_fragment:TV,shadowmap_pars_fragment:AV,shadowmap_pars_vertex:CV,shadowmap_vertex:PV,shadowmask_pars_fragment:RV,skinbase_vertex:LV,skinning_pars_vertex:OV,skinning_vertex:IV,skinnormal_vertex:DV,specularmap_fragment:UV,specularmap_pars_fragment:NV,tonemapping_fragment:FV,tonemapping_pars_fragment:kV,transmission_fragment:BV,transmission_pars_fragment:zV,uv_pars_fragment:VV,uv_pars_vertex:HV,uv_vertex:GV,worldpos_vertex:WV,background_vert:$V,background_frag:jV,backgroundCube_vert:XV,backgroundCube_frag:YV,cube_vert:qV,cube_frag:KV,depth_vert:ZV,depth_frag:JV,distanceRGBA_vert:QV,distanceRGBA_frag:e6,equirect_vert:t6,equirect_frag:n6,linedashed_vert:i6,linedashed_frag:r6,meshbasic_vert:s6,meshbasic_frag:o6,meshlambert_vert:a6,meshlambert_frag:l6,meshmatcap_vert:c6,meshmatcap_frag:u6,meshnormal_vert:h6,meshnormal_frag:d6,meshphong_vert:f6,meshphong_frag:p6,meshphysical_vert:m6,meshphysical_frag:g6,meshtoon_vert:v6,meshtoon_frag:_6,points_vert:y6,points_frag:b6,shadow_vert:x6,shadow_frag:w6,sprite_vert:M6,sprite_frag:E6},De={common:{diffuse:{value:new Oe(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ct}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ct}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ct}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ct},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ct},normalScale:{value:new me(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ct},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ct}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ct}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ct}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Oe(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Oe(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0},uvTransform:{value:new ct}},sprite:{diffuse:{value:new Oe(16777215)},opacity:{value:1},center:{value:new me(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ct},alphaMap:{value:null},alphaMapTransform:{value:new ct},alphaTest:{value:0}}},Zi={basic:{uniforms:ri([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.fog]),vertexShader:at.meshbasic_vert,fragmentShader:at.meshbasic_frag},lambert:{uniforms:ri([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.fog,De.lights,{emissive:{value:new Oe(0)}}]),vertexShader:at.meshlambert_vert,fragmentShader:at.meshlambert_frag},phong:{uniforms:ri([De.common,De.specularmap,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.fog,De.lights,{emissive:{value:new Oe(0)},specular:{value:new Oe(1118481)},shininess:{value:30}}]),vertexShader:at.meshphong_vert,fragmentShader:at.meshphong_frag},standard:{uniforms:ri([De.common,De.envmap,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.roughnessmap,De.metalnessmap,De.fog,De.lights,{emissive:{value:new Oe(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:at.meshphysical_vert,fragmentShader:at.meshphysical_frag},toon:{uniforms:ri([De.common,De.aomap,De.lightmap,De.emissivemap,De.bumpmap,De.normalmap,De.displacementmap,De.gradientmap,De.fog,De.lights,{emissive:{value:new Oe(0)}}]),vertexShader:at.meshtoon_vert,fragmentShader:at.meshtoon_frag},matcap:{uniforms:ri([De.common,De.bumpmap,De.normalmap,De.displacementmap,De.fog,{matcap:{value:null}}]),vertexShader:at.meshmatcap_vert,fragmentShader:at.meshmatcap_frag},points:{uniforms:ri([De.points,De.fog]),vertexShader:at.points_vert,fragmentShader:at.points_frag},dashed:{uniforms:ri([De.common,De.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:at.linedashed_vert,fragmentShader:at.linedashed_frag},depth:{uniforms:ri([De.common,De.displacementmap]),vertexShader:at.depth_vert,fragmentShader:at.depth_frag},normal:{uniforms:ri([De.common,De.bumpmap,De.normalmap,De.displacementmap,{opacity:{value:1}}]),vertexShader:at.meshnormal_vert,fragmentShader:at.meshnormal_frag},sprite:{uniforms:ri([De.sprite,De.fog]),vertexShader:at.sprite_vert,fragmentShader:at.sprite_frag},background:{uniforms:{uvTransform:{value:new ct},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:at.background_vert,fragmentShader:at.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:at.backgroundCube_vert,fragmentShader:at.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:at.cube_vert,fragmentShader:at.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:at.equirect_vert,fragmentShader:at.equirect_frag},distanceRGBA:{uniforms:ri([De.common,De.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:at.distanceRGBA_vert,fragmentShader:at.distanceRGBA_frag},shadow:{uniforms:ri([De.lights,De.fog,{color:{value:new Oe(0)},opacity:{value:1}}]),vertexShader:at.shadow_vert,fragmentShader:at.shadow_frag}};Zi.physical={uniforms:ri([Zi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ct},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ct},clearcoatNormalScale:{value:new me(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ct},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ct},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ct},sheen:{value:0},sheenColor:{value:new Oe(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ct},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ct},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ct},transmissionSamplerSize:{value:new me},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ct},attenuationDistance:{value:0},attenuationColor:{value:new Oe(0)},specularColor:{value:new Oe(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ct},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ct},anisotropyVector:{value:new me},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ct}}]),vertexShader:at.meshphysical_vert,fragmentShader:at.meshphysical_frag};const Bd={r:0,b:0,g:0};function S6(n,e,t,i,r,s,o){const a=new Oe(0);let l=s===!0?0:1,c,u,h=null,d=0,f=null;function p(m,g){let b=!1,y=g.isScene===!0?g.background:null;y&&y.isTexture&&(y=(g.backgroundBlurriness>0?t:e).get(y)),y===null?v(a,l):y&&y.isColor&&(v(y,1),b=!0);const _=n.xr.getEnvironmentBlendMode();_==="additive"?i.buffers.color.setClear(0,0,0,1,o):_==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||b)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),y&&(y.isCubeTexture||y.mapping===yc)?(u===void 0&&(u=new ke(new si(1,1,1),new or({name:"BackgroundCubeMaterial",uniforms:cc(Zi.backgroundCube.uniforms),vertexShader:Zi.backgroundCube.vertexShader,fragmentShader:Zi.backgroundCube.fragmentShader,side:Yn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(T,w,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=Dt.getTransfer(y.colorSpace)!==Bt,(h!==y||d!==y.version||f!==n.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(c===void 0&&(c=new ke(new Oi(2,2),new or({name:"BackgroundMaterial",uniforms:cc(Zi.background.uniforms),vertexShader:Zi.background.vertexShader,fragmentShader:Zi.background.fragmentShader,side:Yr,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=y,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=Dt.getTransfer(y.colorSpace)!==Bt,y.matrixAutoUpdate===!0&&y.updateMatrix(),c.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==n.toneMapping)&&(c.material.needsUpdate=!0,h=y,d=y.version,f=n.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function v(m,g){m.getRGB(Bd,uC(n)),i.buffers.color.setClear(Bd.r,Bd.g,Bd.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(m,g=1){a.set(m),l=g,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,v(a,l)},render:p}}function T6(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=m(null);let c=l,u=!1;function h(U,j,W,q,ie){let Z=!1;if(o){const te=v(q,W,j);c!==te&&(c=te,f(c.object)),Z=g(U,q,W,ie),Z&&b(U,q,W,ie)}else{const te=j.wireframe===!0;(c.geometry!==q.id||c.program!==W.id||c.wireframe!==te)&&(c.geometry=q.id,c.program=W.id,c.wireframe=te,Z=!0)}ie!==null&&t.update(ie,n.ELEMENT_ARRAY_BUFFER),(Z||u)&&(u=!1,x(U,j,W,q),ie!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(ie).buffer))}function d(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function f(U){return i.isWebGL2?n.bindVertexArray(U):s.bindVertexArrayOES(U)}function p(U){return i.isWebGL2?n.deleteVertexArray(U):s.deleteVertexArrayOES(U)}function v(U,j,W){const q=W.wireframe===!0;let ie=a[U.id];ie===void 0&&(ie={},a[U.id]=ie);let Z=ie[j.id];Z===void 0&&(Z={},ie[j.id]=Z);let te=Z[q];return te===void 0&&(te=m(d()),Z[q]=te),te}function m(U){const j=[],W=[],q=[];for(let ie=0;ie<r;ie++)j[ie]=0,W[ie]=0,q[ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:W,attributeDivisors:q,object:U,attributes:{},index:null}}function g(U,j,W,q){const ie=c.attributes,Z=j.attributes;let te=0;const X=W.getAttributes();for(const se in X)if(X[se].location>=0){const xe=ie[se];let Re=Z[se];if(Re===void 0&&(se==="instanceMatrix"&&U.instanceMatrix&&(Re=U.instanceMatrix),se==="instanceColor"&&U.instanceColor&&(Re=U.instanceColor)),xe===void 0||xe.attribute!==Re||Re&&xe.data!==Re.data)return!0;te++}return c.attributesNum!==te||c.index!==q}function b(U,j,W,q){const ie={},Z=j.attributes;let te=0;const X=W.getAttributes();for(const se in X)if(X[se].location>=0){let xe=Z[se];xe===void 0&&(se==="instanceMatrix"&&U.instanceMatrix&&(xe=U.instanceMatrix),se==="instanceColor"&&U.instanceColor&&(xe=U.instanceColor));const Re={};Re.attribute=xe,xe&&xe.data&&(Re.data=xe.data),ie[se]=Re,te++}c.attributes=ie,c.attributesNum=te,c.index=q}function y(){const U=c.newAttributes;for(let j=0,W=U.length;j<W;j++)U[j]=0}function _(U){T(U,0)}function T(U,j){const W=c.newAttributes,q=c.enabledAttributes,ie=c.attributeDivisors;W[U]=1,q[U]===0&&(n.enableVertexAttribArray(U),q[U]=1),ie[U]!==j&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,j),ie[U]=j)}function w(){const U=c.newAttributes,j=c.enabledAttributes;for(let W=0,q=j.length;W<q;W++)j[W]!==U[W]&&(n.disableVertexAttribArray(W),j[W]=0)}function S(U,j,W,q,ie,Z,te){te===!0?n.vertexAttribIPointer(U,j,W,ie,Z):n.vertexAttribPointer(U,j,W,q,ie,Z)}function x(U,j,W,q){if(i.isWebGL2===!1&&(U.isInstancedMesh||q.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;y();const ie=q.attributes,Z=W.getAttributes(),te=j.defaultAttributeValues;for(const X in Z){const se=Z[X];if(se.location>=0){let G=ie[X];if(G===void 0&&(X==="instanceMatrix"&&U.instanceMatrix&&(G=U.instanceMatrix),X==="instanceColor"&&U.instanceColor&&(G=U.instanceColor)),G!==void 0){const xe=G.normalized,Re=G.itemSize,Ie=t.get(G);if(Ie===void 0)continue;const Q=Ie.buffer,K=Ie.type,P=Ie.bytesPerElement,F=i.isWebGL2===!0&&(K===n.INT||K===n.UNSIGNED_INT||G.gpuType===V_);if(G.isInterleavedBufferAttribute){const k=G.data,A=k.stride,R=G.offset;if(k.isInstancedInterleavedBuffer){for(let I=0;I<se.locationSize;I++)T(se.location+I,k.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=k.meshPerAttribute*k.count)}else for(let I=0;I<se.locationSize;I++)_(se.location+I);n.bindBuffer(n.ARRAY_BUFFER,Q);for(let I=0;I<se.locationSize;I++)S(se.location+I,Re/se.locationSize,K,xe,A*P,(R+Re/se.locationSize*I)*P,F)}else{if(G.isInstancedBufferAttribute){for(let k=0;k<se.locationSize;k++)T(se.location+k,G.meshPerAttribute);U.isInstancedMesh!==!0&&q._maxInstanceCount===void 0&&(q._maxInstanceCount=G.meshPerAttribute*G.count)}else for(let k=0;k<se.locationSize;k++)_(se.location+k);n.bindBuffer(n.ARRAY_BUFFER,Q);for(let k=0;k<se.locationSize;k++)S(se.location+k,Re/se.locationSize,K,xe,Re*P,Re/se.locationSize*k*P,F)}}else if(te!==void 0){const xe=te[X];if(xe!==void 0)switch(xe.length){case 2:n.vertexAttrib2fv(se.location,xe);break;case 3:n.vertexAttrib3fv(se.location,xe);break;case 4:n.vertexAttrib4fv(se.location,xe);break;default:n.vertexAttrib1fv(se.location,xe)}}}}w()}function M(){O();for(const U in a){const j=a[U];for(const W in j){const q=j[W];for(const ie in q)p(q[ie].object),delete q[ie];delete j[W]}delete a[U]}}function E(U){if(a[U.id]===void 0)return;const j=a[U.id];for(const W in j){const q=j[W];for(const ie in q)p(q[ie].object),delete q[ie];delete j[W]}delete a[U.id]}function C(U){for(const j in a){const W=a[j];if(W[U.id]===void 0)continue;const q=W[U.id];for(const ie in q)p(q[ie].object),delete q[ie];delete W[U.id]}}function O(){$(),u=!0,c!==l&&(c=l,f(c.object))}function $(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:O,resetDefaultState:$,dispose:M,releaseStatesOfGeometry:E,releaseStatesOfProgram:C,initAttributes:y,enableAttribute:_,disableUnusedAttributes:w}}function A6(n,e,t,i){const r=i.isWebGL2;let s;function o(c){s=c}function a(c,u){n.drawArrays(s,c,u),t.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,f;if(r)d=n,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,u,h),t.update(u,s,h)}this.setMode=o,this.render=a,this.renderInstances=l}function C6(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const S=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(S.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(S){if(S==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";S="mediump"}return S==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=n.getParameter(n.MAX_TEXTURE_SIZE),p=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),m=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),b=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,_=o||e.has("OES_texture_float"),T=y&&_,w=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:b,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:T,maxSamples:w}}function P6(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new gs,a=new ct,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||i!==0||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,v=h.clipIntersection,m=h.clipShadows,g=n.get(h);if(!r||p===null||p.length===0||s&&!m)s?u(null):c();else{const b=s?0:i,y=b*4;let _=g.clippingState||null;l.value=_,_=u(p,d,y,f);for(let T=0;T!==y;++T)_[T]=t[T];g.clippingState=_,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=b}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const v=h!==null?h.length:0;let m=null;if(v!==0){if(m=l.value,p!==!0||m===null){const g=f+v*4,b=d.matrixWorldInverse;a.getNormalMatrix(b),(m===null||m.length<g)&&(m=new Float32Array(g));for(let y=0,_=f;y!==v;++y,_+=4)o.copy(h[y]).applyMatrix4(b,a),o.normal.toArray(m,_),m[_+3]=o.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,m}}function R6(n){let e=new WeakMap;function t(o,a){return a===rc?o.mapping=Ps:a===rh&&(o.mapping=To),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===rc||a===rh)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new dC(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class Ni extends Fh{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Ol=4,a1=[.125,.215,.35,.446,.526,.582],sa=20,mg=new Ni,l1=new Oe;let gg=null;const ta=(1+Math.sqrt(5))/2,hl=1/ta,c1=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,ta,hl),new D(0,ta,-hl),new D(hl,0,ta),new D(-hl,0,ta),new D(ta,hl,0),new D(-ta,hl,0)];class d0{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){gg=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=d1(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=h1(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(gg),e.scissorTest=!1,zd(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ps||e.mapping===To?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),gg=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Qt,minFilter:Qt,generateMipmaps:!1,type:oc,format:Di,colorSpace:Zr,depthBuffer:!1},r=u1(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=u1(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=L6(s)),this._blurMaterial=O6(s,e,t)}return r}_compileMaterial(e){const t=new ke(this._lodPlanes[0],e);this._renderer.compile(t,mg)}_sceneToCubeUV(e,t,i,r){const a=new Nt(90,1,t,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(l1),u.toneMapping=xs,u.autoClear=!1;const f=new Xn({name:"PMREM.Background",side:Yn,depthWrite:!1,depthTest:!1}),p=new ke(new si,f);let v=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,v=!0):(f.color.copy(l1),v=!0);for(let g=0;g<6;g++){const b=g%3;b===0?(a.up.set(0,l[g],0),a.lookAt(c[g],0,0)):b===1?(a.up.set(0,0,l[g]),a.lookAt(0,c[g],0)):(a.up.set(0,l[g],0),a.lookAt(0,0,c[g]));const y=this._cubeSize;zd(r,b*y,g>2?y:0,y,y),u.setRenderTarget(r),v&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=m}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ps||e.mapping===To;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=d1()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=h1());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new ke(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;zd(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,mg)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=c1[(r-1)%c1.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new ke(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*sa-1),v=s/p,m=isFinite(s)?1+Math.floor(u*v):sa;m>sa&&console.warn("sigmaRadians, ".concat(s,", is too large and will clip, as it requested ").concat(m," samples when the maximum is set to ").concat(sa));const g=[];let b=0;for(let S=0;S<sa;++S){const x=S/v,M=Math.exp(-x*x/2);g.push(M),S===0?b+=M:S<m&&(b+=2*M)}for(let S=0;S<g.length;S++)g[S]=g[S]/b;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=g,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:y}=this;d.dTheta.value=p,d.mipInt.value=y-i;const _=this._sizeLods[r],T=3*_*(r>y-Ol?r-y+Ol:0),w=4*(this._cubeSize-_);zd(t,T,w,3*_,2*_),l.setRenderTarget(t),l.render(h,mg)}}function L6(n){const e=[],t=[],i=[];let r=n;const s=n-Ol+1+a1.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-Ol?l=a1[o-n+Ol-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,v=3,m=2,g=1,b=new Float32Array(v*p*f),y=new Float32Array(m*p*f),_=new Float32Array(g*p*f);for(let w=0;w<f;w++){const S=w%3*2/3-1,x=w>2?0:-1,M=[S,x,0,S+2/3,x,0,S+2/3,x+1,0,S,x,0,S+2/3,x+1,0,S,x+1,0];b.set(M,v*p*w),y.set(d,m*p*w);const E=[w,w,w,w,w,w];_.set(E,g*p*w)}const T=new Ye;T.setAttribute("position",new Tt(b,v)),T.setAttribute("uv",new Tt(y,m)),T.setAttribute("faceIndex",new Tt(_,g)),e.push(T),r>Ol&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function u1(n,e,t){const i=new Sr(n,e,t);return i.texture.mapping=yc,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function zd(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function O6(n,e,t){const i=new Float32Array(sa),r=new D(0,1,0);return new or({name:"SphericalGaussianBlur",defines:{n:sa,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:"".concat(n,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:ey(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform int samples;\n			uniform float weights[ n ];\n			uniform bool latitudinal;\n			uniform float dTheta;\n			uniform float mipInt;\n			uniform vec3 poleAxis;\n\n			#define ENVMAP_TYPE_CUBE_UV\n			#include <cube_uv_reflection_fragment>\n\n			vec3 getSample( float theta, vec3 axis ) {\n\n				float cosTheta = cos( theta );\n				// Rodrigues' axis-angle rotation\n				vec3 sampleDirection = vOutputDirection * cosTheta\n					+ cross( axis, vOutputDirection ) * sin( theta )\n					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n				return bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n			}\n\n			void main() {\n\n				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n				}\n\n				axis = normalize( axis );\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n				for ( int i = 1; i < n; i++ ) {\n\n					if ( i >= samples ) {\n\n						break;\n\n					}\n\n					float theta = dTheta * float( i );\n					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n				}\n\n			}\n		",blending:bs,depthTest:!1,depthWrite:!1})}function h1(){return new or({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ey(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n\n			#include <common>\n\n			void main() {\n\n				vec3 outputDirection = normalize( vOutputDirection );\n				vec2 uv = equirectUv( outputDirection );\n\n				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n			}\n		",blending:bs,depthTest:!1,depthWrite:!1})}function d1(){return new or({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ey(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			uniform float flipEnvMap;\n\n			varying vec3 vOutputDirection;\n\n			uniform samplerCube envMap;\n\n			void main() {\n\n				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n			}\n		",blending:bs,depthTest:!1,depthWrite:!1})}function ey(){return"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	"}function I6(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===rc||l===rh,u=l===Ps||l===To;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new d0(n)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&r(h)){t===null&&(t=new d0(n));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function D6(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function U6(n,e,t,i){const r={},s=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);for(const p in d.morphAttributes){const v=d.morphAttributes[p];for(let m=0,g=v.length;m<g;m++)e.remove(v[m])}d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d}function l(h){const d=h.attributes;for(const p in d)e.update(d[p],n.ARRAY_BUFFER);const f=h.morphAttributes;for(const p in f){const v=f[p];for(let m=0,g=v.length;m<g;m++)e.update(v[m],n.ARRAY_BUFFER)}}function c(h){const d=[],f=h.index,p=h.attributes.position;let v=0;if(f!==null){const b=f.array;v=f.version;for(let y=0,_=b.length;y<_;y+=3){const T=b[y+0],w=b[y+1],S=b[y+2];d.push(T,w,w,S,S,T)}}else if(p!==void 0){const b=p.array;v=p.version;for(let y=0,_=b.length/3-1;y<_;y+=3){const T=y+0,w=y+1,S=y+2;d.push(T,w,w,S,S,T)}}else return;const m=new(oC(d)?Q_:qp)(d,1);m.version=v;const g=s.get(h);g&&e.remove(g),s.set(h,m)}function u(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&c(h)}else c(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:u}}function N6(n,e,t,i){const r=i.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function u(d,f){n.drawElements(s,f,a,d*l),t.update(f,s,1)}function h(d,f,p){if(p===0)return;let v,m;if(r)v=n,m="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[m](s,f,a,d*l,p),t.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h}function F6(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function k6(n,e){return n[0]-e[0]}function B6(n,e){return Math.abs(e[1])-Math.abs(n[1])}function z6(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new gt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,h){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=f!==void 0?f.length:0;let v=s.get(u);if(v===void 0||v.count!==p){let U=function(){O.dispose(),s.delete(u),u.removeEventListener("dispose",U)};v!==void 0&&v.texture.dispose();const b=u.morphAttributes.position!==void 0,y=u.morphAttributes.normal!==void 0,_=u.morphAttributes.color!==void 0,T=u.morphAttributes.position||[],w=u.morphAttributes.normal||[],S=u.morphAttributes.color||[];let x=0;b===!0&&(x=1),y===!0&&(x=2),_===!0&&(x=3);let M=u.attributes.position.count*x,E=1;M>e.maxTextureSize&&(E=Math.ceil(M/e.maxTextureSize),M=e.maxTextureSize);const C=new Float32Array(M*E*4*p),O=new Xp(C,M,E,p);O.type=zr,O.needsUpdate=!0;const $=x*4;for(let j=0;j<p;j++){const W=T[j],q=w[j],ie=S[j],Z=M*E*4*j;for(let te=0;te<W.count;te++){const X=te*$;b===!0&&(o.fromBufferAttribute(W,te),C[Z+X+0]=o.x,C[Z+X+1]=o.y,C[Z+X+2]=o.z,C[Z+X+3]=0),y===!0&&(o.fromBufferAttribute(q,te),C[Z+X+4]=o.x,C[Z+X+5]=o.y,C[Z+X+6]=o.z,C[Z+X+7]=0),_===!0&&(o.fromBufferAttribute(ie,te),C[Z+X+8]=o.x,C[Z+X+9]=o.y,C[Z+X+10]=o.z,C[Z+X+11]=ie.itemSize===4?o.w:1)}}v={count:p,texture:O,size:new me(M,E)},s.set(u,v),u.addEventListener("dispose",U)}let m=0;for(let b=0;b<d.length;b++)m+=d[b];const g=u.morphTargetsRelative?1:1-m;h.getUniforms().setValue(n,"morphTargetBaseInfluence",g),h.getUniforms().setValue(n,"morphTargetInfluences",d),h.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}else{const f=d===void 0?0:d.length;let p=i[u.id];if(p===void 0||p.length!==f){p=[];for(let y=0;y<f;y++)p[y]=[y,0];i[u.id]=p}for(let y=0;y<f;y++){const _=p[y];_[0]=y,_[1]=d[y]}p.sort(B6);for(let y=0;y<8;y++)y<f&&p[y][1]?(a[y][0]=p[y][0],a[y][1]=p[y][1]):(a[y][0]=Number.MAX_SAFE_INTEGER,a[y][1]=0);a.sort(k6);const v=u.morphAttributes.position,m=u.morphAttributes.normal;let g=0;for(let y=0;y<8;y++){const _=a[y],T=_[0],w=_[1];T!==Number.MAX_SAFE_INTEGER&&w?(v&&u.getAttribute("morphTarget"+y)!==v[T]&&u.setAttribute("morphTarget"+y,v[T]),m&&u.getAttribute("morphNormal"+y)!==m[T]&&u.setAttribute("morphNormal"+y,m[T]),r[y]=w,g+=w):(v&&u.hasAttribute("morphTarget"+y)===!0&&u.deleteAttribute("morphTarget"+y),m&&u.hasAttribute("morphNormal"+y)===!0&&u.deleteAttribute("morphNormal"+y),r[y]=0)}const b=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(n,"morphTargetBaseInfluence",b),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:l}}function V6(n,e,t,i){let r=new WeakMap;function s(l){const c=i.render.frame,u=l.geometry,h=e.get(l,u);if(r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return h}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}const pC=new Yt,mC=new Xp,gC=new J_,vC=new kh,f1=[],p1=[],m1=new Float32Array(16),g1=new Float32Array(9),v1=new Float32Array(4);function bc(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=f1[r];if(s===void 0&&(s=new Float32Array(r),f1[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Rn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function Ln(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function Jp(n,e){let t=p1[e];t===void 0&&(t=new Int32Array(e),p1[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function H6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function G6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Rn(t,e))return;n.uniform2fv(this.addr,e),Ln(t,e)}}function W6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Rn(t,e))return;n.uniform3fv(this.addr,e),Ln(t,e)}}function $6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Rn(t,e))return;n.uniform4fv(this.addr,e),Ln(t,e)}}function j6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Rn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Ln(t,e)}else{if(Rn(t,i))return;v1.set(i),n.uniformMatrix2fv(this.addr,!1,v1),Ln(t,i)}}function X6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Rn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Ln(t,e)}else{if(Rn(t,i))return;g1.set(i),n.uniformMatrix3fv(this.addr,!1,g1),Ln(t,i)}}function Y6(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Rn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Ln(t,e)}else{if(Rn(t,i))return;m1.set(i),n.uniformMatrix4fv(this.addr,!1,m1),Ln(t,i)}}function q6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function K6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Rn(t,e))return;n.uniform2iv(this.addr,e),Ln(t,e)}}function Z6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Rn(t,e))return;n.uniform3iv(this.addr,e),Ln(t,e)}}function J6(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Rn(t,e))return;n.uniform4iv(this.addr,e),Ln(t,e)}}function Q6(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function eH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Rn(t,e))return;n.uniform2uiv(this.addr,e),Ln(t,e)}}function tH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Rn(t,e))return;n.uniform3uiv(this.addr,e),Ln(t,e)}}function nH(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Rn(t,e))return;n.uniform4uiv(this.addr,e),Ln(t,e)}}function iH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||pC,r)}function rH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||gC,r)}function sH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||vC,r)}function oH(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||mC,r)}function aH(n){switch(n){case 5126:return H6;case 35664:return G6;case 35665:return W6;case 35666:return $6;case 35674:return j6;case 35675:return X6;case 35676:return Y6;case 5124:case 35670:return q6;case 35667:case 35671:return K6;case 35668:case 35672:return Z6;case 35669:case 35673:return J6;case 5125:return Q6;case 36294:return eH;case 36295:return tH;case 36296:return nH;case 35678:case 36198:case 36298:case 36306:case 35682:return iH;case 35679:case 36299:case 36307:return rH;case 35680:case 36300:case 36308:case 36293:return sH;case 36289:case 36303:case 36311:case 36292:return oH}}function lH(n,e){n.uniform1fv(this.addr,e)}function cH(n,e){const t=bc(e,this.size,2);n.uniform2fv(this.addr,t)}function uH(n,e){const t=bc(e,this.size,3);n.uniform3fv(this.addr,t)}function hH(n,e){const t=bc(e,this.size,4);n.uniform4fv(this.addr,t)}function dH(n,e){const t=bc(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function fH(n,e){const t=bc(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function pH(n,e){const t=bc(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function mH(n,e){n.uniform1iv(this.addr,e)}function gH(n,e){n.uniform2iv(this.addr,e)}function vH(n,e){n.uniform3iv(this.addr,e)}function _H(n,e){n.uniform4iv(this.addr,e)}function yH(n,e){n.uniform1uiv(this.addr,e)}function bH(n,e){n.uniform2uiv(this.addr,e)}function xH(n,e){n.uniform3uiv(this.addr,e)}function wH(n,e){n.uniform4uiv(this.addr,e)}function MH(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Rn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||pC,s[o])}function EH(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Rn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||gC,s[o])}function SH(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Rn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||vC,s[o])}function TH(n,e,t){const i=this.cache,r=e.length,s=Jp(t,r);Rn(i,s)||(n.uniform1iv(this.addr,s),Ln(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||mC,s[o])}function AH(n){switch(n){case 5126:return lH;case 35664:return cH;case 35665:return uH;case 35666:return hH;case 35674:return dH;case 35675:return fH;case 35676:return pH;case 5124:case 35670:return mH;case 35667:case 35671:return gH;case 35668:case 35672:return vH;case 35669:case 35673:return _H;case 5125:return yH;case 36294:return bH;case 36295:return xH;case 36296:return wH;case 35678:case 36198:case 36298:case 36306:case 35682:return MH;case 35679:case 36299:case 36307:return EH;case 35680:case 36300:case 36308:case 36293:return SH;case 36289:case 36303:case 36311:case 36292:return TH}}class CH{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=aH(t.type)}}class PH{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=AH(t.type)}}class RH{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const vg=/(\w+)(\])?(\[|\.)?/g;function _1(n,e){n.seq.push(e),n.map[e.id]=e}function LH(n,e,t){const i=n.name,r=i.length;for(vg.lastIndex=0;;){const s=vg.exec(i),o=vg.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){_1(t,c===void 0?new CH(a,n,e):new PH(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new RH(a),_1(t,h)),t=h}}}class Uf{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);LH(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function y1(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let OH=0;function IH(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push("".concat(a===e?">":" "," ").concat(a,": ").concat(t[o]))}return i.join("\n")}function DH(n){const e=Dt.getPrimaries(Dt.workingColorSpace),t=Dt.getPrimaries(n);let i;switch(e===t?i="":e===ch&&t===lh?i="LinearDisplayP3ToLinearSRGB":e===lh&&t===ch&&(i="LinearSRGBToLinearDisplayP3"),n){case Zr:case Nh:return[i,"LinearTransferOETF"];case Mn:case jp:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function b1(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+IH(n.getShaderSource(e),o)}else return r}function UH(n,e){const t=DH(e);return"vec4 ".concat(n,"( vec4 value ) { return ").concat(t[0],"( ").concat(t[1],"( value ) ); }")}function NH(n,e){let t;switch(e){case RA:t="Linear";break;case LA:t="Reinhard";break;case OA:t="OptimizedCineon";break;case z_:t="ACESFilmic";break;case IA:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function FH(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(mu).join("\n")}function kH(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join("\n")}function BH(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function mu(n){return n!==""}function x1(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function w1(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const zH=/^[ \t]*#include +<([\w\d./]+)>/gm;function f0(n){return n.replace(zH,HH)}const VH=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function HH(n,e){let t=at[e];if(t===void 0){const i=VH.get(e);if(i!==void 0)t=at[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return f0(t)}const GH=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function M1(n){return n.replace(GH,WH)}function WH(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function E1(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return n.precision==="highp"?e+="\n#define HIGH_PRECISION":n.precision==="mediump"?e+="\n#define MEDIUM_PRECISION":n.precision==="lowp"&&(e+="\n#define LOW_PRECISION"),e}function $H(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===N_?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===F_?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Fr&&(e="SHADOWMAP_TYPE_VSM"),e}function jH(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ps:case To:e="ENVMAP_TYPE_CUBE";break;case yc:e="ENVMAP_TYPE_CUBE_UV";break}return e}function XH(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case To:e="ENVMAP_MODE_REFRACTION";break}return e}function YH(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Uh:e="ENVMAP_BLENDING_MULTIPLY";break;case CA:e="ENVMAP_BLENDING_MIX";break;case PA:e="ENVMAP_BLENDING_ADD";break}return e}function qH(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function KH(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=$H(t),c=jH(t),u=XH(t),h=YH(t),d=qH(t),f=t.isWebGL2?"":FH(t),p=kH(s),v=r.createProgram();let m,g,b=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(mu).join("\n"),m.length>0&&(m+="\n"),g=[f,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(mu).join("\n"),g.length>0&&(g+="\n")):(m=[E1(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(mu).join("\n"),g=[f,E1(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==xs?"#define TONE_MAPPING":"",t.toneMapping!==xs?at.tonemapping_pars_fragment:"",t.toneMapping!==xs?NH("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",at.colorspace_pars_fragment,UH("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(mu).join("\n")),o=f0(o),o=x1(o,t),o=w1(o,t),a=f0(a),a=x1(a,t),a=w1(a,t),o=M1(o),a=M1(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(b="#version 300 es\n",m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+m,g=["#define varying in",t.glslVersion===u0?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===u0?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+g);const y=b+m+o,_=b+g+a,T=y1(r,r.VERTEX_SHADER,y),w=y1(r,r.FRAGMENT_SHADER,_);if(r.attachShader(v,T),r.attachShader(v,w),t.index0AttributeName!==void 0?r.bindAttribLocation(v,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),n.debug.checkShaderErrors){const M=r.getProgramInfoLog(v).trim(),E=r.getShaderInfoLog(T).trim(),C=r.getShaderInfoLog(w).trim();let O=!0,$=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(O=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,v,T,w);else{const U=b1(r,T,"vertex"),j=b1(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+"\n\nProgram Info Log: "+M+"\n"+U+"\n"+j)}else M!==""?console.warn("THREE.WebGLProgram: Program Info Log:",M):(E===""||C==="")&&($=!1);$&&(this.diagnostics={runnable:O,programLog:M,vertexShader:{log:E,prefix:m},fragmentShader:{log:C,prefix:g}})}r.deleteShader(T),r.deleteShader(w);let S;this.getUniforms=function(){return S===void 0&&(S=new Uf(r,v)),S};let x;return this.getAttributes=function(){return x===void 0&&(x=BH(r,v)),x},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=OH++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=T,this.fragmentShader=w,this}let ZH=0;class JH{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new QH(e),t.set(e,i)),i}}class QH{constructor(e){this.id=ZH++,this.code=e,this.usedTimes=0}}function e8(n,e,t,i,r,s,o){const a=new Yp,l=new JH,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(M){return M===0?"uv":"uv".concat(M)}function m(M,E,C,O,$){const U=O.fog,j=$.geometry,W=M.isMeshStandardMaterial?O.environment:null,q=(M.isMeshStandardMaterial?t:e).get(M.envMap||W),ie=q&&q.mapping===yc?q.image.height:null,Z=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));const te=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,X=te!==void 0?te.length:0;let se=0;j.morphAttributes.position!==void 0&&(se=1),j.morphAttributes.normal!==void 0&&(se=2),j.morphAttributes.color!==void 0&&(se=3);let G,xe,Re,Ie;if(Z){const Rt=Zi[Z];G=Rt.vertexShader,xe=Rt.fragmentShader}else G=M.vertexShader,xe=M.fragmentShader,l.update(M),Re=l.getVertexShaderID(M),Ie=l.getFragmentShaderID(M);const Q=n.getRenderTarget(),K=$.isInstancedMesh===!0,P=!!M.map,F=!!M.matcap,k=!!q,A=!!M.aoMap,R=!!M.lightMap,I=!!M.bumpMap,V=!!M.normalMap,H=!!M.displacementMap,ee=!!M.emissiveMap,oe=!!M.metalnessMap,re=!!M.roughnessMap,ue=M.anisotropy>0,ae=M.clearcoat>0,Ee=M.iridescence>0,N=M.sheen>0,L=M.transmission>0,J=ue&&!!M.anisotropyMap,pe=ae&&!!M.clearcoatMap,he=ae&&!!M.clearcoatNormalMap,ye=ae&&!!M.clearcoatRoughnessMap,Ue=Ee&&!!M.iridescenceMap,Ae=Ee&&!!M.iridescenceThicknessMap,Ne=N&&!!M.sheenColorMap,$e=N&&!!M.sheenRoughnessMap,ht=!!M.specularMap,Le=!!M.specularColorMap,Je=!!M.specularIntensityMap,Y=L&&!!M.transmissionMap,de=L&&!!M.thicknessMap,Se=!!M.gradientMap,z=!!M.alphaMap,Ce=M.alphaTest>0,Pe=!!M.alphaHash,ze=!!M.extensions,Fe=!!j.attributes.uv1,Me=!!j.attributes.uv2,He=!!j.attributes.uv3;let Qe=xs;return M.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Qe=n.toneMapping),{isWebGL2:u,shaderID:Z,shaderType:M.type,shaderName:M.name,vertexShader:G,fragmentShader:xe,defines:M.defines,customVertexShaderID:Re,customFragmentShaderID:Ie,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:K,instancingColor:K&&$.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:Q===null?n.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:Zr,map:P,matcap:F,envMap:k,envMapMode:k&&q.mapping,envMapCubeUVHeight:ie,aoMap:A,lightMap:R,bumpMap:I,normalMap:V,displacementMap:d&&H,emissiveMap:ee,normalMapObjectSpace:V&&M.normalMapType===qA,normalMapTangentSpace:V&&M.normalMapType===Ro,metalnessMap:oe,roughnessMap:re,anisotropy:ue,anisotropyMap:J,clearcoat:ae,clearcoatMap:pe,clearcoatNormalMap:he,clearcoatRoughnessMap:ye,iridescence:Ee,iridescenceMap:Ue,iridescenceThicknessMap:Ae,sheen:N,sheenColorMap:Ne,sheenRoughnessMap:$e,specularMap:ht,specularColorMap:Le,specularIntensityMap:Je,transmission:L,transmissionMap:Y,thicknessMap:de,gradientMap:Se,opaque:M.transparent===!1&&M.blending===va,alphaMap:z,alphaTest:Ce,alphaHash:Pe,combine:M.combine,mapUv:P&&v(M.map.channel),aoMapUv:A&&v(M.aoMap.channel),lightMapUv:R&&v(M.lightMap.channel),bumpMapUv:I&&v(M.bumpMap.channel),normalMapUv:V&&v(M.normalMap.channel),displacementMapUv:H&&v(M.displacementMap.channel),emissiveMapUv:ee&&v(M.emissiveMap.channel),metalnessMapUv:oe&&v(M.metalnessMap.channel),roughnessMapUv:re&&v(M.roughnessMap.channel),anisotropyMapUv:J&&v(M.anisotropyMap.channel),clearcoatMapUv:pe&&v(M.clearcoatMap.channel),clearcoatNormalMapUv:he&&v(M.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ye&&v(M.clearcoatRoughnessMap.channel),iridescenceMapUv:Ue&&v(M.iridescenceMap.channel),iridescenceThicknessMapUv:Ae&&v(M.iridescenceThicknessMap.channel),sheenColorMapUv:Ne&&v(M.sheenColorMap.channel),sheenRoughnessMapUv:$e&&v(M.sheenRoughnessMap.channel),specularMapUv:ht&&v(M.specularMap.channel),specularColorMapUv:Le&&v(M.specularColorMap.channel),specularIntensityMapUv:Je&&v(M.specularIntensityMap.channel),transmissionMapUv:Y&&v(M.transmissionMap.channel),thicknessMapUv:de&&v(M.thicknessMap.channel),alphaMapUv:z&&v(M.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(V||ue),vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUv1s:Fe,vertexUv2s:Me,vertexUv3s:He,pointsUvs:$.isPoints===!0&&!!j.attributes.uv&&(P||z),fog:!!U,useFog:M.fog===!0,fogExp2:U&&U.isFogExp2,flatShading:M.flatShading===!0,sizeAttenuation:M.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:$.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:X,morphTextureStride:se,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numLightProbes:E.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:n.shadowMap.enabled&&C.length>0,shadowMapType:n.shadowMap.type,toneMapping:Qe,useLegacyLights:n._useLegacyLights,decodeVideoTexture:P&&M.map.isVideoTexture===!0&&Dt.getTransfer(M.map.colorSpace)===Bt,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===vi,flipSided:M.side===Yn,useDepthPacking:M.depthPacking>=0,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:ze&&M.extensions.derivatives===!0,extensionFragDepth:ze&&M.extensions.fragDepth===!0,extensionDrawBuffers:ze&&M.extensions.drawBuffers===!0,extensionShaderTextureLOD:ze&&M.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){const E=[];if(M.shaderID?E.push(M.shaderID):(E.push(M.customVertexShaderID),E.push(M.customFragmentShaderID)),M.defines!==void 0)for(const C in M.defines)E.push(C),E.push(M.defines[C]);return M.isRawShaderMaterial===!1&&(b(E,M),y(E,M),E.push(n.outputColorSpace)),E.push(M.customProgramCacheKey),E.join()}function b(M,E){M.push(E.precision),M.push(E.outputColorSpace),M.push(E.envMapMode),M.push(E.envMapCubeUVHeight),M.push(E.mapUv),M.push(E.alphaMapUv),M.push(E.lightMapUv),M.push(E.aoMapUv),M.push(E.bumpMapUv),M.push(E.normalMapUv),M.push(E.displacementMapUv),M.push(E.emissiveMapUv),M.push(E.metalnessMapUv),M.push(E.roughnessMapUv),M.push(E.anisotropyMapUv),M.push(E.clearcoatMapUv),M.push(E.clearcoatNormalMapUv),M.push(E.clearcoatRoughnessMapUv),M.push(E.iridescenceMapUv),M.push(E.iridescenceThicknessMapUv),M.push(E.sheenColorMapUv),M.push(E.sheenRoughnessMapUv),M.push(E.specularMapUv),M.push(E.specularColorMapUv),M.push(E.specularIntensityMapUv),M.push(E.transmissionMapUv),M.push(E.thicknessMapUv),M.push(E.combine),M.push(E.fogExp2),M.push(E.sizeAttenuation),M.push(E.morphTargetsCount),M.push(E.morphAttributeCount),M.push(E.numDirLights),M.push(E.numPointLights),M.push(E.numSpotLights),M.push(E.numSpotLightMaps),M.push(E.numHemiLights),M.push(E.numRectAreaLights),M.push(E.numDirLightShadows),M.push(E.numPointLightShadows),M.push(E.numSpotLightShadows),M.push(E.numSpotLightShadowsWithMaps),M.push(E.numLightProbes),M.push(E.shadowMapType),M.push(E.toneMapping),M.push(E.numClippingPlanes),M.push(E.numClipIntersection),M.push(E.depthPacking)}function y(M,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.matcap&&a.enable(4),E.envMap&&a.enable(5),E.normalMapObjectSpace&&a.enable(6),E.normalMapTangentSpace&&a.enable(7),E.clearcoat&&a.enable(8),E.iridescence&&a.enable(9),E.alphaTest&&a.enable(10),E.vertexColors&&a.enable(11),E.vertexAlphas&&a.enable(12),E.vertexUv1s&&a.enable(13),E.vertexUv2s&&a.enable(14),E.vertexUv3s&&a.enable(15),E.vertexTangents&&a.enable(16),E.anisotropy&&a.enable(17),M.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.useLegacyLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.transmission&&a.enable(15),E.sheen&&a.enable(16),E.opaque&&a.enable(17),E.pointsUvs&&a.enable(18),E.decodeVideoTexture&&a.enable(19),M.push(a.mask)}function _(M){const E=p[M.type];let C;if(E){const O=Zi[E];C=Kp.clone(O.uniforms)}else C=M.uniforms;return C}function T(M,E){let C;for(let O=0,$=c.length;O<$;O++){const U=c[O];if(U.cacheKey===E){C=U,++C.usedTimes;break}}return C===void 0&&(C=new KH(n,E,M,s),c.push(C)),C}function w(M){if(--M.usedTimes===0){const E=c.indexOf(M);c[E]=c[c.length-1],c.pop(),M.destroy()}}function S(M){l.remove(M)}function x(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:_,acquireProgram:T,releaseProgram:w,releaseShaderCache:S,programs:c,dispose:x}}function t8(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function n8(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function S1(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function T1(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,d,f,p,v,m){let g=n[e];return g===void 0?(g={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:v,group:m},n[e]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=f,g.groupOrder=p,g.renderOrder=h.renderOrder,g.z=v,g.group=m),e++,g}function a(h,d,f,p,v,m){const g=o(h,d,f,p,v,m);f.transmission>0?i.push(g):f.transparent===!0?r.push(g):t.push(g)}function l(h,d,f,p,v,m){const g=o(h,d,f,p,v,m);f.transmission>0?i.unshift(g):f.transparent===!0?r.unshift(g):t.unshift(g)}function c(h,d){t.length>1&&t.sort(h||n8),i.length>1&&i.sort(d||S1),r.length>1&&r.sort(d||S1)}function u(){for(let h=e,d=n.length;h<d;h++){const f=n[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:u,sort:c}}function i8(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new T1,n.set(i,[o])):r>=s.length?(o=new T1,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function r8(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new Oe};break;case"SpotLight":t={position:new D,direction:new D,color:new Oe,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new Oe,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new Oe,groundColor:new Oe};break;case"RectAreaLight":t={color:new Oe,position:new D,halfWidth:new D,halfHeight:new D};break}return n[e.id]=t,t}}}function s8(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new me,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let o8=0;function a8(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function l8(n,e){const t=new r8,i=s8(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)r.probe.push(new D);const s=new D,o=new Be,a=new Be;function l(u,h){let d=0,f=0,p=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let v=0,m=0,g=0,b=0,y=0,_=0,T=0,w=0,S=0,x=0,M=0;u.sort(a8);const E=h===!0?Math.PI:1;for(let O=0,$=u.length;O<$;O++){const U=u[O],j=U.color,W=U.intensity,q=U.distance,ie=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)d+=j.r*W*E,f+=j.g*W*E,p+=j.b*W*E;else if(U.isLightProbe){for(let Z=0;Z<9;Z++)r.probe[Z].addScaledVector(U.sh.coefficients[Z],W);M++}else if(U.isDirectionalLight){const Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*E),U.castShadow){const te=U.shadow,X=i.get(U);X.shadowBias=te.bias,X.shadowNormalBias=te.normalBias,X.shadowRadius=te.radius,X.shadowMapSize=te.mapSize,r.directionalShadow[v]=X,r.directionalShadowMap[v]=ie,r.directionalShadowMatrix[v]=U.shadow.matrix,_++}r.directional[v]=Z,v++}else if(U.isSpotLight){const Z=t.get(U);Z.position.setFromMatrixPosition(U.matrixWorld),Z.color.copy(j).multiplyScalar(W*E),Z.distance=q,Z.coneCos=Math.cos(U.angle),Z.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),Z.decay=U.decay,r.spot[g]=Z;const te=U.shadow;if(U.map&&(r.spotLightMap[S]=U.map,S++,te.updateMatrices(U),U.castShadow&&x++),r.spotLightMatrix[g]=te.matrix,U.castShadow){const X=i.get(U);X.shadowBias=te.bias,X.shadowNormalBias=te.normalBias,X.shadowRadius=te.radius,X.shadowMapSize=te.mapSize,r.spotShadow[g]=X,r.spotShadowMap[g]=ie,w++}g++}else if(U.isRectAreaLight){const Z=t.get(U);Z.color.copy(j).multiplyScalar(W),Z.halfWidth.set(U.width*.5,0,0),Z.halfHeight.set(0,U.height*.5,0),r.rectArea[b]=Z,b++}else if(U.isPointLight){const Z=t.get(U);if(Z.color.copy(U.color).multiplyScalar(U.intensity*E),Z.distance=U.distance,Z.decay=U.decay,U.castShadow){const te=U.shadow,X=i.get(U);X.shadowBias=te.bias,X.shadowNormalBias=te.normalBias,X.shadowRadius=te.radius,X.shadowMapSize=te.mapSize,X.shadowCameraNear=te.camera.near,X.shadowCameraFar=te.camera.far,r.pointShadow[m]=X,r.pointShadowMap[m]=ie,r.pointShadowMatrix[m]=U.shadow.matrix,T++}r.point[m]=Z,m++}else if(U.isHemisphereLight){const Z=t.get(U);Z.skyColor.copy(U.color).multiplyScalar(W*E),Z.groundColor.copy(U.groundColor).multiplyScalar(W*E),r.hemi[y]=Z,y++}}b>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=De.LTC_FLOAT_1,r.rectAreaLTC2=De.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=De.LTC_HALF_1,r.rectAreaLTC2=De.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const C=r.hash;(C.directionalLength!==v||C.pointLength!==m||C.spotLength!==g||C.rectAreaLength!==b||C.hemiLength!==y||C.numDirectionalShadows!==_||C.numPointShadows!==T||C.numSpotShadows!==w||C.numSpotMaps!==S||C.numLightProbes!==M)&&(r.directional.length=v,r.spot.length=g,r.rectArea.length=b,r.point.length=m,r.hemi.length=y,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=T,r.pointShadowMap.length=T,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=T,r.spotLightMatrix.length=w+S-x,r.spotLightMap.length=S,r.numSpotLightShadowsWithMaps=x,r.numLightProbes=M,C.directionalLength=v,C.pointLength=m,C.spotLength=g,C.rectAreaLength=b,C.hemiLength=y,C.numDirectionalShadows=_,C.numPointShadows=T,C.numSpotShadows=w,C.numSpotMaps=S,C.numLightProbes=M,r.version=o8++)}function c(u,h){let d=0,f=0,p=0,v=0,m=0;const g=h.matrixWorldInverse;for(let b=0,y=u.length;b<y;b++){const _=u[b];if(_.isDirectionalLight){const T=r.directional[d];T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(g),d++}else if(_.isSpotLight){const T=r.spot[p];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(g),p++}else if(_.isRectAreaLight){const T=r.rectArea[v];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),a.identity(),o.copy(_.matrixWorld),o.premultiply(g),a.extractRotation(o),T.halfWidth.set(_.width*.5,0,0),T.halfHeight.set(0,_.height*.5,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),v++}else if(_.isPointLight){const T=r.point[f];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),f++}else if(_.isHemisphereLight){const T=r.hemi[m];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(g),m++}}}return{setup:l,setupView:c,state:r}}function A1(n,e){const t=new l8(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function l(h){t.setup(i,h)}function c(h){t.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function c8(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new A1(n,e),t.set(s,[l])):o>=a.length?(l=new A1(n,e),a.push(l)):l=a[o],l}function r(){t=new WeakMap}return{get:i,dispose:r}}class ty extends Pn{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=XA,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ny extends Pn{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const u8="void main() {\n	gl_Position = vec4( position, 1.0 );\n}",h8="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function d8(n,e,t){let i=new Zp;const r=new me,s=new me,o=new gt,a=new ty({depthPacking:YA}),l=new ny,c={},u=t.maxTextureSize,h={[Yr]:Yn,[Yn]:Yr,[vi]:vi},d=new or({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new me},radius:{value:4}},vertexShader:u8,fragmentShader:h8}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Ye;p.setAttribute("position",new Tt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new ke(p,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=N_;let g=this.type;this.render=function(T,w,S){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||T.length===0)return;const x=n.getRenderTarget(),M=n.getActiveCubeFace(),E=n.getActiveMipmapLevel(),C=n.state;C.setBlending(bs),C.buffers.color.setClear(1,1,1,1),C.buffers.depth.setTest(!0),C.setScissorTest(!1);const O=g!==Fr&&this.type===Fr,$=g===Fr&&this.type!==Fr;for(let U=0,j=T.length;U<j;U++){const W=T[U],q=W.shadow;if(q===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(q.autoUpdate===!1&&q.needsUpdate===!1)continue;r.copy(q.mapSize);const ie=q.getFrameExtents();if(r.multiply(ie),s.copy(q.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/ie.x),r.x=s.x*ie.x,q.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/ie.y),r.y=s.y*ie.y,q.mapSize.y=s.y)),q.map===null||O===!0||$===!0){const te=this.type!==Fr?{minFilter:an,magFilter:an}:{};q.map!==null&&q.map.dispose(),q.map=new Sr(r.x,r.y,te),q.map.texture.name=W.name+".shadowMap",q.camera.updateProjectionMatrix()}n.setRenderTarget(q.map),n.clear();const Z=q.getViewportCount();for(let te=0;te<Z;te++){const X=q.getViewport(te);o.set(s.x*X.x,s.y*X.y,s.x*X.z,s.y*X.w),C.viewport(o),q.updateMatrices(W,te),i=q.getFrustum(),_(w,S,q.camera,W,this.type)}q.isPointLightShadow!==!0&&this.type===Fr&&b(q,S),q.needsUpdate=!1}g=this.type,m.needsUpdate=!1,n.setRenderTarget(x,M,E)};function b(T,w){const S=e.update(v);d.defines.VSM_SAMPLES!==T.blurSamples&&(d.defines.VSM_SAMPLES=T.blurSamples,f.defines.VSM_SAMPLES=T.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new Sr(r.x,r.y)),d.uniforms.shadow_pass.value=T.map.texture,d.uniforms.resolution.value=T.mapSize,d.uniforms.radius.value=T.radius,n.setRenderTarget(T.mapPass),n.clear(),n.renderBufferDirect(w,null,S,d,v,null),f.uniforms.shadow_pass.value=T.mapPass.texture,f.uniforms.resolution.value=T.mapSize,f.uniforms.radius.value=T.radius,n.setRenderTarget(T.map),n.clear(),n.renderBufferDirect(w,null,S,f,v,null)}function y(T,w,S,x){let M=null;const E=S.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(E!==void 0)M=E;else if(M=S.isPointLight===!0?l:a,n.localClippingEnabled&&w.clipShadows===!0&&Array.isArray(w.clippingPlanes)&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const C=M.uuid,O=w.uuid;let $=c[C];$===void 0&&($={},c[C]=$);let U=$[O];U===void 0&&(U=M.clone(),$[O]=U),M=U}if(M.visible=w.visible,M.wireframe=w.wireframe,x===Fr?M.side=w.shadowSide!==null?w.shadowSide:w.side:M.side=w.shadowSide!==null?w.shadowSide:h[w.side],M.alphaMap=w.alphaMap,M.alphaTest=w.alphaTest,M.map=w.map,M.clipShadows=w.clipShadows,M.clippingPlanes=w.clippingPlanes,M.clipIntersection=w.clipIntersection,M.displacementMap=w.displacementMap,M.displacementScale=w.displacementScale,M.displacementBias=w.displacementBias,M.wireframeLinewidth=w.wireframeLinewidth,M.linewidth=w.linewidth,S.isPointLight===!0&&M.isMeshDistanceMaterial===!0){const C=n.properties.get(M);C.light=S}return M}function _(T,w,S,x,M){if(T.visible===!1)return;if(T.layers.test(w.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&M===Fr)&&(!T.frustumCulled||i.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,T.matrixWorld);const O=e.update(T),$=T.material;if(Array.isArray($)){const U=O.groups;for(let j=0,W=U.length;j<W;j++){const q=U[j],ie=$[q.materialIndex];if(ie&&ie.visible){const Z=y(T,ie,x,M);n.renderBufferDirect(S,null,O,Z,T,q)}}}else if($.visible){const U=y(T,$,x,M);n.renderBufferDirect(S,null,O,U,T,null)}}const C=T.children;for(let O=0,$=C.length;O<$;O++)_(C[O],w,S,x,M)}}function f8(n,e,t){const i=t.isWebGL2;function r(){let z=!1;const Ce=new gt;let Pe=null;const ze=new gt(0,0,0,0);return{setMask:function(Fe){Pe!==Fe&&!z&&(n.colorMask(Fe,Fe,Fe,Fe),Pe=Fe)},setLocked:function(Fe){z=Fe},setClear:function(Fe,Me,He,Qe,un){un===!0&&(Fe*=Qe,Me*=Qe,He*=Qe),Ce.set(Fe,Me,He,Qe),ze.equals(Ce)===!1&&(n.clearColor(Fe,Me,He,Qe),ze.copy(Ce))},reset:function(){z=!1,Pe=null,ze.set(-1,0,0,0)}}}function s(){let z=!1,Ce=null,Pe=null,ze=null;return{setTest:function(Fe){Fe?Q(n.DEPTH_TEST):K(n.DEPTH_TEST)},setMask:function(Fe){Ce!==Fe&&!z&&(n.depthMask(Fe),Ce=Fe)},setFunc:function(Fe){if(Pe!==Fe){switch(Fe){case xA:n.depthFunc(n.NEVER);break;case wA:n.depthFunc(n.ALWAYS);break;case MA:n.depthFunc(n.LESS);break;case ip:n.depthFunc(n.LEQUAL);break;case EA:n.depthFunc(n.EQUAL);break;case SA:n.depthFunc(n.GEQUAL);break;case TA:n.depthFunc(n.GREATER);break;case AA:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Pe=Fe}},setLocked:function(Fe){z=Fe},setClear:function(Fe){ze!==Fe&&(n.clearDepth(Fe),ze=Fe)},reset:function(){z=!1,Ce=null,Pe=null,ze=null}}}function o(){let z=!1,Ce=null,Pe=null,ze=null,Fe=null,Me=null,He=null,Qe=null,un=null;return{setTest:function(Rt){z||(Rt?Q(n.STENCIL_TEST):K(n.STENCIL_TEST))},setMask:function(Rt){Ce!==Rt&&!z&&(n.stencilMask(Rt),Ce=Rt)},setFunc:function(Rt,Jn,Qn){(Pe!==Rt||ze!==Jn||Fe!==Qn)&&(n.stencilFunc(Rt,Jn,Qn),Pe=Rt,ze=Jn,Fe=Qn)},setOp:function(Rt,Jn,Qn){(Me!==Rt||He!==Jn||Qe!==Qn)&&(n.stencilOp(Rt,Jn,Qn),Me=Rt,He=Jn,Qe=Qn)},setLocked:function(Rt){z=Rt},setClear:function(Rt){un!==Rt&&(n.clearStencil(Rt),un=Rt)},reset:function(){z=!1,Ce=null,Pe=null,ze=null,Fe=null,Me=null,He=null,Qe=null,un=null}}}const a=new r,l=new s,c=new o,u=new WeakMap,h=new WeakMap;let d={},f={},p=new WeakMap,v=[],m=null,g=!1,b=null,y=null,_=null,T=null,w=null,S=null,x=null,M=!1,E=null,C=null,O=null,$=null,U=null;const j=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,q=0;const ie=n.getParameter(n.VERSION);ie.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec(ie)[1]),W=q>=1):ie.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),W=q>=2);let Z=null,te={};const X=n.getParameter(n.SCISSOR_BOX),se=n.getParameter(n.VIEWPORT),G=new gt().fromArray(X),xe=new gt().fromArray(se);function Re(z,Ce,Pe,ze){const Fe=new Uint8Array(4),Me=n.createTexture();n.bindTexture(z,Me),n.texParameteri(z,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(z,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let He=0;He<Pe;He++)i&&(z===n.TEXTURE_3D||z===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ce,0,n.RGBA,1,1,ze,0,n.RGBA,n.UNSIGNED_BYTE,Fe):n.texImage2D(Ce+He,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Fe);return Me}const Ie={};Ie[n.TEXTURE_2D]=Re(n.TEXTURE_2D,n.TEXTURE_2D,1),Ie[n.TEXTURE_CUBE_MAP]=Re(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ie[n.TEXTURE_2D_ARRAY]=Re(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ie[n.TEXTURE_3D]=Re(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Q(n.DEPTH_TEST),l.setFunc(ip),H(!1),ee(Dv),Q(n.CULL_FACE),I(bs);function Q(z){d[z]!==!0&&(n.enable(z),d[z]=!0)}function K(z){d[z]!==!1&&(n.disable(z),d[z]=!1)}function P(z,Ce){return f[z]!==Ce?(n.bindFramebuffer(z,Ce),f[z]=Ce,i&&(z===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Ce),z===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Ce)),!0):!1}function F(z,Ce){let Pe=v,ze=!1;if(z)if(Pe=p.get(Ce),Pe===void 0&&(Pe=[],p.set(Ce,Pe)),z.isWebGLMultipleRenderTargets){const Fe=z.texture;if(Pe.length!==Fe.length||Pe[0]!==n.COLOR_ATTACHMENT0){for(let Me=0,He=Fe.length;Me<He;Me++)Pe[Me]=n.COLOR_ATTACHMENT0+Me;Pe.length=Fe.length,ze=!0}}else Pe[0]!==n.COLOR_ATTACHMENT0&&(Pe[0]=n.COLOR_ATTACHMENT0,ze=!0);else Pe[0]!==n.BACK&&(Pe[0]=n.BACK,ze=!0);ze&&(t.isWebGL2?n.drawBuffers(Pe):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Pe))}function k(z){return m!==z?(n.useProgram(z),m=z,!0):!1}const A={[ra]:n.FUNC_ADD,[uA]:n.FUNC_SUBTRACT,[hA]:n.FUNC_REVERSE_SUBTRACT};if(i)A[Fv]=n.MIN,A[kv]=n.MAX;else{const z=e.get("EXT_blend_minmax");z!==null&&(A[Fv]=z.MIN_EXT,A[kv]=z.MAX_EXT)}const R={[dA]:n.ZERO,[fA]:n.ONE,[pA]:n.SRC_COLOR,[k_]:n.SRC_ALPHA,[bA]:n.SRC_ALPHA_SATURATE,[_A]:n.DST_COLOR,[gA]:n.DST_ALPHA,[mA]:n.ONE_MINUS_SRC_COLOR,[B_]:n.ONE_MINUS_SRC_ALPHA,[yA]:n.ONE_MINUS_DST_COLOR,[vA]:n.ONE_MINUS_DST_ALPHA};function I(z,Ce,Pe,ze,Fe,Me,He,Qe){if(z===bs){g===!0&&(K(n.BLEND),g=!1);return}if(g===!1&&(Q(n.BLEND),g=!0),z!==cA){if(z!==b||Qe!==M){if((y!==ra||w!==ra)&&(n.blendEquation(n.FUNC_ADD),y=ra,w=ra),Qe)switch(z){case va:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case np:n.blendFunc(n.ONE,n.ONE);break;case Uv:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Nv:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}else switch(z){case va:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case np:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Uv:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Nv:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",z);break}_=null,T=null,S=null,x=null,b=z,M=Qe}return}Fe=Fe||Ce,Me=Me||Pe,He=He||ze,(Ce!==y||Fe!==w)&&(n.blendEquationSeparate(A[Ce],A[Fe]),y=Ce,w=Fe),(Pe!==_||ze!==T||Me!==S||He!==x)&&(n.blendFuncSeparate(R[Pe],R[ze],R[Me],R[He]),_=Pe,T=ze,S=Me,x=He),b=z,M=!1}function V(z,Ce){z.side===vi?K(n.CULL_FACE):Q(n.CULL_FACE);let Pe=z.side===Yn;Ce&&(Pe=!Pe),H(Pe),z.blending===va&&z.transparent===!1?I(bs):I(z.blending,z.blendEquation,z.blendSrc,z.blendDst,z.blendEquationAlpha,z.blendSrcAlpha,z.blendDstAlpha,z.premultipliedAlpha),l.setFunc(z.depthFunc),l.setTest(z.depthTest),l.setMask(z.depthWrite),a.setMask(z.colorWrite);const ze=z.stencilWrite;c.setTest(ze),ze&&(c.setMask(z.stencilWriteMask),c.setFunc(z.stencilFunc,z.stencilRef,z.stencilFuncMask),c.setOp(z.stencilFail,z.stencilZFail,z.stencilZPass)),re(z.polygonOffset,z.polygonOffsetFactor,z.polygonOffsetUnits),z.alphaToCoverage===!0?Q(n.SAMPLE_ALPHA_TO_COVERAGE):K(n.SAMPLE_ALPHA_TO_COVERAGE)}function H(z){E!==z&&(z?n.frontFace(n.CW):n.frontFace(n.CCW),E=z)}function ee(z){z!==aA?(Q(n.CULL_FACE),z!==C&&(z===Dv?n.cullFace(n.BACK):z===lA?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):K(n.CULL_FACE),C=z}function oe(z){z!==O&&(W&&n.lineWidth(z),O=z)}function re(z,Ce,Pe){z?(Q(n.POLYGON_OFFSET_FILL),($!==Ce||U!==Pe)&&(n.polygonOffset(Ce,Pe),$=Ce,U=Pe)):K(n.POLYGON_OFFSET_FILL)}function ue(z){z?Q(n.SCISSOR_TEST):K(n.SCISSOR_TEST)}function ae(z){z===void 0&&(z=n.TEXTURE0+j-1),Z!==z&&(n.activeTexture(z),Z=z)}function Ee(z,Ce,Pe){Pe===void 0&&(Z===null?Pe=n.TEXTURE0+j-1:Pe=Z);let ze=te[Pe];ze===void 0&&(ze={type:void 0,texture:void 0},te[Pe]=ze),(ze.type!==z||ze.texture!==Ce)&&(Z!==Pe&&(n.activeTexture(Pe),Z=Pe),n.bindTexture(z,Ce||Ie[z]),ze.type=z,ze.texture=Ce)}function N(){const z=te[Z];z!==void 0&&z.type!==void 0&&(n.bindTexture(z.type,null),z.type=void 0,z.texture=void 0)}function L(){try{n.compressedTexImage2D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function J(){try{n.compressedTexImage3D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function pe(){try{n.texSubImage2D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function he(){try{n.texSubImage3D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ye(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Ue(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Ae(){try{n.texStorage2D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Ne(){try{n.texStorage3D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function $e(){try{n.texImage2D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function ht(){try{n.texImage3D.apply(n,arguments)}catch(z){console.error("THREE.WebGLState:",z)}}function Le(z){G.equals(z)===!1&&(n.scissor(z.x,z.y,z.z,z.w),G.copy(z))}function Je(z){xe.equals(z)===!1&&(n.viewport(z.x,z.y,z.z,z.w),xe.copy(z))}function Y(z,Ce){let Pe=h.get(Ce);Pe===void 0&&(Pe=new WeakMap,h.set(Ce,Pe));let ze=Pe.get(z);ze===void 0&&(ze=n.getUniformBlockIndex(Ce,z.name),Pe.set(z,ze))}function de(z,Ce){const ze=h.get(Ce).get(z);u.get(Ce)!==ze&&(n.uniformBlockBinding(Ce,ze,z.__bindingPointIndex),u.set(Ce,ze))}function Se(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},Z=null,te={},f={},p=new WeakMap,v=[],m=null,g=!1,b=null,y=null,_=null,T=null,w=null,S=null,x=null,M=!1,E=null,C=null,O=null,$=null,U=null,G.set(0,0,n.canvas.width,n.canvas.height),xe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:Q,disable:K,bindFramebuffer:P,drawBuffers:F,useProgram:k,setBlending:I,setMaterial:V,setFlipSided:H,setCullFace:ee,setLineWidth:oe,setPolygonOffset:re,setScissorTest:ue,activeTexture:ae,bindTexture:Ee,unbindTexture:N,compressedTexImage2D:L,compressedTexImage3D:J,texImage2D:$e,texImage3D:ht,updateUBOMapping:Y,uniformBlockBinding:de,texStorage2D:Ae,texStorage3D:Ne,texSubImage2D:pe,texSubImage3D:he,compressedTexSubImage2D:ye,compressedTexSubImage3D:Ue,scissor:Le,viewport:Je,reset:Se}}function p8(n,e,t,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let v;const m=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(N){}function b(N,L){return g?new OffscreenCanvas(N,L):dh("canvas")}function y(N,L,J,pe){let he=1;if((N.width>pe||N.height>pe)&&(he=pe/Math.max(N.width,N.height)),he<1||L===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const ye=L?op:Math.floor,Ue=ye(he*N.width),Ae=ye(he*N.height);v===void 0&&(v=b(Ue,Ae));const Ne=J?b(Ue,Ae):v;return Ne.width=Ue,Ne.height=Ae,Ne.getContext("2d").drawImage(N,0,0,Ue,Ae),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+Ue+"x"+Ae+")."),Ne}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function _(N){return h0(N.width)&&h0(N.height)}function T(N){return a?!1:N.wrapS!==An||N.wrapT!==An||N.minFilter!==an&&N.minFilter!==Qt}function w(N,L){return N.generateMipmaps&&L&&N.minFilter!==an&&N.minFilter!==Qt}function S(N){n.generateMipmap(N)}function x(N,L,J,pe,he=!1){if(a===!1)return L;if(N!==null){if(n[N]!==void 0)return n[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let ye=L;if(L===n.RED&&(J===n.FLOAT&&(ye=n.R32F),J===n.HALF_FLOAT&&(ye=n.R16F),J===n.UNSIGNED_BYTE&&(ye=n.R8)),L===n.RED_INTEGER&&(J===n.UNSIGNED_BYTE&&(ye=n.R8UI),J===n.UNSIGNED_SHORT&&(ye=n.R16UI),J===n.UNSIGNED_INT&&(ye=n.R32UI),J===n.BYTE&&(ye=n.R8I),J===n.SHORT&&(ye=n.R16I),J===n.INT&&(ye=n.R32I)),L===n.RG&&(J===n.FLOAT&&(ye=n.RG32F),J===n.HALF_FLOAT&&(ye=n.RG16F),J===n.UNSIGNED_BYTE&&(ye=n.RG8)),L===n.RGBA){const Ue=he?ah:Dt.getTransfer(pe);J===n.FLOAT&&(ye=n.RGBA32F),J===n.HALF_FLOAT&&(ye=n.RGBA16F),J===n.UNSIGNED_BYTE&&(ye=Ue===Bt?n.SRGB8_ALPHA8:n.RGBA8),J===n.UNSIGNED_SHORT_4_4_4_4&&(ye=n.RGBA4),J===n.UNSIGNED_SHORT_5_5_5_1&&(ye=n.RGB5_A1)}return(ye===n.R16F||ye===n.R32F||ye===n.RG16F||ye===n.RG32F||ye===n.RGBA16F||ye===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ye}function M(N,L,J){return w(N,J)===!0||N.isFramebufferTexture&&N.minFilter!==an&&N.minFilter!==Qt?Math.log2(Math.max(L.width,L.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?L.mipmaps.length:1}function E(N){return N===an||N===sh||N===$l?n.NEAREST:n.LINEAR}function C(N){const L=N.target;L.removeEventListener("dispose",C),$(L),L.isVideoTexture&&p.delete(L)}function O(N){const L=N.target;L.removeEventListener("dispose",O),j(L)}function $(N){const L=i.get(N);if(L.__webglInit===void 0)return;const J=N.source,pe=m.get(J);if(pe){const he=pe[L.__cacheKey];he.usedTimes--,he.usedTimes===0&&U(N),Object.keys(pe).length===0&&m.delete(J)}i.remove(N)}function U(N){const L=i.get(N);n.deleteTexture(L.__webglTexture);const J=N.source,pe=m.get(J);delete pe[L.__cacheKey],o.memory.textures--}function j(N){const L=N.texture,J=i.get(N),pe=i.get(L);if(pe.__webglTexture!==void 0&&(n.deleteTexture(pe.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let he=0;he<6;he++){if(Array.isArray(J.__webglFramebuffer[he]))for(let ye=0;ye<J.__webglFramebuffer[he].length;ye++)n.deleteFramebuffer(J.__webglFramebuffer[he][ye]);else n.deleteFramebuffer(J.__webglFramebuffer[he]);J.__webglDepthbuffer&&n.deleteRenderbuffer(J.__webglDepthbuffer[he])}else{if(Array.isArray(J.__webglFramebuffer))for(let he=0;he<J.__webglFramebuffer.length;he++)n.deleteFramebuffer(J.__webglFramebuffer[he]);else n.deleteFramebuffer(J.__webglFramebuffer);if(J.__webglDepthbuffer&&n.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&n.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer)for(let he=0;he<J.__webglColorRenderbuffer.length;he++)J.__webglColorRenderbuffer[he]&&n.deleteRenderbuffer(J.__webglColorRenderbuffer[he]);J.__webglDepthRenderbuffer&&n.deleteRenderbuffer(J.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let he=0,ye=L.length;he<ye;he++){const Ue=i.get(L[he]);Ue.__webglTexture&&(n.deleteTexture(Ue.__webglTexture),o.memory.textures--),i.remove(L[he])}i.remove(L),i.remove(N)}let W=0;function q(){W=0}function ie(){const N=W;return N>=l&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+l),W+=1,N}function Z(N){const L=[];return L.push(N.wrapS),L.push(N.wrapT),L.push(N.wrapR||0),L.push(N.magFilter),L.push(N.minFilter),L.push(N.anisotropy),L.push(N.internalFormat),L.push(N.format),L.push(N.type),L.push(N.generateMipmaps),L.push(N.premultiplyAlpha),L.push(N.flipY),L.push(N.unpackAlignment),L.push(N.colorSpace),L.join()}function te(N,L){const J=i.get(N);if(N.isVideoTexture&&ae(N),N.isRenderTargetTexture===!1&&N.version>0&&J.__version!==N.version){const pe=N.image;if(pe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(pe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{P(J,N,L);return}}t.bindTexture(n.TEXTURE_2D,J.__webglTexture,n.TEXTURE0+L)}function X(N,L){const J=i.get(N);if(N.version>0&&J.__version!==N.version){P(J,N,L);return}t.bindTexture(n.TEXTURE_2D_ARRAY,J.__webglTexture,n.TEXTURE0+L)}function se(N,L){const J=i.get(N);if(N.version>0&&J.__version!==N.version){P(J,N,L);return}t.bindTexture(n.TEXTURE_3D,J.__webglTexture,n.TEXTURE0+L)}function G(N,L){const J=i.get(N);if(N.version>0&&J.__version!==N.version){F(J,N,L);return}t.bindTexture(n.TEXTURE_CUBE_MAP,J.__webglTexture,n.TEXTURE0+L)}const xe={[qr]:n.REPEAT,[An]:n.CLAMP_TO_EDGE,[sc]:n.MIRRORED_REPEAT},Re={[an]:n.NEAREST,[sh]:n.NEAREST_MIPMAP_NEAREST,[$l]:n.NEAREST_MIPMAP_LINEAR,[Qt]:n.LINEAR,[Gp]:n.LINEAR_MIPMAP_NEAREST,[Kr]:n.LINEAR_MIPMAP_LINEAR},Ie={[ZA]:n.NEVER,[rC]:n.ALWAYS,[JA]:n.LESS,[eC]:n.LEQUAL,[QA]:n.EQUAL,[iC]:n.GEQUAL,[tC]:n.GREATER,[nC]:n.NOTEQUAL};function Q(N,L,J){if(J?(n.texParameteri(N,n.TEXTURE_WRAP_S,xe[L.wrapS]),n.texParameteri(N,n.TEXTURE_WRAP_T,xe[L.wrapT]),(N===n.TEXTURE_3D||N===n.TEXTURE_2D_ARRAY)&&n.texParameteri(N,n.TEXTURE_WRAP_R,xe[L.wrapR]),n.texParameteri(N,n.TEXTURE_MAG_FILTER,Re[L.magFilter]),n.texParameteri(N,n.TEXTURE_MIN_FILTER,Re[L.minFilter])):(n.texParameteri(N,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(N,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(N===n.TEXTURE_3D||N===n.TEXTURE_2D_ARRAY)&&n.texParameteri(N,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(L.wrapS!==An||L.wrapT!==An)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(N,n.TEXTURE_MAG_FILTER,E(L.magFilter)),n.texParameteri(N,n.TEXTURE_MIN_FILTER,E(L.minFilter)),L.minFilter!==an&&L.minFilter!==Qt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),L.compareFunction&&(n.texParameteri(N,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(N,n.TEXTURE_COMPARE_FUNC,Ie[L.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const pe=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===an||L.minFilter!==$l&&L.minFilter!==Kr||L.type===zr&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===oc&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(n.texParameterf(N,pe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function K(N,L){let J=!1;N.__webglInit===void 0&&(N.__webglInit=!0,L.addEventListener("dispose",C));const pe=L.source;let he=m.get(pe);he===void 0&&(he={},m.set(pe,he));const ye=Z(L);if(ye!==N.__cacheKey){he[ye]===void 0&&(he[ye]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,J=!0),he[ye].usedTimes++;const Ue=he[N.__cacheKey];Ue!==void 0&&(he[N.__cacheKey].usedTimes--,Ue.usedTimes===0&&U(L)),N.__cacheKey=ye,N.__webglTexture=he[ye].texture}return J}function P(N,L,J){let pe=n.TEXTURE_2D;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(pe=n.TEXTURE_2D_ARRAY),L.isData3DTexture&&(pe=n.TEXTURE_3D);const he=K(N,L),ye=L.source;t.bindTexture(pe,N.__webglTexture,n.TEXTURE0+J);const Ue=i.get(ye);if(ye.version!==Ue.__version||he===!0){t.activeTexture(n.TEXTURE0+J);const Ae=Dt.getPrimaries(Dt.workingColorSpace),Ne=L.colorSpace===Ui?null:Dt.getPrimaries(L.colorSpace),$e=L.colorSpace===Ui||Ae===Ne?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,L.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,L.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$e);const ht=T(L)&&_(L.image)===!1;let Le=y(L.image,ht,!1,u);Le=Ee(L,Le);const Je=_(Le)||a,Y=s.convert(L.format,L.colorSpace);let de=s.convert(L.type),Se=x(L.internalFormat,Y,de,L.colorSpace,L.isVideoTexture);Q(pe,L,Je);let z;const Ce=L.mipmaps,Pe=a&&L.isVideoTexture!==!0,ze=Ue.__version===void 0||he===!0,Fe=M(L,Le,Je);if(L.isDepthTexture)Se=n.DEPTH_COMPONENT,a?L.type===zr?Se=n.DEPTH_COMPONENT32F:L.type===_s?Se=n.DEPTH_COMPONENT24:L.type===go?Se=n.DEPTH24_STENCIL8:Se=n.DEPTH_COMPONENT16:L.type===zr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===vo&&Se===n.DEPTH_COMPONENT&&L.type!==Wp&&L.type!==_s&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=_s,de=s.convert(L.type)),L.format===Sa&&Se===n.DEPTH_COMPONENT&&(Se=n.DEPTH_STENCIL,L.type!==go&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=go,de=s.convert(L.type))),ze&&(Pe?t.texStorage2D(n.TEXTURE_2D,1,Se,Le.width,Le.height):t.texImage2D(n.TEXTURE_2D,0,Se,Le.width,Le.height,0,Y,de,null));else if(L.isDataTexture)if(Ce.length>0&&Je){Pe&&ze&&t.texStorage2D(n.TEXTURE_2D,Fe,Se,Ce[0].width,Ce[0].height);for(let Me=0,He=Ce.length;Me<He;Me++)z=Ce[Me],Pe?t.texSubImage2D(n.TEXTURE_2D,Me,0,0,z.width,z.height,Y,de,z.data):t.texImage2D(n.TEXTURE_2D,Me,Se,z.width,z.height,0,Y,de,z.data);L.generateMipmaps=!1}else Pe?(ze&&t.texStorage2D(n.TEXTURE_2D,Fe,Se,Le.width,Le.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Le.width,Le.height,Y,de,Le.data)):t.texImage2D(n.TEXTURE_2D,0,Se,Le.width,Le.height,0,Y,de,Le.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){Pe&&ze&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Se,Ce[0].width,Ce[0].height,Le.depth);for(let Me=0,He=Ce.length;Me<He;Me++)z=Ce[Me],L.format!==Di?Y!==null?Pe?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,z.width,z.height,Le.depth,Y,z.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Me,Se,z.width,z.height,Le.depth,0,z.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,z.width,z.height,Le.depth,Y,de,z.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Me,Se,z.width,z.height,Le.depth,0,Y,de,z.data)}else{Pe&&ze&&t.texStorage2D(n.TEXTURE_2D,Fe,Se,Ce[0].width,Ce[0].height);for(let Me=0,He=Ce.length;Me<He;Me++)z=Ce[Me],L.format!==Di?Y!==null?Pe?t.compressedTexSubImage2D(n.TEXTURE_2D,Me,0,0,z.width,z.height,Y,z.data):t.compressedTexImage2D(n.TEXTURE_2D,Me,Se,z.width,z.height,0,z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Pe?t.texSubImage2D(n.TEXTURE_2D,Me,0,0,z.width,z.height,Y,de,z.data):t.texImage2D(n.TEXTURE_2D,Me,Se,z.width,z.height,0,Y,de,z.data)}else if(L.isDataArrayTexture)Pe?(ze&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Fe,Se,Le.width,Le.height,Le.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Le.width,Le.height,Le.depth,Y,de,Le.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Se,Le.width,Le.height,Le.depth,0,Y,de,Le.data);else if(L.isData3DTexture)Pe?(ze&&t.texStorage3D(n.TEXTURE_3D,Fe,Se,Le.width,Le.height,Le.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Le.width,Le.height,Le.depth,Y,de,Le.data)):t.texImage3D(n.TEXTURE_3D,0,Se,Le.width,Le.height,Le.depth,0,Y,de,Le.data);else if(L.isFramebufferTexture){if(ze)if(Pe)t.texStorage2D(n.TEXTURE_2D,Fe,Se,Le.width,Le.height);else{let Me=Le.width,He=Le.height;for(let Qe=0;Qe<Fe;Qe++)t.texImage2D(n.TEXTURE_2D,Qe,Se,Me,He,0,Y,de,null),Me>>=1,He>>=1}}else if(Ce.length>0&&Je){Pe&&ze&&t.texStorage2D(n.TEXTURE_2D,Fe,Se,Ce[0].width,Ce[0].height);for(let Me=0,He=Ce.length;Me<He;Me++)z=Ce[Me],Pe?t.texSubImage2D(n.TEXTURE_2D,Me,0,0,Y,de,z):t.texImage2D(n.TEXTURE_2D,Me,Se,Y,de,z);L.generateMipmaps=!1}else Pe?(ze&&t.texStorage2D(n.TEXTURE_2D,Fe,Se,Le.width,Le.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Y,de,Le)):t.texImage2D(n.TEXTURE_2D,0,Se,Y,de,Le);w(L,Je)&&S(pe),Ue.__version=ye.version,L.onUpdate&&L.onUpdate(L)}N.__version=L.version}function F(N,L,J){if(L.image.length!==6)return;const pe=K(N,L),he=L.source;t.bindTexture(n.TEXTURE_CUBE_MAP,N.__webglTexture,n.TEXTURE0+J);const ye=i.get(he);if(he.version!==ye.__version||pe===!0){t.activeTexture(n.TEXTURE0+J);const Ue=Dt.getPrimaries(Dt.workingColorSpace),Ae=L.colorSpace===Ui?null:Dt.getPrimaries(L.colorSpace),Ne=L.colorSpace===Ui||Ue===Ae?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,L.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,L.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ne);const $e=L.isCompressedTexture||L.image[0].isCompressedTexture,ht=L.image[0]&&L.image[0].isDataTexture,Le=[];for(let Me=0;Me<6;Me++)!$e&&!ht?Le[Me]=y(L.image[Me],!1,!0,c):Le[Me]=ht?L.image[Me].image:L.image[Me],Le[Me]=Ee(L,Le[Me]);const Je=Le[0],Y=_(Je)||a,de=s.convert(L.format,L.colorSpace),Se=s.convert(L.type),z=x(L.internalFormat,de,Se,L.colorSpace),Ce=a&&L.isVideoTexture!==!0,Pe=ye.__version===void 0||pe===!0;let ze=M(L,Je,Y);Q(n.TEXTURE_CUBE_MAP,L,Y);let Fe;if($e){Ce&&Pe&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ze,z,Je.width,Je.height);for(let Me=0;Me<6;Me++){Fe=Le[Me].mipmaps;for(let He=0;He<Fe.length;He++){const Qe=Fe[He];L.format!==Di?de!==null?Ce?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He,0,0,Qe.width,Qe.height,de,Qe.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He,z,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ce?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He,0,0,Qe.width,Qe.height,de,Se,Qe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He,z,Qe.width,Qe.height,0,de,Se,Qe.data)}}}else{Fe=L.mipmaps,Ce&&Pe&&(Fe.length>0&&ze++,t.texStorage2D(n.TEXTURE_CUBE_MAP,ze,z,Le[0].width,Le[0].height));for(let Me=0;Me<6;Me++)if(ht){Ce?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,Le[Me].width,Le[Me].height,de,Se,Le[Me].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,z,Le[Me].width,Le[Me].height,0,de,Se,Le[Me].data);for(let He=0;He<Fe.length;He++){const un=Fe[He].image[Me].image;Ce?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He+1,0,0,un.width,un.height,de,Se,un.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He+1,z,un.width,un.height,0,de,Se,un.data)}}else{Ce?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,de,Se,Le[Me]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,z,de,Se,Le[Me]);for(let He=0;He<Fe.length;He++){const Qe=Fe[He];Ce?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He+1,0,0,de,Se,Qe.image[Me]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,He+1,z,de,Se,Qe.image[Me])}}}w(L,Y)&&S(n.TEXTURE_CUBE_MAP),ye.__version=he.version,L.onUpdate&&L.onUpdate(L)}N.__version=L.version}function k(N,L,J,pe,he,ye){const Ue=s.convert(J.format,J.colorSpace),Ae=s.convert(J.type),Ne=x(J.internalFormat,Ue,Ae,J.colorSpace);if(!i.get(L).__hasExternalTextures){const ht=Math.max(1,L.width>>ye),Le=Math.max(1,L.height>>ye);he===n.TEXTURE_3D||he===n.TEXTURE_2D_ARRAY?t.texImage3D(he,ye,Ne,ht,Le,L.depth,0,Ue,Ae,null):t.texImage2D(he,ye,Ne,ht,Le,0,Ue,Ae,null)}t.bindFramebuffer(n.FRAMEBUFFER,N),ue(L)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,pe,he,i.get(J).__webglTexture,0,re(L)):(he===n.TEXTURE_2D||he>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&he<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,pe,he,i.get(J).__webglTexture,ye),t.bindFramebuffer(n.FRAMEBUFFER,null)}function A(N,L,J){if(n.bindRenderbuffer(n.RENDERBUFFER,N),L.depthBuffer&&!L.stencilBuffer){let pe=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(J||ue(L)){const he=L.depthTexture;he&&he.isDepthTexture&&(he.type===zr?pe=n.DEPTH_COMPONENT32F:he.type===_s&&(pe=n.DEPTH_COMPONENT24));const ye=re(L);ue(L)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ye,pe,L.width,L.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ye,pe,L.width,L.height)}else n.renderbufferStorage(n.RENDERBUFFER,pe,L.width,L.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,N)}else if(L.depthBuffer&&L.stencilBuffer){const pe=re(L);J&&ue(L)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,pe,n.DEPTH24_STENCIL8,L.width,L.height):ue(L)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,pe,n.DEPTH24_STENCIL8,L.width,L.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,L.width,L.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,N)}else{const pe=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let he=0;he<pe.length;he++){const ye=pe[he],Ue=s.convert(ye.format,ye.colorSpace),Ae=s.convert(ye.type),Ne=x(ye.internalFormat,Ue,Ae,ye.colorSpace),$e=re(L);J&&ue(L)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,$e,Ne,L.width,L.height):ue(L)?d.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,$e,Ne,L.width,L.height):n.renderbufferStorage(n.RENDERBUFFER,Ne,L.width,L.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function R(N,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,N),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),te(L.depthTexture,0);const pe=i.get(L.depthTexture).__webglTexture,he=re(L);if(L.depthTexture.format===vo)ue(L)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,pe,0,he):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,pe,0);else if(L.depthTexture.format===Sa)ue(L)?d.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,pe,0,he):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,pe,0);else throw new Error("Unknown depthTexture format")}function I(N){const L=i.get(N),J=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture&&!L.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");R(L.__webglFramebuffer,N)}else if(J){L.__webglDepthbuffer=[];for(let pe=0;pe<6;pe++)t.bindFramebuffer(n.FRAMEBUFFER,L.__webglFramebuffer[pe]),L.__webglDepthbuffer[pe]=n.createRenderbuffer(),A(L.__webglDepthbuffer[pe],N,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,L.__webglFramebuffer),L.__webglDepthbuffer=n.createRenderbuffer(),A(L.__webglDepthbuffer,N,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function V(N,L,J){const pe=i.get(N);L!==void 0&&k(pe.__webglFramebuffer,N,N.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),J!==void 0&&I(N)}function H(N){const L=N.texture,J=i.get(N),pe=i.get(L);N.addEventListener("dispose",O),N.isWebGLMultipleRenderTargets!==!0&&(pe.__webglTexture===void 0&&(pe.__webglTexture=n.createTexture()),pe.__version=L.version,o.memory.textures++);const he=N.isWebGLCubeRenderTarget===!0,ye=N.isWebGLMultipleRenderTargets===!0,Ue=_(N)||a;if(he){J.__webglFramebuffer=[];for(let Ae=0;Ae<6;Ae++)if(a&&L.mipmaps&&L.mipmaps.length>0){J.__webglFramebuffer[Ae]=[];for(let Ne=0;Ne<L.mipmaps.length;Ne++)J.__webglFramebuffer[Ae][Ne]=n.createFramebuffer()}else J.__webglFramebuffer[Ae]=n.createFramebuffer()}else{if(a&&L.mipmaps&&L.mipmaps.length>0){J.__webglFramebuffer=[];for(let Ae=0;Ae<L.mipmaps.length;Ae++)J.__webglFramebuffer[Ae]=n.createFramebuffer()}else J.__webglFramebuffer=n.createFramebuffer();if(ye)if(r.drawBuffers){const Ae=N.texture;for(let Ne=0,$e=Ae.length;Ne<$e;Ne++){const ht=i.get(Ae[Ne]);ht.__webglTexture===void 0&&(ht.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&ue(N)===!1){const Ae=ye?L:[L];J.__webglMultisampledFramebuffer=n.createFramebuffer(),J.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,J.__webglMultisampledFramebuffer);for(let Ne=0;Ne<Ae.length;Ne++){const $e=Ae[Ne];J.__webglColorRenderbuffer[Ne]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,J.__webglColorRenderbuffer[Ne]);const ht=s.convert($e.format,$e.colorSpace),Le=s.convert($e.type),Je=x($e.internalFormat,ht,Le,$e.colorSpace,N.isXRRenderTarget===!0),Y=re(N);n.renderbufferStorageMultisample(n.RENDERBUFFER,Y,Je,N.width,N.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ne,n.RENDERBUFFER,J.__webglColorRenderbuffer[Ne])}n.bindRenderbuffer(n.RENDERBUFFER,null),N.depthBuffer&&(J.__webglDepthRenderbuffer=n.createRenderbuffer(),A(J.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(he){t.bindTexture(n.TEXTURE_CUBE_MAP,pe.__webglTexture),Q(n.TEXTURE_CUBE_MAP,L,Ue);for(let Ae=0;Ae<6;Ae++)if(a&&L.mipmaps&&L.mipmaps.length>0)for(let Ne=0;Ne<L.mipmaps.length;Ne++)k(J.__webglFramebuffer[Ae][Ne],N,L,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,Ne);else k(J.__webglFramebuffer[Ae],N,L,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,0);w(L,Ue)&&S(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ye){const Ae=N.texture;for(let Ne=0,$e=Ae.length;Ne<$e;Ne++){const ht=Ae[Ne],Le=i.get(ht);t.bindTexture(n.TEXTURE_2D,Le.__webglTexture),Q(n.TEXTURE_2D,ht,Ue),k(J.__webglFramebuffer,N,ht,n.COLOR_ATTACHMENT0+Ne,n.TEXTURE_2D,0),w(ht,Ue)&&S(n.TEXTURE_2D)}t.unbindTexture()}else{let Ae=n.TEXTURE_2D;if((N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?Ae=N.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ae,pe.__webglTexture),Q(Ae,L,Ue),a&&L.mipmaps&&L.mipmaps.length>0)for(let Ne=0;Ne<L.mipmaps.length;Ne++)k(J.__webglFramebuffer[Ne],N,L,n.COLOR_ATTACHMENT0,Ae,Ne);else k(J.__webglFramebuffer,N,L,n.COLOR_ATTACHMENT0,Ae,0);w(L,Ue)&&S(Ae),t.unbindTexture()}N.depthBuffer&&I(N)}function ee(N){const L=_(N)||a,J=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let pe=0,he=J.length;pe<he;pe++){const ye=J[pe];if(w(ye,L)){const Ue=N.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ae=i.get(ye).__webglTexture;t.bindTexture(Ue,Ae),S(Ue),t.unbindTexture()}}}function oe(N){if(a&&N.samples>0&&ue(N)===!1){const L=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],J=N.width,pe=N.height;let he=n.COLOR_BUFFER_BIT;const ye=[],Ue=N.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ae=i.get(N),Ne=N.isWebGLMultipleRenderTargets===!0;if(Ne)for(let $e=0;$e<L.length;$e++)t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ae.__webglFramebuffer);for(let $e=0;$e<L.length;$e++){ye.push(n.COLOR_ATTACHMENT0+$e),N.depthBuffer&&ye.push(Ue);const ht=Ae.__ignoreDepthValues!==void 0?Ae.__ignoreDepthValues:!1;if(ht===!1&&(N.depthBuffer&&(he|=n.DEPTH_BUFFER_BIT),N.stencilBuffer&&(he|=n.STENCIL_BUFFER_BIT)),Ne&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ae.__webglColorRenderbuffer[$e]),ht===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ue]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ue])),Ne){const Le=i.get(L[$e]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Le,0)}n.blitFramebuffer(0,0,J,pe,0,0,J,pe,he,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ye)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ne)for(let $e=0;$e<L.length;$e++){t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.RENDERBUFFER,Ae.__webglColorRenderbuffer[$e]);const ht=i.get(L[$e]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ae.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$e,n.TEXTURE_2D,ht,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer)}}function re(N){return Math.min(h,N.samples)}function ue(N){const L=i.get(N);return a&&N.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function ae(N){const L=o.render.frame;p.get(N)!==L&&(p.set(N,L),N.update())}function Ee(N,L){const J=N.colorSpace,pe=N.format,he=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||N.format===sp||J!==Zr&&J!==Ui&&(Dt.getTransfer(J)===Bt?a===!1?e.has("EXT_sRGB")===!0&&pe===Di?(N.format=sp,N.minFilter=Qt,N.generateMipmaps=!1):L=Z_.sRGBToLinear(L):(pe!==Di||he!==br)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",J)),L}this.allocateTextureUnit=ie,this.resetTextureUnits=q,this.setTexture2D=te,this.setTexture2DArray=X,this.setTexture3D=se,this.setTextureCube=G,this.rebindTextures=V,this.setupRenderTarget=H,this.updateRenderTargetMipmap=ee,this.updateMultisampleRenderTarget=oe,this.setupDepthRenderbuffer=I,this.setupFrameBufferTexture=k,this.useMultisampledRTT=ue}function _C(n,e,t){const i=t.isWebGL2;function r(s,o=Ui){let a;const l=Dt.getTransfer(o);if(s===br)return n.UNSIGNED_BYTE;if(s===H_)return n.UNSIGNED_SHORT_4_4_4_4;if(s===G_)return n.UNSIGNED_SHORT_5_5_5_1;if(s===DA)return n.BYTE;if(s===UA)return n.SHORT;if(s===Wp)return n.UNSIGNED_SHORT;if(s===V_)return n.INT;if(s===_s)return n.UNSIGNED_INT;if(s===zr)return n.FLOAT;if(s===oc)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===NA)return n.ALPHA;if(s===Di)return n.RGBA;if(s===FA)return n.LUMINANCE;if(s===kA)return n.LUMINANCE_ALPHA;if(s===vo)return n.DEPTH_COMPONENT;if(s===Sa)return n.DEPTH_STENCIL;if(s===sp)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===BA)return n.RED;if(s===W_)return n.RED_INTEGER;if(s===zA)return n.RG;if(s===$_)return n.RG_INTEGER;if(s===j_)return n.RGBA_INTEGER;if(s===Cf||s===Pf||s===Rf||s===Lf)if(l===Bt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Cf)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Pf)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Rf)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Lf)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Cf)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Pf)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Rf)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Lf)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Bv||s===zv||s===Vv||s===Hv)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Bv)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===zv)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Vv)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===Hv)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===VA)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Gv||s===Wv)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===Gv)return l===Bt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===Wv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===$v||s===jv||s===Xv||s===Yv||s===qv||s===Kv||s===Zv||s===Jv||s===Qv||s===e0||s===t0||s===n0||s===i0||s===r0)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===$v)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===jv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Xv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Yv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===qv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===Kv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Zv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Jv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Qv)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===e0)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===t0)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===n0)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===i0)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===r0)return l===Bt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Of||s===s0||s===o0)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Of)return l===Bt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===s0)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===o0)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===HA||s===a0||s===l0||s===c0)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Of)return a.COMPRESSED_RED_RGTC1_EXT;if(s===a0)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===l0)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===c0)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===go?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class yC extends Nt{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class _r extends pt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const m8={type:"move"};class _g{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _r,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _r,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _r,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const m=t.getJointPose(v,i),g=this._getHandJoint(c,v);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=m.radius),g.visible=m!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(m8)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new _r;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class bC extends Yt{constructor(e,t,i,r,s,o,a,l,c,u){if(u=u!==void 0?u:vo,u!==vo&&u!==Sa)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&u===vo&&(i=_s),i===void 0&&u===Sa&&(i=go),super(null,r,s,o,a,l,u,i,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:an,this.minFilter=l!==void 0?l:an,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class g8 extends Lr{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,h=null,d=null,f=null,p=null;const v=t.getContextAttributes();let m=null,g=null;const b=[],y=[],_=new Nt;_.layers.enable(1),_.viewport=new gt;const T=new Nt;T.layers.enable(2),T.viewport=new gt;const w=[_,T],S=new yC;S.layers.enable(1),S.layers.enable(2);let x=null,M=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let se=b[X];return se===void 0&&(se=new _g,b[X]=se),se.getTargetRaySpace()},this.getControllerGrip=function(X){let se=b[X];return se===void 0&&(se=new _g,b[X]=se),se.getGripSpace()},this.getHand=function(X){let se=b[X];return se===void 0&&(se=new _g,b[X]=se),se.getHandSpace()};function E(X){const se=y.indexOf(X.inputSource);if(se===-1)return;const G=b[se];G!==void 0&&(G.update(X.inputSource,X.frame,c||o),G.dispatchEvent({type:X.type,data:X.inputSource}))}function C(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",C),r.removeEventListener("inputsourceschange",O);for(let X=0;X<b.length;X++){const se=y[X];se!==null&&(y[X]=null,b[X].disconnect(se))}x=null,M=null,e.setRenderTarget(m),f=null,d=null,h=null,r=null,g=null,te.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){s=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(X){c=X},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(X){if(r=X,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",C),r.addEventListener("inputsourceschange",O),v.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const se={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,se),r.updateRenderState({baseLayer:f}),g=new Sr(f.framebufferWidth,f.framebufferHeight,{format:Di,type:br,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let se=null,G=null,xe=null;v.depth&&(xe=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,se=v.stencil?Sa:vo,G=v.stencil?go:_s);const Re={colorFormat:t.RGBA8,depthFormat:xe,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(Re),r.updateRenderState({layers:[d]}),g=new Sr(d.textureWidth,d.textureHeight,{format:Di,type:br,depthTexture:new bC(d.textureWidth,d.textureHeight,G,void 0,void 0,void 0,void 0,void 0,void 0,se),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0});const Ie=e.properties.get(g);Ie.__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),te.setContext(r),te.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function O(X){for(let se=0;se<X.removed.length;se++){const G=X.removed[se],xe=y.indexOf(G);xe>=0&&(y[xe]=null,b[xe].disconnect(G))}for(let se=0;se<X.added.length;se++){const G=X.added[se];let xe=y.indexOf(G);if(xe===-1){for(let Ie=0;Ie<b.length;Ie++)if(Ie>=y.length){y.push(G),xe=Ie;break}else if(y[Ie]===null){y[Ie]=G,xe=Ie;break}if(xe===-1)break}const Re=b[xe];Re&&Re.connect(G)}}const $=new D,U=new D;function j(X,se,G){$.setFromMatrixPosition(se.matrixWorld),U.setFromMatrixPosition(G.matrixWorld);const xe=$.distanceTo(U),Re=se.projectionMatrix.elements,Ie=G.projectionMatrix.elements,Q=Re[14]/(Re[10]-1),K=Re[14]/(Re[10]+1),P=(Re[9]+1)/Re[5],F=(Re[9]-1)/Re[5],k=(Re[8]-1)/Re[0],A=(Ie[8]+1)/Ie[0],R=Q*k,I=Q*A,V=xe/(-k+A),H=V*-k;se.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(H),X.translateZ(V),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();const ee=Q+V,oe=K+V,re=R-H,ue=I+(xe-H),ae=P*K/oe*ee,Ee=F*K/oe*ee;X.projectionMatrix.makePerspective(re,ue,ae,Ee,ee,oe),X.projectionMatrixInverse.copy(X.projectionMatrix).invert()}function W(X,se){se===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(se.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(r===null)return;S.near=T.near=_.near=X.near,S.far=T.far=_.far=X.far,(x!==S.near||M!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),x=S.near,M=S.far);const se=X.parent,G=S.cameras;W(S,se);for(let xe=0;xe<G.length;xe++)W(G[xe],se);G.length===2?j(S,_,T):S.projectionMatrix.copy(_.projectionMatrix),q(X,S,se)};function q(X,se,G){G===null?X.matrix.copy(se.matrixWorld):(X.matrix.copy(G.matrixWorld),X.matrix.invert(),X.matrix.multiply(se.matrixWorld)),X.matrix.decompose(X.position,X.quaternion,X.scale),X.updateMatrixWorld(!0),X.projectionMatrix.copy(se.projectionMatrix),X.projectionMatrixInverse.copy(se.projectionMatrixInverse),X.isPerspectiveCamera&&(X.fov=lc*2*Math.atan(1/X.projectionMatrix.elements[5]),X.zoom=1)}this.getCamera=function(){return S},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(X){l=X,d!==null&&(d.fixedFoveation=X),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=X)};let ie=null;function Z(X,se){if(u=se.getViewerPose(c||o),p=se,u!==null){const G=u.views;f!==null&&(e.setRenderTargetFramebuffer(g,f.framebuffer),e.setRenderTarget(g));let xe=!1;G.length!==S.cameras.length&&(S.cameras.length=0,xe=!0);for(let Re=0;Re<G.length;Re++){const Ie=G[Re];let Q=null;if(f!==null)Q=f.getViewport(Ie);else{const P=h.getViewSubImage(d,Ie);Q=P.viewport,Re===0&&(e.setRenderTargetTextures(g,P.colorTexture,d.ignoreDepthValues?void 0:P.depthStencilTexture),e.setRenderTarget(g))}let K=w[Re];K===void 0&&(K=new Nt,K.layers.enable(Re),K.viewport=new gt,w[Re]=K),K.matrix.fromArray(Ie.transform.matrix),K.matrix.decompose(K.position,K.quaternion,K.scale),K.projectionMatrix.fromArray(Ie.projectionMatrix),K.projectionMatrixInverse.copy(K.projectionMatrix).invert(),K.viewport.set(Q.x,Q.y,Q.width,Q.height),Re===0&&(S.matrix.copy(K.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),xe===!0&&S.cameras.push(K)}}for(let G=0;G<b.length;G++){const xe=y[G],Re=b[G];xe!==null&&Re!==void 0&&Re.update(xe,se,c||o)}ie&&ie(X,se),se.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:se}),p=null}const te=new fC;te.setAnimationLoop(Z),this.setAnimationLoop=function(X){ie=X},this.dispose=function(){}}}function v8(n,e){function t(m,g){m.matrixAutoUpdate===!0&&m.updateMatrix(),g.value.copy(m.matrix)}function i(m,g){g.color.getRGB(m.fogColor.value,uC(n)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function r(m,g,b,y,_){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(m,g):g.isMeshToonMaterial?(s(m,g),h(m,g)):g.isMeshPhongMaterial?(s(m,g),u(m,g)):g.isMeshStandardMaterial?(s(m,g),d(m,g),g.isMeshPhysicalMaterial&&f(m,g,_)):g.isMeshMatcapMaterial?(s(m,g),p(m,g)):g.isMeshDepthMaterial?s(m,g):g.isMeshDistanceMaterial?(s(m,g),v(m,g)):g.isMeshNormalMaterial?s(m,g):g.isLineBasicMaterial?(o(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?l(m,g,b,y):g.isSpriteMaterial?c(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.bumpMap&&(m.bumpMap.value=g.bumpMap,t(g.bumpMap,m.bumpMapTransform),m.bumpScale.value=g.bumpScale,g.side===Yn&&(m.bumpScale.value*=-1)),g.normalMap&&(m.normalMap.value=g.normalMap,t(g.normalMap,m.normalMapTransform),m.normalScale.value.copy(g.normalScale),g.side===Yn&&m.normalScale.value.negate()),g.displacementMap&&(m.displacementMap.value=g.displacementMap,t(g.displacementMap,m.displacementMapTransform),m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,m.emissiveMapTransform)),g.specularMap&&(m.specularMap.value=g.specularMap,t(g.specularMap,m.specularMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const b=e.get(g).envMap;if(b&&(m.envMap.value=b,m.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const y=n._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*y,t(g.lightMap,m.lightMapTransform)}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,m.aoMapTransform))}function o(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform))}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function l(m,g,b,y){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*b,m.scale.value=y*.5,g.map&&(m.map.value=g.map,t(g.map,m.uvTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function c(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map,t(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,t(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function h(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function d(m,g){m.metalness.value=g.metalness,g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,m.metalnessMapTransform)),m.roughness.value=g.roughness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,m.roughnessMapTransform)),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function f(m,g,b){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,m.sheenColorMapTransform)),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,m.sheenRoughnessMapTransform))),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,m.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(m.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Yn&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,m.iridescenceMapTransform)),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=b.texture,m.transmissionSamplerSize.value.set(b.width,b.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,m.transmissionMapTransform)),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(m.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(m.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,m.specularColorMapTransform)),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,m.specularIntensityMapTransform))}function p(m,g){g.matcap&&(m.matcap.value=g.matcap)}function v(m,g){const b=e.get(g).light;m.referencePosition.value.setFromMatrixPosition(b.matrixWorld),m.nearDistance.value=b.shadow.camera.near,m.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function _8(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(b,y){const _=y.program;i.uniformBlockBinding(b,_)}function c(b,y){let _=r[b.id];_===void 0&&(p(b),_=u(b),r[b.id]=_,b.addEventListener("dispose",m));const T=y.program;i.updateUBOMapping(b,T);const w=e.render.frame;s[b.id]!==w&&(d(b),s[b.id]=w)}function u(b){const y=h();b.__bindingPointIndex=y;const _=n.createBuffer(),T=b.__size,w=b.usage;return n.bindBuffer(n.UNIFORM_BUFFER,_),n.bufferData(n.UNIFORM_BUFFER,T,w),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,y,_),_}function h(){for(let b=0;b<a;b++)if(o.indexOf(b)===-1)return o.push(b),b;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(b){const y=r[b.id],_=b.uniforms,T=b.__cache;n.bindBuffer(n.UNIFORM_BUFFER,y);for(let w=0,S=_.length;w<S;w++){const x=_[w];if(f(x,w,T)===!0){const M=x.__offset,E=Array.isArray(x.value)?x.value:[x.value];let C=0;for(let O=0;O<E.length;O++){const $=E[O],U=v($);typeof $=="number"?(x.__data[0]=$,n.bufferSubData(n.UNIFORM_BUFFER,M+C,x.__data)):$.isMatrix3?(x.__data[0]=$.elements[0],x.__data[1]=$.elements[1],x.__data[2]=$.elements[2],x.__data[3]=$.elements[0],x.__data[4]=$.elements[3],x.__data[5]=$.elements[4],x.__data[6]=$.elements[5],x.__data[7]=$.elements[0],x.__data[8]=$.elements[6],x.__data[9]=$.elements[7],x.__data[10]=$.elements[8],x.__data[11]=$.elements[0]):($.toArray(x.__data,C),C+=U.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,M,x.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function f(b,y,_){const T=b.value;if(_[y]===void 0){if(typeof T=="number")_[y]=T;else{const w=Array.isArray(T)?T:[T],S=[];for(let x=0;x<w.length;x++)S.push(w[x].clone());_[y]=S}return!0}else if(typeof T=="number"){if(_[y]!==T)return _[y]=T,!0}else{const w=Array.isArray(_[y])?_[y]:[_[y]],S=Array.isArray(T)?T:[T];for(let x=0;x<w.length;x++){const M=w[x];if(M.equals(S[x])===!1)return M.copy(S[x]),!0}}return!1}function p(b){const y=b.uniforms;let _=0;const T=16;let w=0;for(let S=0,x=y.length;S<x;S++){const M=y[S],E={boundary:0,storage:0},C=Array.isArray(M.value)?M.value:[M.value];for(let O=0,$=C.length;O<$;O++){const U=C[O],j=v(U);E.boundary+=j.boundary,E.storage+=j.storage}if(M.__data=new Float32Array(E.storage/Float32Array.BYTES_PER_ELEMENT),M.__offset=_,S>0){w=_%T;const O=T-w;w!==0&&O-E.boundary<0&&(_+=T-w,M.__offset=_)}_+=E.storage}return w=_%T,w>0&&(_+=T-w),b.__size=_,b.__cache={},this}function v(b){const y={boundary:0,storage:0};return typeof b=="number"?(y.boundary=4,y.storage=4):b.isVector2?(y.boundary=8,y.storage=8):b.isVector3||b.isColor?(y.boundary=16,y.storage=12):b.isVector4?(y.boundary=16,y.storage=16):b.isMatrix3?(y.boundary=48,y.storage=48):b.isMatrix4?(y.boundary=64,y.storage=64):b.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",b),y}function m(b){const y=b.target;y.removeEventListener("dispose",m);const _=o.indexOf(y.__bindingPointIndex);o.splice(_,1),n.deleteBuffer(r[y.id]),delete r[y.id],delete s[y.id]}function g(){for(const b in r)n.deleteBuffer(r[b]);o=[],r={},s={}}return{bind:l,update:c,dispose:g}}class Ru{constructor(e={}){const{canvas:t=aC(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;const f=new Uint32Array(4),p=new Int32Array(4);let v=null,m=null;const g=[],b=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Mn,this._useLegacyLights=!1,this.toneMapping=xs,this.toneMappingExposure=1;const y=this;let _=!1,T=0,w=0,S=null,x=-1,M=null;const E=new gt,C=new gt;let O=null;const $=new Oe(0);let U=0,j=t.width,W=t.height,q=1,ie=null,Z=null;const te=new gt(0,0,j,W),X=new gt(0,0,j,W);let se=!1;const G=new Zp;let xe=!1,Re=!1,Ie=null;const Q=new Be,K=new me,P=new D,F={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function k(){return S===null?q:1}let A=i;function R(B,le){for(let ge=0;ge<B.length;ge++){const ce=B[ge],ve=t.getContext(ce,le);if(ve!==null)return ve}return null}try{const B={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(_c)),t.addEventListener("webglcontextlost",Ce,!1),t.addEventListener("webglcontextrestored",Pe,!1),t.addEventListener("webglcontextcreationerror",ze,!1),A===null){const le=["webgl2","webgl","experimental-webgl"];if(y.isWebGL1Renderer===!0&&le.shift(),A=R(le,B),A===null)throw R(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&A instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),A.getShaderPrecisionFormat===void 0&&(A.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let I,V,H,ee,oe,re,ue,ae,Ee,N,L,J,pe,he,ye,Ue,Ae,Ne,$e,ht,Le,Je,Y,de;function Se(){I=new D6(A),V=new C6(A,I,e),I.init(V),Je=new _C(A,I,V),H=new f8(A,I,V),ee=new F6(A),oe=new t8,re=new p8(A,I,H,oe,V,Je,ee),ue=new R6(y),ae=new I6(y),Ee=new X5(A,V),Y=new T6(A,I,Ee,V),N=new U6(A,Ee,ee,Y),L=new V6(A,N,Ee,ee),$e=new z6(A,V,re),Ue=new P6(oe),J=new e8(y,ue,ae,I,V,Y,Ue),pe=new v8(y,oe),he=new i8,ye=new c8(I,V),Ne=new S6(y,ue,ae,H,L,d,l),Ae=new d8(y,L,V),de=new _8(A,ee,V,H),ht=new A6(A,I,ee,V),Le=new N6(A,I,ee,V),ee.programs=J.programs,y.capabilities=V,y.extensions=I,y.properties=oe,y.renderLists=he,y.shadowMap=Ae,y.state=H,y.info=ee}Se();const z=new g8(y,A);this.xr=z,this.getContext=function(){return A},this.getContextAttributes=function(){return A.getContextAttributes()},this.forceContextLoss=function(){const B=I.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=I.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(B){B!==void 0&&(q=B,this.setSize(j,W,!1))},this.getSize=function(B){return B.set(j,W)},this.setSize=function(B,le,ge=!0){if(z.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}j=B,W=le,t.width=Math.floor(B*q),t.height=Math.floor(le*q),ge===!0&&(t.style.width=B+"px",t.style.height=le+"px"),this.setViewport(0,0,B,le)},this.getDrawingBufferSize=function(B){return B.set(j*q,W*q).floor()},this.setDrawingBufferSize=function(B,le,ge){j=B,W=le,q=ge,t.width=Math.floor(B*ge),t.height=Math.floor(le*ge),this.setViewport(0,0,B,le)},this.getCurrentViewport=function(B){return B.copy(E)},this.getViewport=function(B){return B.copy(te)},this.setViewport=function(B,le,ge,ce){B.isVector4?te.set(B.x,B.y,B.z,B.w):te.set(B,le,ge,ce),H.viewport(E.copy(te).multiplyScalar(q).floor())},this.getScissor=function(B){return B.copy(X)},this.setScissor=function(B,le,ge,ce){B.isVector4?X.set(B.x,B.y,B.z,B.w):X.set(B,le,ge,ce),H.scissor(C.copy(X).multiplyScalar(q).floor())},this.getScissorTest=function(){return se},this.setScissorTest=function(B){H.setScissorTest(se=B)},this.setOpaqueSort=function(B){ie=B},this.setTransparentSort=function(B){Z=B},this.getClearColor=function(B){return B.copy(Ne.getClearColor())},this.setClearColor=function(){Ne.setClearColor.apply(Ne,arguments)},this.getClearAlpha=function(){return Ne.getClearAlpha()},this.setClearAlpha=function(){Ne.setClearAlpha.apply(Ne,arguments)},this.clear=function(B=!0,le=!0,ge=!0){let ce=0;if(B){let ve=!1;if(S!==null){const Ge=S.texture.format;ve=Ge===j_||Ge===$_||Ge===W_}if(ve){const Ge=S.texture.type,je=Ge===br||Ge===_s||Ge===Wp||Ge===go||Ge===H_||Ge===G_,nt=Ne.getClearColor(),it=Ne.getClearAlpha(),yt=nt.r,et=nt.g,dt=nt.b;je?(f[0]=yt,f[1]=et,f[2]=dt,f[3]=it,A.clearBufferuiv(A.COLOR,0,f)):(p[0]=yt,p[1]=et,p[2]=dt,p[3]=it,A.clearBufferiv(A.COLOR,0,p))}else ce|=A.COLOR_BUFFER_BIT}le&&(ce|=A.DEPTH_BUFFER_BIT),ge&&(ce|=A.STENCIL_BUFFER_BIT),A.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ce,!1),t.removeEventListener("webglcontextrestored",Pe,!1),t.removeEventListener("webglcontextcreationerror",ze,!1),he.dispose(),ye.dispose(),oe.dispose(),ue.dispose(),ae.dispose(),L.dispose(),Y.dispose(),de.dispose(),J.dispose(),z.dispose(),z.removeEventListener("sessionstart",Rt),z.removeEventListener("sessionend",Jn),Ie&&(Ie.dispose(),Ie=null),Qn.stop()};function Ce(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function Pe(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const B=ee.autoReset,le=Ae.enabled,ge=Ae.autoUpdate,ce=Ae.needsUpdate,ve=Ae.type;Se(),ee.autoReset=B,Ae.enabled=le,Ae.autoUpdate=ge,Ae.needsUpdate=ce,Ae.type=ve}function ze(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function Fe(B){const le=B.target;le.removeEventListener("dispose",Fe),Me(le)}function Me(B){He(B),oe.remove(B)}function He(B){const le=oe.get(B).programs;le!==void 0&&(le.forEach(function(ge){J.releaseProgram(ge)}),B.isShaderMaterial&&J.releaseShaderCache(B))}this.renderBufferDirect=function(B,le,ge,ce,ve,Ge){le===null&&(le=F);const je=ve.isMesh&&ve.matrixWorld.determinant()<0,nt=VP(B,le,ge,ce,ve);H.setMaterial(ce,je);let it=ge.index,yt=1;if(ce.wireframe===!0){if(it=N.getWireframeAttribute(ge),it===void 0)return;yt=2}const et=ge.drawRange,dt=ge.attributes.position;let nn=et.start*yt,hn=(et.start+et.count)*yt;Ge!==null&&(nn=Math.max(nn,Ge.start*yt),hn=Math.min(hn,(Ge.start+Ge.count)*yt)),it!==null?(nn=Math.max(nn,0),hn=Math.min(hn,it.count)):dt!=null&&(nn=Math.max(nn,0),hn=Math.min(hn,dt.count));const Hi=hn-nn;if(Hi<0||Hi===1/0)return;Y.setup(ve,ce,nt,ge,it);let ns,yn=ht;if(it!==null&&(ns=Ee.get(it),yn=Le,yn.setIndex(ns)),ve.isMesh)ce.wireframe===!0?(H.setLineWidth(ce.wireframeLinewidth*k()),yn.setMode(A.LINES)):yn.setMode(A.TRIANGLES);else if(ve.isLine){let xt=ce.linewidth;xt===void 0&&(xt=1),H.setLineWidth(xt*k()),ve.isLineSegments?yn.setMode(A.LINES):ve.isLineLoop?yn.setMode(A.LINE_LOOP):yn.setMode(A.LINE_STRIP)}else ve.isPoints?yn.setMode(A.POINTS):ve.isSprite&&yn.setMode(A.TRIANGLES);if(ve.isInstancedMesh)yn.renderInstances(nn,Hi,ve.count);else if(ge.isInstancedBufferGeometry){const xt=ge._maxInstanceCount!==void 0?ge._maxInstanceCount:1/0,Am=Math.min(ge.instanceCount,xt);yn.renderInstances(nn,Hi,Am)}else yn.render(nn,Hi)},this.compile=function(B,le){function ge(ce,ve,Ge){ce.transparent===!0&&ce.side===vi&&ce.forceSinglePass===!1?(ce.side=Yn,ce.needsUpdate=!0,ed(ce,ve,Ge),ce.side=Yr,ce.needsUpdate=!0,ed(ce,ve,Ge),ce.side=vi):ed(ce,ve,Ge)}m=ye.get(B),m.init(),b.push(m),B.traverseVisible(function(ce){ce.isLight&&ce.layers.test(le.layers)&&(m.pushLight(ce),ce.castShadow&&m.pushShadow(ce))}),m.setupLights(y._useLegacyLights),B.traverse(function(ce){const ve=ce.material;if(ve)if(Array.isArray(ve))for(let Ge=0;Ge<ve.length;Ge++){const je=ve[Ge];ge(je,B,ce)}else ge(ve,B,ce)}),b.pop(),m=null};let Qe=null;function un(B){Qe&&Qe(B)}function Rt(){Qn.stop()}function Jn(){Qn.start()}const Qn=new fC;Qn.setAnimationLoop(un),typeof self<"u"&&Qn.setContext(self),this.setAnimationLoop=function(B){Qe=B,z.setAnimationLoop(B),B===null?Qn.stop():Qn.start()},z.addEventListener("sessionstart",Rt),z.addEventListener("sessionend",Jn),this.render=function(B,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),z.enabled===!0&&z.isPresenting===!0&&(z.cameraAutoUpdate===!0&&z.updateCamera(le),le=z.getCamera()),B.isScene===!0&&B.onBeforeRender(y,B,le,S),m=ye.get(B,b.length),m.init(),b.push(m),Q.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),G.setFromProjectionMatrix(Q),Re=this.localClippingEnabled,xe=Ue.init(this.clippingPlanes,Re),v=he.get(B,g.length),v.init(),g.push(v),rb(B,le,0,y.sortObjects),v.finish(),y.sortObjects===!0&&v.sort(ie,Z),this.info.render.frame++,xe===!0&&Ue.beginShadows();const ge=m.state.shadowsArray;if(Ae.render(ge,B,le),xe===!0&&Ue.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ne.render(v,B),m.setupLights(y._useLegacyLights),le.isArrayCamera){const ce=le.cameras;for(let ve=0,Ge=ce.length;ve<Ge;ve++){const je=ce[ve];sb(v,B,je,je.viewport)}}else sb(v,B,le);S!==null&&(re.updateMultisampleRenderTarget(S),re.updateRenderTargetMipmap(S)),B.isScene===!0&&B.onAfterRender(y,B,le),Y.resetDefaultState(),x=-1,M=null,b.pop(),b.length>0?m=b[b.length-1]:m=null,g.pop(),g.length>0?v=g[g.length-1]:v=null};function rb(B,le,ge,ce){if(B.visible===!1)return;if(B.layers.test(le.layers)){if(B.isGroup)ge=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(le);else if(B.isLight)m.pushLight(B),B.castShadow&&m.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||G.intersectsSprite(B)){ce&&P.setFromMatrixPosition(B.matrixWorld).applyMatrix4(Q);const je=L.update(B),nt=B.material;nt.visible&&v.push(B,je,nt,ge,P.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||G.intersectsObject(B))){const je=L.update(B),nt=B.material;if(ce&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),P.copy(B.boundingSphere.center)):(je.boundingSphere===null&&je.computeBoundingSphere(),P.copy(je.boundingSphere.center)),P.applyMatrix4(B.matrixWorld).applyMatrix4(Q)),Array.isArray(nt)){const it=je.groups;for(let yt=0,et=it.length;yt<et;yt++){const dt=it[yt],nn=nt[dt.materialIndex];nn&&nn.visible&&v.push(B,je,nn,ge,P.z,dt)}}else nt.visible&&v.push(B,je,nt,ge,P.z,null)}}const Ge=B.children;for(let je=0,nt=Ge.length;je<nt;je++)rb(Ge[je],le,ge,ce)}function sb(B,le,ge,ce){const ve=B.opaque,Ge=B.transmissive,je=B.transparent;m.setupLightsView(ge),xe===!0&&Ue.setGlobalState(y.clippingPlanes,ge),Ge.length>0&&zP(ve,Ge,le,ge),ce&&H.viewport(E.copy(ce)),ve.length>0&&Qh(ve,le,ge),Ge.length>0&&Qh(Ge,le,ge),je.length>0&&Qh(je,le,ge),H.buffers.depth.setTest(!0),H.buffers.depth.setMask(!0),H.buffers.color.setMask(!0),H.setPolygonOffset(!1)}function zP(B,le,ge,ce){const ve=V.isWebGL2;Ie===null&&(Ie=new Sr(1,1,{generateMipmaps:!0,type:I.has("EXT_color_buffer_half_float")?oc:br,minFilter:Kr,samples:ve?4:0})),y.getDrawingBufferSize(K),ve?Ie.setSize(K.x,K.y):Ie.setSize(op(K.x),op(K.y));const Ge=y.getRenderTarget();y.setRenderTarget(Ie),y.getClearColor($),U=y.getClearAlpha(),U<1&&y.setClearColor(16777215,.5),y.clear();const je=y.toneMapping;y.toneMapping=xs,Qh(B,ge,ce),re.updateMultisampleRenderTarget(Ie),re.updateRenderTargetMipmap(Ie);let nt=!1;for(let it=0,yt=le.length;it<yt;it++){const et=le[it],dt=et.object,nn=et.geometry,hn=et.material,Hi=et.group;if(hn.side===vi&&dt.layers.test(ce.layers)){const ns=hn.side;hn.side=Yn,hn.needsUpdate=!0,ob(dt,ge,ce,nn,hn,Hi),hn.side=ns,hn.needsUpdate=!0,nt=!0}}nt===!0&&(re.updateMultisampleRenderTarget(Ie),re.updateRenderTargetMipmap(Ie)),y.setRenderTarget(Ge),y.setClearColor($,U),y.toneMapping=je}function Qh(B,le,ge){const ce=le.isScene===!0?le.overrideMaterial:null;for(let ve=0,Ge=B.length;ve<Ge;ve++){const je=B[ve],nt=je.object,it=je.geometry,yt=ce===null?je.material:ce,et=je.group;nt.layers.test(ge.layers)&&ob(nt,le,ge,it,yt,et)}}function ob(B,le,ge,ce,ve,Ge){B.onBeforeRender(y,le,ge,ce,ve,Ge),B.modelViewMatrix.multiplyMatrices(ge.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),ve.onBeforeRender(y,le,ge,ce,B,Ge),ve.transparent===!0&&ve.side===vi&&ve.forceSinglePass===!1?(ve.side=Yn,ve.needsUpdate=!0,y.renderBufferDirect(ge,le,ce,ve,B,Ge),ve.side=Yr,ve.needsUpdate=!0,y.renderBufferDirect(ge,le,ce,ve,B,Ge),ve.side=vi):y.renderBufferDirect(ge,le,ce,ve,B,Ge),B.onAfterRender(y,le,ge,ce,ve,Ge)}function ed(B,le,ge){le.isScene!==!0&&(le=F);const ce=oe.get(B),ve=m.state.lights,Ge=m.state.shadowsArray,je=ve.state.version,nt=J.getParameters(B,ve.state,Ge,le,ge),it=J.getProgramCacheKey(nt);let yt=ce.programs;ce.environment=B.isMeshStandardMaterial?le.environment:null,ce.fog=le.fog,ce.envMap=(B.isMeshStandardMaterial?ae:ue).get(B.envMap||ce.environment),yt===void 0&&(B.addEventListener("dispose",Fe),yt=new Map,ce.programs=yt);let et=yt.get(it);if(et!==void 0){if(ce.currentProgram===et&&ce.lightsStateVersion===je)return ab(B,nt),et}else nt.uniforms=J.getUniforms(B),B.onBuild(ge,nt,y),B.onBeforeCompile(nt,y),et=J.acquireProgram(nt,it),yt.set(it,et),ce.uniforms=nt.uniforms;const dt=ce.uniforms;(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(dt.clippingPlanes=Ue.uniform),ab(B,nt),ce.needsLights=GP(B),ce.lightsStateVersion=je,ce.needsLights&&(dt.ambientLightColor.value=ve.state.ambient,dt.lightProbe.value=ve.state.probe,dt.directionalLights.value=ve.state.directional,dt.directionalLightShadows.value=ve.state.directionalShadow,dt.spotLights.value=ve.state.spot,dt.spotLightShadows.value=ve.state.spotShadow,dt.rectAreaLights.value=ve.state.rectArea,dt.ltc_1.value=ve.state.rectAreaLTC1,dt.ltc_2.value=ve.state.rectAreaLTC2,dt.pointLights.value=ve.state.point,dt.pointLightShadows.value=ve.state.pointShadow,dt.hemisphereLights.value=ve.state.hemi,dt.directionalShadowMap.value=ve.state.directionalShadowMap,dt.directionalShadowMatrix.value=ve.state.directionalShadowMatrix,dt.spotShadowMap.value=ve.state.spotShadowMap,dt.spotLightMatrix.value=ve.state.spotLightMatrix,dt.spotLightMap.value=ve.state.spotLightMap,dt.pointShadowMap.value=ve.state.pointShadowMap,dt.pointShadowMatrix.value=ve.state.pointShadowMatrix);const nn=et.getUniforms(),hn=Uf.seqWithValue(nn.seq,dt);return ce.currentProgram=et,ce.uniformsList=hn,et}function ab(B,le){const ge=oe.get(B);ge.outputColorSpace=le.outputColorSpace,ge.instancing=le.instancing,ge.instancingColor=le.instancingColor,ge.skinning=le.skinning,ge.morphTargets=le.morphTargets,ge.morphNormals=le.morphNormals,ge.morphColors=le.morphColors,ge.morphTargetsCount=le.morphTargetsCount,ge.numClippingPlanes=le.numClippingPlanes,ge.numIntersection=le.numClipIntersection,ge.vertexAlphas=le.vertexAlphas,ge.vertexTangents=le.vertexTangents,ge.toneMapping=le.toneMapping}function VP(B,le,ge,ce,ve){le.isScene!==!0&&(le=F),re.resetTextureUnits();const Ge=le.fog,je=ce.isMeshStandardMaterial?le.environment:null,nt=S===null?y.outputColorSpace:S.isXRRenderTarget===!0?S.texture.colorSpace:Zr,it=(ce.isMeshStandardMaterial?ae:ue).get(ce.envMap||je),yt=ce.vertexColors===!0&&!!ge.attributes.color&&ge.attributes.color.itemSize===4,et=!!ge.attributes.tangent&&(!!ce.normalMap||ce.anisotropy>0),dt=!!ge.morphAttributes.position,nn=!!ge.morphAttributes.normal,hn=!!ge.morphAttributes.color;let Hi=xs;ce.toneMapped&&(S===null||S.isXRRenderTarget===!0)&&(Hi=y.toneMapping);const ns=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,yn=ns!==void 0?ns.length:0,xt=oe.get(ce),Am=m.state.lights;if(xe===!0&&(Re===!0||B!==M)){const Ci=B===M&&ce.id===x;Ue.setState(ce,B,Ci)}let bn=!1;ce.version===xt.__version?(xt.needsLights&&xt.lightsStateVersion!==Am.state.version||xt.outputColorSpace!==nt||ve.isInstancedMesh&&xt.instancing===!1||!ve.isInstancedMesh&&xt.instancing===!0||ve.isSkinnedMesh&&xt.skinning===!1||!ve.isSkinnedMesh&&xt.skinning===!0||ve.isInstancedMesh&&xt.instancingColor===!0&&ve.instanceColor===null||ve.isInstancedMesh&&xt.instancingColor===!1&&ve.instanceColor!==null||xt.envMap!==it||ce.fog===!0&&xt.fog!==Ge||xt.numClippingPlanes!==void 0&&(xt.numClippingPlanes!==Ue.numPlanes||xt.numIntersection!==Ue.numIntersection)||xt.vertexAlphas!==yt||xt.vertexTangents!==et||xt.morphTargets!==dt||xt.morphNormals!==nn||xt.morphColors!==hn||xt.toneMapping!==Hi||V.isWebGL2===!0&&xt.morphTargetsCount!==yn)&&(bn=!0):(bn=!0,xt.__version=ce.version);let Do=xt.currentProgram;bn===!0&&(Do=ed(ce,le,ve));let lb=!1,Oc=!1,Cm=!1;const ei=Do.getUniforms(),Uo=xt.uniforms;if(H.useProgram(Do.program)&&(lb=!0,Oc=!0,Cm=!0),ce.id!==x&&(x=ce.id,Oc=!0),lb||M!==B){ei.setValue(A,"projectionMatrix",B.projectionMatrix),ei.setValue(A,"viewMatrix",B.matrixWorldInverse);const Ci=ei.map.cameraPosition;Ci!==void 0&&Ci.setValue(A,P.setFromMatrixPosition(B.matrixWorld)),V.logarithmicDepthBuffer&&ei.setValue(A,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&ei.setValue(A,"isOrthographic",B.isOrthographicCamera===!0),M!==B&&(M=B,Oc=!0,Cm=!0)}if(ve.isSkinnedMesh){ei.setOptional(A,ve,"bindMatrix"),ei.setOptional(A,ve,"bindMatrixInverse");const Ci=ve.skeleton;Ci&&(V.floatVertexTextures?(Ci.boneTexture===null&&Ci.computeBoneTexture(),ei.setValue(A,"boneTexture",Ci.boneTexture,re),ei.setValue(A,"boneTextureSize",Ci.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Pm=ge.morphAttributes;if((Pm.position!==void 0||Pm.normal!==void 0||Pm.color!==void 0&&V.isWebGL2===!0)&&$e.update(ve,ge,Do),(Oc||xt.receiveShadow!==ve.receiveShadow)&&(xt.receiveShadow=ve.receiveShadow,ei.setValue(A,"receiveShadow",ve.receiveShadow)),ce.isMeshGouraudMaterial&&ce.envMap!==null&&(Uo.envMap.value=it,Uo.flipEnvMap.value=it.isCubeTexture&&it.isRenderTargetTexture===!1?-1:1),Oc&&(ei.setValue(A,"toneMappingExposure",y.toneMappingExposure),xt.needsLights&&HP(Uo,Cm),Ge&&ce.fog===!0&&pe.refreshFogUniforms(Uo,Ge),pe.refreshMaterialUniforms(Uo,ce,q,W,Ie),Uf.upload(A,xt.uniformsList,Uo,re)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(Uf.upload(A,xt.uniformsList,Uo,re),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&ei.setValue(A,"center",ve.center),ei.setValue(A,"modelViewMatrix",ve.modelViewMatrix),ei.setValue(A,"normalMatrix",ve.normalMatrix),ei.setValue(A,"modelMatrix",ve.matrixWorld),ce.isShaderMaterial||ce.isRawShaderMaterial){const Ci=ce.uniformsGroups;for(let Rm=0,WP=Ci.length;Rm<WP;Rm++)if(V.isWebGL2){const cb=Ci[Rm];de.update(cb,Do),de.bind(cb,Do)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Do}function HP(B,le){B.ambientLightColor.needsUpdate=le,B.lightProbe.needsUpdate=le,B.directionalLights.needsUpdate=le,B.directionalLightShadows.needsUpdate=le,B.pointLights.needsUpdate=le,B.pointLightShadows.needsUpdate=le,B.spotLights.needsUpdate=le,B.spotLightShadows.needsUpdate=le,B.rectAreaLights.needsUpdate=le,B.hemisphereLights.needsUpdate=le}function GP(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(B,le,ge){oe.get(B.texture).__webglTexture=le,oe.get(B.depthTexture).__webglTexture=ge;const ce=oe.get(B);ce.__hasExternalTextures=!0,ce.__hasExternalTextures&&(ce.__autoAllocateDepthBuffer=ge===void 0,ce.__autoAllocateDepthBuffer||I.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ce.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(B,le){const ge=oe.get(B);ge.__webglFramebuffer=le,ge.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(B,le=0,ge=0){S=B,T=le,w=ge;let ce=!0,ve=null,Ge=!1,je=!1;if(B){const it=oe.get(B);it.__useDefaultFramebuffer!==void 0?(H.bindFramebuffer(A.FRAMEBUFFER,null),ce=!1):it.__webglFramebuffer===void 0?re.setupRenderTarget(B):it.__hasExternalTextures&&re.rebindTextures(B,oe.get(B.texture).__webglTexture,oe.get(B.depthTexture).__webglTexture);const yt=B.texture;(yt.isData3DTexture||yt.isDataArrayTexture||yt.isCompressedArrayTexture)&&(je=!0);const et=oe.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(Array.isArray(et[le])?ve=et[le][ge]:ve=et[le],Ge=!0):V.isWebGL2&&B.samples>0&&re.useMultisampledRTT(B)===!1?ve=oe.get(B).__webglMultisampledFramebuffer:Array.isArray(et)?ve=et[ge]:ve=et,E.copy(B.viewport),C.copy(B.scissor),O=B.scissorTest}else E.copy(te).multiplyScalar(q).floor(),C.copy(X).multiplyScalar(q).floor(),O=se;if(H.bindFramebuffer(A.FRAMEBUFFER,ve)&&V.drawBuffers&&ce&&H.drawBuffers(B,ve),H.viewport(E),H.scissor(C),H.setScissorTest(O),Ge){const it=oe.get(B.texture);A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+le,it.__webglTexture,ge)}else if(je){const it=oe.get(B.texture),yt=le||0;A.framebufferTextureLayer(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,it.__webglTexture,ge||0,yt)}x=-1},this.readRenderTargetPixels=function(B,le,ge,ce,ve,Ge,je){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let nt=oe.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&je!==void 0&&(nt=nt[je]),nt){H.bindFramebuffer(A.FRAMEBUFFER,nt);try{const it=B.texture,yt=it.format,et=it.type;if(yt!==Di&&Je.convert(yt)!==A.getParameter(A.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const dt=et===oc&&(I.has("EXT_color_buffer_half_float")||V.isWebGL2&&I.has("EXT_color_buffer_float"));if(et!==br&&Je.convert(et)!==A.getParameter(A.IMPLEMENTATION_COLOR_READ_TYPE)&&!(et===zr&&(V.isWebGL2||I.has("OES_texture_float")||I.has("WEBGL_color_buffer_float")))&&!dt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=B.width-ce&&ge>=0&&ge<=B.height-ve&&A.readPixels(le,ge,ce,ve,Je.convert(yt),Je.convert(et),Ge)}finally{const it=S!==null?oe.get(S).__webglFramebuffer:null;H.bindFramebuffer(A.FRAMEBUFFER,it)}}},this.copyFramebufferToTexture=function(B,le,ge=0){const ce=Math.pow(2,-ge),ve=Math.floor(le.image.width*ce),Ge=Math.floor(le.image.height*ce);re.setTexture2D(le,0),A.copyTexSubImage2D(A.TEXTURE_2D,ge,0,0,B.x,B.y,ve,Ge),H.unbindTexture()},this.copyTextureToTexture=function(B,le,ge,ce=0){const ve=le.image.width,Ge=le.image.height,je=Je.convert(ge.format),nt=Je.convert(ge.type);re.setTexture2D(ge,0),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,ge.flipY),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ge.premultiplyAlpha),A.pixelStorei(A.UNPACK_ALIGNMENT,ge.unpackAlignment),le.isDataTexture?A.texSubImage2D(A.TEXTURE_2D,ce,B.x,B.y,ve,Ge,je,nt,le.image.data):le.isCompressedTexture?A.compressedTexSubImage2D(A.TEXTURE_2D,ce,B.x,B.y,le.mipmaps[0].width,le.mipmaps[0].height,je,le.mipmaps[0].data):A.texSubImage2D(A.TEXTURE_2D,ce,B.x,B.y,je,nt,le.image),ce===0&&ge.generateMipmaps&&A.generateMipmap(A.TEXTURE_2D),H.unbindTexture()},this.copyTextureToTexture3D=function(B,le,ge,ce,ve=0){if(y.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ge=B.max.x-B.min.x+1,je=B.max.y-B.min.y+1,nt=B.max.z-B.min.z+1,it=Je.convert(ce.format),yt=Je.convert(ce.type);let et;if(ce.isData3DTexture)re.setTexture3D(ce,0),et=A.TEXTURE_3D;else if(ce.isDataArrayTexture)re.setTexture2DArray(ce,0),et=A.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,ce.flipY),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),A.pixelStorei(A.UNPACK_ALIGNMENT,ce.unpackAlignment);const dt=A.getParameter(A.UNPACK_ROW_LENGTH),nn=A.getParameter(A.UNPACK_IMAGE_HEIGHT),hn=A.getParameter(A.UNPACK_SKIP_PIXELS),Hi=A.getParameter(A.UNPACK_SKIP_ROWS),ns=A.getParameter(A.UNPACK_SKIP_IMAGES),yn=ge.isCompressedTexture?ge.mipmaps[0]:ge.image;A.pixelStorei(A.UNPACK_ROW_LENGTH,yn.width),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,yn.height),A.pixelStorei(A.UNPACK_SKIP_PIXELS,B.min.x),A.pixelStorei(A.UNPACK_SKIP_ROWS,B.min.y),A.pixelStorei(A.UNPACK_SKIP_IMAGES,B.min.z),ge.isDataTexture||ge.isData3DTexture?A.texSubImage3D(et,ve,le.x,le.y,le.z,Ge,je,nt,it,yt,yn.data):ge.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),A.compressedTexSubImage3D(et,ve,le.x,le.y,le.z,Ge,je,nt,it,yn.data)):A.texSubImage3D(et,ve,le.x,le.y,le.z,Ge,je,nt,it,yt,yn),A.pixelStorei(A.UNPACK_ROW_LENGTH,dt),A.pixelStorei(A.UNPACK_IMAGE_HEIGHT,nn),A.pixelStorei(A.UNPACK_SKIP_PIXELS,hn),A.pixelStorei(A.UNPACK_SKIP_ROWS,Hi),A.pixelStorei(A.UNPACK_SKIP_IMAGES,ns),ve===0&&ce.generateMipmaps&&A.generateMipmap(et),H.unbindTexture()},this.initTexture=function(B){B.isCubeTexture?re.setTextureCube(B,0):B.isData3DTexture?re.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?re.setTexture2DArray(B,0):re.setTexture2D(B,0),H.unbindTexture()},this.resetState=function(){T=0,w=0,S=null,H.reset(),Y.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Vr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===jp?"display-p3":"srgb",t.unpackColorSpace=Dt.workingColorSpace===Nh?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Mn?_o:q_}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===_o?Mn:Zr}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class xC extends Ru{}xC.prototype.isWebGL1Renderer=!0;class Qp{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Oe(e),this.density=t}clone(){return new Qp(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class em{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new Oe(e),this.near=t,this.far=i}clone(){return new em(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class iy extends pt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class xc{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=uh,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ki()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ki()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ki()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ni=new D;class Jr{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.applyMatrix4(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.applyNormalMatrix(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ni.fromBufferAttribute(this,t),ni.transformDirection(e),this.setXYZ(t,ni.x,ni.y,ni.z);return this}setX(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ut(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=_i(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=_i(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=_i(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=_i(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ut(t,this.array),i=ut(i,this.array),r=ut(r,this.array),s=ut(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Tt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Jr(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class ry extends Pn{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Oe(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let dl;const Yc=new D,fl=new D,pl=new D,ml=new me,qc=new me,wC=new Be,Vd=new D,Kc=new D,Hd=new D,C1=new me,yg=new me,P1=new me;class MC extends pt{constructor(e=new ry){if(super(),this.isSprite=!0,this.type="Sprite",dl===void 0){dl=new Ye;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new xc(t,5);dl.setIndex([0,1,2,0,2,3]),dl.setAttribute("position",new Jr(i,3,0,!1)),dl.setAttribute("uv",new Jr(i,2,3,!1))}this.geometry=dl,this.material=e,this.center=new me(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),fl.setFromMatrixScale(this.matrixWorld),wC.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),pl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&fl.multiplyScalar(-pl.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Gd(Vd.set(-.5,-.5,0),pl,o,fl,r,s),Gd(Kc.set(.5,-.5,0),pl,o,fl,r,s),Gd(Hd.set(.5,.5,0),pl,o,fl,r,s),C1.set(0,0),yg.set(1,0),P1.set(1,1);let a=e.ray.intersectTriangle(Vd,Kc,Hd,!1,Yc);if(a===null&&(Gd(Kc.set(-.5,.5,0),pl,o,fl,r,s),yg.set(0,1),a=e.ray.intersectTriangle(Vd,Hd,Kc,!1,Yc),a===null))return;const l=e.ray.origin.distanceTo(Yc);l<e.near||l>e.far||t.push({distance:l,point:Yc.clone(),uv:gi.getInterpolation(Yc,Vd,Kc,Hd,C1,yg,P1,new me),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Gd(n,e,t,i,r,s){ml.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(qc.x=s*ml.x-r*ml.y,qc.y=r*ml.x+s*ml.y):qc.copy(ml),n.copy(e),n.x+=qc.x,n.y+=qc.y,n.applyMatrix4(wC)}const Wd=new D,R1=new D;class EC extends pt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Wd.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Wd);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Wd.setFromMatrixPosition(e.matrixWorld),R1.setFromMatrixPosition(this.matrixWorld);const i=Wd.distanceTo(R1)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),i>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const L1=new D,O1=new gt,I1=new gt,y8=new D,D1=new Be,gl=new D,bg=new Ai,U1=new Be,xg=new Ba;class tm extends ke{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Be,this.bindMatrixInverse=new Be,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ti),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gl.fromBufferAttribute(t,i),this.applyBoneTransform(i,gl),this.boundingBox.expandByPoint(gl)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Ai),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)gl.fromBufferAttribute(t,i),this.applyBoneTransform(i,gl),this.boundingSphere.expandByPoint(gl)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bg.copy(this.boundingSphere),bg.applyMatrix4(r),e.ray.intersectsSphere(bg)!==!1&&(U1.copy(r).invert(),xg.copy(e.ray).applyMatrix4(U1),!(this.boundingBox!==null&&xg.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,xg)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new gt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;O1.fromBufferAttribute(r.attributes.skinIndex,e),I1.fromBufferAttribute(r.attributes.skinWeight,e),L1.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=I1.getComponent(s);if(o!==0){const a=O1.getComponent(s);D1.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(y8.copy(L1).applyMatrix4(D1),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class uc extends pt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Xl extends Yt{constructor(e=null,t=1,i=1,r,s,o,a,l,c=an,u=an,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const N1=new Be,b8=new Be;class wc{constructor(e=[],t=[]){this.uuid=ki(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Be)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Be;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:b8;N1.multiplyMatrices(a,t[s]),N1.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new wc(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=sC(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Xl(t,e,e,Di,zr);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new uc),this.bones.push(o),this.boneInverses.push(new Be().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class hc extends Tt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const vl=new Be,F1=new Be,$d=[],k1=new Ti,x8=new Be,Zc=new ke,Jc=new Ai;class sy extends ke{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new hc(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,x8)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ti),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,vl),k1.copy(e.boundingBox).applyMatrix4(vl),this.boundingBox.union(k1)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Ai),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,vl),Jc.copy(e.boundingSphere).applyMatrix4(vl),this.boundingSphere.union(Jc)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Zc.geometry=this.geometry,Zc.material=this.material,Zc.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Jc.copy(this.boundingSphere),Jc.applyMatrix4(i),e.ray.intersectsSphere(Jc)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,vl),F1.multiplyMatrices(i,vl),Zc.matrixWorld=F1,Zc.raycast(e,$d);for(let o=0,a=$d.length;o<a;o++){const l=$d[o];l.instanceId=s,l.object=this,t.push(l)}$d.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new hc(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Nn extends Pn{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Oe(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const B1=new D,z1=new D,V1=new Be,wg=new Ba,jd=new Ai;class lt extends pt{constructor(e=new Ye,t=new Nn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)B1.fromBufferAttribute(t,r-1),z1.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=B1.distanceTo(z1);e.setAttribute("lineDistance",new Ve(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),jd.copy(i.boundingSphere),jd.applyMatrix4(r),jd.radius+=s,e.ray.intersectsSphere(jd)===!1)return;V1.copy(r).invert(),wg.copy(e.ray).applyMatrix4(V1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new D,u=new D,h=new D,d=new D,f=this.isLineSegments?2:1,p=i.index,m=i.attributes.position;if(p!==null){const g=Math.max(0,o.start),b=Math.min(p.count,o.start+o.count);for(let y=g,_=b-1;y<_;y+=f){const T=p.getX(y),w=p.getX(y+1);if(c.fromBufferAttribute(m,T),u.fromBufferAttribute(m,w),wg.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const x=e.ray.origin.distanceTo(d);x<e.near||x>e.far||t.push({distance:x,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),b=Math.min(m.count,o.start+o.count);for(let y=g,_=b-1;y<_;y+=f){if(c.fromBufferAttribute(m,y),u.fromBufferAttribute(m,y+1),wg.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(d);w<e.near||w>e.far||t.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const H1=new D,G1=new D;class Or extends lt{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)H1.fromBufferAttribute(t,r),G1.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+H1.distanceTo(G1);e.setAttribute("lineDistance",new Ve(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class oy extends lt{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class nm extends Pn{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Oe(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const W1=new Be,p0=new Ba,Xd=new Ai,Yd=new D;class ay extends pt{constructor(e=new Ye,t=new nm){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Xd.copy(i.boundingSphere),Xd.applyMatrix4(r),Xd.radius+=s,e.ray.intersectsSphere(Xd)===!1)return;W1.copy(r).invert(),p0.copy(e.ray).applyMatrix4(W1);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,h=i.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,v=f;p<v;p++){const m=c.getX(p);Yd.fromBufferAttribute(h,m),$1(Yd,m,l,r,e,t,this)}}else{const d=Math.max(0,o.start),f=Math.min(h.count,o.start+o.count);for(let p=d,v=f;p<v;p++)Yd.fromBufferAttribute(h,p),$1(Yd,p,l,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function $1(n,e,t,i,r,s,o){const a=p0.distanceSqToPoint(n);if(a<t){const l=new D;p0.closestPointToPoint(n,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class w8 extends Yt{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Qt,this.magFilter=s!==void 0?s:Qt,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class m0 extends Yt{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=an,this.minFilter=an,this.generateMipmaps=!1,this.needsUpdate=!0}}class im extends Yt{constructor(e,t,i,r,s,o,a,l,c,u,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class M8 extends im{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=An}}class E8 extends im{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,Ps),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class S8 extends Yt{constructor(e,t,i,r,s,o,a,l,c){super(e,t,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ar{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const u=i[r],d=i[r+1]-u,f=(o-u)/d;return(r+f)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new me:new D);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new D,r=[],s=[],o=[],a=new D,l=new Be;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new D)}s[0]=new D,o[0]=new D;let c=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=c&&(c=u,i.set(1,0,0)),h<=c&&(c=h,i.set(0,1,0)),d<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(ln(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(t===!0){let f=Math.acos(ln(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class rm extends ar{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const i=t||new me,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*u-f*h+this.aX,c=d*h+f*u+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class SC extends rm{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function ly(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+h)+(l-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const qd=new D,Mg=new ly,Eg=new ly,Sg=new ly;class TC extends ar{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new D){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=r[(a-1)%s]:(qd.subVectors(r[0],r[1]).add(r[0]),c=qd);const h=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?u=r[(a+2)%s]:(qd.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=qd),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(d),f),m=Math.pow(d.distanceToSquared(u),f);v<1e-4&&(v=1),p<1e-4&&(p=v),m<1e-4&&(m=v),Mg.initNonuniformCatmullRom(c.x,h.x,d.x,u.x,p,v,m),Eg.initNonuniformCatmullRom(c.y,h.y,d.y,u.y,p,v,m),Sg.initNonuniformCatmullRom(c.z,h.z,d.z,u.z,p,v,m)}else this.curveType==="catmullrom"&&(Mg.initCatmullRom(c.x,h.x,d.x,u.x,this.tension),Eg.initCatmullRom(c.y,h.y,d.y,u.y,this.tension),Sg.initCatmullRom(c.z,h.z,d.z,u.z,this.tension));return i.set(Mg.calc(l),Eg.calc(l),Sg.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new D().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function j1(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function T8(n,e){const t=1-n;return t*t*e}function A8(n,e){return 2*(1-n)*n*e}function C8(n,e){return n*n*e}function Lu(n,e,t,i){return T8(n,e)+A8(n,t)+C8(n,i)}function P8(n,e){const t=1-n;return t*t*t*e}function R8(n,e){const t=1-n;return 3*t*t*n*e}function L8(n,e){return 3*(1-n)*n*n*e}function O8(n,e){return n*n*n*e}function Ou(n,e,t,i,r){return P8(n,e)+R8(n,t)+L8(n,i)+O8(n,r)}class cy extends ar{constructor(e=new me,t=new me,i=new me,r=new me){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new me){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Ou(e,r.x,s.x,o.x,a.x),Ou(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class AC extends ar{constructor(e=new D,t=new D,i=new D,r=new D){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new D){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Ou(e,r.x,s.x,o.x,a.x),Ou(e,r.y,s.y,o.y,a.y),Ou(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class uy extends ar{constructor(e=new me,t=new me){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new me){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new me){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class CC extends ar{constructor(e=new D,t=new D){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new D){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new D){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hy extends ar{constructor(e=new me,t=new me,i=new me){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new me){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Lu(e,r.x,s.x,o.x),Lu(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class dy extends ar{constructor(e=new D,t=new D,i=new D){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new D){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Lu(e,r.x,s.x,o.x),Lu(e,r.y,s.y,o.y),Lu(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class fy extends ar{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new me){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],u=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(j1(a,l.x,c.x,u.x,h.x),j1(a,l.y,c.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new me().fromArray(r))}return this}}var ap=Object.freeze({__proto__:null,ArcCurve:SC,CatmullRomCurve3:TC,CubicBezierCurve:cy,CubicBezierCurve3:AC,EllipseCurve:rm,LineCurve:uy,LineCurve3:CC,QuadraticBezierCurve:hy,QuadraticBezierCurve3:dy,SplineCurve:fy});class PC extends ar{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ap[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];i&&i.equals(u)||(t.push(u),i=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new ap[r.type]().fromJSON(r))}return this}}class fh extends PC{constructor(e){super(),this.type="Path",this.currentPoint=new me,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new uy(this.currentPoint.clone(),new me(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new hy(this.currentPoint.clone(),new me(e,t),new me(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new cy(this.currentPoint.clone(),new me(e,t),new me(i,r),new me(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new fy(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const c=new rm(e,t,i,r,s,o,a,l);if(this.curves.length>0){const h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Bh extends Ye{constructor(e=[new me(0,-.5),new me(.5,0),new me(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=ln(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,h=new D,d=new me,f=new D,p=new D,v=new D;let m=0,g=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:m=e[b+1].x-e[b].x,g=e[b+1].y-e[b].y,f.x=g*1,f.y=-m,f.z=g*0,v.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(v.x,v.y,v.z);break;default:m=e[b+1].x-e[b].x,g=e[b+1].y-e[b].y,f.x=g*1,f.y=-m,f.z=g*0,p.copy(f),f.x+=v.x,f.y+=v.y,f.z+=v.z,f.normalize(),l.push(f.x,f.y,f.z),v.copy(p)}for(let b=0;b<=t;b++){const y=i+b*u*r,_=Math.sin(y),T=Math.cos(y);for(let w=0;w<=e.length-1;w++){h.x=e[w].x*_,h.y=e[w].y,h.z=e[w].x*T,o.push(h.x,h.y,h.z),d.x=b/t,d.y=w/(e.length-1),a.push(d.x,d.y);const S=l[3*w+0]*_,x=l[3*w+1],M=l[3*w+0]*T;c.push(S,x,M)}}for(let b=0;b<t;b++)for(let y=0;y<e.length-1;y++){const _=y+b*e.length,T=_,w=_+e.length,S=_+e.length+1,x=_+1;s.push(T,w,x),s.push(S,x,w)}this.setIndex(s),this.setAttribute("position",new Ve(o,3)),this.setAttribute("uv",new Ve(a,2)),this.setAttribute("normal",new Ve(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bh(e.points,e.segments,e.phiStart,e.phiLength)}}class sm extends Bh{constructor(e=1,t=1,i=4,r=8){const s=new fh;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new sm(e.radius,e.length,e.capSegments,e.radialSegments)}}class om extends Ye{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new D,u=new me;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,d=3;h<=t;h++,d+=3){const f=i+h/t*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,l.push(u.x,u.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Ve(o,3)),this.setAttribute("normal",new Ve(a,3)),this.setAttribute("uv",new Ve(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new om(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kn extends Ye{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const v=[],m=i/2;let g=0;b(),o===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(u),this.setAttribute("position",new Ve(h,3)),this.setAttribute("normal",new Ve(d,3)),this.setAttribute("uv",new Ve(f,2));function b(){const _=new D,T=new D;let w=0;const S=(t-e)/i;for(let x=0;x<=s;x++){const M=[],E=x/s,C=E*(t-e)+e;for(let O=0;O<=r;O++){const $=O/r,U=$*l+a,j=Math.sin(U),W=Math.cos(U);T.x=C*j,T.y=-E*i+m,T.z=C*W,h.push(T.x,T.y,T.z),_.set(j,S,W).normalize(),d.push(_.x,_.y,_.z),f.push($,1-E),M.push(p++)}v.push(M)}for(let x=0;x<r;x++)for(let M=0;M<s;M++){const E=v[M][x],C=v[M+1][x],O=v[M+1][x+1],$=v[M][x+1];u.push(E,C,$),u.push(C,O,$),w+=6}c.addGroup(g,w,0),g+=w}function y(_){const T=p,w=new me,S=new D;let x=0;const M=_===!0?e:t,E=_===!0?1:-1;for(let O=1;O<=r;O++)h.push(0,m*E,0),d.push(0,E,0),f.push(.5,.5),p++;const C=p;for(let O=0;O<=r;O++){const U=O/r*l+a,j=Math.cos(U),W=Math.sin(U);S.x=M*W,S.y=m*E,S.z=M*j,h.push(S.x,S.y,S.z),d.push(0,E,0),w.x=j*.5+.5,w.y=W*.5*E+.5,f.push(w.x,w.y),p++}for(let O=0;O<r;O++){const $=T+O,U=C+O;_===!0?u.push(U,U+1,$):u.push(U+1,U,$),x+=3}c.addGroup(g,x,_===!0?1:2),g+=x}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kn(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class am extends kn{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new am(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Lo extends Ye{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];a(r),c(i),u(),this.setAttribute("position",new Ve(s,3)),this.setAttribute("normal",new Ve(s.slice(),3)),this.setAttribute("uv",new Ve(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(b){const y=new D,_=new D,T=new D;for(let w=0;w<t.length;w+=3)f(t[w+0],y),f(t[w+1],_),f(t[w+2],T),l(y,_,T,b)}function l(b,y,_,T){const w=T+1,S=[];for(let x=0;x<=w;x++){S[x]=[];const M=b.clone().lerp(_,x/w),E=y.clone().lerp(_,x/w),C=w-x;for(let O=0;O<=C;O++)O===0&&x===w?S[x][O]=M:S[x][O]=M.clone().lerp(E,O/C)}for(let x=0;x<w;x++)for(let M=0;M<2*(w-x)-1;M++){const E=Math.floor(M/2);M%2===0?(d(S[x][E+1]),d(S[x+1][E]),d(S[x][E])):(d(S[x][E+1]),d(S[x+1][E+1]),d(S[x+1][E]))}}function c(b){const y=new D;for(let _=0;_<s.length;_+=3)y.x=s[_+0],y.y=s[_+1],y.z=s[_+2],y.normalize().multiplyScalar(b),s[_+0]=y.x,s[_+1]=y.y,s[_+2]=y.z}function u(){const b=new D;for(let y=0;y<s.length;y+=3){b.x=s[y+0],b.y=s[y+1],b.z=s[y+2];const _=m(b)/2/Math.PI+.5,T=g(b)/Math.PI+.5;o.push(_,1-T)}p(),h()}function h(){for(let b=0;b<o.length;b+=6){const y=o[b+0],_=o[b+2],T=o[b+4],w=Math.max(y,_,T),S=Math.min(y,_,T);w>.9&&S<.1&&(y<.2&&(o[b+0]+=1),_<.2&&(o[b+2]+=1),T<.2&&(o[b+4]+=1))}}function d(b){s.push(b.x,b.y,b.z)}function f(b,y){const _=b*3;y.x=e[_+0],y.y=e[_+1],y.z=e[_+2]}function p(){const b=new D,y=new D,_=new D,T=new D,w=new me,S=new me,x=new me;for(let M=0,E=0;M<s.length;M+=9,E+=6){b.set(s[M+0],s[M+1],s[M+2]),y.set(s[M+3],s[M+4],s[M+5]),_.set(s[M+6],s[M+7],s[M+8]),w.set(o[E+0],o[E+1]),S.set(o[E+2],o[E+3]),x.set(o[E+4],o[E+5]),T.copy(b).add(y).add(_).divideScalar(3);const C=m(T);v(w,E+0,b,C),v(S,E+2,y,C),v(x,E+4,_,C)}}function v(b,y,_,T){T<0&&b.x===1&&(o[y]=b.x-1),_.x===0&&_.z===0&&(o[y]=T/2/Math.PI+.5)}function m(b){return Math.atan2(b.z,-b.x)}function g(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lo(e.vertices,e.indices,e.radius,e.details)}}class lm extends Lo{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new lm(e.radius,e.detail)}}const Kd=new D,Zd=new D,Tg=new D,Jd=new gi;class RC extends Ye{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(_a*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:v,b:m,c:g}=Jd;if(v.fromBufferAttribute(a,c[0]),m.fromBufferAttribute(a,c[1]),g.fromBufferAttribute(a,c[2]),Jd.getNormal(Tg),h[0]="".concat(Math.round(v.x*r),",").concat(Math.round(v.y*r),",").concat(Math.round(v.z*r)),h[1]="".concat(Math.round(m.x*r),",").concat(Math.round(m.y*r),",").concat(Math.round(m.z*r)),h[2]="".concat(Math.round(g.x*r),",").concat(Math.round(g.y*r),",").concat(Math.round(g.z*r)),!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let b=0;b<3;b++){const y=(b+1)%3,_=h[b],T=h[y],w=Jd[u[b]],S=Jd[u[y]],x="".concat(_,"_").concat(T),M="".concat(T,"_").concat(_);M in d&&d[M]?(Tg.dot(d[M].normal)<=s&&(f.push(w.x,w.y,w.z),f.push(S.x,S.y,S.z)),d[M]=null):x in d||(d[x]={index0:c[b],index1:c[y],normal:Tg.clone()})}}for(const p in d)if(d[p]){const{index0:v,index1:m}=d[p];Kd.fromBufferAttribute(a,v),Zd.fromBufferAttribute(a,m),f.push(Kd.x,Kd.y,Kd.z),f.push(Zd.x,Zd.y,Zd.z)}this.setAttribute("position",new Ve(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ya extends fh{constructor(e){super(e),this.uuid=ki(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new fh().fromJSON(r))}return this}}const I8={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=LC(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(i&&(s=k8(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let p=t;p<r;p+=t)h=n[p],d=n[p+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=f!==0?32767/f:0}return ph(s,o,t,a,l,f,0),o}};function LC(n,e,t,i,r){let s,o;if(r===q8(n,e,t,i)>0)for(s=e;s<t;s+=i)o=X1(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=X1(s,n[s],n[s+1],o);return o&&cm(o,o.next)&&(gh(o),o=o.next),o}function Aa(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(cm(t,t.next)||en(t.prev,t,t.next)===0)){if(gh(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function ph(n,e,t,i,r,s,o){if(!n)return;!o&&s&&G8(n,i,r,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?U8(n,i,r,s):D8(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),gh(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=N8(Aa(n),e,t),ph(n,e,t,i,r,s,2)):o===2&&F8(n,e,t,i,r,s):ph(Aa(n),e,t,i,r,s,1);break}}}function D8(n){const e=n.prev,t=n,i=n.next;if(en(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,c=i.y,u=r<s?r<o?r:o:s<o?s:o,h=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&Il(r,a,s,l,o,c,p.x,p.y)&&en(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function U8(n,e,t,i){const r=n.prev,s=n,o=n.next;if(en(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,u=r.y,h=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=u<h?u<d?u:d:h<d?h:d,v=a>l?a>c?a:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,g=g0(f,p,e,t,i),b=g0(v,m,e,t,i);let y=n.prevZ,_=n.nextZ;for(;y&&y.z>=g&&_&&_.z<=b;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&Il(a,u,l,h,c,d,y.x,y.y)&&en(y.prev,y,y.next)>=0||(y=y.prevZ,_.x>=f&&_.x<=v&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Il(a,u,l,h,c,d,_.x,_.y)&&en(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;y&&y.z>=g;){if(y.x>=f&&y.x<=v&&y.y>=p&&y.y<=m&&y!==r&&y!==o&&Il(a,u,l,h,c,d,y.x,y.y)&&en(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;_&&_.z<=b;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Il(a,u,l,h,c,d,_.x,_.y)&&en(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function N8(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!cm(r,s)&&OC(r,i,i.next,s)&&mh(r,s)&&mh(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),gh(i),gh(i.next),i=n=s),i=i.next}while(i!==n);return Aa(i)}function F8(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&j8(o,a)){let l=IC(o,a);o=Aa(o,o.next),l=Aa(l,l.next),ph(o,e,t,i,r,s,0),ph(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function k8(n,e,t,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,c=LC(n,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push($8(c));for(r.sort(B8),s=0;s<r.length;s++)t=z8(r[s],t);return t}function B8(n,e){return n.x-e.x}function z8(n,e){const t=V8(n,e);if(!t)return e;const i=IC(t,n);return Aa(i,i.next),Aa(t,t.next)}function V8(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>i&&(i=d,r=t.x<t.next.x?t:t.next,d===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let u=1/0,h;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&Il(o<c?s:i,o,l,c,o<c?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),mh(t,n)&&(h<u||h===u&&(t.x>r.x||t.x===r.x&&H8(r,t)))&&(r=t,u=h)),t=t.next;while(t!==a);return r}function H8(n,e){return en(n.prev,n,e.prev)<0&&en(e.next,n,n.next)<0}function G8(n,e,t,i){let r=n;do r.z===0&&(r.z=g0(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,W8(r)}function W8(n){let e,t,i,r,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,c*=2}while(o>1);return n}function g0(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function $8(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Il(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function j8(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!X8(n,e)&&(mh(n,e)&&mh(e,n)&&Y8(n,e)&&(en(n.prev,n,e.prev)||en(n,e.prev,e))||cm(n,e)&&en(n.prev,n,n.next)>0&&en(e.prev,e,e.next)>0)}function en(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function cm(n,e){return n.x===e.x&&n.y===e.y}function OC(n,e,t,i){const r=ef(en(n,e,t)),s=ef(en(n,e,i)),o=ef(en(t,i,n)),a=ef(en(t,i,e));return!!(r!==s&&o!==a||r===0&&Qd(n,t,e)||s===0&&Qd(n,i,e)||o===0&&Qd(t,n,i)||a===0&&Qd(t,e,i))}function Qd(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ef(n){return n>0?1:n<0?-1:0}function X8(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&OC(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function mh(n,e){return en(n.prev,n,n.next)<0?en(n,e,n.next)>=0&&en(n,n.prev,e)>=0:en(n,e,n.prev)<0||en(n,n.next,e)<0}function Y8(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function IC(n,e){const t=new v0(n.i,n.x,n.y),i=new v0(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function X1(n,e,t,i){const r=new v0(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function gh(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function v0(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function q8(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class Gr{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Gr.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];Y1(e),q1(i,e);let o=e.length;t.forEach(Y1);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,q1(i,t[l]);const a=I8.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Y1(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function q1(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class um extends Ye{constructor(e=new ya([new me(.5,.5),new me(-.5,.5),new me(-.5,-.5),new me(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Ve(r,3)),this.setAttribute("uv",new Ve(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,f=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:f-.1,v=t.bevelOffset!==void 0?t.bevelOffset:0,m=t.bevelSegments!==void 0?t.bevelSegments:3;const g=t.extrudePath,b=t.UVGenerator!==void 0?t.UVGenerator:K8;let y,_=!1,T,w,S,x;g&&(y=g.getSpacedPoints(u),_=!0,d=!1,T=g.computeFrenetFrames(u,!1),w=new D,S=new D,x=new D),d||(m=0,f=0,p=0,v=0);const M=a.extractPoints(c);let E=M.shape;const C=M.holes;if(!Gr.isClockWise(E)){E=E.reverse();for(let A=0,R=C.length;A<R;A++){const I=C[A];Gr.isClockWise(I)&&(C[A]=I.reverse())}}const $=Gr.triangulateShape(E,C),U=E;for(let A=0,R=C.length;A<R;A++){const I=C[A];E=E.concat(I)}function j(A,R,I){return R||console.error("THREE.ExtrudeGeometry: vec does not exist"),A.clone().addScaledVector(R,I)}const W=E.length,q=$.length;function ie(A,R,I){let V,H,ee;const oe=A.x-R.x,re=A.y-R.y,ue=I.x-A.x,ae=I.y-A.y,Ee=oe*oe+re*re,N=oe*ae-re*ue;if(Math.abs(N)>Number.EPSILON){const L=Math.sqrt(Ee),J=Math.sqrt(ue*ue+ae*ae),pe=R.x-re/L,he=R.y+oe/L,ye=I.x-ae/J,Ue=I.y+ue/J,Ae=((ye-pe)*ae-(Ue-he)*ue)/(oe*ae-re*ue);V=pe+oe*Ae-A.x,H=he+re*Ae-A.y;const Ne=V*V+H*H;if(Ne<=2)return new me(V,H);ee=Math.sqrt(Ne/2)}else{let L=!1;oe>Number.EPSILON?ue>Number.EPSILON&&(L=!0):oe<-Number.EPSILON?ue<-Number.EPSILON&&(L=!0):Math.sign(re)===Math.sign(ae)&&(L=!0),L?(V=-re,H=oe,ee=Math.sqrt(Ee)):(V=oe,H=re,ee=Math.sqrt(Ee/2))}return new me(V/ee,H/ee)}const Z=[];for(let A=0,R=U.length,I=R-1,V=A+1;A<R;A++,I++,V++)I===R&&(I=0),V===R&&(V=0),Z[A]=ie(U[A],U[I],U[V]);const te=[];let X,se=Z.concat();for(let A=0,R=C.length;A<R;A++){const I=C[A];X=[];for(let V=0,H=I.length,ee=H-1,oe=V+1;V<H;V++,ee++,oe++)ee===H&&(ee=0),oe===H&&(oe=0),X[V]=ie(I[V],I[ee],I[oe]);te.push(X),se=se.concat(X)}for(let A=0;A<m;A++){const R=A/m,I=f*Math.cos(R*Math.PI/2),V=p*Math.sin(R*Math.PI/2)+v;for(let H=0,ee=U.length;H<ee;H++){const oe=j(U[H],Z[H],V);Q(oe.x,oe.y,-I)}for(let H=0,ee=C.length;H<ee;H++){const oe=C[H];X=te[H];for(let re=0,ue=oe.length;re<ue;re++){const ae=j(oe[re],X[re],V);Q(ae.x,ae.y,-I)}}}const G=p+v;for(let A=0;A<W;A++){const R=d?j(E[A],se[A],G):E[A];_?(S.copy(T.normals[0]).multiplyScalar(R.x),w.copy(T.binormals[0]).multiplyScalar(R.y),x.copy(y[0]).add(S).add(w),Q(x.x,x.y,x.z)):Q(R.x,R.y,0)}for(let A=1;A<=u;A++)for(let R=0;R<W;R++){const I=d?j(E[R],se[R],G):E[R];_?(S.copy(T.normals[A]).multiplyScalar(I.x),w.copy(T.binormals[A]).multiplyScalar(I.y),x.copy(y[A]).add(S).add(w),Q(x.x,x.y,x.z)):Q(I.x,I.y,h/u*A)}for(let A=m-1;A>=0;A--){const R=A/m,I=f*Math.cos(R*Math.PI/2),V=p*Math.sin(R*Math.PI/2)+v;for(let H=0,ee=U.length;H<ee;H++){const oe=j(U[H],Z[H],V);Q(oe.x,oe.y,h+I)}for(let H=0,ee=C.length;H<ee;H++){const oe=C[H];X=te[H];for(let re=0,ue=oe.length;re<ue;re++){const ae=j(oe[re],X[re],V);_?Q(ae.x,ae.y+y[u-1].y,y[u-1].x+I):Q(ae.x,ae.y,h+I)}}}xe(),Re();function xe(){const A=r.length/3;if(d){let R=0,I=W*R;for(let V=0;V<q;V++){const H=$[V];K(H[2]+I,H[1]+I,H[0]+I)}R=u+m*2,I=W*R;for(let V=0;V<q;V++){const H=$[V];K(H[0]+I,H[1]+I,H[2]+I)}}else{for(let R=0;R<q;R++){const I=$[R];K(I[2],I[1],I[0])}for(let R=0;R<q;R++){const I=$[R];K(I[0]+W*u,I[1]+W*u,I[2]+W*u)}}i.addGroup(A,r.length/3-A,0)}function Re(){const A=r.length/3;let R=0;Ie(U,R),R+=U.length;for(let I=0,V=C.length;I<V;I++){const H=C[I];Ie(H,R),R+=H.length}i.addGroup(A,r.length/3-A,1)}function Ie(A,R){let I=A.length;for(;--I>=0;){const V=I;let H=I-1;H<0&&(H=A.length-1);for(let ee=0,oe=u+m*2;ee<oe;ee++){const re=W*ee,ue=W*(ee+1),ae=R+V+re,Ee=R+H+re,N=R+H+ue,L=R+V+ue;P(ae,Ee,N,L)}}}function Q(A,R,I){l.push(A),l.push(R),l.push(I)}function K(A,R,I){F(A),F(R),F(I);const V=r.length/3,H=b.generateTopUV(i,r,V-3,V-2,V-1);k(H[0]),k(H[1]),k(H[2])}function P(A,R,I,V){F(A),F(R),F(V),F(R),F(I),F(V);const H=r.length/3,ee=b.generateSideWallUV(i,r,H-6,H-3,H-2,H-1);k(ee[0]),k(ee[1]),k(ee[3]),k(ee[1]),k(ee[2]),k(ee[3])}function F(A){r.push(l[A*3+0]),r.push(l[A*3+1]),r.push(l[A*3+2])}function k(A){s.push(A.x),s.push(A.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return Z8(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new ap[r.type]().fromJSON(r)),new um(i,e.options)}}const K8={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],u=e[r*3+1];return[new me(s,o),new me(a,l),new me(c,u)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[i*3],u=e[i*3+1],h=e[i*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],v=e[s*3],m=e[s*3+1],g=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new me(o,1-l),new me(c,1-h),new me(d,1-p),new me(v,1-g)]:[new me(a,1-l),new me(u,1-h),new me(f,1-p),new me(m,1-g)]}};function Z8(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class hm extends Lo{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new hm(e.radius,e.detail)}}class Ki extends Lo{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ki(e.radius,e.detail)}}class dm extends Ye{constructor(e=.5,t=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],c=[],u=[];let h=e;const d=(t-e)/r,f=new D,p=new me;for(let v=0;v<=r;v++){for(let m=0;m<=i;m++){const g=s+m/i*o;f.x=h*Math.cos(g),f.y=h*Math.sin(g),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/t+1)/2,p.y=(f.y/t+1)/2,u.push(p.x,p.y)}h+=d}for(let v=0;v<r;v++){const m=v*(i+1);for(let g=0;g<i;g++){const b=g+m,y=b,_=b+i+1,T=b+i+2,w=b+1;a.push(y,_,w),a.push(_,T,w)}}this.setIndex(a),this.setAttribute("position",new Ve(l,3)),this.setAttribute("normal",new Ve(c,3)),this.setAttribute("uv",new Ve(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dm(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class fm extends Ye{constructor(e=new ya([new me(0,.5),new me(-.5,-.5),new me(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new Ve(r,3)),this.setAttribute("normal",new Ve(s,3)),this.setAttribute("uv",new Ve(o,2));function c(u){const h=r.length/3,d=u.extractPoints(t);let f=d.shape;const p=d.holes;Gr.isClockWise(f)===!1&&(f=f.reverse());for(let m=0,g=p.length;m<g;m++){const b=p[m];Gr.isClockWise(b)===!0&&(p[m]=b.reverse())}const v=Gr.triangulateShape(f,p);for(let m=0,g=p.length;m<g;m++){const b=p[m];f=f.concat(b)}for(let m=0,g=f.length;m<g;m++){const b=f[m];r.push(b.x,b.y,0),s.push(0,0,1),o.push(b.x,b.y)}for(let m=0,g=v.length;m<g;m++){const b=v[m],y=b[0]+h,_=b[1]+h,T=b[2]+h;i.push(y,_,T),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return J8(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new fm(i,e.curveSegments)}}function J8(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class Mc extends Ye{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const u=[],h=new D,d=new D,f=[],p=[],v=[],m=[];for(let g=0;g<=i;g++){const b=[],y=g/i;let _=0;g===0&&o===0?_=.5/t:g===i&&l===Math.PI&&(_=-.5/t);for(let T=0;T<=t;T++){const w=T/t;h.x=-e*Math.cos(r+w*s)*Math.sin(o+y*a),h.y=e*Math.cos(o+y*a),h.z=e*Math.sin(r+w*s)*Math.sin(o+y*a),p.push(h.x,h.y,h.z),d.copy(h).normalize(),v.push(d.x,d.y,d.z),m.push(w+_,1-y),b.push(c++)}u.push(b)}for(let g=0;g<i;g++)for(let b=0;b<t;b++){const y=u[g][b+1],_=u[g][b],T=u[g+1][b],w=u[g+1][b+1];(g!==0||o>0)&&f.push(y,_,w),(g!==i-1||l<Math.PI)&&f.push(_,T,w)}this.setIndex(f),this.setAttribute("position",new Ve(p,3)),this.setAttribute("normal",new Ve(v,3)),this.setAttribute("uv",new Ve(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mc(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class pm extends Lo{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new pm(e.radius,e.detail)}}class lo extends Ye{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],u=new D,h=new D,d=new D;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const v=p/r*s,m=f/i*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(v),h.y=(e+t*Math.cos(m))*Math.sin(v),h.z=t*Math.sin(m),a.push(h.x,h.y,h.z),u.x=e*Math.cos(v),u.y=e*Math.sin(v),d.subVectors(h,u).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const v=(r+1)*f+p-1,m=(r+1)*(f-1)+p-1,g=(r+1)*(f-1)+p,b=(r+1)*f+p;o.push(v,m,b),o.push(m,g,b)}this.setIndex(o),this.setAttribute("position",new Ve(a,3)),this.setAttribute("normal",new Ve(l,3)),this.setAttribute("uv",new Ve(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lo(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class mm extends Ye{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],u=[],h=new D,d=new D,f=new D,p=new D,v=new D,m=new D,g=new D;for(let y=0;y<=i;++y){const _=y/i*s*Math.PI*2;b(_,s,o,e,f),b(_+.01,s,o,e,p),m.subVectors(p,f),g.addVectors(p,f),v.crossVectors(m,g),g.crossVectors(v,m),v.normalize(),g.normalize();for(let T=0;T<=r;++T){const w=T/r*Math.PI*2,S=-t*Math.cos(w),x=t*Math.sin(w);h.x=f.x+(S*g.x+x*v.x),h.y=f.y+(S*g.y+x*v.y),h.z=f.z+(S*g.z+x*v.z),l.push(h.x,h.y,h.z),d.subVectors(h,f).normalize(),c.push(d.x,d.y,d.z),u.push(y/i),u.push(T/r)}}for(let y=1;y<=i;y++)for(let _=1;_<=r;_++){const T=(r+1)*(y-1)+(_-1),w=(r+1)*y+(_-1),S=(r+1)*y+_,x=(r+1)*(y-1)+_;a.push(T,w,x),a.push(w,S,x)}this.setIndex(a),this.setAttribute("position",new Ve(l,3)),this.setAttribute("normal",new Ve(c,3)),this.setAttribute("uv",new Ve(u,2));function b(y,_,T,w,S){const x=Math.cos(y),M=Math.sin(y),E=T/_*y,C=Math.cos(E);S.x=w*(2+C)*.5*x,S.y=w*(2+C)*M*.5,S.z=w*Math.sin(E)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mm(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class gm extends Ye{constructor(e=new dy(new D(-1,-1,0),new D(-1,1,0),new D(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new D,l=new D,c=new me;let u=new D;const h=[],d=[],f=[],p=[];v(),this.setIndex(p),this.setAttribute("position",new Ve(h,3)),this.setAttribute("normal",new Ve(d,3)),this.setAttribute("uv",new Ve(f,2));function v(){for(let y=0;y<t;y++)m(y);m(s===!1?t:0),b(),g()}function m(y){u=e.getPointAt(y/t,u);const _=o.normals[y],T=o.binormals[y];for(let w=0;w<=r;w++){const S=w/r*Math.PI*2,x=Math.sin(S),M=-Math.cos(S);l.x=M*_.x+x*T.x,l.y=M*_.y+x*T.y,l.z=M*_.z+x*T.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=u.x+i*l.x,a.y=u.y+i*l.y,a.z=u.z+i*l.z,h.push(a.x,a.y,a.z)}}function g(){for(let y=1;y<=t;y++)for(let _=1;_<=r;_++){const T=(r+1)*(y-1)+(_-1),w=(r+1)*y+(_-1),S=(r+1)*y+_,x=(r+1)*(y-1)+_;p.push(T,w,x),p.push(w,S,x)}}function b(){for(let y=0;y<=t;y++)for(let _=0;_<=r;_++)c.x=y/t,c.y=_/r,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new gm(new ap[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class DC extends Ye{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new D,s=new D;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const h=l[c],d=h.start,f=h.count;for(let p=d,v=d+f;p<v;p+=3)for(let m=0;m<3;m++){const g=a.getX(p+m),b=a.getX(p+(m+1)%3);r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,b),K1(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,h=3*a+(c+1)%3;r.fromBufferAttribute(o,u),s.fromBufferAttribute(o,h),K1(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Ve(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function K1(n,e,t){const i="".concat(n.x,",").concat(n.y,",").concat(n.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z),r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(n.x,",").concat(n.y,",").concat(n.z);return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var Z1=Object.freeze({__proto__:null,BoxGeometry:si,CapsuleGeometry:sm,CircleGeometry:om,ConeGeometry:am,CylinderGeometry:kn,DodecahedronGeometry:lm,EdgesGeometry:RC,ExtrudeGeometry:um,IcosahedronGeometry:hm,LatheGeometry:Bh,OctahedronGeometry:Ki,PlaneGeometry:Oi,PolyhedronGeometry:Lo,RingGeometry:dm,ShapeGeometry:fm,SphereGeometry:Mc,TetrahedronGeometry:pm,TorusGeometry:lo,TorusKnotGeometry:mm,TubeGeometry:gm,WireframeGeometry:DC});class UC extends Pn{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Oe(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Iu extends or{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class za extends Pn{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Oe(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ts extends za{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new me(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ln(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Oe(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Oe(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Oe(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Du extends Pn{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Oe(16777215),this.specular=new Oe(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NC extends Pn{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Oe(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class FC extends Pn{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class py extends Pn{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Oe(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Oe(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Uh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kC extends Pn{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Oe(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ro,this.normalScale=new me(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class BC extends Nn{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function fa(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function zC(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function VC(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function _0(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=n[a+l]}return r}function my(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}function Q8(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=i)){h.push(c.times[f]);for(let v=0;v<u;++v)d.push(c.values[f*u+v])}}h.length!==0&&(c.times=fa(h,c.times.constructor),c.values=fa(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function e7(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===l});if(c===void 0)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let v;if(s<=a.times[0]){const g=u,b=h-u;v=a.values.slice(g,b)}else if(s>=a.times[p]){const g=p*h+u,b=g+h-u;v=a.values.slice(g,b)}else{const g=a.createInterpolant(),b=u,y=h-u;g.evaluate(s),v=g.resultBuffer.slice(b,y)}l==="quaternion"&&new mt().fromArray(v).normalize().conjugate().toArray(v);const m=c.times.length;for(let g=0;g<m;++g){const b=g*f+d;if(l==="quaternion")mt.multiplyQuaternionsFlat(c.values,b,v,0,c.values,b);else{const y=f-d*2;for(let _=0;_<y;++_)c.values[b+_]-=v[_]}}}return n.blendMode=X_,n}const t7={convertArray:fa,isTypedArray:zC,getKeyframeOrder:VC,sortedArray:_0,flattenJSON:my,subclip:Q8,makeClipAdditive:e7};class Ec{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class HC extends Ec{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ua,endingEnd:ua}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case ha:s=e,a=2*t-i;break;case oh:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case ha:o=e,l=2*i-t;break;case oh:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=t}const c=(i-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-i),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-t)/(r-t),v=p*p,m=v*p,g=-d*m+2*d*v-d*p,b=(1+d)*m+(-1.5-2*d)*v+(-.5+d)*p+1,y=(-1-f)*m+(1.5+f)*v+.5*p,_=f*m-f*v;for(let T=0;T!==a;++T)s[T]=g*o[u+T]+b*o[c+T]+y*o[l+T]+_*o[h+T];return s}}class gy extends Ec{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(i-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}}class GC extends Ec{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ir{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fa(t,this.TimeBufferType),this.values=fa(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:fa(e.times,Array),values:fa(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new GC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new gy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new HC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ac:t=this.InterpolantFactoryMethodDiscrete;break;case Ta:t=this.InterpolantFactoryMethodLinear;break;case If:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ac;case this.InterpolantFactoryMethodLinear:return Ta;case this.InterpolantFactoryMethodSmooth:return If}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&zC(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===If,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(r)l=!0;else{const h=a*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const v=t[h+p];if(v!==t[d+p]||v!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*i,d=o*i;for(let f=0;f!==i;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ir.prototype.TimeBufferType=Float32Array;Ir.prototype.ValueBufferType=Float32Array;Ir.prototype.DefaultInterpolation=Ta;class Va extends Ir{}Va.prototype.ValueTypeName="bool";Va.prototype.ValueBufferType=Array;Va.prototype.DefaultInterpolation=ac;Va.prototype.InterpolantFactoryMethodLinear=void 0;Va.prototype.InterpolantFactoryMethodSmooth=void 0;class vy extends Ir{}vy.prototype.ValueTypeName="color";class Ca extends Ir{}Ca.prototype.ValueTypeName="number";class WC extends Ec{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)mt.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Rs extends Ir{InterpolantFactoryMethodLinear(e){return new WC(this.times,this.values,this.getValueSize(),e)}}Rs.prototype.ValueTypeName="quaternion";Rs.prototype.DefaultInterpolation=Ta;Rs.prototype.InterpolantFactoryMethodSmooth=void 0;class Ha extends Ir{}Ha.prototype.ValueTypeName="string";Ha.prototype.ValueBufferType=Array;Ha.prototype.DefaultInterpolation=ac;Ha.prototype.InterpolantFactoryMethodLinear=void 0;Ha.prototype.InterpolantFactoryMethodSmooth=void 0;class Pa extends Ir{}Pa.prototype.ValueTypeName="vector";class Ra{constructor(e,t=-1,i,r=$p){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=ki(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(i7(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Ir.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=VC(l);l=_0(l,1,u),c=_0(c,1,u),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Ca(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,v){if(f.length!==0){const m=[],g=[];my(f,m,g,p),m.length!==0&&v.push(new h(d,m,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const d=c[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let v=0;v<d[p].morphTargets.length;v++)f[d[p].morphTargets[v]]=-1;for(const v in f){const m=[],g=[];for(let b=0;b!==d[p].morphTargets.length;++b){const y=d[p];m.push(y.time),g.push(y.morphTarget===v?1:0)}r.push(new Ca(".morphTargetInfluence["+v+"]",m,g))}l=f.length*o}else{const f=".bones["+t[h].name+"]";i(Pa,f+".position",d,"pos",r),i(Rs,f+".quaternion",d,"rot",r),i(Pa,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function n7(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ca;case"vector":case"vector2":case"vector3":case"vector4":return Pa;case"color":return vy;case"quaternion":return Rs;case"bool":case"boolean":return Va;case"string":return Ha}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function i7(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=n7(n.type);if(n.times===void 0){const t=[],i=[];my(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const La={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class vm{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const f=c[h],p=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const Dl=new vm;class Vn{constructor(e){this.manager=e!==void 0?e:Dl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Vn.DEFAULT_MATERIAL_NAME="__DEFAULT";const us={};class r7 extends Error{constructor(e,t){super(e),this.response=t}}class Mi extends Vn{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=La.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(us[e]!==void 0){us[e].push({onLoad:t,onProgress:i,onError:r});return}us[e]=[],us[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=us[e],h=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let v=0;const m=new ReadableStream({start(g){b();function b(){h.read().then(({done:y,value:_})=>{if(y)g.close();else{v+=_.byteLength;const T=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:f});for(let w=0,S=u.length;w<S;w++){const x=u[w];x.onProgress&&x.onProgress(T)}g.enqueue(_),b()}})}}});return new Response(m)}else throw new r7('fetch for "'.concat(c.url,'" responded with ').concat(c.status,": ").concat(c.statusText),c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{La.add(e,c);const u=us[e];delete us[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=us[e];if(u===void 0)throw this.manager.itemError(e),c;delete us[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class s7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Mi(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Ra.parse(e[i]);t.push(r)}return t}}class o7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new im,l=new Mi(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(h){l.load(e[h],function(d){const f=s.parse(d,!0);o[h]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=Qt),a.image=o,a.format=f.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)u(h);else l.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let v=0;v<d.mipmapCount;v++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+v]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=Qt),a.format=d.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class vh extends Vn{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=La.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=dh("img");function l(){u(),La.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class a7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=new kh;s.colorSpace=Mn;const o=new vh(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class l7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Xl,a=new Mi(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:An,o.wrapT=c.wrapT!==void 0?c.wrapT:An,o.magFilter=c.magFilter!==void 0?c.magFilter:Qt,o.minFilter=c.minFilter!==void 0?c.minFilter:Qt,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Kr),c.mipmapCount===1&&(o.minFilter=Qt),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},i,r),o}}class _m extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=new Yt,o=new vh(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Oo extends pt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Oe(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class $C extends Oo{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(pt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Oe(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Ag=new Be,J1=new D,Q1=new D;class _y{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new me(512,512),this.map=null,this.mapPass=null,this.matrix=new Be,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Zp,this._frameExtents=new me(1,1),this._viewportCount=1,this._viewports=[new gt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;J1.setFromMatrixPosition(e.matrixWorld),t.position.copy(J1),Q1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Q1),t.updateMatrixWorld(),Ag.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ag),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Ag)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class c7 extends _y{constructor(){super(new Nt(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=lc*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class ym extends Oo{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(pt.DEFAULT_UP),this.updateMatrix(),this.target=new pt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new c7}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const eM=new Be,Qc=new D,Cg=new D;class u7 extends _y{constructor(){super(new Nt(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new me(4,2),this._viewportCount=6,this._viewports=[new gt(2,1,1,1),new gt(0,1,1,1),new gt(3,1,1,1),new gt(1,1,1,1),new gt(3,0,1,1),new gt(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Qc.setFromMatrixPosition(e.matrixWorld),i.position.copy(Qc),Cg.copy(i.position),Cg.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Cg),i.updateMatrixWorld(),r.makeTranslation(-Qc.x,-Qc.y,-Qc.z),eM.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eM)}}class _h extends Oo{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new u7}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class h7 extends _y{constructor(){super(new Ni(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class bm extends Oo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(pt.DEFAULT_UP),this.updateMatrix(),this.target=new pt,this.shadow=new h7}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class yy extends Oo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class jC extends Oo{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class XC{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new D)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class YC extends Oo{constructor(e=new XC,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class xm extends Vn{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Mi(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=xm.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Oe().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new Oe().setHex(o.value);break;case"v2":r.uniforms[s].value=new me().fromArray(o.value);break;case"v3":r.uniforms[s].value=new D().fromArray(o.value);break;case"v4":r.uniforms[s].value=new gt().fromArray(o.value);break;case"m3":r.uniforms[s].value=new ct().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Be().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new me().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new me().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:UC,SpriteMaterial:ry,RawShaderMaterial:Iu,ShaderMaterial:or,PointsMaterial:nm,MeshPhysicalMaterial:ts,MeshStandardMaterial:za,MeshPhongMaterial:Du,MeshToonMaterial:NC,MeshNormalMaterial:FC,MeshLambertMaterial:py,MeshDepthMaterial:ty,MeshDistanceMaterial:ny,MeshBasicMaterial:Xn,MeshMatcapMaterial:kC,LineDashedMaterial:BC,LineBasicMaterial:Nn,Material:Pn};return new t[e]}}class Bi{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(i){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class qC extends Ye{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class KC extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Mi(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(f,p){if(t[p]!==void 0)return t[p];const m=f.interleavedBuffers[p],g=s(f,m.buffer),b=Ll(m.type,g),y=new xc(b,m.stride);return y.uuid=m.uuid,t[p]=y,y}function s(f,p){if(i[p]!==void 0)return i[p];const m=f.arrayBuffers[p],g=new Uint32Array(m).buffer;return i[p]=g,g}const o=e.isInstancedBufferGeometry?new qC:new Ye,a=e.data.index;if(a!==void 0){const f=Ll(a.type,a.array);o.setIndex(new Tt(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let v;if(p.isInterleavedBufferAttribute){const m=r(e.data,p.data);v=new Jr(m,p.itemSize,p.offset,p.normalized)}else{const m=Ll(p.type,p.array),g=p.isInstancedBufferAttribute?hc:Tt;v=new g(m,p.itemSize,p.normalized)}p.name!==void 0&&(v.name=p.name),p.usage!==void 0&&v.setUsage(p.usage),p.updateRange!==void 0&&(v.updateRange.offset=p.updateRange.offset,v.updateRange.count=p.updateRange.count),o.setAttribute(f,v)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],v=[];for(let m=0,g=p.length;m<g;m++){const b=p[m];let y;if(b.isInterleavedBufferAttribute){const _=r(e.data,b.data);y=new Jr(_,b.itemSize,b.offset,b.normalized)}else{const _=Ll(b.type,b.array);y=new Tt(_,b.itemSize,b.normalized)}b.name!==void 0&&(y.name=b.name),v.push(y)}o.morphAttributes[f]=v}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let f=0,p=h.length;f!==p;++f){const v=h[f];o.addGroup(v.start,v.count,v.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new D;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new Ai(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class d7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=this.path===""?Bi.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Mi(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?Bi.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Mi(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),t!==void 0){let h=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new ya().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new wc().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new KC;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in Z1?a=Z1[l.type].fromJSON(l,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(l.type,'"'))}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new xm;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Ra.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(u)}else return l.data?{data:Ll(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new vm(t);s=new vh(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const h=e[c],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const m=d[p],g=a(m);g!==null&&(g instanceof HTMLImageElement?f.push(g):f.push(new Xl(g.data,g.width,g.height)))}r[h.uuid]=new da(f)}else{const f=a(h.url);r[h.uuid]=new da(f)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Ll(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new vh(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let h=0,d=c.length;h<d;h++){const f=c[h],p=await s(f);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Xl(p.data,p.width,p.height)))}i[l.uuid]=new da(u)}else{const u=await s(l.url);i[l.uuid]=new da(u)}}}return i}parseTextures(e,t){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new kh,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Xl:u=new Yt,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=i(a.mapping,f7)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=i(a.wrap[0],tM),u.wrapT=i(a.wrap[1],tM)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=i(a.minFilter,nM)),a.magFilter!==void 0&&(u.magFilter=i(a.magFilter,nM)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,i,r,s){let o;function a(d){return t[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const m=d[p];i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),f.push(i[m])}return f}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let u,h;switch(e.type){case"Scene":o=new iy,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Oe(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new em(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Qp(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Nt(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Ni(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new yy(e.color,e.intensity);break;case"DirectionalLight":o=new bm(e.color,e.intensity);break;case"PointLight":o=new _h(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new jC(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new ym(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new $C(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new YC().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),h=l(e.material),o=new tm(u,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),h=l(e.material),o=new ke(u,h);break;case"InstancedMesh":u=a(e.geometry),h=l(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new sy(u,h,d),o.instanceMatrix=new hc(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new hc(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new EC;break;case"Line":o=new lt(a(e.geometry),l(e.material));break;case"LineLoop":o=new oy(a(e.geometry),l(e.material));break;case"LineSegments":o=new Or(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new ay(a(e.geometry),l(e.material));break;case"Sprite":o=new MC(l(e.material));break;case"Group":o=new _r;break;case"Bone":o=new uc;break;default:o=new pt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],t,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],v=o.getObjectByProperty("uuid",p.object);v!==void 0&&o.addLevel(v,p.distance,p.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const f7={UVMapping:Hp,CubeReflectionMapping:Ps,CubeRefractionMapping:To,EquirectangularReflectionMapping:rc,EquirectangularRefractionMapping:rh,CubeUVReflectionMapping:yc},tM={RepeatWrapping:qr,ClampToEdgeWrapping:An,MirroredRepeatWrapping:sc},nM={NearestFilter:an,NearestMipmapNearestFilter:sh,NearestMipmapLinearFilter:$l,LinearFilter:Qt,LinearMipmapNearestFilter:Gp,LinearMipmapLinearFilter:Kr};class ZC extends Vn{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=La.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){La.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let tf;class by{static getContext(){return tf===void 0&&(tf=new(window.AudioContext||window.webkitAudioContext)),tf}static setContext(e){tf=e}}class p7 extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Mi(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);by.getContext().decodeAudioData(c,function(h){t(h)},a)}catch(c){a(c)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}const iM=new Be,rM=new Be,Wo=new Be;class m7{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Nt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Nt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Wo.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(_a*t.fov*.5)/t.zoom;let a,l;rM.elements[12]=-r,iM.elements[12]=r,a=-o*t.aspect+s,l=o*t.aspect+s,Wo.elements[0]=2*t.near/(l-a),Wo.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Wo),a=-o*t.aspect-s,l=o*t.aspect-s,Wo.elements[0]=2*t.near/(l-a),Wo.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Wo)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(rM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(iM)}}class xy{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=sM(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=sM();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function sM(){return(typeof performance>"u"?Date:performance).now()}const $o=new D,oM=new mt,g7=new D,jo=new D;class v7 extends pt{constructor(){super(),this.type="AudioListener",this.context=by.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new xy}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose($o,oM,g7),jo.set(0,0,-1).applyQuaternion(oM),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime($o.x,r),t.positionY.linearRampToValueAtTime($o.y,r),t.positionZ.linearRampToValueAtTime($o.z,r),t.forwardX.linearRampToValueAtTime(jo.x,r),t.forwardY.linearRampToValueAtTime(jo.y,r),t.forwardZ.linearRampToValueAtTime(jo.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition($o.x,$o.y,$o.z),t.setOrientation(jo.x,jo.y,jo.z,i.x,i.y,i.z)}}class JC extends pt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Xo=new D,aM=new mt,_7=new D,Yo=new D;class y7 extends JC{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xo,aM,_7),Yo.set(0,0,1).applyQuaternion(aM);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xo.x,i),t.positionY.linearRampToValueAtTime(Xo.y,i),t.positionZ.linearRampToValueAtTime(Xo.z,i),t.orientationX.linearRampToValueAtTime(Yo.x,i),t.orientationY.linearRampToValueAtTime(Yo.y,i),t.orientationZ.linearRampToValueAtTime(Yo.z,i)}else t.setPosition(Xo.x,Xo.y,Xo.z),t.setOrientation(Yo.x,Yo.y,Yo.z)}}class b7{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class QC{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(i,r,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(i[l]!==i[l+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){mt.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;mt.multiplyQuaternionsFlat(e,o,e,t,e,i),mt.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const wy="\\[\\]\\.:\\/",x7=new RegExp("["+wy+"]","g"),My="[^"+wy+"]",w7="[^"+wy.replace("\\.","")+"]",M7=/((?:WC+[\/:])*)/.source.replace("WC",My),E7=/(WCOD+)?/.source.replace("WCOD",w7),S7=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",My),T7=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",My),A7=new RegExp("^"+M7+E7+S7+T7+"$"),C7=["material","materials","bones","map"];class P7{constructor(e,t,i){const r=i||_t.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class _t{constructor(e,t,i){this.path=t,this.parsedPath=i||_t.parseTrackName(t),this.node=_t.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new _t.Composite(e,t,i):new _t(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(x7,"")}static parseTrackName(e){const t=A7.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);C7.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=_t.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let c=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}_t.Composite=P7;_t.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};_t.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};_t.prototype.GetterByBindingType=[_t.prototype._getValue_direct,_t.prototype._getValue_array,_t.prototype._getValue_arrayElement,_t.prototype._getValue_toArray];_t.prototype.SetterByBindingTypeAndVersioning=[[_t.prototype._setValue_direct,_t.prototype._setValue_direct_setNeedsUpdate,_t.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[_t.prototype._setValue_array,_t.prototype._setValue_array_setNeedsUpdate,_t.prototype._setValue_array_setMatrixWorldNeedsUpdate],[_t.prototype._setValue_arrayElement,_t.prototype._setValue_arrayElement_setNeedsUpdate,_t.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[_t.prototype._setValue_fromArray,_t.prototype._setValue_fromArray_setNeedsUpdate,_t.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class R7{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ki(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],f=d.uuid;let p=t[f];if(p===void 0){p=l++,t[f]=p,e.push(d);for(let v=0,m=o;v!==m;++v)s[v].push(new _t(d,i[v],r[v]))}else if(p<c){a=e[p];const v=--c,m=e[v];t[m.uuid]=p,e[p]=m,t[f]=v,e[v]=d;for(let g=0,b=o;g!==b;++g){const y=s[g],_=y[v];let T=y[p];y[p]=_,T===void 0&&(T=new _t(d,i[g],r[g])),y[v]=T}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const h=s++,d=e[h];t[d.uuid]=u,e[u]=d,t[c]=h,e[h]=l;for(let f=0,p=r;f!==p;++f){const v=i[f],m=v[h],g=v[u];v[u]=m,v[h]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,h=t[u];if(h!==void 0)if(delete t[u],h<s){const d=--s,f=e[d],p=--o,v=e[p];t[f.uuid]=h,e[h]=f,t[v.uuid]=d,e[d]=v,e.pop();for(let m=0,g=r;m!==g;++m){const b=i[m],y=b[d],_=b[p];b[h]=y,b[d]=_,b.pop()}}else{const d=--o,f=e[d];d>0&&(t[f.uuid]=h),e[h]=f,e.pop();for(let p=0,v=r;p!==v;++p){const m=i[p];m[h]=m[d],m.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,h=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(h);for(let d=u,f=l.length;d!==f;++d){const p=l[d];h[d]=new _t(p,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class e2{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:ua,endingEnd:ua};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=WA,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?t=0:(this._startTime=null,t=i*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case X_:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case $p:default:for(let u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===$A;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===GA){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=ha,r.endingEnd=ha):(e?r.endingStart=this.zeroSlopeAtStart?ha:ua:r.endingStart=oh,t?r.endingEnd=this.zeroSlopeAtEnd?ha:ua:r.endingEnd=oh)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=i,this}}const L7=new Float32Array(1);class O7 extends Lr{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=u[f];if(p!==void 0)++p.referenceCount,o[h]=p;else{if(p=o[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const v=t&&t._propertyBindings[h].binding.parsedPath;p=new QC(_t.create(i,f,v),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[h]=p}a[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new gy(new Float32Array(2),new Float32Array(2),1,L7),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Ra.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=$p),l!==void 0){const h=l.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new e2(this,o,t,i);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?Ra.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)t[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=u,t[u]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class Ey{constructor(e){this.value=e}clone(){return new Ey(this.value.clone===void 0?this.value:this.value.clone())}}let I7=0;class D7 extends Lr{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:I7++}),this.name="",this.usage=uh,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++)this.uniforms.push(t[i].clone());return this}clone(){return new this.constructor().copy(this)}}class U7 extends xc{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class N7{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class wm{constructor(e,t,i=0,r=1/0){this.ray=new Ba(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Yp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return y0(e,this,i,t),i.sort(lM),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)y0(e[r],this,i,t);return i.sort(lM),i}}function lM(n,e){return n.distance-e.distance}function y0(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let s=0,o=r.length;s<o;s++)y0(r[s],e,t,!0)}}class yh{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(ln(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class F7{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const cM=new me;class t2{constructor(e=new me(1/0,1/0),t=new me(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=cM.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,cM).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const uM=new D,nf=new D;class n2{constructor(e=new D,t=new D){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){uM.subVectors(e,this.start),nf.subVectors(this.end,this.start);const i=nf.dot(nf);let s=nf.dot(uM)/i;return t&&(s=ln(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const hM=new D;class k7 extends pt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Ye,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Ve(r,3));const s=new Nn({fog:!1,toneMapped:!1});this.cone=new Or(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),hM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(hM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Xs=new D,rf=new Be,Pg=new Be;class B7 extends Or{constructor(e){const t=i2(e),i=new Ye,r=[],s=[],o=new Oe(0,0,1),a=new Oe(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new Ve(r,3)),i.setAttribute("color",new Ve(s,3));const l=new Nn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");Pg.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(rf.multiplyMatrices(Pg,a.matrixWorld),Xs.setFromMatrixPosition(rf),r.setXYZ(o,Xs.x,Xs.y,Xs.z),rf.multiplyMatrices(Pg,a.parent.matrixWorld),Xs.setFromMatrixPosition(rf),r.setXYZ(o+1,Xs.x,Xs.y,Xs.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function i2(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,i2(n.children[t]));return e}class z7 extends ke{constructor(e,t,i){const r=new Mc(t,4,2),s=new Xn({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const V7=new D,dM=new Oe,fM=new Oe;class H7 extends pt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new Ki(t);r.rotateY(Math.PI*.5),this.material=new Xn({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Tt(o,3)),this.add(new ke(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");dM.copy(this.light.color),fM.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?dM:fM;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(V7.setFromMatrixPosition(this.light.matrixWorld).negate())}}class G7 extends Or{constructor(e=10,t=10,i=4473924,r=8947848){i=new Oe(i),r=new Oe(r);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=t;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const v=d===s?i:r;v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3}const u=new Ye;u.setAttribute("position",new Ve(l,3)),u.setAttribute("color",new Ve(c,3));const h=new Nn({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class W7 extends Or{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new Oe(s),o=new Oe(o);const a=[],l=[];if(t>1)for(let h=0;h<t;h++){const d=h/t*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const v=h&1?s:o;l.push(v.r,v.g,v.b),l.push(v.r,v.g,v.b)}for(let h=0;h<i;h++){const d=h&1?s:o,f=e-e/i*h;for(let p=0;p<r;p++){let v=p/r*(Math.PI*2),m=Math.sin(v)*f,g=Math.cos(v)*f;a.push(m,0,g),l.push(d.r,d.g,d.b),v=(p+1)/r*(Math.PI*2),m=Math.sin(v)*f,g=Math.cos(v)*f,a.push(m,0,g),l.push(d.r,d.g,d.b)}}const c=new Ye;c.setAttribute("position",new Ve(a,3)),c.setAttribute("color",new Ve(l,3));const u=new Nn({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const pM=new D,sf=new D,mM=new D;class $7 extends pt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Ye;r.setAttribute("position",new Ve([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Nn({fog:!1,toneMapped:!1});this.lightPlane=new lt(r,s),this.add(this.lightPlane),r=new Ye,r.setAttribute("position",new Ve([0,0,0,0,0,1],3)),this.targetLine=new lt(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),pM.setFromMatrixPosition(this.light.matrixWorld),sf.setFromMatrixPosition(this.light.target.matrixWorld),mM.subVectors(sf,pM),this.lightPlane.lookAt(sf),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(sf),this.targetLine.scale.z=mM.length()}}const of=new D,rn=new Fh;class j7 extends Or{constructor(e){const t=new Ye,i=new Nn({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,v){l(p),l(v)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}t.setAttribute("position",new Ve(r,3)),t.setAttribute("color",new Ve(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new Oe(16755200),u=new Oe(16711680),h=new Oe(43775),d=new Oe(16777215),f=new Oe(3355443);this.setColors(c,u,h,d,f)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;rn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),dn("c",t,e,rn,0,0,-1),dn("t",t,e,rn,0,0,1),dn("n1",t,e,rn,-i,-r,-1),dn("n2",t,e,rn,i,-r,-1),dn("n3",t,e,rn,-i,r,-1),dn("n4",t,e,rn,i,r,-1),dn("f1",t,e,rn,-i,-r,1),dn("f2",t,e,rn,i,-r,1),dn("f3",t,e,rn,-i,r,1),dn("f4",t,e,rn,i,r,1),dn("u1",t,e,rn,i*.7,r*1.1,-1),dn("u2",t,e,rn,-i*.7,r*1.1,-1),dn("u3",t,e,rn,0,r*2,-1),dn("cf1",t,e,rn,-i,0,1),dn("cf2",t,e,rn,i,0,1),dn("cf3",t,e,rn,0,-r,1),dn("cf4",t,e,rn,0,r,1),dn("cn1",t,e,rn,-i,0,-1),dn("cn2",t,e,rn,i,0,-1),dn("cn3",t,e,rn,0,-r,-1),dn("cn4",t,e,rn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function dn(n,e,t,i,r,s,o){of.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],of.x,of.y,of.z)}}const af=new Ti;class X7 extends Or{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Ye;s.setIndex(new Tt(i,1)),s.setAttribute("position",new Tt(r,3)),super(s,new Nn({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&af.setFromObject(this.object),af.isEmpty())return;const t=af.min,i=af.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Y7 extends Or{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ye;s.setIndex(new Tt(i,1)),s.setAttribute("position",new Ve(r,3)),super(s,new Nn({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class q7 extends lt{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Ye;o.setAttribute("position",new Ve(s,3)),o.computeBoundingSphere(),super(o,new Nn({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Ye;l.setAttribute("position",new Ve(a,3)),l.computeBoundingSphere(),this.add(new ke(l,new Xn({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const gM=new D;let lf,Rg;class K7 extends pt{constructor(e=new D(0,0,1),t=new D(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",lf===void 0&&(lf=new Ye,lf.setAttribute("position",new Ve([0,0,0,0,1,0],3)),Rg=new kn(0,.5,1,5,1),Rg.translate(0,-.5,0)),this.position.copy(t),this.line=new lt(lf,new Nn({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ke(Rg,new Xn({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{gM.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(gM,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Z7 extends Or{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ye;r.setAttribute("position",new Ve(t,3)),r.setAttribute("color",new Ve(i,3));const s=new Nn({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new Oe,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class r2{constructor(){this.type="ShapePath",this.color=new Oe,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new fh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(g){const b=[];for(let y=0,_=g.length;y<_;y++){const T=g[y],w=new ya;w.curves=T.curves,b.push(w)}return b}function i(g,b){const y=b.length;let _=!1;for(let T=y-1,w=0;w<y;T=w++){let S=b[T],x=b[w],M=x.x-S.x,E=x.y-S.y;if(Math.abs(E)>Number.EPSILON){if(E<0&&(S=b[w],M=-M,x=b[T],E=-E),g.y<S.y||g.y>x.y)continue;if(g.y===S.y){if(g.x===S.x)return!0}else{const C=E*(g.x-S.x)-M*(g.y-S.y);if(C===0)return!0;if(C<0)continue;_=!_}}else{if(g.y!==S.y)continue;if(x.x<=g.x&&g.x<=S.x||S.x<=g.x&&g.x<=x.x)return!0}}return _}const r=Gr.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new ya,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],d=[];let f=[],p=0,v;d[p]=void 0,f[p]=[];for(let g=0,b=s.length;g<b;g++)a=s[g],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!u&&d[p]&&p++,d[p]={s:new ya,p:v},d[p].s.curves=a.curves,u&&p++,f[p]=[]):f[p].push({h:a,p:v[0]});if(!d[0])return t(s);if(d.length>1){let g=!1,b=0;for(let y=0,_=d.length;y<_;y++)h[y]=[];for(let y=0,_=d.length;y<_;y++){const T=f[y];for(let w=0;w<T.length;w++){const S=T[w];let x=!0;for(let M=0;M<d.length;M++)i(S.p,d[M].p)&&(y!==M&&b++,x?(x=!1,h[M].push(S)):g=!0);x&&h[y].push(S)}}b>0&&g===!1&&(f=h)}let m;for(let g=0,b=d.length;g<b;g++){l=d[g].s,c.push(l),m=f[g];for(let y=0,_=m.length;y<_;y++)l.holes.push(m[y].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_c}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_c);const J7=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:z_,AddEquation:ra,AddOperation:PA,AdditiveAnimationBlendMode:X_,AdditiveBlending:np,AlphaFormat:NA,AlwaysCompare:rC,AlwaysDepth:wA,AlwaysStencilFunc:KA,AmbientLight:yy,AnimationAction:e2,AnimationClip:Ra,AnimationLoader:s7,AnimationMixer:O7,AnimationObjectGroup:R7,AnimationUtils:t7,ArcCurve:SC,ArrayCamera:yC,ArrowHelper:K7,Audio:JC,AudioAnalyser:b7,AudioContext:by,AudioListener:v7,AudioLoader:p7,AxesHelper:Z7,BackSide:Yn,BasicDepthPacking:XA,BasicShadowMap:A4,Bone:uc,BooleanKeyframeTrack:Va,Box2:t2,Box3:Ti,Box3Helper:Y7,BoxGeometry:si,BoxHelper:X7,BufferAttribute:Tt,BufferGeometry:Ye,BufferGeometryLoader:KC,ByteType:DA,Cache:La,Camera:Fh,CameraHelper:j7,CanvasTexture:S8,CapsuleGeometry:sm,CatmullRomCurve3:TC,CineonToneMapping:OA,CircleGeometry:om,ClampToEdgeWrapping:An,Clock:xy,Color:Oe,ColorKeyframeTrack:vy,ColorManagement:Dt,CompressedArrayTexture:M8,CompressedCubeTexture:E8,CompressedTexture:im,CompressedTextureLoader:o7,ConeGeometry:am,CubeCamera:hC,CubeReflectionMapping:Ps,CubeRefractionMapping:To,CubeTexture:kh,CubeTextureLoader:a7,CubeUVReflectionMapping:yc,CubicBezierCurve:cy,CubicBezierCurve3:AC,CubicInterpolant:HC,CullFaceBack:Dv,CullFaceFront:lA,CullFaceFrontBack:T4,CullFaceNone:aA,Curve:ar,CurvePath:PC,CustomBlending:cA,CustomToneMapping:IA,CylinderGeometry:kn,Cylindrical:F7,Data3DTexture:J_,DataArrayTexture:Xp,DataTexture:Xl,DataTextureLoader:l7,DataUtils:O5,DecrementStencilOp:N4,DecrementWrapStencilOp:k4,DefaultLoadingManager:Dl,DepthFormat:vo,DepthStencilFormat:Sa,DepthTexture:bC,DirectionalLight:bm,DirectionalLightHelper:$7,DiscreteInterpolant:GC,DisplayP3ColorSpace:jp,DodecahedronGeometry:lm,DoubleSide:vi,DstAlphaFactor:gA,DstColorFactor:_A,DynamicCopyUsage:Q4,DynamicDrawUsage:X4,DynamicReadUsage:K4,EdgesGeometry:RC,EllipseCurve:rm,EqualCompare:QA,EqualDepth:EA,EqualStencilFunc:H4,EquirectangularReflectionMapping:rc,EquirectangularRefractionMapping:rh,Euler:tr,EventDispatcher:Lr,ExtrudeGeometry:um,FileLoader:Mi,Float16BufferAttribute:k5,Float32BufferAttribute:Ve,Float64BufferAttribute:B5,FloatType:zr,Fog:em,FogExp2:Qp,FramebufferTexture:m0,FrontSide:Yr,Frustum:Zp,GLBufferAttribute:N7,GLSL1:t5,GLSL3:u0,GreaterCompare:tC,GreaterDepth:TA,GreaterEqualCompare:iC,GreaterEqualDepth:SA,GreaterEqualStencilFunc:j4,GreaterStencilFunc:W4,GridHelper:G7,Group:_r,HalfFloatType:oc,HemisphereLight:$C,HemisphereLightHelper:H7,IcosahedronGeometry:hm,ImageBitmapLoader:ZC,ImageLoader:vh,ImageUtils:Z_,IncrementStencilOp:U4,IncrementWrapStencilOp:F4,InstancedBufferAttribute:hc,InstancedBufferGeometry:qC,InstancedInterleavedBuffer:U7,InstancedMesh:sy,Int16BufferAttribute:N5,Int32BufferAttribute:F5,Int8BufferAttribute:I5,IntType:V_,InterleavedBuffer:xc,InterleavedBufferAttribute:Jr,Interpolant:Ec,InterpolateDiscrete:ac,InterpolateLinear:Ta,InterpolateSmooth:If,InvertStencilOp:B4,KeepStencilOp:Df,KeyframeTrack:Ir,LOD:EC,LatheGeometry:Bh,Layers:Yp,LessCompare:JA,LessDepth:MA,LessEqualCompare:eC,LessEqualDepth:ip,LessEqualStencilFunc:G4,LessStencilFunc:V4,Light:Oo,LightProbe:YC,Line:lt,Line3:n2,LineBasicMaterial:Nn,LineCurve:uy,LineCurve3:CC,LineDashedMaterial:BC,LineLoop:oy,LineSegments:Or,LinearDisplayP3ColorSpace:Nh,LinearEncoding:q_,LinearFilter:Qt,LinearInterpolant:gy,LinearMipMapLinearFilter:O4,LinearMipMapNearestFilter:L4,LinearMipmapLinearFilter:Kr,LinearMipmapNearestFilter:Gp,LinearSRGBColorSpace:Zr,LinearToneMapping:RA,LinearTransfer:ah,Loader:Vn,LoaderUtils:Bi,LoadingManager:vm,LoopOnce:GA,LoopPingPong:$A,LoopRepeat:WA,LuminanceAlphaFormat:kA,LuminanceFormat:FA,MOUSE:ms,Material:Pn,MaterialLoader:xm,MathUtils:jn,Matrix3:ct,Matrix4:Be,MaxEquation:kv,Mesh:ke,MeshBasicMaterial:Xn,MeshDepthMaterial:ty,MeshDistanceMaterial:ny,MeshLambertMaterial:py,MeshMatcapMaterial:kC,MeshNormalMaterial:FC,MeshPhongMaterial:Du,MeshPhysicalMaterial:ts,MeshStandardMaterial:za,MeshToonMaterial:NC,MinEquation:Fv,MirroredRepeatWrapping:sc,MixOperation:CA,MultiplyBlending:Nv,MultiplyOperation:Uh,NearestFilter:an,NearestMipMapLinearFilter:R4,NearestMipMapNearestFilter:P4,NearestMipmapLinearFilter:$l,NearestMipmapNearestFilter:sh,NeverCompare:ZA,NeverDepth:xA,NeverStencilFunc:z4,NoBlending:bs,NoColorSpace:Ui,NoToneMapping:xs,NormalAnimationBlendMode:$p,NormalBlending:va,NotEqualCompare:nC,NotEqualDepth:AA,NotEqualStencilFunc:$4,NumberKeyframeTrack:Ca,Object3D:pt,ObjectLoader:d7,ObjectSpaceNormalMap:qA,OctahedronGeometry:Ki,OneFactor:fA,OneMinusDstAlphaFactor:vA,OneMinusDstColorFactor:yA,OneMinusSrcAlphaFactor:B_,OneMinusSrcColorFactor:mA,OrthographicCamera:Ni,P3Primaries:ch,PCFShadowMap:N_,PCFSoftShadowMap:F_,PMREMGenerator:d0,Path:fh,PerspectiveCamera:Nt,Plane:gs,PlaneGeometry:Oi,PlaneHelper:q7,PointLight:_h,PointLightHelper:z7,Points:ay,PointsMaterial:nm,PolarGridHelper:W7,PolyhedronGeometry:Lo,PositionalAudio:y7,PropertyBinding:_t,PropertyMixer:QC,QuadraticBezierCurve:hy,QuadraticBezierCurve3:dy,Quaternion:mt,QuaternionKeyframeTrack:Rs,QuaternionLinearInterpolant:WC,RED_GREEN_RGTC2_Format:l0,RED_RGTC1_Format:HA,REVISION:_c,RGBADepthPacking:YA,RGBAFormat:Di,RGBAIntegerFormat:j_,RGBA_ASTC_10x10_Format:n0,RGBA_ASTC_10x5_Format:Qv,RGBA_ASTC_10x6_Format:e0,RGBA_ASTC_10x8_Format:t0,RGBA_ASTC_12x10_Format:i0,RGBA_ASTC_12x12_Format:r0,RGBA_ASTC_4x4_Format:$v,RGBA_ASTC_5x4_Format:jv,RGBA_ASTC_5x5_Format:Xv,RGBA_ASTC_6x5_Format:Yv,RGBA_ASTC_6x6_Format:qv,RGBA_ASTC_8x5_Format:Kv,RGBA_ASTC_8x6_Format:Zv,RGBA_ASTC_8x8_Format:Jv,RGBA_BPTC_Format:Of,RGBA_ETC2_EAC_Format:Wv,RGBA_PVRTC_2BPPV1_Format:Hv,RGBA_PVRTC_4BPPV1_Format:Vv,RGBA_S3TC_DXT1_Format:Pf,RGBA_S3TC_DXT3_Format:Rf,RGBA_S3TC_DXT5_Format:Lf,RGB_BPTC_SIGNED_Format:s0,RGB_BPTC_UNSIGNED_Format:o0,RGB_ETC1_Format:VA,RGB_ETC2_Format:Gv,RGB_PVRTC_2BPPV1_Format:zv,RGB_PVRTC_4BPPV1_Format:Bv,RGB_S3TC_DXT1_Format:Cf,RGFormat:zA,RGIntegerFormat:$_,RawShaderMaterial:Iu,Ray:Ba,Raycaster:wm,Rec709Primaries:lh,RectAreaLight:jC,RedFormat:BA,RedIntegerFormat:W_,ReinhardToneMapping:LA,RenderTarget:lC,RepeatWrapping:qr,ReplaceStencilOp:D4,ReverseSubtractEquation:hA,RingGeometry:dm,SIGNED_RED_GREEN_RGTC2_Format:c0,SIGNED_RED_RGTC1_Format:a0,SRGBColorSpace:Mn,SRGBTransfer:Bt,Scene:iy,ShaderChunk:at,ShaderLib:Zi,ShaderMaterial:or,ShadowMaterial:UC,Shape:ya,ShapeGeometry:fm,ShapePath:r2,ShapeUtils:Gr,ShortType:UA,Skeleton:wc,SkeletonHelper:B7,SkinnedMesh:tm,Source:da,Sphere:Ai,SphereGeometry:Mc,Spherical:yh,SphericalHarmonics3:XC,SplineCurve:fy,SpotLight:ym,SpotLightHelper:k7,Sprite:MC,SpriteMaterial:ry,SrcAlphaFactor:k_,SrcAlphaSaturateFactor:bA,SrcColorFactor:pA,StaticCopyUsage:J4,StaticDrawUsage:uh,StaticReadUsage:q4,StereoCamera:m7,StreamCopyUsage:e5,StreamDrawUsage:Y4,StreamReadUsage:Z4,StringKeyframeTrack:Ha,SubtractEquation:uA,SubtractiveBlending:Uv,TOUCH:mr,TangentSpaceNormalMap:Ro,TetrahedronGeometry:pm,Texture:Yt,TextureLoader:_m,TorusGeometry:lo,TorusKnotGeometry:mm,Triangle:gi,TriangleFanDrawMode:rp,TriangleStripDrawMode:Y_,TrianglesDrawMode:jA,TubeGeometry:gm,TwoPassDoubleSide:C4,UVMapping:Hp,Uint16BufferAttribute:qp,Uint32BufferAttribute:Q_,Uint8BufferAttribute:D5,Uint8ClampedBufferAttribute:U5,Uniform:Ey,UniformsGroup:D7,UniformsLib:De,UniformsUtils:Kp,UnsignedByteType:br,UnsignedInt248Type:go,UnsignedIntType:_s,UnsignedShort4444Type:H_,UnsignedShort5551Type:G_,UnsignedShortType:Wp,VSMShadowMap:Fr,Vector2:me,Vector3:D,Vector4:gt,VectorKeyframeTrack:Pa,VideoTexture:w8,WebGL1Renderer:xC,WebGL3DRenderTarget:b5,WebGLArrayRenderTarget:y5,WebGLCoordinateSystem:Vr,WebGLCubeRenderTarget:dC,WebGLMultipleRenderTargets:x5,WebGLRenderTarget:Sr,WebGLRenderer:Ru,WebGLUtils:_C,WebGPUCoordinateSystem:hh,WireframeGeometry:DC,WrapAroundEnding:oh,ZeroCurvatureEnding:ua,ZeroFactor:dA,ZeroSlopeEnding:ha,ZeroStencilOp:I4,_SRGBAFormat:sp,createCanvasElement:aC,sRGBEncoding:_o},Symbol.toStringTag,{value:"Module"}));function Sc(n){return _p()?(H0(n),!0):!1}function bh(){const n=new Set,e=r=>{n.delete(r)};return{on:r=>{n.add(r);const s=()=>e(r);return Sc(s),{off:s}},off:e,trigger:r=>Promise.all(Array.from(n).map(s=>s(r)))}}function fn(n){return typeof n=="function"?n():we(n)}const Q7=typeof window<"u"&&typeof document<"u",eG=Object.prototype.toString,tG=n=>eG.call(n)==="[object Object]",nG=()=>{};function iG(n,e,t=!1){return e.reduce((i,r)=>(r in n&&(!t||n[r]!==void 0)&&(i[r]=n[r]),i),{})}function rG(n,e={}){if(!gn(n))return Ar(n);const t=Array.isArray(n.value)?Array.from({length:n.value.length}):{};for(const i in n.value)t[i]=V3(()=>({get(){return n.value[i]},set(r){var s;if((s=fn(e.replaceRef))!=null?s:!0)if(Array.isArray(n.value)){const a=[...n.value];a[i]=r,n.value=a}else{const a=ti(Ft({},n.value),{[i]:r});Object.setPrototypeOf(a,Object.getPrototypeOf(n.value)),n.value=a}else n.value[i]=r}}));return t}function s2(n,e=!0){En()?_n(n):e?n():$r(n)}function ws(n){var e;const t=fn(n);return(e=t==null?void 0:t.$el)!=null?e:t}const Io=Q7?window:void 0;function xh(...n){let e,t,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,r]=n,e=Io):[e,t,i,r]=n,!e)return nG;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=ft(()=>[ws(e),fn(r)],([u,h])=>{if(o(),!u)return;const d=tG(h)?Ft({},h):h;s.push(...t.flatMap(f=>i.map(p=>a(u,f,p,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return Sc(c),c}function sG(){const n=be(!1);return En()&&_n(()=>{n.value=!0}),n}function o2(n){const e=sG();return Te(()=>(e.value,!!n()))}function oG(n,e={}){const{immediate:t=!0,fpsLimit:i=void 0,window:r=Io}=e,s=be(!1),o=i?1e3/i:null;let a=0,l=null;function c(d){if(!s.value||!r)return;const f=d-(a||d);if(o&&f<o){l=r.requestAnimationFrame(c);return}n({delta:f,timestamp:d}),a=d,l=r.requestAnimationFrame(c)}function u(){!s.value&&r&&(s.value=!0,l=r.requestAnimationFrame(c))}function h(){s.value=!1,l!=null&&r&&(r.cancelAnimationFrame(l),l=null)}return t&&u(),Sc(h),{isActive:bp(s),pause:h,resume:u}}function aG(n,e={}){const{window:t=Io}=e,i=o2(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let r;const s=be(!1),o=c=>{s.value=c.matches},a=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",o):r.removeListener(o))},l=rr(()=>{i.value&&(a(),r=t.matchMedia(fn(n)),"addEventListener"in r?r.addEventListener("change",o):r.addListener(o),s.value=r.matches)});return Sc(()=>{l(),a(),r=void 0}),s}function lG(n={}){const{window:e=Io}=n,t=be(1);if(e){let i=function(){t.value=e.devicePixelRatio,r(),s=e.matchMedia("(resolution: ".concat(t.value,"dppx)")),s.addEventListener("change",i,{once:!0})},r=function(){s==null||s.removeEventListener("change",i)},s;i(),Sc(r)}return{pixelRatio:t}}function a2(n,e,t={}){const h=t,{window:i=Io}=h,r=nd(h,["window"]);let s;const o=o2(()=>i&&"ResizeObserver"in i),a=()=>{s&&(s.disconnect(),s=void 0)},l=Te(()=>Array.isArray(n)?n.map(d=>ws(d)):[ws(n)]),c=ft(l,d=>{if(a(),o.value&&i){s=new ResizeObserver(e);for(const f of d)f&&s.observe(f,r)}},{immediate:!0,flush:"post",deep:!0}),u=()=>{a(),c()};return Sc(u),{isSupported:o,stop:u}}function cG(n,e={}){const{reset:t=!0,windowResize:i=!0,windowScroll:r=!0,immediate:s=!0}=e,o=be(0),a=be(0),l=be(0),c=be(0),u=be(0),h=be(0),d=be(0),f=be(0);function p(){const v=ws(n);if(!v){t&&(o.value=0,a.value=0,l.value=0,c.value=0,u.value=0,h.value=0,d.value=0,f.value=0);return}const m=v.getBoundingClientRect();o.value=m.height,a.value=m.bottom,l.value=m.left,c.value=m.right,u.value=m.top,h.value=m.width,d.value=m.x,f.value=m.y}return a2(n,p),ft(()=>ws(n),v=>!v&&p()),r&&xh("scroll",p,{capture:!0,passive:!0}),i&&xh("resize",p,{passive:!0}),s2(()=>{s&&p()}),{height:o,bottom:a,left:l,right:c,top:u,width:h,x:d,y:f,update:p}}function uG(n,e={width:0,height:0},t={}){const{window:i=Io,box:r="content-box"}=t,s=Te(()=>{var l,c;return(c=(l=ws(n))==null?void 0:l.namespaceURI)==null?void 0:c.includes("svg")}),o=be(e.width),a=be(e.height);return a2(n,([l])=>{const c=r==="border-box"?l.borderBoxSize:r==="content-box"?l.contentBoxSize:l.devicePixelContentBoxSize;if(i&&s.value){const u=ws(n);if(u){const h=i.getComputedStyle(u);o.value=Number.parseFloat(h.width),a.value=Number.parseFloat(h.height)}}else if(c){const u=Array.isArray(c)?c:[c];o.value=u.reduce((h,{inlineSize:d})=>h+d,0),a.value=u.reduce((h,{blockSize:d})=>h+d,0)}else o.value=l.contentRect.width,a.value=l.contentRect.height},t),ft(()=>ws(n),l=>{o.value=l?e.width:0,a.value=l?e.height:0}),{width:o,height:a}}const l2={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},hG=Object.keys(l2);function dG(n={}){const{target:e=Io}=n,t=be(!1),i=be(n.initialValue||{});Object.assign(i.value,l2,i.value);const r=s=>{t.value=!0,!(n.pointerTypes&&!n.pointerTypes.includes(s.pointerType))&&(i.value=iG(s,hG,!1))};if(e){const s={passive:!0};xh(e,["pointerdown","pointermove","pointerup"],r,s),xh(e,"pointerleave",()=>t.value=!1,s)}return ti(Ft({},rG(i)),{isInside:t})}function fG(n={}){const{window:e=Io,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:i=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:s=!0}=n,o=be(t),a=be(i),l=()=>{e&&(s?(o.value=e.innerWidth,a.value=e.innerHeight):(o.value=e.document.documentElement.clientWidth,a.value=e.document.documentElement.clientHeight))};if(l(),s2(l),xh("resize",l,{passive:!0}),r){const c=aG("(orientation: portrait)");ft(c,()=>l())}return{width:o,height:a}}const pG=({sizes:n,scene:e})=>{const t=be([]),i=Te(()=>t.value[0]),r=(a,l=!1)=>{t.value.some(({uuid:c})=>c===a.uuid)||(l?o(a):t.value.push(a))},s=a=>{t.value=t.value.filter(({uuid:l})=>l!==a.uuid)},o=a=>{const l=a instanceof Fh?a:t.value.find(u=>u.uuid===a);if(!l)return;const c=t.value.filter(({uuid:u})=>u!==l.uuid);t.value=[l,...c]};return rr(()=>{n.aspectRatio.value&&t.value.forEach(a=>{a instanceof Nt&&(a.aspect=n.aspectRatio.value),(a instanceof Nt||a instanceof Ni)&&a.updateProjectionMatrix()})}),e.userData.tres__registerCamera=r,e.userData.tres__deregisterCamera=s,Si(()=>{t.value=[]}),{camera:i,cameras:t,registerCamera:r,deregisterCamera:s,setCameraActive:o}},c2=bh(),u2=bh(),Sy=bh(),Uu=new xy;let Nf=0,Ff=0;const{pause:mG,resume:gG,isActive:vG}=oG(()=>{c2.trigger({delta:Nf,elapsed:Ff,clock:Uu}),u2.trigger({delta:Nf,elapsed:Ff,clock:Uu}),Sy.trigger({delta:Nf,elapsed:Ff,clock:Uu})},{immediate:!1});Sy.on(()=>{Nf=Uu.getDelta(),Ff=Uu.getElapsedTime()});const lr=()=>({onBeforeLoop:c2.on,onLoop:u2.on,onAfterLoop:Sy.on,pause:mG,resume:gG,isActive:vG}),vM="[TresJS ▲ ■ ●] ";function Tc(){function n(i,r){console.error("".concat(vM," ").concat(i),r||"")}function e(i){console.warn("".concat(vM," ").concat(i))}function t(i,r){}return{logError:n,logWarning:e,logMessage:t}}function _G(n){return n instanceof Oe?n:Array.isArray(n)?new Oe(...n):new Oe(n)}const h2=(n,e)=>{for(const t of Object.keys(e))e[t]instanceof Object&&Object.assign(e[t],h2(n[t],e[t]));return Object.assign(n||{},e),n},yG="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",bG=xG(yG);function _M(n){return n&&n.nodeType===1}function cf(n){return n.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function xG(n,e){const t=Object.create(null),i=n.split(",");for(let r=0;r<i.length;r++)t[i[r]]=!0;return e?r=>!!t[r.toLowerCase()]:r=>!!t[r]}const wG=(n,e)=>{const t=new Set,i=[];for(const r of n){const s=e(r);t.has(s)||(t.add(s),i.push(r))}return i},yM=(n,e)=>{if(!e)return;const t=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return t==null?void 0:t.reduce((i,r)=>i&&i[r],n)},MG=(n,e,t)=>{const i=Array.isArray(e)?e:e.match(/([^[.\]])+/g);i&&i.reduce((r,s,o)=>(r[s]===void 0&&(r[s]={}),o===i.length-1&&(r[s]=t),r[s]),n)};function d2(n,e){if(_M(n)&&_M(e)){const r=n.attributes,s=e.attributes;return r.length!==s.length?!1:Array.from(r).every(({name:o,value:a})=>e.getAttribute(o)===a)}if(n===e)return!0;if(n===null||typeof n!="object"||e===null||typeof e!="object")return!1;const t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(const r of t)if(!i.includes(r)||!d2(n[r],e[r]))return!1;return!0}function EG(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!d2(n[t],e[t]))return!1;return!0}const SG=Array.isArray,TG=Number.parseInt(_c.replace("dev","")),uf={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:Mn,toneMapping:z_,toneMappingExposure:3,shadowMap:{enabled:!0,type:F_}}};function AG({scene:n,canvas:e,options:t,disableRender:i,contextParts:{sizes:r,camera:s}}){const o=Te(()=>({alpha:fn(t.alpha),depth:fn(t.depth),canvas:ws(e),context:fn(t.context),stencil:fn(t.stencil),antialias:fn(t.antialias)===void 0?!0:fn(t.antialias),precision:fn(t.precision),powerPreference:fn(t.powerPreference),premultipliedAlpha:fn(t.premultipliedAlpha),preserveDrawingBuffer:fn(t.preserveDrawingBuffer),logarithmicDepthBuffer:fn(t.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:fn(t.failIfMajorPerformanceCaveat)})),a=qn(new Ru(o.value));ft(o,()=>{a.value.dispose(),a.value=new Ru(o.value)}),rr(()=>{a.value.setSize(r.width.value,r.height.value)});const{pixelRatio:l}=lG();rr(()=>{a.value.setPixelRatio(l.value)});const{logError:c}=Tc(),u=(()=>{const p=new Ru,v={shadowMap:{enabled:p.shadowMap.enabled,type:p.shadowMap.type},toneMapping:p.toneMapping,toneMappingExposure:p.toneMappingExposure,outputColorSpace:p.outputColorSpace};return p.dispose(),v})();rr(()=>{const p=fn(t.preset);p&&(p in uf||c("Renderer Preset must be one of these: ".concat(Object.keys(uf).join(", "))),h2(a.value,uf[p]));const v=(b,y)=>{const _=fn(b),T=()=>{if(p)return yM(uf[p],y)};if(_!==void 0)return _;const w=T();return w!==void 0?w:yM(u,y)},m=(b,y)=>MG(a.value,y,v(b,y));m(t.shadows,"shadowMap.enabled"),m(t.toneMapping,"toneMapping"),m(t.shadowMapType,"shadowMap.type"),TG<150&&m(!t.useLegacyLights,"physicallyCorrectLights"),m(t.outputColorSpace,"outputColorSpace"),m(t.toneMappingExposure,"toneMappingExposure");const g=v(t.clearColor,"clearColor");g&&a.value.setClearColor(g?_G(g):new Oe(0))});const{pause:h,resume:d,onLoop:f}=lr();return f(()=>{s.value&&!fn(i)&&a.value.render(n,s.value)}),d(),Si(()=>{h(),a.value.dispose(),a.value.forceContextLoss()}),{renderer:a}}const bM=n=>typeof n=="function",CG=n=>!!n&&n.constructor===Array;function PG(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}async function f2(n,e,t,i,r){const{logError:s}=Tc(),o=new n;r&&r(o),t&&t(o);const a=(Array.isArray(e)?e:[e]).map(l=>new Promise((c,u)=>{o.load(l,h=>{h.scene&&Object.assign(h,PG(h.scene)),c(h)},i,h=>u(s("[useLoader] - Failed to load resource",h)))}));return CG(e)?await Promise.all(a):await a[0]}async function PK(n){const e=new vm,t=new _m(e),i=r=>new Promise((s,o)=>{t.load(r,a=>s(a),()=>null,()=>{o(new Error("[useTextures] - Failed to load texture"))})});if(SG(n)){const r=await Promise.all(n.map(s=>i(s)));return n.length>1?r:r[0]}else{const{map:r,displacementMap:s,normalMap:o,roughnessMap:a,metalnessMap:l,aoMap:c,alphaMap:u,matcap:h}=n;return{map:r?await i(r):null,displacementMap:s?await i(s):null,normalMap:o?await i(o):null,roughnessMap:a?await i(a):null,metalnessMap:l?await i(l):null,aoMap:c?await i(c):null,alphaMap:u?await i(u):null,matcap:h?await i(h):null}}}const RG=(n,{renderer:e,camera:t,raycaster:i})=>{const r=Te(()=>e.value.domElement),{x:s,y:o}=dG({target:r}),{width:a,height:l,top:c,left:u}=cG(r),h=({x:S,y:x})=>{if(r.value)return{x:(S-u.value)/a.value*2-1,y:-((x-c.value)/l.value)*2+1}},d=({x:S,y:x})=>{if(t.value)return i.value.setFromCamera(new me(S,x),t.value),i.value.intersectObjects(n.value,!1)},f=S=>{var M,E;const x=h({x:(M=S==null?void 0:S.clientX)!=null?M:s.value,y:(E=S==null?void 0:S.clientY)!=null?E:o.value});return x?d(x)||[]:[]},p=Te(()=>f()),v=bh(),m=bh(),g=(S,x)=>{S.trigger({event:x,intersects:f(x)})},b=S=>{g(m,S)};let y;const _=S=>{var x;y=(x=f(S)[0])==null?void 0:x.object},T=S=>{var x;S instanceof PointerEvent&&y===((x=f(S)[0])==null?void 0:x.object)&&g(v,S)},w=S=>m.trigger({event:S,intersects:[]});return r.value.addEventListener("pointerup",T),r.value.addEventListener("pointerdown",_),r.value.addEventListener("pointermove",b),r.value.addEventListener("pointerleave",w),Si(()=>{r!=null&&r.value&&(r.value.removeEventListener("pointerup",T),r.value.removeEventListener("pointerdown",_),r.value.removeEventListener("pointermove",b),r.value.removeEventListener("pointerleave",w))}),{intersects:p,onClick:S=>v.on(S).off,onPointerMove:S=>m.on(S).off}};function RK(){const{logWarning:n}=Tc();function e(s,o,a){let l=null;return s.traverse(c=>{c[o]===a&&(l=c)}),l||n("Child with ".concat(o," '").concat(a,"' not found.")),l}function t(s,o,a){const l=[];return s.traverse(c=>{c[o].includes(a)&&l.push(c)}),l.length||n("Children with ".concat(o," '").concat(a,"' not found.")),l}function i(s,o){return e(s,"name",o)}function r(s,o){return t(s,"name",o)}return{seek:e,seekByName:i,seekAll:t,seekAllByName:r}}const LG=({scene:n,contextParts:e})=>{const t=li({click:new Map,pointerMove:new Map,pointerEnter:new Map,pointerLeave:new Map}),i=be(new Set),r=d=>{i.value.add(d)},s=d=>{i.value.delete(d)},o=d=>{Object.values(t).forEach(f=>f.delete(d)),s(d)},a=d=>{const{onClick:f,onPointerMove:p,onPointerEnter:v,onPointerLeave:m}=d;f&&t.click.set(d,f),p&&t.pointerMove.set(d,p),v&&t.pointerEnter.set(d,v),m&&t.pointerLeave.set(d,m)};n.userData.tres__registerAtPointerEventHandler=a,n.userData.tres__deregisterAtPointerEventHandler=o,n.userData.tres__registerBlockingObjectAtPointerEventHandler=r,n.userData.tres__deregisterBlockingObjectAtPointerEventHandler=s;const l=Te(()=>wG([...Array.from(i.value),...Object.values(t).map(d=>Array.from(d.keys())).flat()],({uuid:d})=>d)),{onClick:c,onPointerMove:u}=RG(l,e);c(({intersects:d,event:f})=>{var p;d.length&&((p=t.click.get(d[0].object))==null||p(d[0],f))});let h;return u(({intersects:d,event:f})=>{var p,v,m,g;const b=(p=d==null?void 0:d[0])==null?void 0:p.object,{pointerLeave:y,pointerEnter:_,pointerMove:T}=t;h&&h!==b&&((v=y.get(h))==null||v(h,f)),b&&(h!==b&&((m=_.get(b))==null||m(d[0],f)),(g=T.get(b))==null||g(d[0],f)),h=b||null}),{registerObject:a,deregisterObject:o}},b0=be({}),Ty=n=>Object.assign(b0.value,n);function OG({scene:n,canvas:e,windowSize:t,disableRender:i,rendererOptions:r}){const s=Te(()=>fn(t)?fG():uG(fn(e).parentElement)),o=Te(()=>s.value.width.value),a=Te(()=>s.value.height.value),l=Te(()=>o.value/a.value),c={height:a,width:o,aspectRatio:l},u=qn(n),{camera:h,cameras:d,registerCamera:f,deregisterCamera:p,setCameraActive:v}=pG({sizes:c,scene:n}),{renderer:m}=AG({scene:n,canvas:e,options:r,contextParts:{sizes:c,camera:h},disableRender:i}),g={sizes:c,scene:u,camera:h,cameras:bp(d),renderer:m,raycaster:qn(new wm),controls:be(null),extend:Ty,registerCamera:f,setCameraActive:v,deregisterCamera:p};return bi("useTres",g),g}function Tr(){const n=Xt("useTres");if(!n)throw new Error("useTresContext must be used together with useTresContextProvider");return n}let sn=null;const{logError:xM}=Tc(),IG={createElement(n,e,t,i){var r,s;if(i||(i={}),i.args||(i.args=[]),n==="template"||bG(n))return null;let o=n.replace("Tres",""),a;if(n==="primitive"){(i==null?void 0:i.object)===void 0&&xM("Tres primitives need a prop 'object'");const l=i.object;o=l.type,a=Object.assign(l,{type:o,attach:i.attach,primitive:!0})}else{const l=b0.value[o];l||xM("".concat(o," is not defined on the THREE namespace. Use extend to add it to the catalog.")),a=new l(...i.args)}return a.isCamera&&(i!=null&&i.position||a.position.set(3,3,3),i!=null&&i.lookAt||a.lookAt(0,0,0)),(i==null?void 0:i.attach)===void 0&&(a.isMaterial?a.attach="material":a.isBufferGeometry&&(a.attach="geometry")),a.isObject3D&&((r=i==null?void 0:i.material)!=null&&r.isMaterial&&(a.userData.tres__materialViaProp=!0),(s=i==null?void 0:i.geometry)!=null&&s.isBufferGeometry&&(a.userData.tres__geometryViaProp=!0)),a.userData=ti(Ft({},a.userData),{tres__name:o}),a},insert(n,e){var t,i,r,s;e&&e.isScene&&(sn=e);const o=e||sn;if(n!=null&&n.isObject3D){if(n!=null&&n.isCamera){if(!(sn!=null&&sn.userData.tres__registerCamera))throw"could not find tres__registerCamera on scene's userData";(i=sn==null?void 0:(t=sn.userData).tres__registerCamera)==null||i.call(t,n)}if(n!=null&&n.onClick||n!=null&&n.onPointerMove||n!=null&&n.onPointerEnter||n!=null&&n.onPointerLeave){if(!(sn!=null&&sn.userData.tres__registerAtPointerEventHandler))throw"could not find tres__registerAtPointerEventHandler on scene's userData";(s=sn==null?void 0:(r=sn.userData).tres__registerAtPointerEventHandler)==null||s.call(r,n)}}n!=null&&n.isObject3D&&o!=null&&o.isObject3D?(o.add(n),n.dispatchEvent({type:"added"})):n!=null&&n.isFog?o.fog=n:typeof(n==null?void 0:n.attach)=="string"&&(n.__previousAttach=n[o==null?void 0:o.attach],o&&(o[n.attach]=n))},remove(n){var e,t;if(n){if(n.isObject3D){const i=n,r=c=>{var u,h;const d=c;c.userData.tres__materialViaProp||(u=d.material)==null||u.dispose(),c.userData.tres__geometryViaProp||(h=d.geometry)==null||h.dispose()},s=sn==null?void 0:sn.userData.tres__deregisterAtPointerEventHandler,o=sn==null?void 0:sn.userData.tres__deregisterBlockingObjectAtPointerEventHandler,a=c=>{var u,h;if(!o)throw"could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData";if((h=sn==null?void 0:(u=sn.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||h.call(u,c),!s)throw"could not find tres__deregisterAtPointerEventHandler on scene's userData";(c!=null&&c.onClick||c!=null&&c.onPointerMove||c!=null&&c.onPointerEnter||c!=null&&c.onPointerLeave)&&(s==null||s(c))},l=c=>{const u=sn==null?void 0:sn.userData.tres__deregisterCamera;if(!u)throw"could not find tres__deregisterCamera on scene's userData";c.isCamera&&(u==null||u(c))};i.traverse(c=>{r(c),l(c),a==null||a(c)}),r(i),l(i),a==null||a(i)}(e=n.removeFromParent)==null||e.call(n),(t=n.dispose)==null||t.call(n)}},patchProp(n,e,t,i){var r,s,o,a;if(n){let l=n,c=e;if(n.isObject3D&&c==="blocks-pointer-events"){i||i===""?(s=sn==null?void 0:(r=sn.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||s.call(r,n):(a=sn==null?void 0:(o=sn.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||a.call(o,n);return}let u=cf(c),h=l==null?void 0:l[u];if(c==="args"){const f=n,p=t!=null?t:[],v=i!=null?i:[],m=n.userData.tres__name||n.type;m&&p.length&&!EG(p,v)&&(l=Object.assign(f,new b0.value[m](...i)));return}if(l.type==="BufferGeometry"){if(c==="args")return;l.setAttribute(cf(c),new Tt(...i));return}if(c.includes("-")&&h===void 0){const f=c.split("-");h=f.reduce((p,v)=>p[cf(v)],l),c=f.pop(),u=c.toLowerCase(),h!=null&&h.set||(l=f.reduce((p,v)=>p[cf(v)],l))}let d=i;if(d===""&&(d=!0),bM(h)){Array.isArray(d)?n[u](...d):n[u](d);return}!(h!=null&&h.set)&&!bM(h)?l[u]=d:h.constructor===d.constructor&&h!=null&&h.copy?h==null||h.copy(d):Array.isArray(d)?h.set(...d):!h.isColor&&h.setScalar?h.setScalar(d):h.set(d)}},parentNode(n){return(n==null?void 0:n.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}},{render:DG}=vS(IG);Ty(J7);const UG=["data-scene"],LK=qe({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},setup(n,{expose:e}){var t;const i=n,{logWarning:r}=Tc(),s=be(),o=qn(new iy);lr();const a=lS(),l=(t=En())==null?void 0:t.appContext.app,c=f=>qe({setup(){var p;const v=(p=En())==null?void 0:p.appContext;return v&&(v.app=l),bi("useTres",f),bi("extend",Ty),()=>wo(Kt,null,a!=null&&a.default?a.default():[])}}),u=f=>{const p=c(f);DG(wo(p),o.value)},h=Te(()=>i.disableRender),d=qn(null);return e({context:d}),_n(()=>{const f=s;d.value=OG({scene:o.value,canvas:f,windowSize:i.windowSize,disableRender:h,rendererOptions:i}),LG({scene:o.value,contextParts:d.value});const{registerCamera:p,camera:v,cameras:m,deregisterCamera:g}=d.value;u(d.value);const b=()=>{const y=new Nt(45,window.innerWidth/window.innerHeight,.1,1e3);y.position.set(3,3,3),y.lookAt(0,0,0),p(y);const _=rr(()=>{m.value.length>=2&&(y.removeFromParent(),g(y),_==null||_())})};ft(()=>i.camera,(y,_)=>{y&&p(y),_&&(_.removeFromParent(),g(_))},{immediate:!0}),v.value||(r("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),b())}),(f,p)=>(rt(),Mt("canvas",{ref_key:"canvas",ref:s,"data-scene":o.value.uuid,class:Wt(f.$attrs.class),style:Dn(Ft({display:"block",width:"100%",height:"100%",position:f.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none"},f.$attrs.style))},null,14,UG))}});/*! Tweakpane 4.0.1 (c) 2016 cocopon, licensed under the MIT license. */function zt(n){return n==null}function Ay(n){return n!==null&&typeof n=="object"}function x0(n){return n!==null&&typeof n=="object"}function NG(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Oa(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,r)=>{const s=n[r],o=e[r];return x0(s)&&x0(o)?Object.assign(Object.assign({},i),{[r]:Oa(s,o)}):Object.assign(Object.assign({},i),{[r]:r in e?o:s})},{})}function Cy(n){return Ay(n)?"target"in n:!1}const FG={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>"Invalid parameters for '".concat(n.name,"'"),nomatchingcontroller:n=>"No matching controller for '".concat(n.key,"'"),nomatchingview:n=>"No matching view for '".concat(JSON.stringify(n.params),"'"),notbindable:()=>"Value is not bindable",notcompatible:n=>"Not compatible with  plugin '".concat(n.id,"'"),propertynotfound:n=>"Property '".concat(n.name,"' not found"),shouldneverhappen:()=>"This error should never happen"};class cn{static alreadyDisposed(){return new cn({type:"alreadydisposed"})}static notBindable(){return new cn({type:"notbindable"})}static notCompatible(e,t){return new cn({type:"notcompatible",context:{id:"".concat(e,".").concat(t)}})}static propertyNotFound(e){return new cn({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new cn({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=FG[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class lp{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!lp.isBindable(i))throw cn.notBindable();if(!(e in i))throw cn.propertyNotFound(e);i[e]=t}}class Sn{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(r=>r.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(r=>{r.handler(t)})}}class kG{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(r,s)=>r===s,this.emitter=new Sn,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t!=null?t:{forceEmit:!1,last:!0},r=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;this.equals_(s,r)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=r,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:r,sender:this}))}}class BG{constructor(e){this.emitter=new Sn,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t!=null?t:{forceEmit:!1,last:!0},r=this.value_;r===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:this.value_,sender:this}))}}class zG{constructor(e){this.emitter=new Sn,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Jt(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new BG(n):new kG(n,e)}function VG(n){return[new zG(n),(e,t)=>{n.setRawValue(e,t)}]}class vt{constructor(e){this.emitter=new Sn,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,r)=>Object.assign(i,{[r]:Jt(e[r])}),{})}static fromObject(e){const t=this.createCore(e);return new vt(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class zh{constructor(e){this.values=vt.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}}class HG{constructor(e){this.values=vt.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let r=e;return zt(i)||(r=Math.max(r,i)),zt(t)||(r=Math.min(r,t)),r}}class GG{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}}class WG{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const $G={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};class jG{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=$G[this.operator];if(!e)throw new Error("unexpected binary operator: '".concat(this.operator));return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const XG={"+":n=>n,"-":n=>-n,"~":n=>~n};class YG{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=XG[this.operator];if(!e)throw new Error("unexpected unary operator: '".concat(this.operator));return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Py(n){return(e,t)=>{for(let i=0;i<n.length;i++){const r=n[i](e,t);if(r!=="")return r}return""}}function wh(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function qG(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Mh(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function KG(n,e){const t=Mh(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const r=Mh(n,e);return r===""?"":i+r}function Ry(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=KG(n,e);return i===""?"":t+i}function p2(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=qG(n,e);return e+=i.length,i===""?"":i+Mh(n,e)}function ZG(n,e){const t=p2(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const r=Mh(n,e);return e+=r.length,t+i+r+Ry(n,e)}function JG(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=Mh(n,e);return e+=i.length,i===""?"":t+i+Ry(n,e)}function QG(n,e){const t=p2(n,e);return e+=t.length,t===""?"":t+Ry(n,e)}const e9=Py([ZG,JG,QG]);function t9(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function n9(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=t9(n,e);return i===""?"":t+i}function i9(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function r9(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=i9(n,e);return i===""?"":t+i}function s9(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function o9(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=s9(n,e);return i===""?"":t+i}const a9=Py([n9,r9,o9]),l9=Py([a9,e9]);function c9(n,e){const t=l9(n,e);return e+=t.length,t===""?null:{evaluable:new WG(t),cursor:e}}function u9(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=g2(n,e);if(!i)return null;e=i.cursor,e+=wh(n,e).length;const r=n.substr(e,1);return e+=r.length,r!==")"?null:{evaluable:i.evaluable,cursor:e}}function h9(n,e){var t;return(t=c9(n,e))!==null&&t!==void 0?t:u9(n,e)}function m2(n,e){const t=h9(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const r=m2(n,e);return r?(e=r.cursor,{cursor:e,evaluable:new YG(i,r.evaluable)}):null}function d9(n,e,t){t+=wh(e,t).length;const i=n.filter(r=>e.startsWith(r,t))[0];return i?(t+=i.length,t+=wh(e,t).length,{cursor:t,operator:i}):null}function f9(n,e){return(t,i)=>{const r=n(t,i);if(!r)return null;i=r.cursor;let s=r.evaluable;for(;;){const o=d9(e,t,i);if(!o)break;i=o.cursor;const a=n(t,i);if(!a)return null;i=a.cursor,s=new jG(o.operator,s,a.evaluable)}return s?{cursor:i,evaluable:s}:null}}const p9=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>f9(n,e),m2);function g2(n,e){return e+=wh(n,e).length,p9(n,e)}function m9(n){const e=g2(n,0);return!e||e.cursor+wh(n,e.cursor).length!==n.length?null:e.evaluable}function Ls(n){var e;const t=m9(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function v2(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Ls(n);if(!zt(e))return e}return 0}function g9(n){return String(n)}function Ei(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function Ot(n,e,t,i,r){const s=(n-e)/(t-e);return i+s*(r-i)}function wM(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Cn(n,e,t){return Math.min(Math.max(n,e),t)}function _2(n,e){return(n%e+e)%e}function v9(n,e){return zt(n.step)?Math.max(wM(e),2):wM(n.step)}function y2(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function b2(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function x2(n,e){return zt(n.step)?null:new GG(n.step,e)}function w2(n){return!zt(n.max)&&!zt(n.min)?new zh({max:n.max,min:n.min}):!zt(n.max)||!zt(n.min)?new HG({max:n.max,min:n.min}):null}function M2(n,e){var t,i,r;return{formatter:(t=n.format)!==null&&t!==void 0?t:Ei(v9(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:y2(n),pointerScale:(r=n.pointerScale)!==null&&r!==void 0?r:b2(n,e)}}function E2(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function Ly(n){return{constraint:n.constraint,textProps:vt.fromObject(M2(n.params,n.initialValue))}}class Ga{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class Mm{constructor(e){this.target=e}}class Vh extends Mm{constructor(e,t,i){super(e),this.value=t,this.last=i!=null?i:!0}}class _9 extends Mm{constructor(e,t){super(e),this.expanded=t}}class y9 extends Mm{constructor(e,t){super(e),this.index=t}}class Eh extends Ga{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Sn,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Vh(this,t.binding.target.read(),e.options.last))}}class b9{constructor(e,t){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t,this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new Sn}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function x9(n){if(!("binding"in n))return!1;const e=n.binding;return Cy(e)&&"read"in e&&"write"in e}function w9(n,e){const i=Object.keys(e).reduce((r,s)=>{if(r===void 0)return;const o=e[s],a=o(n[s]);return a.succeeded?Object.assign(Object.assign({},r),{[s]:a.value}):void 0},{});return i}function M9(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const r=e(i);if(!(!r.succeeded||r.value===void 0))return[...t,r.value]},[])}function E9(n){return n===null?!1:typeof n=="object"}function hs(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function MM(n){return{custom:e=>hs(e)(n),boolean:hs(e=>typeof e=="boolean"?e:void 0)(n),number:hs(e=>typeof e=="number"?e:void 0)(n),string:hs(e=>typeof e=="string"?e:void 0)(n),function:hs(e=>typeof e=="function"?e:void 0)(n),constant:e=>hs(t=>t===e?e:void 0)(n),raw:hs(e=>e)(n),object:e=>hs(t=>{if(E9(t))return w9(t,e)})(n),array:e=>hs(t=>{if(Array.isArray(t))return M9(t,e)})(n)}}const w0={optional:MM(!0),required:MM(!1)};function tn(n,e){const t=e(w0),i=w0.required.object(t)(n);return i.succeeded?i.value:void 0}function zi(n,e,t,i){if(e&&!e(n))return!1;const r=tn(n,t);return r?i(r):!1}function Vi(n,e){var t;return Oa((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function ba(n){return"value"in n}function S2(n){if(!Ay(n)||!("binding"in n))return!1;const e=n.binding;return Cy(e)}const Hr="http://www.w3.org/2000/svg";function cp(n){n.offsetHeight}function S9(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function Oy(n){return n.ontouchstart!==void 0}function T9(){return globalThis}function A9(){return T9().document}function C9(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const P9={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Em(n,e){const t=n.createElementNS(Hr,"svg");return t.innerHTML=P9[e],t}function T2(n,e,t){n.insertBefore(e,n.children[t])}function Iy(n){n.parentElement&&n.parentElement.removeChild(n)}function A2(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function R9(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function C2(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Ms(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function Qr(n,e,t){Ms(n.value(e),t)}const L9="tp";function At(n){return(t,i)=>[L9,"-",n,"v",t?"_".concat(t):"",i?"-".concat(i):""].join("")}const eu=At("lbl");function O9(n,e){const t=n.createDocumentFragment();return e.split("\n").map(r=>n.createTextNode(r)).forEach((r,s)=>{s>0&&t.appendChild(n.createElement("br")),t.appendChild(r)}),t}class P2{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(eu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(eu("l")),Qr(t.props,"label",s=>{zt(s)?this.element.classList.add(eu(void 0,"nol")):(this.element.classList.remove(eu(void 0,"nol")),R9(i),i.appendChild(O9(e,s)))}),this.element.appendChild(i),this.labelElement=i;const r=e.createElement("div");r.classList.add(eu("v")),this.element.appendChild(r),this.valueElement=r}}class R2{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new P2(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return zi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Vi(null,{label:this.props.get("label")})}}function I9(){return["veryfirst","first","last","verylast"]}const EM=At(""),SM={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Sm{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{I9().forEach(i=>{t.classList.remove(EM(void 0,SM[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(EM(void 0,SM[i]))})}),this.viewProps.handleDispose(()=>{Iy(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return zi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Vi(null,Object.assign({},this.viewProps.exportState()))}}class Ia extends Sm{constructor(e,t){if(t.value!==t.valueController.value)throw cn.shouldNeverHappen();const i=t.valueController.viewProps,r=new R2(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new P2(e,{props:t.props,viewProps:i}),viewProps:i})),this.labelController=r,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return zi(e,t=>{var i,r,s;return super.importState(t)&&this.labelController.importProps(t)&&((s=(r=(i=this.valueController).importProps)===null||r===void 0?void 0:r.call(i,e))!==null&&s!==void 0?s:!0)},t=>({value:t.optional.raw}),t=>(t.value&&(this.value.rawValue=t.value),!0))}exportState(){var e,t,i;return Vi(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(i=(t=(e=this.valueController).exportProps)===null||t===void 0?void 0:t.call(e))!==null&&i!==void 0?i:{}))}}function TM(n){const e=Object.assign({},n);return delete e.value,e}class L2 extends Ia{constructor(e,t){super(e,t),this.tag=t.tag}importState(e){return zi(e,t=>super.importState(TM(e)),t=>({tag:t.optional.string}),t=>(this.tag=t.tag,!0))}exportState(){return Vi(()=>TM(super.exportState()),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}function D9(n){return ba(n)&&S2(n.value)}class U9 extends L2{importState(e){return zi(e,t=>super.importState(t),t=>({binding:t.required.object({value:t.required.raw})}),t=>(this.value.binding.inject(t.binding.value),this.value.fetch(),!0))}}function N9(n){return ba(n)&&x9(n.value)}function O2(n,e){for(;n.length<e;)n.push(void 0)}function F9(n){const e=[];return O2(e,n),e}function k9(n){const e=n.indexOf(void 0);return e<0?n:n.slice(0,e)}function B9(n,e){const t=[...k9(n),e];return t.length>n.length?t.splice(0,t.length-n.length):O2(t,n.length),t}class z9{constructor(e){this.emitter=new Sn,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e.binding,this.value_=Jt(F9(e.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=B9(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function V9(n){if(!("binding"in n))return!1;const e=n.binding;return Cy(e)&&"read"in e&&!("write"in e)}class H9 extends L2{exportState(){return Vi(()=>super.exportState(),{binding:{readonly:!0}})}}function G9(n){return ba(n)&&V9(n.value)}class W9 extends Ga{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new Mm(this))}),this}}function $9(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Ac(n,e){return t=>{$9(n,e,t)}}function Dy(n,e){Ms(n,t=>{e.textContent=t!=null?t:""})}const Lg=At("btn");class j9{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Lg()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(Lg("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const r=e.createElement("div");r.classList.add(Lg("t")),Dy(t.props.value("title"),r),this.buttonElement.appendChild(r)}}class X9{constructor(e,t){this.emitter=new Sn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new j9(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return zi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Vi(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}}class AM extends Sm{constructor(e,t){const i=new X9(e,{props:t.buttonProps,viewProps:t.viewProps}),r=new R2(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:r.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=r}importState(e){return zi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Vi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class I2{constructor(e){const[t,i]=e.split("-"),r=t.split(".");this.major=parseInt(r[0],10),this.minor=parseInt(r[1],10),this.patch=parseInt(r[2],10),this.prerelease=i!=null?i:null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const Cc=new I2("2.0.1");function ui(n){return Object.assign({core:Cc},n)}const Y9=ui({id:"button",type:"blade",accept(n){const e=tn(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new AM(n.document,{blade:n.blade,buttonProps:vt.fromObject({title:n.params.title}),labelProps:vt.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof AM?new W9(n.controller):null}});function q9(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function K9(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Z9(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function J9(n){return Ay(n)?"refresh"in n&&typeof n.refresh=="function":!1}function Q9(n,e){if(!lp.isBindable(n))throw cn.notBindable();return new lp(n,e)}class eW{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Sn,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const r=i!=null?i:{},s=this.controller_.element.ownerDocument,o=this.pool_.createBinding(s,Q9(e,t),r),a=this.pool_.createBindingApi(o);return this.add(a,r.index)}addFolder(e){return K9(this,e)}addButton(e){return q9(this,e)}addTab(e){return Z9(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),r=this.pool_.createApi(i);return this.add(r,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}refresh(){this.children.forEach(e=>{J9(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),r=S2(t.value)?t.value.binding:null;this.emitter_.emit("change",new Vh(i,r?r.target.read():t.value.rawValue,e.options.last))}}class Uy extends Ga{constructor(e,t){super(e),this.rackApi_=new eW(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class Ny extends Sm{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return zi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,r)=>i.importState(t.children[r])))}exportState(){return Vi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function M0(n){return"rackController"in n}class tW{constructor(e){this.emitter=new Sn,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw cn.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const r=this.extract_(e);r&&(r.emitter.on("add",this.onSubListAdd_),r.emitter.on("remove",this.onSubListRemove_),r.allItems().forEach(s=>{this.cache_.add(s)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(r=>{this.cache_.delete(r)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function nW(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(ba(i)&&i.value===e)return i}return null}function iW(n){return M0(n)?n.rackController.rack.bcSet_:null}class rW{constructor(e){var t,i;this.emitter=new Sn,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new tW(iW),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),ba(i))i.value.emitter.on("change",this.onChildValueChange_);else if(M0(i)){const r=i.rackController.rack;if(r){const s=r.emitter;s.on("layout",this.onRackLayout_),s.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(ba(i))i.value.emitter.off("change",this.onChildValueChange_);else if(M0(i)){const r=i.rackController.rack;if(r){const s=r.emitter;s.off("layout",this.onRackLayout_),s.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(r=>!r.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(r=>{const s=[];r===t&&(s.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&s.push("veryfirst")),r===i&&(s.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&s.push("verylast")),r.blade.set("positions",s)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=nW(this.find(ba),e.sender);if(!t)throw cn.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class Fy{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new rW({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&T2(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Iy(e.bladeController.view.element)}}function Pc(){return new vt({positions:Jt([],{equals:NG})})}class Hh extends vt{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=vt.createCore(t);return new Hh(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!zt(e)?"".concat(e,"px"):"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};Qr(this,"expanded",i),Qr(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function sW(n,e){let t=0;return S9(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),cp(e),t=e.clientHeight,n.set("temporaryExpanded",null),cp(e)}),t}function CM(n,e){e.style.height=n.styleHeight}function ky(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),zt(n.get("expandedHeight"))){const t=sW(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),cp(e)}),n.emitter.on("change",()=>{CM(n,e)}),CM(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}class D2 extends Uy{constructor(e,t){super(e,t),this.emitter_=new Sn,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new _9(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}}const U2=At("cnt");class oW{constructor(e,t){var i;this.className_=At((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),U2()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Qr(this.foldable_,"completed",Ac(this.element,this.className_(void 0,"cpl")));const r=e.createElement("button");r.classList.add(this.className_("b")),Qr(t.props,"title",c=>{zt(c)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const o=e.createElement("div");o.classList.add(this.className_("t")),Dy(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);const l=e.createElement("div");l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}}class E0 extends Ny{constructor(e,t){var i;const r=Hh.create((i=t.expanded)!==null&&i!==void 0?i:!0),s=new oW(e,{foldable:r,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Fy({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=r,ky(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return zi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Vi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const aW=ui({id:"folder",type:"blade",accept(n){const e=tn(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new E0(n.document,{blade:n.blade,expanded:n.params.expanded,props:vt.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof E0?new D2(n.controller,n.pool):null}}),lW=At("");function PM(n,e){return Ac(n,lW(void 0,e))}class Ns extends vt{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=VG(Jt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,r;const s=e!=null?e:{};return new Ns(vt.createCore({disabled:(t=s.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=s.hidden)!==null&&i!==void 0?i:!1,parent:(r=s.parent)!==null&&r!==void 0?r:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Ms(this.globalDisabled_,PM(e,"disabled")),Qr(this,"hidden",PM(e,"hidden"))}bindDisabled(e){Ms(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Ms(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const RM=At("tbp");class cW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(RM()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(RM("c")),this.element.appendChild(i),this.containerElement=i}}const tu=At("tbi");class uW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(tu()),t.viewProps.bindClassModifiers(this.element),Qr(t.props,"selected",s=>{s?this.element.classList.add(tu(void 0,"sel")):this.element.classList.remove(tu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(tu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const r=e.createElement("div");r.classList.add(tu("t")),Dy(t.props.value("title"),r),this.buttonElement.appendChild(r),this.titleElement=r}}class hW{constructor(e,t){this.emitter=new Sn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new uW(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class S0 extends Ny{constructor(e,t){const i=new cW(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Fy({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new hW(e,{props:t.itemProps,viewProps:Ns.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,Qr(this.props,"selected",r=>{this.itemController.props.set("selected",r),this.viewProps.set("hidden",!r)})}get itemController(){return this.ic_}importState(e){return zi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Vi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class dW extends Uy{constructor(e,t){super(e,t),this.emitter_=new Sn,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new S0(t,{blade:Pc(),itemProps:vt.fromObject({selected:!1,title:e.title}),props:vt.fromObject({selected:!1}),viewProps:Ns.create()}),r=this.pool_.createApi(i);return this.rackApi_.add(r,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}onSelect_(e){this.emitter_.emit("select",new y9(this,e.rawValue))}}class fW extends Uy{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}}const LM=-1;class pW{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Jt(!0),this.selectedIndex=Jt(LM),this.items_=[]}add(e,t){const i=t!=null?t:this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=LM,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,r)=>{i.rawValue=r===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const nu=At("tab");class mW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nu(),U2()),t.viewProps.bindClassModifiers(this.element),Ms(t.empty,Ac(this.element,nu(void 0,"nop")));const i=e.createElement("div");i.classList.add(nu("t")),this.element.appendChild(i),this.itemsElement=i;const r=e.createElement("div");r.classList.add(nu("i")),this.element.appendChild(r);const s=e.createElement("div");s.classList.add(nu("c")),this.element.appendChild(s),this.contentsElement=s}}class OM extends Ny{constructor(e,t){const i=new pW,r=new mW(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Fy({blade:t.blade,element:r.contentsElement,viewProps:t.viewProps}),view:r}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;T2(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Iy(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}const N2=ui({id:"tab",type:"blade",accept(n){const e=tn(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new OM(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new S0(n.document,{blade:Pc(),itemProps:vt.fromObject({selected:!1,title:t.title}),props:vt.fromObject({selected:!1}),viewProps:Ns.create()});e.add(i)}),e},api(n){return n.controller instanceof OM?new dW(n.controller,n.pool):n.controller instanceof S0?new fW(n.controller,n.pool):null}});function gW(n,e){const t=n.accept(e.params);if(!t)return null;const i=tn(e.params,r=>({disabled:r.optional.boolean,hidden:r.optional.boolean}));return n.controller({blade:Pc(),document:e.document,params:Object.assign(Object.assign({},t.params),{disabled:i==null?void 0:i.disabled,hidden:i==null?void 0:i.hidden}),viewProps:Ns.create({disabled:i==null?void 0:i.disabled,hidden:i==null?void 0:i.hidden})})}class By extends Eh{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class vW{constructor(){this.disabled=!1,this.emitter=new Sn}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class _W{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Sn,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class Gh{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}}function up(n,e){if(n instanceof e)return n;if(n instanceof Gh){const t=n.constraints.reduce((i,r)=>i||(r instanceof e?r:null),null);if(t)return t}return null}class Wh{constructor(e){this.values=vt.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(r=>r.value===e).length>0?e:t[0].value}}function $h(n){var e;const t=w0;if(Array.isArray(n))return(e=tn({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function zy(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Vy(n){return zt(n)?null:new Wh(zy(n))}const Og=At("lst");class yW{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Og()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Og("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const r=e.createElement("div");r.classList.add(Og("m")),r.appendChild(Em(e,"dropdown")),this.element.appendChild(r),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,Qr(this.props_,"options",s=>{A2(this.selectElement),s.forEach(o=>{const a=e.createElement("option");a.textContent=o.text,this.selectElement.appendChild(a)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ao{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new yW(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return zi(e,null,t=>({options:t.required.custom($h)}),t=>(this.props.set("options",zy(t.options)),!0))}exportProps(){return Vi(null,{options:this.props.get("options")})}}const IM=At("pop");class bW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(IM()),t.viewProps.bindClassModifiers(this.element),Ms(t.shows,Ac(this.element,IM(void 0,"v")))}}class F2{constructor(e,t){this.shows=Jt(!1),this.viewProps=t.viewProps,this.view=new bW(e,{shows:this.shows,viewProps:this.viewProps})}}const DM=At("txt");class xW{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(DM()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(DM("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class Sh{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new xW(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,r=this.parser_(i);zt(r)||(this.value.rawValue=r),this.view.refresh()}}function wW(n){return String(n)}function k2(n){return n==="false"?!1:!!n}function UM(n){return wW(n)}function MW(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const EW=Ei(0);function hp(n){return EW(n)+"%"}function B2(n){return String(n)}function T0(n){return n}function Rc({primary:n,secondary:e,forward:t,backward:i}){let r=!1;function s(o){r||(r=!0,o(),r=!1)}n.emitter.on("change",o=>{s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{s(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function yi(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Th(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Os(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function SW(n){return n==="ArrowUp"||n==="ArrowDown"}function z2(n){return SW(n)||n==="ArrowLeft"||n==="ArrowRight"}function Ig(n,e){var t,i;const r=e.ownerDocument.defaultView,s=e.getBoundingClientRect();return{x:n.pageX-(((t=r&&r.scrollX)!==null&&t!==void 0?t:0)+s.left),y:n.pageY-(((i=r&&r.scrollY)!==null&&i!==void 0?i:0)+s.top)}}class Wa{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Sn,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Ig(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Ig(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Ig(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,r=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-r.left,y:i.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const ji=At("txt");class TW{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(ji(),ji(void 0,"num")),t.arrayPosition&&this.element.classList.add(ji(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(ji("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ji()),this.inputElement.classList.add(ji("i"));const r=e.createElement("div");r.classList.add(ji("k")),this.element.appendChild(r),this.knobElement=r;const s=e.createElementNS(Hr,"svg");s.classList.add(ji("g")),this.knobElement.appendChild(s);const o=e.createElementNS(Hr,"path");o.classList.add(ji("gb")),s.appendChild(o),this.guideBodyElem_=o;const a=e.createElementNS(Hr,"path");a.classList.add(ji("gh")),s.appendChild(a),this.guideHeadElem_=a;const l=e.createElement("div");l.classList.add(At("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(ji(void 0,"drg"));return}this.element.classList.add(ji(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),r=Cn(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",["M ".concat(i+r,",0 L").concat(i,",4 L").concat(i+r,",8"),"M ".concat(t,",-1 L").concat(t,",9")].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d","M 0,4 L".concat(t,",4"));const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left="".concat(t,"px")}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class jh{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=Jt(null),this.view=new TW(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const r=new Wa(this.view.knobElement);r.emitter.on("down",this.onPointerDown_),r.emitter.on("move",this.onPointerMove_),r.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const r=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),s=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return r!==void 0&&(o=Math.max(o,r)),s!==void 0&&(o=Math.min(o,s)),o}onInputChange_(e){const i=e.currentTarget.value,r=this.parser_(i);zt(r)||(this.value.rawValue=this.constrainValue_(r)),this.view.refresh()}onInputKeyDown_(e){const t=yi(this.props.get("keyScale"),Th(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){yi(this.props.get("keyScale"),Th(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Dg=At("sld");class AW{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Dg()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Dg("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const r=e.createElement("div");r.classList.add(Dg("k")),this.trackElement.appendChild(r),this.knobElement=r,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Cn(Ot(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width="".concat(e,"%")}onChange_(){this.update_()}}class CW{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new AW(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wa(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(Ot(Cn(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=yi(this.props.get("keyScale"),Os(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){yi(this.props.get("keyScale"),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ug=At("sldtxt");class PW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ug());const i=e.createElement("div");i.classList.add(Ug("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(Ug("t")),this.textView_=t.textView,r.appendChild(this.textView_.element),this.element.appendChild(r)}}class dp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new CW(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new jh(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new PW(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Vi(null,{max:e.get("max"),min:e.get("min")})}}function V2(n){return{sliderProps:new vt({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new vt({formatter:Jt(n.formatter),keyScale:n.keyScale,pointerScale:Jt(n.pointerScale)})}}const RW={containerUnitSize:"cnt-usz"};function H2(n){return"--".concat(RW[n])}function Ah(n){return E2(n)}function co(n){if(x0(n))return tn(n,Ah)}function ys(n,e){if(!n)return;const t=[],i=x2(n,e);i&&t.push(i);const r=w2(n);return r&&t.push(r),new Gh(t)}function LW(n){return n?n.major===Cc.major:!1}function G2(n){if(n==="inline"||n==="popup")return n}function Xh(n,e){n.write(e)}const hf=At("ckb");class OW{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(hf()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(hf("l")),this.element.appendChild(i);const r=e.createElement("input");r.classList.add(hf("i")),r.type="checkbox",i.appendChild(r),this.inputElement=r,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(hf("w")),i.appendChild(s);const o=Em(e,"check");s.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class IW{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new OW(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}}function DW(n){const e=[],t=Vy(n.options);return t&&e.push(t),new Gh(e)}const UW=ui({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=tn(e,i=>({options:i.optional.custom($h),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>k2,constraint:n=>DW(n.params),writer:n=>Xh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,r=i&&up(i,Wh);return r?new Ao(e,{props:new vt({options:r.values.value("options")}),value:t,viewProps:n.viewProps}):new IW(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof Ao?new By(n.controller):null}}),qo=At("col");class NW{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qo()),t.foldable.bindExpandedClass(this.element,qo(void 0,"expanded")),Qr(t.foldable,"completed",Ac(this.element,qo(void 0,"cpl")));const i=e.createElement("div");i.classList.add(qo("h")),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(qo("s")),i.appendChild(r),this.swatchElement=r;const s=e.createElement("div");if(s.classList.add(qo("t")),i.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(qo("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}function FW(n,e,t){const i=Cn(n/255,0,1),r=Cn(e/255,0,1),s=Cn(t/255,0,1),o=Math.max(i,r,s),a=Math.min(i,r,s),l=o-a;let c=0,u=0;const h=(a+o)/2;return l!==0&&(u=l/(1-Math.abs(o+a-1)),i===o?c=(r-s)/l:r===o?c=2+(s-i)/l:c=4+(i-r)/l,c=c/6+(c<0?1:0)),[c*360,u*100,h*100]}function kW(n,e,t){const i=(n%360+360)%360,r=Cn(e/100,0,1),s=Cn(t/100,0,1),o=(1-Math.abs(2*s-1))*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o/2;let c,u,h;return i>=0&&i<60?[c,u,h]=[o,a,0]:i>=60&&i<120?[c,u,h]=[a,o,0]:i>=120&&i<180?[c,u,h]=[0,o,a]:i>=180&&i<240?[c,u,h]=[0,a,o]:i>=240&&i<300?[c,u,h]=[a,0,o]:[c,u,h]=[o,0,a],[(c+l)*255,(u+l)*255,(h+l)*255]}function BW(n,e,t){const i=Cn(n/255,0,1),r=Cn(e/255,0,1),s=Cn(t/255,0,1),o=Math.max(i,r,s),a=Math.min(i,r,s),l=o-a;let c;l===0?c=0:o===i?c=60*(((r-s)/l%6+6)%6):o===r?c=60*((s-i)/l+2):c=60*((i-r)/l+4);const u=o===0?0:l/o,h=o;return[c,u*100,h*100]}function W2(n,e,t){const i=_2(n,360),r=Cn(e/100,0,1),s=Cn(t/100,0,1),o=s*r,a=o*(1-Math.abs(i/60%2-1)),l=s-o;let c,u,h;return i>=0&&i<60?[c,u,h]=[o,a,0]:i>=60&&i<120?[c,u,h]=[a,o,0]:i>=120&&i<180?[c,u,h]=[0,o,a]:i>=180&&i<240?[c,u,h]=[0,a,o]:i>=240&&i<300?[c,u,h]=[a,0,o]:[c,u,h]=[o,0,a],[(c+l)*255,(u+l)*255,(h+l)*255]}function zW(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function VW(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function es(n){return[n[0],n[1],n[2]]}function Tm(n,e){return[n[0],n[1],n[2],e]}const HW={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:zW,rgb:kW},hsv:{hsl:VW,hsv:(n,e,t)=>[n,e,t],rgb:W2},rgb:{hsl:FW,hsv:BW,rgb:(n,e,t)=>[n,e,t]}};function dc(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function GW(n,e){return n===e?e:_2(n,e)}function $2(n,e,t){var i;const r=dc(e,t);return[e==="rgb"?Cn(n[0],0,r[0]):GW(n[0],r[0]),Cn(n[1],0,r[1]),Cn(n[2],0,r[2]),Cn((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function NM(n,e,t,i){const r=dc(e,t),s=dc(e,i);return n.map((o,a)=>o/r[a]*s[a])}function j2(n,e,t){const i=NM(n,e.mode,e.type,"int"),r=HW[e.mode][t.mode](...i);return NM(r,t.mode,"int",t.type)}class Pt{static black(){return new Pt([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=$2(e,t,this.type)}getComponents(e){return Tm(j2(es(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Ys=At("colp");class WW{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Ys()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Ys("hsv"));const r=e.createElement("div");r.classList.add(Ys("sv")),this.svPaletteView_=t.svPaletteView,r.appendChild(this.svPaletteView_.element),i.appendChild(r);const s=e.createElement("div");s.classList.add(Ys("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),i.appendChild(s),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(Ys("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const a=e.createElement("div");a.classList.add(Ys("a"));const l=e.createElement("div");l.classList.add(Ys("ap")),l.appendChild(this.alphaViews_.palette.element),a.appendChild(l);const c=e.createElement("div");c.classList.add(Ys("at")),c.appendChild(this.alphaViews_.text.element),a.appendChild(c),this.element.appendChild(a)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function $W(n){return n==="int"?"int":n==="float"?"float":void 0}function Hy(n){return tn(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom($W)}),expanded:e.optional.boolean,picker:e.optional.custom(G2),readonly:e.optional.constant(!1)}))}function Da(n){return n?.1:1}function X2(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}class Gy{constructor(e,t){this.type="float",this.mode=t,this.comps_=$2(e,t,this.type)}getComponents(e){return Tm(j2(es(this.comps_),{mode:this.mode,type:this.type},{mode:e!=null?e:this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const jW={int:(n,e)=>new Pt(n,e),float:(n,e)=>new Gy(n,e)};function Wy(n,e,t){return jW[t](n,e)}function XW(n){return n.type==="float"}function YW(n){return n.type==="int"}function qW(n){const e=n.getComponents(),t=dc(n.mode,"int");return new Pt([Math.round(Ot(e[0],0,1,0,t[0])),Math.round(Ot(e[1],0,1,0,t[1])),Math.round(Ot(e[2],0,1,0,t[2])),e[3]],n.mode)}function KW(n){const e=n.getComponents(),t=dc(n.mode,"int");return new Gy([Ot(e[0],0,t[0],0,1),Ot(e[1],0,t[1],0,1),Ot(e[2],0,t[2],0,1),e[3]],n.mode)}function ai(n,e){if(n.type===e)return n;if(YW(n)&&e==="float")return KW(n);if(XW(n)&&e==="int")return qW(n);throw cn.shouldNeverHappen()}function ZW(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function nr(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const JW={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Y2(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return JW[i](t)}function q2(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[nr(e[1],255),nr(e[2],255),nr(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function QW(n){const e=q2(n);return e?new Pt(e,"rgb"):null}function K2(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[nr(e[1],255),nr(e[2],255),nr(e[3],255),nr(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function e$(n){const e=K2(n);return e?new Pt(e,"rgb"):null}function Z2(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Y2(e[1]),nr(e[2],100),nr(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function t$(n){const e=Z2(n);return e?new Pt(e,"hsl"):null}function J2(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Y2(e[1]),nr(e[2],100),nr(e[3],100),nr(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function n$(n){const e=J2(n);return e?new Pt(e,"hsl"):null}function Q2(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function i$(n){const e=Q2(n);return e?new Pt(e,"rgb"):null}function eP(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),Ot(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),Ot(parseInt(t[4],16),0,255,0,1)]:null}function r$(n){const e=eP(n);return e?new Pt(e,"rgb"):null}function tP(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function FM(n){return e=>{const t=tP(e);return t?Wy(t,"rgb",n):null}}function nP(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function kM(n){return e=>{const t=nP(e);return t?Wy(t,"rgb",n):null}}const s$=[{parser:Q2,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:eP,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:q2,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:K2,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Z2,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:J2,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:tP,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:nP,result:{alpha:!0,mode:"rgb",notation:"object"}}];function o$(n){return s$.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function a$(n,e="int"){const t=o$(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Yh(n){const e=[i$,r$,QW,e$,t$,n$];n==="int"&&e.push(FM("int"),kM("int")),n==="float"&&e.push(FM("float"),kM("float"));const t=MW(e);return i=>{const r=t(i);return r?ai(r,n):null}}function l$(n){const e=Yh("int");if(typeof n!="string")return Pt.black();const t=e(n);return t!=null?t:Pt.black()}function iP(n){const e=Cn(Math.floor(n),0,255).toString(16);return e.length===1?"0".concat(e):e}function $y(n,e="#"){const t=es(n.getComponents("rgb")).map(iP).join("");return"".concat(e).concat(t)}function jy(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(iP).join("");return"".concat(e).concat(i)}function rP(n){const e=Ei(0),t=ai(n,"int"),i=es(t.getComponents("rgb")).map(r=>e(r));return"rgb(".concat(i.join(", "),")")}function kf(n){const e=Ei(2),t=Ei(0),r=ai(n,"int").getComponents("rgb").map((s,o)=>(o===3?e:t)(s));return"rgba(".concat(r.join(", "),")")}function c$(n){const e=[Ei(0),hp,hp],t=ai(n,"int"),i=es(t.getComponents("hsl")).map((r,s)=>e[s](r));return"hsl(".concat(i.join(", "),")")}function u$(n){const e=[Ei(0),hp,hp,Ei(2)],i=ai(n,"int").getComponents("hsl").map((r,s)=>e[s](r));return"hsla(".concat(i.join(", "),")")}function sP(n,e){const t=Ei(e==="float"?2:0),i=["r","g","b"],r=ai(n,e),s=es(r.getComponents("rgb")).map((o,a)=>"".concat(i[a],": ").concat(t(o)));return"{".concat(s.join(", "),"}")}function h$(n){return e=>sP(e,n)}function oP(n,e){const t=Ei(2),i=Ei(e==="float"?2:0),r=["r","g","b","a"],o=ai(n,e).getComponents("rgb").map((a,l)=>{const c=l===3?t:i;return"".concat(r[l],": ").concat(c(a))});return"{".concat(o.join(", "),"}")}function d$(n){return e=>oP(e,n)}const f$=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:$y},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:jy},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:rP},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:kf},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:c$},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:u$},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:h$(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:d$(e)}],[])];function aP(n){return f$.reduce((e,t)=>e||(ZW(t.format,n)?t.stringifier:null),null)}const iu=At("apl");class p${constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(iu()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(iu("b")),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(iu("c")),i.appendChild(r),this.colorElem_=r;const s=e.createElement("div");s.classList.add(iu("m")),this.element.appendChild(s),this.markerElem_=s;const o=e.createElement("div");o.classList.add(iu("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new Pt([t[0],t[1],t[2],0],"rgb"),r=new Pt([t[0],t[1],t[2],255],"rgb"),s=["to right",kf(i),kf(r)];this.colorElem_.style.background="linear-gradient(".concat(s.join(","),")"),this.previewElem_.style.backgroundColor=kf(e);const o=Ot(t[3],0,1,0,100);this.markerElem_.style.left="".concat(o,"%")}onValueChange_(){this.update_()}}class m${constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new p$(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,r=this.value.rawValue,[s,o,a]=r.getComponents("hsv");this.value.setRawValue(new Pt([s,o,a,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=yi(Da(!0),Os(e));if(t===0)return;const i=this.value.rawValue,[r,s,o,a]=i.getComponents("hsv");this.value.setRawValue(new Pt([r,s,o,a+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){yi(Da(!0),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const _l=At("coltxt");function g$(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,r)=>{const s=n.createElement("option");return s.textContent=r.text,s.value=r.value,i.appendChild(s),i},n.createDocumentFragment())),e}class v${constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(_l()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(_l("m")),this.modeElem_=g$(e),this.modeElem_.classList.add(_l("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const r=e.createElement("div");r.classList.add(_l("mm")),r.appendChild(Em(e,"dropdown")),i.appendChild(r),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(_l("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),Ms(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){A2(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(_l("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}}function _$(n){return Ei(n==="float"?2:0)}function y$(n,e,t){const i=dc(n,e)[t];return new zh({min:0,max:i})}function b$(n,e,t){return new jh(n,{arrayPosition:t===0?"fst":t===3-1?"lst":"mid",parser:e.parser,props:vt.fromObject({formatter:_$(e.colorType),keyScale:Da(!1),pointerScale:e.colorType==="float"?.01:1}),value:Jt(0,{constraint:y$(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function x$(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Ls,viewProps:e.viewProps};return[0,1,2].map(i=>{const r=b$(n,t,i);return Rc({primary:e.value,secondary:r.value,forward(s){return ai(s,e.colorType).getComponents(e.colorMode)[i]},backward(s,o){const a=e.colorMode,c=ai(s,e.colorType).getComponents(a);c[i]=o;const u=Wy(Tm(es(c),c[3]),a,e.colorType);return ai(u,"int")}}),r})}function w$(n,e){const t=new Sh(n,{parser:Yh("int"),props:vt.fromObject({formatter:$y}),value:Jt(Pt.black()),viewProps:e.viewProps});return Rc({primary:e.value,secondary:t.value,forward:i=>new Pt(es(i.getComponents()),i.mode),backward:(i,r)=>new Pt(Tm(es(r.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function M$(n){return n!=="hex"}class E${constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=Jt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new v$(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return M$(t)?x$(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):w$(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}}const Ng=At("hpl");class S${constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ng()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Ng("c")),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(Ng("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=rP(new Pt([t,100,100],"hsv"));const i=Ot(t,0,360,0,100);this.markerElem_.style.left="".concat(i,"%")}onValueChange_(){this.update_()}}class T${constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new S$(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=Ot(Cn(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),r=this.value.rawValue,[,s,o,a]=r.getComponents("hsv");this.value.setRawValue(new Pt([i,s,o,a],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=yi(Da(!1),Os(e));if(t===0)return;const i=this.value.rawValue,[r,s,o,a]=i.getComponents("hsv");this.value.setRawValue(new Pt([r+t,s,o,a],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){yi(Da(!1),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Fg=At("svp"),BM=64;class A${constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Fg()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=BM,i.width=BM,i.classList.add(Fg("c")),this.element.appendChild(i),this.canvasElement=i;const r=e.createElement("div");r.classList.add(Fg("m")),this.element.appendChild(r),this.markerElem_=r,this.update_()}update_(){const e=C9(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),r=this.canvasElement.width,s=this.canvasElement.height,o=e.getImageData(0,0,r,s),a=o.data;for(let u=0;u<s;u++)for(let h=0;h<r;h++){const d=Ot(h,0,r,0,100),f=Ot(u,0,s,100,0),p=W2(i[0],d,f),v=(u*r+h)*4;a[v]=p[0],a[v+1]=p[1],a[v+2]=p[2],a[v+3]=255}e.putImageData(o,0,0);const l=Ot(i[1],0,100,0,100);this.markerElem_.style.left="".concat(l,"%");const c=Ot(i[2],0,100,100,0);this.markerElem_.style.top="".concat(c,"%")}onValueChange_(){this.update_()}}class C${constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new A$(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wa(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=Ot(e.point.x,0,e.bounds.width,0,100),r=Ot(e.point.y,0,e.bounds.height,100,0),[s,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Pt([s,i,r,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){z2(e.key)&&e.preventDefault();const[t,i,r,s]=this.value.rawValue.getComponents("hsv"),o=Da(!1),a=yi(o,Os(e)),l=yi(o,Th(e));a===0&&l===0||this.value.setRawValue(new Pt([t,i+a,r+l,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Da(!1),i=yi(t,Os(e)),r=yi(t,Th(e));i===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class P${constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new T$(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new C$(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new m$(e,{value:this.value,viewProps:this.viewProps}),text:new jh(e,{parser:Ls,props:vt.fromObject({pointerScale:.01,keyScale:.1,formatter:Ei(2)}),value:Jt(0,{constraint:new zh({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Rc({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,r)=>{const s=i.getComponents();return s[3]=r,new Pt(s,i.mode)}}),this.textsC_=new E$(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new WW(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const kg=At("colsw");class R${constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(kg()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(kg("sw")),this.element.appendChild(i),this.swatchElem_=i;const r=e.createElement("button");r.classList.add(kg("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=jy(e)}onValueChange_(){this.update_()}}class L${constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new R$(e,{value:this.value,viewProps:this.viewProps})}}class Xy{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Hh.create(t.expanded),this.swatchC_=new L$(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Sh(e,{parser:t.parser,props:vt.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new NW(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new F2(e,{viewProps:this.viewProps}):null;const r=new P$(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(r.view.element),Rc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s,backward:(s,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ky(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=C2(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Oy(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function O$(n){return es(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function I$(n){return n.getComponents("rgb").reduce((e,t,i)=>{const r=Math.floor(i===3?t*255:t)&255;return e<<8|r},0)>>>0}function D$(n){return new Pt([n>>16&255,n>>8&255,n&255],"rgb")}function U$(n){return new Pt([n>>24&255,n>>16&255,n>>8&255,Ot(n&255,0,255,0,1)],"rgb")}function N$(n){return typeof n!="number"?Pt.black():D$(n)}function F$(n){return typeof n!="number"?Pt.black():U$(n)}function Bf(n,e){return typeof n!="object"||zt(n)?!1:e in n&&typeof n[e]=="number"}function lP(n){return Bf(n,"r")&&Bf(n,"g")&&Bf(n,"b")}function cP(n){return lP(n)&&Bf(n,"a")}function uP(n){return lP(n)}function Yy(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let r=0;r<t.length;r++)if(t[r]!==i[r])return!1;return!0}function zM(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function k$(n){const e=aP(n);return e?(t,i)=>{Xh(t,e(i))}:null}function B$(n){const e=n?I$:O$;return(t,i)=>{Xh(t,e(i))}}function z$(n,e,t){const r=ai(e,t).toRgbaObject();n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b),n.writeProperty("a",r.a)}function V$(n,e,t){const r=ai(e,t).toRgbaObject();n.writeProperty("r",r.r),n.writeProperty("g",r.g),n.writeProperty("b",r.b)}function H$(n,e){return(t,i)=>{n?z$(t,i,e):V$(t,i,e)}}function G$(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function W$(n){return n?e=>jy(e,"0x"):e=>$y(e,"0x")}function $$(n){return"color"in n||n.view==="color"}const j$=ui({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!$$(e))return null;const t=Hy(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:G$(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?F$:N$,equals:Yy,writer:n=>B$(n.params.supportsAlpha)},controller:n=>{var e,t;return new Xy(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:W$(n.params.supportsAlpha),parser:Yh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function X$(n,e){if(!uP(n))return ai(Pt.black(),e);if(e==="int"){const t=zM(n);return new Pt(t,"rgb")}if(e==="float"){const t=zM(n);return new Gy(t,"rgb")}return ai(Pt.black(),"int")}function Y$(n){return cP(n)}function q$(n){return e=>{const t=X$(e,n);return ai(t,"int")}}function K$(n,e){return t=>n?oP(t,e):sP(t,e)}const Z$=ui({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!uP(n))return null;const i=Hy(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=X2(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>q$(n.params.colorType),equals:Yy,writer:n=>H$(Y$(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=cP(n.initialValue);return new Xy(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:K$(i,n.params.colorType),parser:Yh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}}),J$=ui({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=a$(n,X2(e));if(!t)return null;const i=aP(t);if(!i)return null;const r=Hy(e);return r?{initialValue:n,params:Object.assign(Object.assign({},r),{format:t,stringifier:i})}:null},binding:{reader:()=>l$,equals:Yy,writer:n=>{const e=k$(n.params.format);if(!e)throw cn.notBindable();return e}},controller:n=>{var e,t;return new Xy(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Yh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});class qy{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,r)=>{var s,o;return(o=(s=this.components[r])===null||s===void 0?void 0:s.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}}const VM=At("pndtxt");class Q${constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(VM()),this.textViews.forEach(i=>{const r=e.createElement("div");r.classList.add(VM("a")),r.appendChild(i.element),this.element.appendChild(r)})}}function ej(n,e,t){return new jh(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:Jt(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class Ky{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,r)=>ej(e,t,r)),this.acs_.forEach((i,r)=>{Rc({primary:this.value,secondary:i.value,forward:s=>t.assembly.toComponents(s)[r],backward:(s,o)=>{const a=t.assembly.toComponents(s);return a[r]=o,t.assembly.fromComponents(a)}})}),this.view=new Q$(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}}class tj extends Eh{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function nj(n,e){const t=[],i=x2(n,e);i&&t.push(i);const r=w2(n);r&&t.push(r);const s=Vy(n.options);return s&&t.push(s),new Gh(t)}const ij=ui({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=tn(e,i=>Object.assign(Object.assign({},E2(i)),{options:i.optional.custom($h),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>v2,constraint:n=>nj(n.params,n.initialValue),writer:n=>Xh},controller:n=>{const e=n.value,t=n.constraint,i=t&&up(t,Wh);if(i)return new Ao(n.document,{props:new vt({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const r=M2(n.params,e.rawValue),s=t&&up(t,zh);return s?new dp(n.document,Object.assign(Object.assign({},V2(Object.assign(Object.assign({},r),{keyScale:Jt(r.keyScale),max:s.values.value("max"),min:s.values.value("min")}))),{parser:Ls,value:e,viewProps:n.viewProps})):new jh(n.document,{parser:Ls,props:vt.fromObject(r),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof dp?new tj(n.controller):n.controller.valueController instanceof Ao?new By(n.controller):null}});class yo{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(zt(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const hP={toComponents:n=>n.getComponents(),fromComponents:n=>new yo(...n)},yl=At("p2d");class rj{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yl()),t.viewProps.bindClassModifiers(this.element),Ms(t.expanded,Ac(this.element,yl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(yl("h")),this.element.appendChild(i);const r=e.createElement("button");r.classList.add(yl("b")),r.appendChild(Em(e,"p2dpad")),t.viewProps.bindDisabled(r),i.appendChild(r),this.buttonElement=r;const s=e.createElement("div");if(s.classList.add(yl("t")),i.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(yl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}const qs=At("p2dp");class sj{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(qs()),t.layout==="popup"&&this.element.classList.add(qs(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(qs("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const r=e.createElementNS(Hr,"svg");r.classList.add(qs("g")),this.padElement.appendChild(r),this.svgElem_=r;const s=e.createElementNS(Hr,"line");s.classList.add(qs("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const o=e.createElementNS(Hr,"line");o.classList.add(qs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const a=e.createElementNS(Hr,"line");a.classList.add(qs("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;const l=e.createElement("div");l.classList.add(qs("m")),this.padElement.appendChild(l),this.markerElem_=l,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),r=Ot(e,-i,+i,0,100),s=Ot(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2","".concat(r,"%")),this.lineElem_.setAttributeNS(null,"y2","".concat(o,"%")),this.markerElem_.style.left="".concat(r,"%"),this.markerElem_.style.top="".concat(o,"%")}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function HM(n,e,t){return[yi(e[0],Os(n)),yi(e[1],Th(n))*(t?1:-1)]}class oj{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new sj(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Wa(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),r=Ot(e.point.x,0,e.bounds.width,-i,+i),s=Ot(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new yo(r,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){z2(e.key)&&e.preventDefault();const[t,i]=HM(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new yo(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=HM(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class aj{constructor(e,t){var i,r;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Hh.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new F2(e,{viewProps:this.viewProps}):null;const s=new oj(e,{layout:t.pickerLayout,props:new vt({invertsY:Jt(t.invertsY),max:Jt(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.textC_=new Ky(e,{assembly:hP,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new rj(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Rc({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,a)=>a})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ky(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=C2(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!Oy(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function lj(n){return yo.isObject(n)?new yo(n.x,n.y):new yo}function cj(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function uj(n,e){return new qy({assembly:hP,components:[ys(Object.assign(Object.assign({},n),n.x),e.x),ys(Object.assign(Object.assign({},n),n.y),e.y)]})}function GM(n,e){var t,i;if(!zt(n.min)||!zt(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const r=y2(n);return Math.max(Math.abs(r)*10,Math.abs(e)*10)}function hj(n,e){var t,i;const r=GM(Oa(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),s=GM(Oa(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(r,s)}function dj(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}const fj=ui({id:"input-point2d",type:"input",accept:(n,e)=>{if(!yo.isObject(n))return null;const t=tn(e,i=>Object.assign(Object.assign({},Ah(i)),{expanded:i.optional.boolean,picker:i.optional.custom(G2),readonly:i.optional.constant(!1),x:i.optional.custom(co),y:i.optional.object(Object.assign(Object.assign({},Ah(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>lj,constraint:n=>uj(n.params,n.initialValue),equals:yo.equals,writer:()=>cj},controller:n=>{var e,t;const i=n.document,r=n.value,s=n.constraint,o=[n.params.x,n.params.y];return new aj(i,{axes:r.rawValue.getComponents().map((a,l)=>{var c;return Ly({constraint:s.components[l],initialValue:a,params:Oa(n.params,(c=o[l])!==null&&c!==void 0?c:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:dj(n.params),max:hj(n.params,r.rawValue),parser:Ls,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:r,viewProps:n.viewProps})}});class Yl{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(zt(e))return!1;const t=e.x,i=e.y,r=e.z;return!(typeof t!="number"||typeof i!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const dP={toComponents:n=>n.getComponents(),fromComponents:n=>new Yl(...n)};function pj(n){return Yl.isObject(n)?new Yl(n.x,n.y,n.z):new Yl}function mj(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function gj(n,e){return new qy({assembly:dP,components:[ys(Object.assign(Object.assign({},n),n.x),e.x),ys(Object.assign(Object.assign({},n),n.y),e.y),ys(Object.assign(Object.assign({},n),n.z),e.z)]})}const vj=ui({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Yl.isObject(n))return null;const t=tn(e,i=>Object.assign(Object.assign({},Ah(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(co),y:i.optional.custom(co),z:i.optional.custom(co)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>pj,constraint:n=>gj(n.params,n.initialValue),equals:Yl.equals,writer:n=>mj},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new Ky(n.document,{assembly:dP,axes:e.rawValue.getComponents().map((r,s)=>{var o;return Ly({constraint:t.components[s],initialValue:r,params:Oa(n.params,(o=i[s])!==null&&o!==void 0?o:{})})}),parser:Ls,value:e,viewProps:n.viewProps})}});class ql{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.z=i,this.w=r}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(zt(e))return!1;const t=e.x,i=e.y,r=e.z,s=e.w;return!(typeof t!="number"||typeof i!="number"||typeof r!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const fP={toComponents:n=>n.getComponents(),fromComponents:n=>new ql(...n)};function _j(n){return ql.isObject(n)?new ql(n.x,n.y,n.z,n.w):new ql}function yj(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function bj(n,e){return new qy({assembly:fP,components:[ys(Object.assign(Object.assign({},n),n.x),e.x),ys(Object.assign(Object.assign({},n),n.y),e.y),ys(Object.assign(Object.assign({},n),n.z),e.z),ys(Object.assign(Object.assign({},n),n.w),e.w)]})}const xj=ui({id:"input-point4d",type:"input",accept:(n,e)=>{if(!ql.isObject(n))return null;const t=tn(e,i=>Object.assign(Object.assign({},Ah(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(co),x:i.optional.custom(co),y:i.optional.custom(co),z:i.optional.custom(co)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>_j,constraint:n=>bj(n.params,n.initialValue),equals:ql.equals,writer:n=>yj},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new Ky(n.document,{assembly:fP,axes:e.rawValue.getComponents().map((r,s)=>{var o;return Ly({constraint:t.components[s],initialValue:r,params:Oa(n.params,(o=i[s])!==null&&o!==void 0?o:{})})}),parser:Ls,value:e,viewProps:n.viewProps})}});function wj(n){const e=[],t=Vy(n.options);return t&&e.push(t),new Gh(e)}const Mj=ui({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=tn(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom($h)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>B2,constraint:n=>wj(n.params),writer:n=>Xh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,r=i&&up(i,Wh);return r?new Ao(e,{props:new vt({options:r.values.value("options")}),value:t,viewProps:n.viewProps}):new Sh(e,{parser:s=>s,props:vt.fromObject({formatter:T0}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof Ao?new By(n.controller):null}}),qh={monitor:{defaultInterval:200,defaultRows:3}},WM=At("mll");class Ej{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(WM()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(WM("i")),i.style.height="calc(var(".concat(H2("containerUnitSize"),") * ").concat(t.rows,")"),i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(r=>{r!==void 0&&i.push(this.formatter_(r))}),e.textContent=i.join("\n"),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class Zy{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Ej(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const $M=At("sgl");class Sj{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add($M()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add($M("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Jy{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Sj(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}const Tj=ui({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=tn(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>k2},controller:n=>{var e;return n.value.rawValue.length===1?new Jy(n.document,{formatter:UM,value:n.value,viewProps:n.viewProps}):new Zy(n.document,{formatter:UM,rows:(e=n.params.rows)!==null&&e!==void 0?e:qh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});class Aj extends Eh{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const Ks=At("grl");class Cj{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ks()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(Hr,"svg");i.classList.add(Ks("g")),i.style.height="calc(var(".concat(H2("containerUnitSize"),") * ").concat(t.rows,")"),this.element.appendChild(i),this.svgElem_=i;const r=e.createElementNS(Hr,"polyline");this.svgElem_.appendChild(r),this.lineElem_=r;const s=e.createElement("div");s.classList.add(Ks("t"),At("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),r=this.props_.get("max"),s=[];this.value.rawValue.forEach((u,h)=>{if(u===void 0)return;const d=Ot(h,0,t,0,e.width),f=Ot(u,i,r,e.height,0);s.push([d,f].join(","))}),this.lineElem_.setAttributeNS(null,"points",s.join(" "));const o=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){o.classList.remove(Ks("t","a"));return}const l=Ot(this.cursor_.rawValue,0,t,0,e.width),c=Ot(a,i,r,e.height,0);o.style.left="".concat(l,"px"),o.style.top="".concat(c,"px"),o.textContent="".concat(this.formatter_(a)),o.classList.contains(Ks("t","a"))||(o.classList.add(Ks("t","a"),Ks("t","in")),cp(o),o.classList.remove(Ks("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class pP{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=Jt(-1),this.view=new Cj(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Oy(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Wa(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Vi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(Ot(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(Ot(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function A0(n){return zt(n.format)?Ei(2):n.format}function Pj(n){var e;return n.value.rawValue.length===1?new Jy(n.document,{formatter:A0(n.params),value:n.value,viewProps:n.viewProps}):new Zy(n.document,{formatter:A0(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:qh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Rj(n){var e,t,i;return new pP(n.document,{formatter:A0(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:qh.monitor.defaultRows,props:vt.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function jM(n){return n.view==="graph"}const Lj=ui({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=tn(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>jM(n)?64:1,reader:n=>v2},controller:n=>jM(n.params)?Rj(n):Pj(n),api:n=>n.controller.valueController instanceof pP?new Aj(n.controller):null}),Oj=ui({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=tn(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>B2},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Zy(n.document,{formatter:T0,rows:(e=n.params.rows)!==null&&e!==void 0?e:qh.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Jy(n.document,{formatter:T0,value:t,viewProps:n.viewProps})}});class Ij{constructor(){this.map_=new Map}get(e){var t;return(t=this.map_.get(e))!==null&&t!==void 0?t:null}has(e){return this.map_.has(e)}add(e,t){return this.map_.set(e,t),e.viewProps.handleDispose(()=>{this.map_.delete(e)}),t}}class Dj{constructor(e){this.target=e.target,this.reader_=e.reader,this.writer_=e.writer}read(){return this.reader_(this.target.read())}write(e){this.writer_(this.target,e)}inject(e){this.write(this.reader_(e))}}function Uj(n,e){var t;const i=n.accept(e.target.read(),e.params);if(zt(i))return null;const r={target:e.target,initialValue:i.initialValue,params:i.params},s=tn(e.params,h=>({disabled:h.optional.boolean,hidden:h.optional.boolean,label:h.optional.string,tag:h.optional.string})),o=n.binding.reader(r),a=n.binding.constraint?n.binding.constraint(r):void 0,l=new Dj({reader:o,target:e.target,writer:n.binding.writer(r)}),c=new b9(Jt(o(i.initialValue),{constraint:a,equals:n.binding.equals}),l),u=n.controller({constraint:a,document:e.document,initialValue:i.initialValue,params:i.params,value:c,viewProps:Ns.create({disabled:s==null?void 0:s.disabled,hidden:s==null?void 0:s.hidden})});return new U9(e.document,{blade:Pc(),props:vt.fromObject({label:"label"in e.params?(t=s==null?void 0:s.label)!==null&&t!==void 0?t:null:e.target.key}),tag:s==null?void 0:s.tag,value:c,valueController:u})}class Nj{constructor(e){this.target=e.target,this.reader_=e.reader}read(){return this.reader_(this.target.read())}}function Fj(n,e){return e===0?new vW:new _W(n,e!=null?e:qh.monitor.defaultInterval)}function kj(n,e){var t,i,r;const s=n.accept(e.target.read(),e.params);if(zt(s))return null;const o={target:e.target,initialValue:s.initialValue,params:s.params},a=tn(e.params,d=>({bufferSize:d.optional.number,disabled:d.optional.boolean,hidden:d.optional.boolean,interval:d.optional.number,label:d.optional.string})),l=n.binding.reader(o),c=(i=(t=a==null?void 0:a.bufferSize)!==null&&t!==void 0?t:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(s.params))!==null&&i!==void 0?i:1,u=new z9({binding:new Nj({reader:l,target:e.target}),bufferSize:c,ticker:Fj(e.document,a==null?void 0:a.interval)}),h=n.controller({document:e.document,params:s.params,value:u,viewProps:Ns.create({disabled:a==null?void 0:a.disabled,hidden:a==null?void 0:a.hidden})});return h.viewProps.bindDisabled(u.ticker),h.viewProps.handleDispose(()=>{u.ticker.dispose()}),new H9(e.document,{blade:Pc(),props:vt.fromObject({label:"label"in e.params?(r=a==null?void 0:a.label)!==null&&r!==void 0?r:null:e.target.key}),value:u,valueController:h})}class Bj{constructor(e){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=e}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e,t){if(!LW(t.core))throw cn.notCompatible(e,t.id);t.type==="blade"?this.pluginsMap_.blades.unshift(t):t.type==="input"?this.pluginsMap_.inputs.unshift(t):t.type==="monitor"&&this.pluginsMap_.monitors.unshift(t)}createInput_(e,t,i){return this.pluginsMap_.inputs.reduce((r,s)=>r!=null?r:Uj(s,{document:e,target:t,params:i}),null)}createMonitor_(e,t,i){return this.pluginsMap_.monitors.reduce((r,s)=>r!=null?r:kj(s,{document:e,params:i,target:t}),null)}createBinding(e,t,i){const r=t.read();if(zt(r))throw new cn({context:{key:t.key},type:"nomatchingcontroller"});const s=this.createInput_(e,t,i);if(s)return s;const o=this.createMonitor_(e,t,i);if(o)return o;throw new cn({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const i=this.pluginsMap_.blades.reduce((r,s)=>r!=null?r:gW(s,{document:e,params:t}),null);if(!i)throw new cn({type:"nomatchingview",context:{params:t}});return i}createInputBindingApi_(e){const t=this.pluginsMap_.inputs.reduce((i,r)=>{var s,o;return i||((o=(s=r.api)===null||s===void 0?void 0:s.call(r,{controller:e}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(e,t!=null?t:new Eh(e))}createMonitorBindingApi_(e){const t=this.pluginsMap_.monitors.reduce((i,r)=>{var s,o;return i||((o=(s=r.api)===null||s===void 0?void 0:s.call(r,{controller:e}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(e,t!=null?t:new Eh(e))}createBindingApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(N9(e))return this.createInputBindingApi_(e);if(G9(e))return this.createMonitorBindingApi_(e);throw cn.shouldNeverHappen()}createApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(D9(e))return this.createBindingApi(e);const t=this.pluginsMap_.blades.reduce((i,r)=>i!=null?i:r.api({controller:e,pool:this}),null);if(!t)throw cn.shouldNeverHappen();return this.apiCache_.add(e,t)}}const zj=new Ij;function Vj(){const n=new Bj(zj);return[fj,vj,xj,Mj,ij,J$,Z$,j$,UW,Tj,Oj,Lj,Y9,aW,N2].forEach(e=>{n.register("core",e)}),n}class Hj extends Ga{constructor(e){super(e),this.emitter_=new Sn,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Vh(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}}class Gj extends Ga{}class Wj extends Ga{constructor(e){super(e),this.emitter_=new Sn,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Vh(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}}class $j extends Ga{constructor(e){super(e),this.emitter_=new Sn,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Vh(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(e){this.controller.valueController.props.set("formatter",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,r=>{i(r)}),this}}const jj=function(){return{id:"list",type:"blade",core:Cc,accept(n){const e=tn(n,t=>({options:t.required.custom($h),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string}));return e?{params:e}:null},controller(n){const e=new Wh(zy(n.params.options)),t=Jt(n.params.value,{constraint:e}),i=new Ao(n.document,{props:new vt({options:e.values.value("options")}),value:t,viewProps:n.viewProps});return new Ia(n.document,{blade:n.blade,props:vt.fromObject({label:n.params.label}),value:t,valueController:i})},api(n){return!(n.controller instanceof Ia)||!(n.controller.valueController instanceof Ao)?null:new Hj(n.controller)}}}();class Xj extends D2{constructor(e,t){super(e,t)}get element(){return this.controller.view.element}}class Yj extends E0{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const XM=At("spr");class qj{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(XM()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("hr");i.classList.add(XM("r")),this.element.appendChild(i)}}class YM extends Sm{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new qj(e,{viewProps:t.viewProps})}))}}const Kj={id:"separator",type:"blade",core:Cc,accept(n){const e=tn(n,t=>({view:t.required.constant("separator")}));return e?{params:e}:null},controller(n){return new YM(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof YM?new Gj(n.controller):null}},Zj={id:"slider",type:"blade",core:Cc,accept(n){const e=tn(n,t=>({max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number}));return e?{params:e}:null},controller(n){var e,t;const i=(e=n.params.value)!==null&&e!==void 0?e:0,r=new zh({max:n.params.max,min:n.params.min}),s=Jt(i,{constraint:r}),o=new dp(n.document,Object.assign(Object.assign({},V2({formatter:(t=n.params.format)!==null&&t!==void 0?t:g9,keyScale:Jt(1),max:r.values.value("max"),min:r.values.value("min"),pointerScale:b2(n.params,i)})),{parser:Ls,value:s,viewProps:n.viewProps}));return new Ia(n.document,{blade:n.blade,props:vt.fromObject({label:n.params.label}),value:s,valueController:o})},api(n){return!(n.controller instanceof Ia)||!(n.controller.valueController instanceof dp)?null:new Wj(n.controller)}},Jj=function(){return{id:"text",type:"blade",core:Cc,accept(n){const e=tn(n,t=>({parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string}));return e?{params:e}:null},controller(n){var e;const t=Jt(n.params.value),i=new Sh(n.document,{parser:n.params.parse,props:vt.fromObject({formatter:(e=n.params.format)!==null&&e!==void 0?e:r=>String(r)}),value:t,viewProps:n.viewProps});return new Ia(n.document,{blade:n.blade,props:vt.fromObject({label:n.params.label}),value:t,valueController:i})},api(n){return!(n.controller instanceof Ia)||!(n.controller.valueController instanceof Sh)?null:new $j(n.controller)}}}();function Qj(n){const e=n.createElement("div");return e.classList.add(At("dfw")()),n.body&&n.body.appendChild(e),e}function eX(n,e,t){if(n.querySelector("style[data-tp-style=".concat(e,"]")))return;const i=n.createElement("style");i.dataset.tpStyle=e,i.textContent=t,n.head.appendChild(i)}class tX extends Xj{constructor(e){var t,i;const r=e!=null?e:{},s=(t=r.document)!==null&&t!==void 0?t:A9(),o=Vj(),a=new Yj(s,{expanded:r.expanded,blade:Pc(),props:vt.fromObject({title:r.title}),viewProps:Ns.create()});super(a,o),this.pool_=o,this.containerElem_=(i=r.container)!==null&&i!==void 0?i:Qj(s),this.containerElem_.appendChild(this.element),this.doc_=s,this.usesDefaultWrapper_=!r.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw cn.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw cn.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){e.css&&eX(this.document,"plugin-".concat(e.id),e.css),("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach(i=>{this.pool_.register(e.id,i)})}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1 * var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(		2px * 2 + var(--cnt-usz) + var(--cnt-hp)	);position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(		var(--cnt-hp) + (				var(--cnt-usz) + 4px - 6px			) / 2 - 2px	);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1 * var(--cnt-hp));right:calc(-1 * var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(			var(--cnt-vp) + 2px		);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1 * var(--cnt-hp));position:absolute;right:calc(-1 * var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz) * 3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz) * 3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1 * var(--cnt-hp));right:calc(-1 * var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(			var(--bld-hp) - 5px		);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(			2px * 2 + var(--cnt-usz) + var(--cnt-hp)		);text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1 * var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1 * var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[jj,Kj,Zj,N2,Jj]})}}new I2("4.0.1");var nX=Object.defineProperty,iX=(n,e,t)=>e in n?nX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,wn=(n,e,t)=>(iX(n,typeof e!="symbol"?e+"":e,t),t);function qM(n,e){if(e===jA)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===rp||e===Y_){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(t)if(e===rp)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const rX=parseInt(_c.replace(/\D+/g,""));var Ji=Uint8Array,uo=Uint16Array,C0=Uint32Array,mP=new Ji([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),gP=new Ji([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),sX=new Ji([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vP=function(n,e){for(var t=new uo(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new C0(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]},_P=vP(mP,2),yP=_P[0],oX=_P[1];yP[28]=258,oX[258]=28;var aX=vP(gP,0),lX=aX[0],P0=new uo(32768);for(var jt=0;jt<32768;++jt){var Zs=(jt&43690)>>>1|(jt&21845)<<1;Zs=(Zs&52428)>>>2|(Zs&13107)<<2,Zs=(Zs&61680)>>>4|(Zs&3855)<<4,P0[jt]=((Zs&65280)>>>8|(Zs&255)<<8)>>>1}var Nu=function(n,e,t){for(var i=n.length,r=0,s=new uo(e);r<i;++r)++s[n[r]-1];var o=new uo(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(t){a=new uo(1<<e);var l=15-e;for(r=0;r<i;++r)if(n[r])for(var c=r<<4|n[r],u=e-n[r],h=o[n[r]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[P0[h]>>>l]=c}else for(a=new uo(i),r=0;r<i;++r)n[r]&&(a[r]=P0[o[n[r]-1]++]>>>15-n[r]);return a},Kh=new Ji(288);for(var jt=0;jt<144;++jt)Kh[jt]=8;for(var jt=144;jt<256;++jt)Kh[jt]=9;for(var jt=256;jt<280;++jt)Kh[jt]=7;for(var jt=280;jt<288;++jt)Kh[jt]=8;var bP=new Ji(32);for(var jt=0;jt<32;++jt)bP[jt]=5;var cX=Nu(Kh,9,1),uX=Nu(bP,5,1),Bg=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},hr=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},zg=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},hX=function(n){return(n/8|0)+(n&7&&1)},dX=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof uo?uo:n instanceof C0?C0:Ji)(t-e);return i.set(n.subarray(e,t)),i},fX=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new Ji(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new Ji(i*3));var o=function(Ie){var Q=e.length;if(Ie>Q){var K=new Ji(Math.max(Q*2,Ie));K.set(e),e=K}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,h=t.d,d=t.m,f=t.n,p=i*8;do{if(!u){t.f=a=hr(n,l,1);var v=hr(n,l+1,3);if(l+=3,v)if(v==1)u=cX,h=uX,d=9,f=5;else if(v==2){var m=hr(n,l,31)+257,g=hr(n,l+10,15)+4,b=m+hr(n,l+5,31)+1;l+=14;for(var y=new Ji(b),_=new Ji(19),T=0;T<g;++T)_[sX[T]]=hr(n,l+T*3,7);l+=g*3;for(var w=Bg(_),S=(1<<w)-1,x=Nu(_,w,1),T=0;T<b;){var M=x[hr(n,l,S)];l+=M&15;var E=M>>>4;if(E<16)y[T++]=E;else{var C=0,O=0;for(E==16?(O=3+hr(n,l,3),l+=2,C=y[T-1]):E==17?(O=3+hr(n,l,7),l+=3):E==18&&(O=11+hr(n,l,127),l+=7);O--;)y[T++]=C}}var $=y.subarray(0,m),U=y.subarray(m);d=Bg($),f=Bg(U),u=Nu($,d,1),h=Nu(U,f,1)}else throw"invalid block type";else{var E=hX(l)+4,j=n[E-4]|n[E-3]<<8,W=E+j;if(W>i){if(s)throw"unexpected EOF";break}r&&o(c+j),e.set(n.subarray(E,W),c),t.b=c+=j,t.p=l=W*8;continue}if(l>p){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var q=(1<<d)-1,ie=(1<<f)-1,Z=l;;Z=l){var C=u[zg(n,l)&q],te=C>>>4;if(l+=C&15,l>p){if(s)throw"unexpected EOF";break}if(!C)throw"invalid length/literal";if(te<256)e[c++]=te;else if(te==256){Z=l,u=null;break}else{var X=te-254;if(te>264){var T=te-257,se=mP[T];X=hr(n,l,(1<<se)-1)+yP[T],l+=se}var G=h[zg(n,l)&ie],xe=G>>>4;if(!G)throw"invalid distance";l+=G&15;var U=lX[xe];if(xe>3){var se=gP[xe];U+=zg(n,l)&(1<<se)-1,l+=se}if(l>p){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var Re=c+X;c<Re;c+=4)e[c]=e[c-U],e[c+1]=e[c+1-U],e[c+2]=e[c+2-U],e[c+3]=e[c+3-U];c=Re}}t.l=u,t.p=Z,t.b=c,u&&(a=1,t.m=d,t.d=h,t.n=f)}while(!a);return c==e.length?e:dX(e,0,c)},pX=new Ji(0),mX=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function gX(n,e){return fX((mX(n),n.subarray(2,-4)),e)}var vX=typeof TextDecoder<"u"&&new TextDecoder,_X=0;try{vX.decode(pX,{stream:!0}),_X=1}catch(n){}var yX=Object.defineProperty,bX=(n,e,t)=>e in n?yX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,fe=(n,e,t)=>(bX(n,typeof e!="symbol"?e+"":e,t),t);class xX extends pt{constructor(e,t){super(),fe(this,"isTransformControls",!0),fe(this,"visible",!1),fe(this,"domElement"),fe(this,"raycaster",new wm),fe(this,"gizmo"),fe(this,"plane"),fe(this,"tempVector",new D),fe(this,"tempVector2",new D),fe(this,"tempQuaternion",new mt),fe(this,"unit",{X:new D(1,0,0),Y:new D(0,1,0),Z:new D(0,0,1)}),fe(this,"pointStart",new D),fe(this,"pointEnd",new D),fe(this,"offset",new D),fe(this,"rotationAxis",new D),fe(this,"startNorm",new D),fe(this,"endNorm",new D),fe(this,"rotationAngle",0),fe(this,"cameraPosition",new D),fe(this,"cameraQuaternion",new mt),fe(this,"cameraScale",new D),fe(this,"parentPosition",new D),fe(this,"parentQuaternion",new mt),fe(this,"parentQuaternionInv",new mt),fe(this,"parentScale",new D),fe(this,"worldPositionStart",new D),fe(this,"worldQuaternionStart",new mt),fe(this,"worldScaleStart",new D),fe(this,"worldPosition",new D),fe(this,"worldQuaternion",new mt),fe(this,"worldQuaternionInv",new mt),fe(this,"worldScale",new D),fe(this,"eye",new D),fe(this,"positionStart",new D),fe(this,"quaternionStart",new mt),fe(this,"scaleStart",new D),fe(this,"camera"),fe(this,"object"),fe(this,"enabled",!0),fe(this,"axis",null),fe(this,"mode","translate"),fe(this,"translationSnap",null),fe(this,"rotationSnap",null),fe(this,"scaleSnap",null),fe(this,"space","world"),fe(this,"size",1),fe(this,"dragging",!1),fe(this,"showX",!0),fe(this,"showY",!0),fe(this,"showZ",!0),fe(this,"changeEvent",{type:"change"}),fe(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),fe(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),fe(this,"objectChangeEvent",{type:"objectChange"}),fe(this,"intersectObjectWithRay",(r,s,o)=>{const a=s.intersectObject(r,!0);for(let l=0;l<a.length;l++)if(a[l].object.visible||o)return a[l];return!1}),fe(this,"attach",r=>(this.object=r,this.visible=!0,this)),fe(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),fe(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),fe(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),fe(this,"pointerHover",r=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera(r,this.camera);const s=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);s?this.axis=s.object.name:this.axis=null}),fe(this,"pointerDown",r=>{if(!(this.object===void 0||this.dragging===!0||r.button!==0)&&this.axis!==null){this.raycaster.setFromCamera(r,this.camera);const s=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(s){let o=this.space;if(this.mode==="scale"?o="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(o="world"),o==="local"&&this.mode==="rotate"){const a=this.rotationSnap;this.axis==="X"&&a&&(this.object.rotation.x=Math.round(this.object.rotation.x/a)*a),this.axis==="Y"&&a&&(this.object.rotation.y=Math.round(this.object.rotation.y/a)*a),this.axis==="Z"&&a&&(this.object.rotation.z=Math.round(this.object.rotation.z/a)*a)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(s.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),fe(this,"pointerMove",r=>{const s=this.axis,o=this.mode,a=this.object;let l=this.space;if(o==="scale"?l="local":(s==="E"||s==="XYZE"||s==="XYZ")&&(l="world"),a===void 0||s===null||this.dragging===!1||r.button!==-1)return;this.raycaster.setFromCamera(r,this.camera);const c=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(c){if(this.pointEnd.copy(c.point).sub(this.worldPositionStart),o==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),l==="local"&&s!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),s.indexOf("X")===-1&&(this.offset.x=0),s.indexOf("Y")===-1&&(this.offset.y=0),s.indexOf("Z")===-1&&(this.offset.z=0),l==="local"&&s!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),a.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(l==="local"&&(a.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),s.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),s.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),s.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.position.applyQuaternion(this.quaternionStart)),l==="world"&&(a.parent&&a.position.add(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld)),s.search("X")!==-1&&(a.position.x=Math.round(a.position.x/this.translationSnap)*this.translationSnap),s.search("Y")!==-1&&(a.position.y=Math.round(a.position.y/this.translationSnap)*this.translationSnap),s.search("Z")!==-1&&(a.position.z=Math.round(a.position.z/this.translationSnap)*this.translationSnap),a.parent&&a.position.sub(this.tempVector.setFromMatrixPosition(a.parent.matrixWorld))));else if(o==="scale"){if(s.search("XYZ")!==-1){let u=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(u*=-1),this.tempVector2.set(u,u,u)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),s.search("X")===-1&&(this.tempVector2.x=1),s.search("Y")===-1&&(this.tempVector2.y=1),s.search("Z")===-1&&(this.tempVector2.z=1);a.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(s.search("X")!==-1&&(this.object.scale.x=Math.round(a.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),s.search("Y")!==-1&&(a.scale.y=Math.round(a.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),s.search("Z")!==-1&&(a.scale.z=Math.round(a.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(o==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const u=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));s==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):s==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*u):(s==="X"||s==="Y"||s==="Z")&&(this.rotationAxis.copy(this.unit[s]),this.tempVector.copy(this.unit[s]),l==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*u),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),l==="local"&&s!=="E"&&s!=="XYZE"?(a.quaternion.copy(this.quaternionStart),a.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),a.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),a.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),fe(this,"pointerUp",r=>{r.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),fe(this,"getPointer",r=>{var s,o;if(this.domElement&&(s=this.domElement.ownerDocument)!=null&&s.pointerLockElement)return{x:0,y:0,button:r.button};{const a=r.changedTouches?r.changedTouches[0]:r,l=(o=this.domElement)==null?void 0:o.getBoundingClientRect();return{x:(a.clientX-l.left)/l.width*2-1,y:-(a.clientY-l.top)/l.height*2+1,button:r.button}}}),fe(this,"onPointerHover",r=>{if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(r));break}}),fe(this,"onPointerDown",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(r)),this.pointerDown(this.getPointer(r)))}),fe(this,"onPointerMove",r=>{this.enabled&&this.pointerMove(this.getPointer(r))}),fe(this,"onPointerUp",r=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(r)))}),fe(this,"getMode",()=>this.mode),fe(this,"setMode",r=>{this.mode=r}),fe(this,"setTranslationSnap",r=>{this.translationSnap=r}),fe(this,"setRotationSnap",r=>{this.rotationSnap=r}),fe(this,"setScaleSnap",r=>{this.scaleSnap=r}),fe(this,"setSize",r=>{this.size=r}),fe(this,"setSpace",r=>{this.space=r}),fe(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),fe(this,"connect",r=>{r===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=r,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),fe(this,"dispose",()=>{var r,s,o,a,l,c;(r=this.domElement)==null||r.removeEventListener("pointerdown",this.onPointerDown),(s=this.domElement)==null||s.removeEventListener("pointermove",this.onPointerHover),(a=(o=this.domElement)==null?void 0:o.ownerDocument)==null||a.removeEventListener("pointermove",this.onPointerMove),(c=(l=this.domElement)==null?void 0:l.ownerDocument)==null||c.removeEventListener("pointerup",this.onPointerUp),this.traverse(u=>{const h=u;h.geometry&&h.geometry.dispose(),h.material&&h.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new wX,this.add(this.gizmo),this.plane=new MX,this.add(this.plane);const i=(r,s)=>{let o=s;Object.defineProperty(this,r,{get:function(){return o!==void 0?o:s},set:function(a){o!==a&&(o=a,this.plane[r]=a,this.gizmo[r]=a,this.dispatchEvent({type:r+"-changed",value:a}),this.dispatchEvent(this.changeEvent))}}),this[r]=s,this.plane[r]=s,this.gizmo[r]=s};i("camera",this.camera),i("object",this.object),i("enabled",this.enabled),i("axis",this.axis),i("mode",this.mode),i("translationSnap",this.translationSnap),i("rotationSnap",this.rotationSnap),i("scaleSnap",this.scaleSnap),i("space",this.space),i("size",this.size),i("dragging",this.dragging),i("showX",this.showX),i("showY",this.showY),i("showZ",this.showZ),i("worldPosition",this.worldPosition),i("worldPositionStart",this.worldPositionStart),i("worldQuaternion",this.worldQuaternion),i("worldQuaternionStart",this.worldQuaternionStart),i("cameraPosition",this.cameraPosition),i("cameraQuaternion",this.cameraQuaternion),i("pointStart",this.pointStart),i("pointEnd",this.pointEnd),i("rotationAxis",this.rotationAxis),i("rotationAngle",this.rotationAngle),i("eye",this.eye),t!==void 0&&this.connect(t)}}class wX extends pt{constructor(){super(),fe(this,"isTransformControlsGizmo",!0),fe(this,"type","TransformControlsGizmo"),fe(this,"tempVector",new D(0,0,0)),fe(this,"tempEuler",new tr),fe(this,"alignVector",new D(0,1,0)),fe(this,"zeroVector",new D(0,0,0)),fe(this,"lookAtMatrix",new Be),fe(this,"tempQuaternion",new mt),fe(this,"tempQuaternion2",new mt),fe(this,"identityQuaternion",new mt),fe(this,"unitX",new D(1,0,0)),fe(this,"unitY",new D(0,1,0)),fe(this,"unitZ",new D(0,0,1)),fe(this,"gizmo"),fe(this,"picker"),fe(this,"helper"),fe(this,"rotationAxis",new D),fe(this,"cameraPosition",new D),fe(this,"worldPositionStart",new D),fe(this,"worldQuaternionStart",new mt),fe(this,"worldPosition",new D),fe(this,"worldQuaternion",new mt),fe(this,"eye",new D),fe(this,"camera",null),fe(this,"enabled",!0),fe(this,"axis",null),fe(this,"mode","translate"),fe(this,"space","world"),fe(this,"size",1),fe(this,"dragging",!1),fe(this,"showX",!0),fe(this,"showY",!0),fe(this,"showZ",!0),fe(this,"updateMatrixWorld",()=>{let Z=this.space;this.mode==="scale"&&(Z="local");const te=Z==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let X=[];X=X.concat(this.picker[this.mode].children),X=X.concat(this.gizmo[this.mode].children),X=X.concat(this.helper[this.mode].children);for(let se=0;se<X.length;se++){const G=X[se];G.visible=!0,G.rotation.set(0,0,0),G.position.copy(this.worldPosition);let xe;if(this.camera.isOrthographicCamera?xe=(this.camera.top-this.camera.bottom)/this.camera.zoom:xe=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),G.scale.set(1,1,1).multiplyScalar(xe*this.size/7),G.tag==="helper"){G.visible=!1,G.name==="AXIS"?(G.position.copy(this.worldPositionStart),G.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),G.quaternion.copy(te).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(te).dot(this.eye))>.9&&(G.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),G.quaternion.copy(te).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(te).dot(this.eye))>.9&&(G.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),G.quaternion.copy(te).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(te).dot(this.eye))>.9&&(G.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),G.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),G.quaternion.multiply(this.tempQuaternion),G.visible=this.dragging),this.axis==="E"&&(G.visible=!1)):G.name==="START"?(G.position.copy(this.worldPositionStart),G.visible=this.dragging):G.name==="END"?(G.position.copy(this.worldPosition),G.visible=this.dragging):G.name==="DELTA"?(G.position.copy(this.worldPositionStart),G.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),G.scale.copy(this.tempVector),G.visible=this.dragging):(G.quaternion.copy(te),this.dragging?G.position.copy(this.worldPositionStart):G.position.copy(this.worldPosition),this.axis&&(G.visible=this.axis.search(G.name)!==-1));continue}G.quaternion.copy(te),this.mode==="translate"||this.mode==="scale"?((G.name==="X"||G.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(te).dot(this.eye))>.99&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),(G.name==="Y"||G.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(te).dot(this.eye))>.99&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),(G.name==="Z"||G.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(te).dot(this.eye))>.99&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),G.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(te).dot(this.eye))<.2&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),G.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(te).dot(this.eye))<.2&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),G.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(te).dot(this.eye))<.2&&(G.scale.set(1e-10,1e-10,1e-10),G.visible=!1),G.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(te).dot(this.eye)<0?G.tag==="fwd"?G.visible=!1:G.scale.x*=-1:G.tag==="bwd"&&(G.visible=!1)),G.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(te).dot(this.eye)<0?G.tag==="fwd"?G.visible=!1:G.scale.y*=-1:G.tag==="bwd"&&(G.visible=!1)),G.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(te).dot(this.eye)<0?G.tag==="fwd"?G.visible=!1:G.scale.z*=-1:G.tag==="bwd"&&(G.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(te),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(te).invert()),G.name.search("E")!==-1&&G.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),G.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),G.quaternion.copy(this.tempQuaternion)),G.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),G.quaternion.copy(this.tempQuaternion)),G.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),G.quaternion.copy(this.tempQuaternion))),G.visible=G.visible&&(G.name.indexOf("X")===-1||this.showX),G.visible=G.visible&&(G.name.indexOf("Y")===-1||this.showY),G.visible=G.visible&&(G.name.indexOf("Z")===-1||this.showZ),G.visible=G.visible&&(G.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),G.material.tempOpacity=G.material.tempOpacity||G.material.opacity,G.material.tempColor=G.material.tempColor||G.material.color.clone(),G.material.color.copy(G.material.tempColor),G.material.opacity=G.material.tempOpacity,this.enabled?this.axis&&(G.name===this.axis?(G.material.opacity=1,G.material.color.lerp(new Oe(1,1,1),.5)):this.axis.split("").some(function(Re){return G.name===Re})?(G.material.opacity=1,G.material.color.lerp(new Oe(1,1,1),.5)):(G.material.opacity*=.25,G.material.color.lerp(new Oe(1,1,1),.5))):(G.material.opacity*=.5,G.material.color.lerp(new Oe(1,1,1),.5))}super.updateMatrixWorld()});const e=new Xn({depthTest:!1,depthWrite:!1,transparent:!0,side:vi,fog:!1,toneMapped:!1}),t=new Nn({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),i=e.clone();i.opacity=.15;const r=e.clone();r.opacity=.33;const s=e.clone();s.color.set(16711680);const o=e.clone();o.color.set(65280);const a=e.clone();a.color.set(255);const l=e.clone();l.opacity=.25;const c=l.clone();c.color.set(16776960);const u=l.clone();u.color.set(65535);const h=l.clone();h.color.set(16711935),e.clone().color.set(16776960);const d=t.clone();d.color.set(16711680);const f=t.clone();f.color.set(65280);const p=t.clone();p.color.set(255);const v=t.clone();v.color.set(65535);const m=t.clone();m.color.set(16711935);const g=t.clone();g.color.set(16776960);const b=t.clone();b.color.set(7895160);const y=g.clone();y.opacity=.25;const _=new kn(0,.05,.2,12,1,!1),T=new si(.125,.125,.125),w=new Ye;w.setAttribute("position",new Ve([0,0,0,1,0,0],3));const S=(Z,te)=>{const X=new Ye,se=[];for(let G=0;G<=64*te;++G)se.push(0,Math.cos(G/32*Math.PI)*Z,Math.sin(G/32*Math.PI)*Z);return X.setAttribute("position",new Ve(se,3)),X},x=()=>{const Z=new Ye;return Z.setAttribute("position",new Ve([0,0,0,1,1,1],3)),Z},M={X:[[new ke(_,s),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new ke(_,s),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new lt(w,d)]],Y:[[new ke(_,o),[0,1,0],null,null,"fwd"],[new ke(_,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new lt(w,f),null,[0,0,Math.PI/2]]],Z:[[new ke(_,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new ke(_,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new lt(w,p),null,[0,-Math.PI/2,0]]],XYZ:[[new ke(new Ki(.1,0),l.clone()),[0,0,0],[0,0,0]]],XY:[[new ke(new Oi(.295,.295),c.clone()),[.15,.15,0]],[new lt(w,g),[.18,.3,0],null,[.125,1,1]],[new lt(w,g),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new ke(new Oi(.295,.295),u.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new lt(w,v),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new lt(w,v),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new ke(new Oi(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new lt(w,m),[.18,0,.3],null,[.125,1,1]],[new lt(w,m),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},E={X:[[new ke(new kn(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new ke(new kn(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new ke(new kn(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new ke(new Ki(.2,0),i)]],XY:[[new ke(new Oi(.4,.4),i),[.2,.2,0]]],YZ:[[new ke(new Oi(.4,.4),i),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new ke(new Oi(.4,.4),i),[.2,0,.2],[-Math.PI/2,0,0]]]},C={START:[[new ke(new Ki(.01,2),r),null,null,null,"helper"]],END:[[new ke(new Ki(.01,2),r),null,null,null,"helper"]],DELTA:[[new lt(x(),r),null,null,null,"helper"]],X:[[new lt(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new lt(w,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new lt(w,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},O={X:[[new lt(S(1,.5),d)],[new ke(new Ki(.04,0),s),[0,0,.99],null,[1,3,1]]],Y:[[new lt(S(1,.5),f),null,[0,0,-Math.PI/2]],[new ke(new Ki(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new lt(S(1,.5),p),null,[0,Math.PI/2,0]],[new ke(new Ki(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new lt(S(1.25,1),y),null,[0,Math.PI/2,0]],[new ke(new kn(.03,0,.15,4,1,!1),y),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new ke(new kn(.03,0,.15,4,1,!1),y),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new ke(new kn(.03,0,.15,4,1,!1),y),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new ke(new kn(.03,0,.15,4,1,!1),y),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new lt(S(1,1),b),null,[0,Math.PI/2,0]]]},$={AXIS:[[new lt(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},U={X:[[new ke(new lo(1,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new ke(new lo(1,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new ke(new lo(1,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new ke(new lo(1.25,.1,2,24),i)]],XYZE:[[new ke(new Mc(.7,10,8),i)]]},j={X:[[new ke(T,s),[.8,0,0],[0,0,-Math.PI/2]],[new lt(w,d),null,null,[.8,1,1]]],Y:[[new ke(T,o),[0,.8,0]],[new lt(w,f),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new ke(T,a),[0,0,.8],[Math.PI/2,0,0]],[new lt(w,p),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new ke(T,c),[.85,.85,0],null,[2,2,.2]],[new lt(w,g),[.855,.98,0],null,[.125,1,1]],[new lt(w,g),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new ke(T,u),[0,.85,.85],null,[.2,2,2]],[new lt(w,v),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new lt(w,v),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new ke(T,h),[.85,0,.85],null,[2,.2,2]],[new lt(w,m),[.855,0,.98],null,[.125,1,1]],[new lt(w,m),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new ke(new si(.125,.125,.125),l.clone()),[1.1,0,0]]],XYZY:[[new ke(new si(.125,.125,.125),l.clone()),[0,1.1,0]]],XYZZ:[[new ke(new si(.125,.125,.125),l.clone()),[0,0,1.1]]]},W={X:[[new ke(new kn(.2,0,.8,4,1,!1),i),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new ke(new kn(.2,0,.8,4,1,!1),i),[0,.5,0]]],Z:[[new ke(new kn(.2,0,.8,4,1,!1),i),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new ke(T,i),[.85,.85,0],null,[3,3,.2]]],YZ:[[new ke(T,i),[0,.85,.85],null,[.2,3,3]]],XZ:[[new ke(T,i),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new ke(new si(.2,.2,.2),i),[1.1,0,0]]],XYZY:[[new ke(new si(.2,.2,.2),i),[0,1.1,0]]],XYZZ:[[new ke(new si(.2,.2,.2),i),[0,0,1.1]]]},q={X:[[new lt(w,r.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new lt(w,r.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new lt(w,r.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},ie=Z=>{const te=new pt;for(let X in Z)for(let se=Z[X].length;se--;){const G=Z[X][se][0].clone(),xe=Z[X][se][1],Re=Z[X][se][2],Ie=Z[X][se][3],Q=Z[X][se][4];G.name=X,G.tag=Q,xe&&G.position.set(xe[0],xe[1],xe[2]),Re&&G.rotation.set(Re[0],Re[1],Re[2]),Ie&&G.scale.set(Ie[0],Ie[1],Ie[2]),G.updateMatrix();const K=G.geometry.clone();K.applyMatrix4(G.matrix),G.geometry=K,G.renderOrder=1/0,G.position.set(0,0,0),G.rotation.set(0,0,0),G.scale.set(1,1,1),te.add(G)}return te};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ie(M)),this.add(this.gizmo.rotate=ie(O)),this.add(this.gizmo.scale=ie(j)),this.add(this.picker.translate=ie(E)),this.add(this.picker.rotate=ie(U)),this.add(this.picker.scale=ie(W)),this.add(this.helper.translate=ie(C)),this.add(this.helper.rotate=ie($)),this.add(this.helper.scale=ie(q)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class MX extends ke{constructor(){super(new Oi(1e5,1e5,2,2),new Xn({visible:!1,wireframe:!0,side:vi,transparent:!0,opacity:.1,toneMapped:!1})),fe(this,"isTransformControlsPlane",!0),fe(this,"type","TransformControlsPlane"),fe(this,"unitX",new D(1,0,0)),fe(this,"unitY",new D(0,1,0)),fe(this,"unitZ",new D(0,0,1)),fe(this,"tempVector",new D),fe(this,"dirVector",new D),fe(this,"alignVector",new D),fe(this,"tempMatrix",new Be),fe(this,"identityQuaternion",new mt),fe(this,"cameraQuaternion",new mt),fe(this,"worldPosition",new D),fe(this,"worldQuaternion",new mt),fe(this,"eye",new D),fe(this,"axis",null),fe(this,"mode","translate"),fe(this,"space","world"),fe(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),this.unitX.set(1,0,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}var EX=Object.defineProperty,SX=(n,e,t)=>e in n?EX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Tn=(n,e,t)=>(SX(n,typeof e!="symbol"?e+"":e,t),t);const bl=new tr(0,0,0,"YXZ"),xl=new D,TX={type:"change"},AX={type:"lock"},CX={type:"unlock"},KM=Math.PI/2;class R0 extends Lr{constructor(e,t){super(),Tn(this,"camera"),Tn(this,"domElement"),Tn(this,"isLocked"),Tn(this,"minPolarAngle"),Tn(this,"maxPolarAngle"),Tn(this,"pointerSpeed"),Tn(this,"onMouseMove",i=>{if(!this.domElement||this.isLocked===!1)return;const r=i.movementX||i.mozMovementX||i.webkitMovementX||0,s=i.movementY||i.mozMovementY||i.webkitMovementY||0;bl.setFromQuaternion(this.camera.quaternion),bl.y-=r*.002*this.pointerSpeed,bl.x-=s*.002*this.pointerSpeed,bl.x=Math.max(KM-this.maxPolarAngle,Math.min(KM-this.minPolarAngle,bl.x)),this.camera.quaternion.setFromEuler(bl),this.dispatchEvent(TX)}),Tn(this,"onPointerlockChange",()=>{this.domElement&&(this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(AX),this.isLocked=!0):(this.dispatchEvent(CX),this.isLocked=!1))}),Tn(this,"onPointerlockError",()=>{console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}),Tn(this,"connect",i=>{this.domElement=i||this.domElement,this.domElement&&(this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError))}),Tn(this,"disconnect",()=>{this.domElement&&(this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError))}),Tn(this,"dispose",()=>{this.disconnect()}),Tn(this,"getObject",()=>this.camera),Tn(this,"direction",new D(0,0,-1)),Tn(this,"getDirection",i=>i.copy(this.direction).applyQuaternion(this.camera.quaternion)),Tn(this,"moveForward",i=>{xl.setFromMatrixColumn(this.camera.matrix,0),xl.crossVectors(this.camera.up,xl),this.camera.position.addScaledVector(xl,i)}),Tn(this,"moveRight",i=>{xl.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(xl,i)}),Tn(this,"lock",()=>{this.domElement&&this.domElement.requestPointerLock()}),Tn(this,"unlock",()=>{this.domElement&&this.domElement.ownerDocument.exitPointerLock()}),this.camera=e,this.domElement=t,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,t&&this.connect(t)}}var PX=Object.defineProperty,RX=(n,e,t)=>e in n?PX(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Ke=(n,e,t)=>(RX(n,typeof e!="symbol"?e+"":e,t),t);const df=new Ba,ZM=new gs,LX=Math.cos(70*(Math.PI/180)),JM=(n,e)=>(n%e+e)%e;class xP extends Lr{constructor(e,t){super(),Ke(this,"object"),Ke(this,"domElement"),Ke(this,"enabled",!0),Ke(this,"target",new D),Ke(this,"minDistance",0),Ke(this,"maxDistance",1/0),Ke(this,"minZoom",0),Ke(this,"maxZoom",1/0),Ke(this,"minPolarAngle",0),Ke(this,"maxPolarAngle",Math.PI),Ke(this,"minAzimuthAngle",-1/0),Ke(this,"maxAzimuthAngle",1/0),Ke(this,"enableDamping",!1),Ke(this,"dampingFactor",.05),Ke(this,"enableZoom",!0),Ke(this,"zoomSpeed",1),Ke(this,"enableRotate",!0),Ke(this,"rotateSpeed",1),Ke(this,"enablePan",!0),Ke(this,"panSpeed",1),Ke(this,"screenSpacePanning",!0),Ke(this,"keyPanSpeed",7),Ke(this,"zoomToCursor",!1),Ke(this,"autoRotate",!1),Ke(this,"autoRotateSpeed",2),Ke(this,"reverseOrbit",!1),Ke(this,"reverseHorizontalOrbit",!1),Ke(this,"reverseVerticalOrbit",!1),Ke(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ke(this,"mouseButtons",{LEFT:ms.ROTATE,MIDDLE:ms.DOLLY,RIGHT:ms.PAN}),Ke(this,"touches",{ONE:mr.ROTATE,TWO:mr.DOLLY_PAN}),Ke(this,"target0"),Ke(this,"position0"),Ke(this,"zoom0"),Ke(this,"_domElementKeyEvents",null),Ke(this,"getPolarAngle"),Ke(this,"getAzimuthalAngle"),Ke(this,"setPolarAngle"),Ke(this,"setAzimuthalAngle"),Ke(this,"getDistance"),Ke(this,"listenToKeyEvents"),Ke(this,"stopListenToKeyEvents"),Ke(this,"saveState"),Ke(this,"reset"),Ke(this,"update"),Ke(this,"connect"),Ke(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=Y=>{let de=JM(Y,2*Math.PI),Se=u.phi;Se<0&&(Se+=2*Math.PI),de<0&&(de+=2*Math.PI);let z=Math.abs(de-Se);2*Math.PI-z<z&&(de<Se?de+=2*Math.PI:Se+=2*Math.PI),h.phi=de-Se,i.update()},this.setAzimuthalAngle=Y=>{let de=JM(Y,2*Math.PI),Se=u.theta;Se<0&&(Se+=2*Math.PI),de<0&&(de+=2*Math.PI);let z=Math.abs(de-Se);2*Math.PI-z<z&&(de<Se?de+=2*Math.PI:Se+=2*Math.PI),h.theta=de-Se,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Y=>{Y.addEventListener("keydown",ye),this._domElementKeyEvents=Y},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ye),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const Y=new D,de=new D(0,1,0),Se=new mt().setFromUnitVectors(e.up,de),z=Se.clone().invert(),Ce=new D,Pe=new mt,ze=2*Math.PI;return function(){const Fe=i.object.position;Se.setFromUnitVectors(e.up,de),z.copy(Se).invert(),Y.copy(Fe).sub(i.target),Y.applyQuaternion(Se),u.setFromVector3(Y),i.autoRotate&&l===a.NONE&&U(O()),i.enableDamping?(u.theta+=h.theta*i.dampingFactor,u.phi+=h.phi*i.dampingFactor):(u.theta+=h.theta,u.phi+=h.phi);let Me=i.minAzimuthAngle,He=i.maxAzimuthAngle;isFinite(Me)&&isFinite(He)&&(Me<-Math.PI?Me+=ze:Me>Math.PI&&(Me-=ze),He<-Math.PI?He+=ze:He>Math.PI&&(He-=ze),Me<=He?u.theta=Math.max(Me,Math.min(He,u.theta)):u.theta=u.theta>(Me+He)/2?Math.max(Me,u.theta):Math.min(He,u.theta)),u.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,u.phi)),u.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),i.zoomToCursor&&M||i.object.isOrthographicCamera?u.radius=se(u.radius):u.radius=se(u.radius*d),Y.setFromSpherical(u),Y.applyQuaternion(z),Fe.copy(i.target).add(Y),i.object.lookAt(i.target),i.enableDamping===!0?(h.theta*=1-i.dampingFactor,h.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(h.set(0,0,0),f.set(0,0,0));let Qe=!1;if(i.zoomToCursor&&M){let un=null;if(i.object instanceof Nt&&i.object.isPerspectiveCamera){const Rt=Y.length();un=se(Rt*d);const Jn=Rt-un;i.object.position.addScaledVector(S,Jn),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Rt=new D(x.x,x.y,0);Rt.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix(),Qe=!0;const Jn=new D(x.x,x.y,0);Jn.unproject(i.object),i.object.position.sub(Jn).add(Rt),i.object.updateMatrixWorld(),un=Y.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;un!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(un).add(i.object.position):(df.origin.copy(i.object.position),df.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(df.direction))<LX?e.lookAt(i.target):(ZM.setFromNormalAndCoplanarPoint(i.object.up,i.target),df.intersectPlane(ZM,i.target))))}else i.object instanceof Ni&&i.object.isOrthographicCamera&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/d)),i.object.updateProjectionMatrix(),Qe=!0);return d=1,M=!1,Qe||Ce.distanceToSquared(i.object.position)>c||8*(1-Pe.dot(i.object.quaternion))>c?(i.dispatchEvent(r),Ce.copy(i.object.position),Pe.copy(i.object.quaternion),Qe=!1,!0):!1}})(),this.connect=Y=>{Y===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=Y,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Ne),i.domElement.addEventListener("pointerdown",ae),i.domElement.addEventListener("pointercancel",L),i.domElement.addEventListener("wheel",he)},this.dispose=()=>{var Y,de,Se,z,Ce,Pe;(Y=i.domElement)==null||Y.removeEventListener("contextmenu",Ne),(de=i.domElement)==null||de.removeEventListener("pointerdown",ae),(Se=i.domElement)==null||Se.removeEventListener("pointercancel",L),(z=i.domElement)==null||z.removeEventListener("wheel",he),(Ce=i.domElement)==null||Ce.ownerDocument.removeEventListener("pointermove",Ee),(Pe=i.domElement)==null||Pe.ownerDocument.removeEventListener("pointerup",N),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",ye)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new yh,h=new yh;let d=1;const f=new D,p=new me,v=new me,m=new me,g=new me,b=new me,y=new me,_=new me,T=new me,w=new me,S=new D,x=new me;let M=!1;const E=[],C={};function O(){return 2*Math.PI/60/60*i.autoRotateSpeed}function $(){return Math.pow(.95,i.zoomSpeed)}function U(Y){i.reverseOrbit||i.reverseHorizontalOrbit?h.theta+=Y:h.theta-=Y}function j(Y){i.reverseOrbit||i.reverseVerticalOrbit?h.phi+=Y:h.phi-=Y}const W=(()=>{const Y=new D;return function(de,Se){Y.setFromMatrixColumn(Se,0),Y.multiplyScalar(-de),f.add(Y)}})(),q=(()=>{const Y=new D;return function(de,Se){i.screenSpacePanning===!0?Y.setFromMatrixColumn(Se,1):(Y.setFromMatrixColumn(Se,0),Y.crossVectors(i.object.up,Y)),Y.multiplyScalar(de),f.add(Y)}})(),ie=(()=>{const Y=new D;return function(de,Se){const z=i.domElement;if(z&&i.object instanceof Nt&&i.object.isPerspectiveCamera){const Ce=i.object.position;Y.copy(Ce).sub(i.target);let Pe=Y.length();Pe*=Math.tan(i.object.fov/2*Math.PI/180),W(2*de*Pe/z.clientHeight,i.object.matrix),q(2*Se*Pe/z.clientHeight,i.object.matrix)}else z&&i.object instanceof Ni&&i.object.isOrthographicCamera?(W(de*(i.object.right-i.object.left)/i.object.zoom/z.clientWidth,i.object.matrix),q(Se*(i.object.top-i.object.bottom)/i.object.zoom/z.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function Z(Y){i.object instanceof Nt&&i.object.isPerspectiveCamera||i.object instanceof Ni&&i.object.isOrthographicCamera?d/=Y:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function te(Y){i.object instanceof Nt&&i.object.isPerspectiveCamera||i.object instanceof Ni&&i.object.isOrthographicCamera?d*=Y:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function X(Y){if(!i.zoomToCursor||!i.domElement)return;M=!0;const de=i.domElement.getBoundingClientRect(),Se=Y.clientX-de.left,z=Y.clientY-de.top,Ce=de.width,Pe=de.height;x.x=Se/Ce*2-1,x.y=-(z/Pe)*2+1,S.set(x.x,x.y,1).unproject(i.object).sub(i.object.position).normalize()}function se(Y){return Math.max(i.minDistance,Math.min(i.maxDistance,Y))}function G(Y){p.set(Y.clientX,Y.clientY)}function xe(Y){X(Y),_.set(Y.clientX,Y.clientY)}function Re(Y){g.set(Y.clientX,Y.clientY)}function Ie(Y){v.set(Y.clientX,Y.clientY),m.subVectors(v,p).multiplyScalar(i.rotateSpeed);const de=i.domElement;de&&(U(2*Math.PI*m.x/de.clientHeight),j(2*Math.PI*m.y/de.clientHeight)),p.copy(v),i.update()}function Q(Y){T.set(Y.clientX,Y.clientY),w.subVectors(T,_),w.y>0?Z($()):w.y<0&&te($()),_.copy(T),i.update()}function K(Y){b.set(Y.clientX,Y.clientY),y.subVectors(b,g).multiplyScalar(i.panSpeed),ie(y.x,y.y),g.copy(b),i.update()}function P(Y){X(Y),Y.deltaY<0?te($()):Y.deltaY>0&&Z($()),i.update()}function F(Y){let de=!1;switch(Y.code){case i.keys.UP:ie(0,i.keyPanSpeed),de=!0;break;case i.keys.BOTTOM:ie(0,-i.keyPanSpeed),de=!0;break;case i.keys.LEFT:ie(i.keyPanSpeed,0),de=!0;break;case i.keys.RIGHT:ie(-i.keyPanSpeed,0),de=!0;break}de&&(Y.preventDefault(),i.update())}function k(){if(E.length==1)p.set(E[0].pageX,E[0].pageY);else{const Y=.5*(E[0].pageX+E[1].pageX),de=.5*(E[0].pageY+E[1].pageY);p.set(Y,de)}}function A(){if(E.length==1)g.set(E[0].pageX,E[0].pageY);else{const Y=.5*(E[0].pageX+E[1].pageX),de=.5*(E[0].pageY+E[1].pageY);g.set(Y,de)}}function R(){const Y=E[0].pageX-E[1].pageX,de=E[0].pageY-E[1].pageY,Se=Math.sqrt(Y*Y+de*de);_.set(0,Se)}function I(){i.enableZoom&&R(),i.enablePan&&A()}function V(){i.enableZoom&&R(),i.enableRotate&&k()}function H(Y){if(E.length==1)v.set(Y.pageX,Y.pageY);else{const Se=Je(Y),z=.5*(Y.pageX+Se.x),Ce=.5*(Y.pageY+Se.y);v.set(z,Ce)}m.subVectors(v,p).multiplyScalar(i.rotateSpeed);const de=i.domElement;de&&(U(2*Math.PI*m.x/de.clientHeight),j(2*Math.PI*m.y/de.clientHeight)),p.copy(v)}function ee(Y){if(E.length==1)b.set(Y.pageX,Y.pageY);else{const de=Je(Y),Se=.5*(Y.pageX+de.x),z=.5*(Y.pageY+de.y);b.set(Se,z)}y.subVectors(b,g).multiplyScalar(i.panSpeed),ie(y.x,y.y),g.copy(b)}function oe(Y){const de=Je(Y),Se=Y.pageX-de.x,z=Y.pageY-de.y,Ce=Math.sqrt(Se*Se+z*z);T.set(0,Ce),w.set(0,Math.pow(T.y/_.y,i.zoomSpeed)),Z(w.y),_.copy(T)}function re(Y){i.enableZoom&&oe(Y),i.enablePan&&ee(Y)}function ue(Y){i.enableZoom&&oe(Y),i.enableRotate&&H(Y)}function ae(Y){var de,Se;i.enabled!==!1&&(E.length===0&&((de=i.domElement)==null||de.ownerDocument.addEventListener("pointermove",Ee),(Se=i.domElement)==null||Se.ownerDocument.addEventListener("pointerup",N)),$e(Y),Y.pointerType==="touch"?Ue(Y):J(Y))}function Ee(Y){i.enabled!==!1&&(Y.pointerType==="touch"?Ae(Y):pe(Y))}function N(Y){var de,Se,z;ht(Y),E.length===0&&((de=i.domElement)==null||de.releasePointerCapture(Y.pointerId),(Se=i.domElement)==null||Se.ownerDocument.removeEventListener("pointermove",Ee),(z=i.domElement)==null||z.ownerDocument.removeEventListener("pointerup",N)),i.dispatchEvent(o),l=a.NONE}function L(Y){ht(Y)}function J(Y){let de;switch(Y.button){case 0:de=i.mouseButtons.LEFT;break;case 1:de=i.mouseButtons.MIDDLE;break;case 2:de=i.mouseButtons.RIGHT;break;default:de=-1}switch(de){case ms.DOLLY:if(i.enableZoom===!1)return;xe(Y),l=a.DOLLY;break;case ms.ROTATE:if(Y.ctrlKey||Y.metaKey||Y.shiftKey){if(i.enablePan===!1)return;Re(Y),l=a.PAN}else{if(i.enableRotate===!1)return;G(Y),l=a.ROTATE}break;case ms.PAN:if(Y.ctrlKey||Y.metaKey||Y.shiftKey){if(i.enableRotate===!1)return;G(Y),l=a.ROTATE}else{if(i.enablePan===!1)return;Re(Y),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function pe(Y){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;Ie(Y);break;case a.DOLLY:if(i.enableZoom===!1)return;Q(Y);break;case a.PAN:if(i.enablePan===!1)return;K(Y);break}}function he(Y){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(Y.preventDefault(),i.dispatchEvent(s),P(Y),i.dispatchEvent(o))}function ye(Y){i.enabled===!1||i.enablePan===!1||F(Y)}function Ue(Y){switch(Le(Y),E.length){case 1:switch(i.touches.ONE){case mr.ROTATE:if(i.enableRotate===!1)return;k(),l=a.TOUCH_ROTATE;break;case mr.PAN:if(i.enablePan===!1)return;A(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case mr.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;I(),l=a.TOUCH_DOLLY_PAN;break;case mr.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;V(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Ae(Y){switch(Le(Y),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;H(Y),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;ee(Y),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;re(Y),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ue(Y),i.update();break;default:l=a.NONE}}function Ne(Y){i.enabled!==!1&&Y.preventDefault()}function $e(Y){E.push(Y)}function ht(Y){delete C[Y.pointerId];for(let de=0;de<E.length;de++)if(E[de].pointerId==Y.pointerId){E.splice(de,1);return}}function Le(Y){let de=C[Y.pointerId];de===void 0&&(de=new me,C[Y.pointerId]=de),de.set(Y.pageX,Y.pageY)}function Je(Y){const de=Y.pointerId===E[0].pointerId?E[1]:E[0];return C[de.pointerId]}t!==void 0&&this.connect(t),this.update()}}class OX extends xP{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons.LEFT=ms.PAN,this.mouseButtons.RIGHT=ms.ROTATE,this.touches.ONE=mr.PAN,this.touches.TWO=mr.DOLLY_ROTATE}}class IX extends Vn{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new kX(t)}),this.register(function(t){return new jX(t)}),this.register(function(t){return new XX(t)}),this.register(function(t){return new YX(t)}),this.register(function(t){return new zX(t)}),this.register(function(t){return new VX(t)}),this.register(function(t){return new HX(t)}),this.register(function(t){return new GX(t)}),this.register(function(t){return new FX(t)}),this.register(function(t){return new WX(t)}),this.register(function(t){return new BX(t)}),this.register(function(t){return new $X(t)}),this.register(function(t){return new UX(t)}),this.register(function(t){return new qX(t)}),this.register(function(t){return new KX(t)})}load(e,t,i,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Bi.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new Mi(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(Bi.decodeText(new Uint8Array(e.slice(0,4)))===wP){try{o[wt.KHR_BINARY_GLTF]=new ZX(e)}catch(c){r&&r(c);return}s=JSON.parse(o[wt.KHR_BINARY_GLTF].content)}else s=JSON.parse(Bi.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new uY(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](l);a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const u=s.extensionsUsed[c],h=s.extensionsRequired||[];switch(u){case wt.KHR_MATERIALS_UNLIT:o[u]=new NX;break;case wt.KHR_DRACO_MESH_COMPRESSION:o[u]=new JX(s,this.dracoLoader);break;case wt.KHR_TEXTURE_TRANSFORM:o[u]=new QX;break;case wt.KHR_MESH_QUANTIZATION:o[u]=new eY;break;default:h.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function DX(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const wt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class UX{constructor(e){this.parser=e,this.name=wt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let a;const l=new Oe(16777215);o.color!==void 0&&l.fromArray(o.color);const c=o.range!==void 0?o.range:0;switch(o.type){case"directional":a=new bm(l),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new _h(l),a.distance=c;break;case"spot":a=new ym(l),a.distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=o.spot.innerConeAngle!==void 0?o.spot.innerConeAngle:0,o.spot.outerConeAngle=o.spot.outerConeAngle!==void 0?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,so(a,o),o.intensity!==void 0&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),r=Promise.resolve(a),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,r=i.json.nodes[e],s=(r.extensions&&r.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(o){return i._getNodeRef(t.cache,s,o)})}}class NX{constructor(){this.name=wt.KHR_MATERIALS_UNLIT}getMaterialType(){return Xn}extendParams(e,t,i){const r=[];e.color=new Oe(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,3001))}return Promise.all(r)}}class FX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name].emissiveStrength;return r!==void 0&&(t.emissiveIntensity=r),Promise.resolve()}}class kX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new me(a,a)}return Promise.all(s)}}class BX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class zX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Oe(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&t.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",o.sheenColorTexture,3001)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class VX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class HX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new Oe(a[0],a[1],a[2]),Promise.all(s)}}class GX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=i.extensions[this.name];return t.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class WX{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new Oe(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",o.specularColorTexture,3001)),Promise.all(s)}}class $X{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return!t.extensions||!t.extensions[this.name]?null:ts}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class jX{constructor(e){this.parser=e,this.name=wt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class XX{constructor(e){this.parser=e,this.name=wt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class YX{constructor(e){this.parser=e,this.name=wt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class qX{constructor(e){this.name=wt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,h,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(u*h);return o.decodeGltfBuffer(new Uint8Array(f),u,h,d,r.mode,r.filter),f})})}else return null}}class KX{constructor(e){this.name=wt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const l of r.primitives)if(l.mode!==qi.TRIANGLES&&l.mode!==qi.TRIANGLE_STRIP&&l.mode!==qi.TRIANGLE_FAN&&l.mode!==void 0)return null;const s=i.extensions[this.name].attributes,o=[],a={};for(const l in s)o.push(this.parser.getDependency("accessor",s[l]).then(c=>(a[l]=c,a[l])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(l=>{const c=l.pop(),u=c.isGroup?c.children:[c],h=l[0].count,d=[];for(const f of u){const p=new Be,v=new D,m=new mt,g=new D(1,1,1),b=new sy(f.geometry,f.material,h);for(let y=0;y<h;y++)a.TRANSLATION&&v.fromBufferAttribute(a.TRANSLATION,y),a.ROTATION&&m.fromBufferAttribute(a.ROTATION,y),a.SCALE&&g.fromBufferAttribute(a.SCALE,y),b.setMatrixAt(y,p.compose(v,m,g));for(const y in a)y!=="TRANSLATION"&&y!=="ROTATION"&&y!=="SCALE"&&f.geometry.setAttribute(y,a[y]);pt.prototype.copy.call(b,f),this.parser.assignFinalMaterial(b),d.push(b)}return c.isGroup?(c.clear(),c.add(...d),c):d[0]}))}}const wP="glTF",ru=12,QM={JSON:1313821514,BIN:5130562};class ZX{constructor(e){this.name=wt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,ru);if(this.header={magic:Bi.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==wP)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-ru,r=new DataView(e,ru);let s=0;for(;s<i;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,a===QM.JSON){const l=new Uint8Array(e,ru+s,o);this.content=Bi.decodeText(l)}else if(a===QM.BIN){const l=ru+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class JX{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=wt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const h=L0[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=L0[u]||u.toLowerCase();if(o[u]!==void 0){const d=i.accessors[e.attributes[u]],f=Kl[d.componentType];c[h]=f.name,l[h]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const p=d.attributes[f],v=l[f];v!==void 0&&(p.normalized=v)}h(d)},a,c)})})}}class QX{constructor(){this.name=wt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class eY{constructor(){this.name=wt.KHR_MESH_QUANTIZATION}}class MP extends Ec{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=i[s+o];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=r-t,h=(i-t)/u,d=h*h,f=d*h,p=e*c,v=p-c,m=-2*f+3*d,g=f-d,b=1-m,y=g-d+h;for(let _=0;_!==a;_++){const T=o[v+_+a],w=o[v+_+l]*u,S=o[p+_+a],x=o[p+_]*u;s[_]=b*T+y*w+m*S+g*x}return s}}const tY=new mt;class nY extends MP{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return tY.fromArray(s).normalize().toArray(s),s}}const qi={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Kl={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},eE={9728:an,9729:Qt,9984:sh,9985:Gp,9986:$l,9987:Kr},tE={33071:An,33648:sc,10497:qr},Vg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},L0=ti(Ft({POSITION:"position",NORMAL:"normal",TANGENT:"tangent"},rX>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"}),{COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"}),Js={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},iY={CUBICSPLINE:void 0,LINEAR:Ta,STEP:ac},Hg={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function rY(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new za({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Yr})),n.DefaultMaterial}function Ko(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function so(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function sY(n,e,t){let i=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(h.POSITION!==void 0&&(i=!0),h.NORMAL!==void 0&&(r=!0),h.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(i){const d=h.POSITION!==void 0?t.getDependency("accessor",h.POSITION):n.attributes.position;o.push(d)}if(r){const d=h.NORMAL!==void 0?t.getDependency("accessor",h.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=h.COLOR_0!==void 0?t.getDependency("accessor",h.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],d=c[2];return i&&(n.morphAttributes.position=u),r&&(n.morphAttributes.normal=h),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}function oY(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function aY(n){let e;const t=n.extensions&&n.extensions[wt.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Gg(t.attributes):e=n.indices+":"+Gg(n.attributes)+":"+n.mode,n.targets!==void 0)for(let i=0,r=n.targets.length;i<r;i++)e+=":"+Gg(n.targets[i]);return e}function Gg(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function O0(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function lY(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const cY=new Be;class uY{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new DX,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new _m(this.options.manager):this.textureLoader=new ZC(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Mi(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};Ko(s,a,r),so(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[wt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Bi.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=Vg[r.type],a=Kl[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Tt(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Vg[r.type],c=Kl[r.componentType],u=c.BYTES_PER_ELEMENT,h=u*l,d=r.byteOffset||0,f=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let v,m;if(f&&f!==h){const g=Math.floor(d/f),b="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+g+":"+r.count;let y=t.cache.get(b);y||(v=new c(a,g*f,r.count*f/u),y=new xc(v,f/u),t.cache.add(b,y)),m=new Jr(y,l,d%f/u,p)}else a===null?v=new c(r.count*l):v=new c(a,d,r.count*l),m=new Tt(v,l,p);if(r.sparse!==void 0){const g=Vg.SCALAR,b=Kl[r.sparse.indices.componentType],y=r.sparse.indices.byteOffset||0,_=r.sparse.values.byteOffset||0,T=new b(o[1],y,r.sparse.count*g),w=new c(o[2],_,r.sparse.count*l);a!==null&&(m=new Tt(m.array.slice(),m.itemSize,m.normalized));for(let S=0,x=T.length;S<x;S++){const M=T[S];if(m.setX(M,w[S*l]),l>=2&&m.setY(M,w[S*l+1]),l>=3&&m.setZ(M,w[S*l+2]),l>=4&&m.setW(M,w[S*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m})}loadTexture(e){const t=this.json,i=this.options,r=t.textures[e].source,s=t.images[r];let o=this.textureLoader;if(s.uri){const a=i.manager.getHandler(s.uri);a!==null&&(o=a)}return this.loadTextureImage(e,r,o)}loadTextureImage(e,t,i){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,i).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const h=(s.samplers||{})[o.sampler]||{};return u.magFilter=eE[h.magFilter]||Qt,u.minFilter=eE[h.minFilter]||Kr,u.wrapS=tE[h.wrapS]||qr,u.wrapT=tE[h.wrapT]||qr,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(d,f){let p=d;t.isImageBitmapLoader===!0&&(p=function(v){const m=new Yt(v);m.needsUpdate=!0,d(m)}),t.load(Bi.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return c===!0&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||lY(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[wt.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[wt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[wt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&("colorSpace"in o?o.colorSpace=r===3001?"srgb":"srgb-linear":o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new nm,Pn.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Nn,Pn.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return za}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[wt.KHR_MATERIALS_UNLIT]){const h=r[wt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new Oe(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}h.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",h.baseColorTexture,3001)),a.metalness=h.metallicFactor!==void 0?h.metallicFactor:1,a.roughness=h.roughnessFactor!==void 0?h.roughnessFactor:1,h.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=vi);const u=s.alphaMode||Hg.OPAQUE;if(u===Hg.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===Hg.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Xn&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new me(1,1),s.normalTexture.scale!==void 0)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return s.occlusionTexture!==void 0&&o!==Xn&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Xn&&(a.emissive=new Oe().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==Xn&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,3001)),Promise.all(c).then(function(){const h=new o(a);return s.name&&(h.name=s.name),so(h,s),t.associations.set(h,{materials:e}),s.extensions&&Ko(r,h,s),h})}createUniqueName(e){const t=_t.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[wt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return nE(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=aY(c),h=r[u];if(h)o.push(h.promise);else{let d;c.extensions&&c.extensions[wt.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=nE(new Ye,c,t),r[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?rY(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const v=u[f],m=o[f];let g;const b=c[f];if(m.mode===qi.TRIANGLES||m.mode===qi.TRIANGLE_STRIP||m.mode===qi.TRIANGLE_FAN||m.mode===void 0)g=s.isSkinnedMesh===!0?new tm(v,b):new ke(v,b),g.isSkinnedMesh===!0&&g.normalizeSkinWeights(),m.mode===qi.TRIANGLE_STRIP?g.geometry=qM(g.geometry,Y_):m.mode===qi.TRIANGLE_FAN&&(g.geometry=qM(g.geometry,rp));else if(m.mode===qi.LINES)g=new Or(v,b);else if(m.mode===qi.LINE_STRIP)g=new lt(v,b);else if(m.mode===qi.LINE_LOOP)g=new oy(v,b);else if(m.mode===qi.POINTS)g=new ay(v,b);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(g.geometry.morphAttributes).length>0&&oY(g,s),g.name=t.createUniqueName(s.name||"mesh_"+e),so(g,s),m.extensions&&Ko(r,g,m),t.assignFinalMaterial(g),h.push(g)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(h.length===1)return s.extensions&&Ko(r,h[0],s),h[0];const d=new _r;s.extensions&&Ko(r,d,s),t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Nt(jn.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new Ni(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),so(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const h=o[c];if(h){a.push(h);const d=new Be;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new wc(a,l)})}loadAnimation(e){const t=this.json.animations[e],i=t.name?t.name:"animation_"+e,r=[],s=[],o=[],a=[],l=[];for(let c=0,u=t.channels.length;c<u;c++){const h=t.channels[c],d=t.samplers[h.sampler],f=h.target,p=f.node,v=t.parameters!==void 0?t.parameters[d.input]:d.input,m=t.parameters!==void 0?t.parameters[d.output]:d.output;f.node!==void 0&&(r.push(this.getDependency("node",p)),s.push(this.getDependency("accessor",v)),o.push(this.getDependency("accessor",m)),a.push(d),l.push(f))}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],d=c[2],f=c[3],p=c[4],v=[];for(let m=0,g=u.length;m<g;m++){const b=u[m],y=h[m],_=d[m],T=f[m],w=p[m];if(b===void 0)continue;b.updateMatrix();let S;switch(Js[w.path]){case Js.weights:S=Ca;break;case Js.rotation:S=Rs;break;case Js.position:case Js.scale:default:S=Pa;break}const x=b.name?b.name:b.uuid,M=T.interpolation!==void 0?iY[T.interpolation]:Ta,E=[];Js[w.path]===Js.weights?b.traverse(function(O){O.morphTargetInfluences&&E.push(O.name?O.name:O.uuid)}):E.push(x);let C=_.array;if(_.normalized){const O=O0(C.constructor),$=new Float32Array(C.length);for(let U=0,j=C.length;U<j;U++)$[U]=C[U]*O;C=$}for(let O=0,$=E.length;O<$;O++){const U=new S(E[O]+"."+Js[w.path],y.array,C,M);T.interpolation==="CUBICSPLINE"&&(U.createInterpolant=function(j){const W=this instanceof Rs?nY:MP;return new W(this.times,this.values,this.getValueSize()/3,j)},U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),v.push(U)}}return new Ra(i,void 0,v)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,u=a.length;c<u;c++)o.push(i.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],h=c[1],d=c[2];d!==null&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(d,cY)});for(let f=0,p=h.length;f<p;f++)u.add(h[f]);return u})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new uc:c.length>1?u=new _r:c.length===1?u=c[0]:u=new pt,u!==c[0])for(let h=0,d=c.length;h<d;h++)u.add(c[h]);if(s.name&&(u.userData.name=s.name,u.name=o),so(u,s),s.extensions&&Ko(i,u,s),s.matrix!==void 0){const h=new Be;h.fromArray(s.matrix),u.applyMatrix4(h)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return r.associations.has(u)||r.associations.set(u,{}),r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new _r;i.name&&(s.name=r.createUniqueName(i.name)),so(s,i),i.extensions&&Ko(t,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,h=l.length;u<h;u++)s.add(l[u]);const c=u=>{const h=new Map;for(const[d,f]of r.associations)(d instanceof Pn||d instanceof Yt)&&h.set(d,f);return u.traverse(d=>{const f=r.associations.get(d);f!=null&&h.set(d,f)}),h};return r.associations=c(s),s})}}function hY(n,e,t){const i=e.attributes,r=new Ti;if(i.POSITION!==void 0){const a=t.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new D(l[0],l[1],l[2]),new D(c[0],c[1],c[2])),a.normalized){const u=O0(Kl[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new D,l=new D;for(let c=0,u=s.length;c<u;c++){const h=s[c];if(h.POSITION!==void 0){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const v=O0(Kl[d.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}n.boundingBox=r;const o=new Ai;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=o}function nE(n,e,t){const i=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in i){const a=L0[o]||o.toLowerCase();a in n.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});r.push(o)}return so(n,e),hY(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?sY(n,e.targets,t):n})}function EP(n,e,t){const i=t.length-n-1;if(e>=t[i])return i-1;if(e<=t[n])return n;let r=n,s=i,o=Math.floor((r+s)/2);for(;e<t[o]||e>=t[o+1];)e<t[o]?s=o:r=o,o=Math.floor((r+s)/2);return o}function dY(n,e,t,i){const r=[],s=[],o=[];r[0]=1;for(let a=1;a<=t;++a){s[a]=e-i[n+1-a],o[a]=i[n+a]-e;let l=0;for(let c=0;c<a;++c){const u=o[c+1],h=s[a-c],d=r[c]/(u+h);r[c]=l+u*d,l=h*d}r[a]=l}return r}function fY(n,e,t,i){const r=EP(n,i,e),s=dY(r,i,n,e),o=new gt(0,0,0,0);for(let a=0;a<=n;++a){const l=t[r-n+a],c=s[a],u=l.w*c;o.x+=l.x*u,o.y+=l.y*u,o.z+=l.z*u,o.w+=l.w*c}return o}function pY(n,e,t,i,r){const s=[];for(let h=0;h<=t;++h)s[h]=0;const o=[];for(let h=0;h<=i;++h)o[h]=s.slice(0);const a=[];for(let h=0;h<=t;++h)a[h]=s.slice(0);a[0][0]=1;const l=s.slice(0),c=s.slice(0);for(let h=1;h<=t;++h){l[h]=e-r[n+1-h],c[h]=r[n+h]-e;let d=0;for(let f=0;f<h;++f){const p=c[f+1],v=l[h-f];a[h][f]=p+v;const m=a[f][h-1]/a[h][f];a[f][h]=d+p*m,d=v*m}a[h][h]=d}for(let h=0;h<=t;++h)o[0][h]=a[h][t];for(let h=0;h<=t;++h){let d=0,f=1;const p=[];for(let v=0;v<=t;++v)p[v]=s.slice(0);p[0][0]=1;for(let v=1;v<=i;++v){let m=0;const g=h-v,b=t-v;h>=v&&(p[f][0]=p[d][0]/a[b+1][g],m=p[f][0]*a[g][b]);const y=g>=-1?1:-g,_=h-1<=b?v-1:t-h;for(let w=y;w<=_;++w)p[f][w]=(p[d][w]-p[d][w-1])/a[b+1][g+w],m+=p[f][w]*a[g+w][b];h<=b&&(p[f][v]=-p[d][v-1]/a[b+1][h],m+=p[f][v]*a[h][b]),o[v][h]=m;const T=d;d=f,f=T}}let u=t;for(let h=1;h<=i;++h){for(let d=0;d<=t;++d)o[h][d]*=u;u*=t-h}return o}function mY(n,e,t,i,r){const s=r<n?r:n,o=[],a=EP(n,i,e),l=pY(a,i,n,s,e),c=[];for(let u=0;u<t.length;++u){const h=t[u].clone(),d=h.w;h.x*=d,h.y*=d,h.z*=d,c[u]=h}for(let u=0;u<=s;++u){const h=c[a-n].clone().multiplyScalar(l[u][0]);for(let d=1;d<=n;++d)h.add(c[a-n+d].clone().multiplyScalar(l[u][d]));o[u]=h}for(let u=s+1;u<=r+1;++u)o[u]=new gt(0,0,0);return o}function gY(n,e){let t=1;for(let r=2;r<=n;++r)t*=r;let i=1;for(let r=2;r<=e;++r)i*=r;for(let r=2;r<=n-e;++r)i*=r;return t/i}function vY(n){const e=n.length,t=[],i=[];for(let s=0;s<e;++s){const o=n[s];t[s]=new D(o.x,o.y,o.z),i[s]=o.w}const r=[];for(let s=0;s<e;++s){const o=t[s].clone();for(let a=1;a<=s;++a)o.sub(r[s-a].clone().multiplyScalar(gY(s,a)*i[a]));r[s]=o.divideScalar(i[0])}return r}function _Y(n,e,t,i,r){const s=mY(n,e,t,i,r);return vY(s)}class iE extends ar{constructor(e,t,i,r,s){super(),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=r||0,this.endKnot=s||this.knots.length-1;for(let o=0;o<i.length;++o){const a=i[o];this.controlPoints[o]=new gt(a.x,a.y,a.z,a.w)}}getPoint(e,t){const i=t||new D,r=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=fY(this.degree,this.knots,this.controlPoints,r);return s.w!=1&&s.divideScalar(s.w),i.set(s.x,s.y,s.z)}getTangent(e,t){const i=t||new D,r=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),s=_Y(this.degree,this.knots,this.controlPoints,r,1);return i.copy(s[1]).normalize(),i}}let bt,pn,mi;class yY extends Vn{constructor(e){super(e)}load(e,t,i,r){const s=this,o=s.path===""?Bi.extractUrlBase(e):s.path,a=new Mi(this.manager);a.setPath(s.path),a.setResponseType("arraybuffer"),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e,t){if(SY(e))bt=new EY().parse(e);else{const r=CP(e);if(!TY(r))throw new Error("THREE.FBXLoader: Unknown format.");if(sE(r)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+sE(r));bt=new MY().parse(r)}const i=new _m(this.manager).setPath(this.resourcePath||t).setCrossOrigin(this.crossOrigin);return new bY(i,this.manager).parse(bt)}}class bY{constructor(e,t){this.textureLoader=e,this.manager=t}parse(){pn=this.parseConnections();const e=this.parseImages(),t=this.parseTextures(e),i=this.parseMaterials(t),r=this.parseDeformers(),s=new xY().parse(r);return this.parseScene(r,s,i),mi}parseConnections(){const e=new Map;return"Connections"in bt&&bt.Connections.connections.forEach(function(t){const i=t[0],r=t[1],s=t[2];e.has(i)||e.set(i,{parents:[],children:[]});const o={ID:r,relationship:s};e.get(i).parents.push(o),e.has(r)||e.set(r,{parents:[],children:[]});const a={ID:i,relationship:s};e.get(r).children.push(a)}),e}parseImages(){const e={},t={};if("Video"in bt.Objects){const i=bt.Objects.Video;for(const r in i){const s=i[r],o=parseInt(r);if(e[o]=s.RelativeFilename||s.Filename,"Content"in s){const a=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,l=typeof s.Content=="string"&&s.Content!=="";if(a||l){const c=this.parseImage(i[r]);t[s.RelativeFilename||s.Filename]=c}}}}for(const i in e){const r=e[i];t[r]!==void 0?e[i]=t[r]:e[i]=e[i].split("\\").pop()}return e}parseImage(e){const t=e.Content,i=e.RelativeFilename||e.Filename,r=i.slice(i.lastIndexOf(".")+1).toLowerCase();let s;switch(r){case"bmp":s="image/bmp";break;case"jpg":case"jpeg":s="image/jpeg";break;case"png":s="image/png";break;case"tif":s="image/tiff";break;case"tga":this.manager.getHandler(".tga")===null&&console.warn("FBXLoader: TGA loader not found, skipping ",i),s="image/tga";break;default:console.warn('FBXLoader: Image type "'+r+'" is not supported.');return}if(typeof t=="string")return"data:"+s+";base64,"+t;{const o=new Uint8Array(t);return window.URL.createObjectURL(new Blob([o],{type:s}))}}parseTextures(e){const t=new Map;if("Texture"in bt.Objects){const i=bt.Objects.Texture;for(const r in i){const s=this.parseTexture(i[r],e);t.set(parseInt(r),s)}}return t}parseTexture(e,t){const i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;const r=e.WrapModeU,s=e.WrapModeV,o=r!==void 0?r.value:0,a=s!==void 0?s.value:0;if(i.wrapS=o===0?qr:An,i.wrapT=a===0?qr:An,"Scaling"in e){const l=e.Scaling.value;i.repeat.x=l[0],i.repeat.y=l[1]}return i}loadTexture(e,t){let i;const r=this.textureLoader.path,s=pn.get(e.id).children;s!==void 0&&s.length>0&&t[s[0].ID]!==void 0&&(i=t[s[0].ID],(i.indexOf("blob:")===0||i.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));let o;const a=e.FileName.slice(-3).toLowerCase();if(a==="tga"){const l=this.manager.getHandler(".tga");l===null?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),o=new Yt):(l.setPath(this.textureLoader.path),o=l.load(i))}else a==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),o=new Yt):o=this.textureLoader.load(i);return this.textureLoader.setPath(r),o}parseMaterials(e){const t=new Map;if("Material"in bt.Objects){const i=bt.Objects.Material;for(const r in i){const s=this.parseMaterial(i[r],e);s!==null&&t.set(parseInt(r),s)}}return t}parseMaterial(e,t){const i=e.id,r=e.attrName;let s=e.ShadingModel;if(typeof s=="object"&&(s=s.value),!pn.has(i))return null;const o=this.parseParameters(e,t,i);let a;switch(s.toLowerCase()){case"phong":a=new Du;break;case"lambert":a=new py;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),a=new Du;break}return a.setValues(o),a.name=r,a}parseParameters(e,t,i){const r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=new Oe().fromArray(e.Diffuse.value):e.DiffuseColor&&(e.DiffuseColor.type==="Color"||e.DiffuseColor.type==="ColorRGB")&&(r.color=new Oe().fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=new Oe().fromArray(e.Emissive.value):e.EmissiveColor&&(e.EmissiveColor.type==="Color"||e.EmissiveColor.type==="ColorRGB")&&(r.emissive=new Oe().fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=new Oe().fromArray(e.Specular.value):e.SpecularColor&&e.SpecularColor.type==="Color"&&(r.specular=new Oe().fromArray(e.SpecularColor.value));const s=this;return pn.get(i).children.forEach(function(o){const a=o.relationship;switch(a){case"Bump":r.bumpMap=s.getTexture(t,o.ID);break;case"Maya|TEX_ao_map":r.aoMap=s.getTexture(t,o.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=s.getTexture(t,o.ID),r.map!==void 0&&("colorSpace"in r.map?r.map.colorSpace="srgb":r.map.encoding=3001);break;case"DisplacementColor":r.displacementMap=s.getTexture(t,o.ID);break;case"EmissiveColor":r.emissiveMap=s.getTexture(t,o.ID),r.emissiveMap!==void 0&&("colorSpace"in r.emissiveMap?r.emissiveMap.colorSpace="srgb":r.emissiveMap.encoding=3001);break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=s.getTexture(t,o.ID);break;case"ReflectionColor":r.envMap=s.getTexture(t,o.ID),r.envMap!==void 0&&(r.envMap.mapping=rc,"colorSpace"in r.envMap?r.envMap.colorSpace="srgb":r.envMap.encoding=3001);break;case"SpecularColor":r.specularMap=s.getTexture(t,o.ID),r.specularMap!==void 0&&("colorSpace"in r.specularMap?r.specularMap.colorSpace="srgb":r.specularMap.encoding=3001);break;case"TransparentColor":case"TransparencyFactor":r.alphaMap=s.getTexture(t,o.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",a);break}}),r}getTexture(e,t){return"LayeredTexture"in bt.Objects&&t in bt.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),t=pn.get(t).children[0].ID),e.get(t)}parseDeformers(){const e={},t={};if("Deformer"in bt.Objects){const i=bt.Objects.Deformer;for(const r in i){const s=i[r],o=pn.get(parseInt(r));if(s.attrType==="Skin"){const a=this.parseSkeleton(o,i);a.ID=r,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),a.geometryID=o.parents[0].ID,e[r]=a}else if(s.attrType==="BlendShape"){const a={id:r};a.rawTargets=this.parseMorphTargets(o,i),a.id=r,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),t[r]=a}}}return{skeletons:e,morphTargets:t}}parseSkeleton(e,t){const i=[];return e.children.forEach(function(r){const s=t[r.ID];if(s.attrType!=="Cluster")return;const o={ID:r.ID,indices:[],weights:[],transformLink:new Be().fromArray(s.TransformLink.a)};"Indexes"in s&&(o.indices=s.Indexes.a,o.weights=s.Weights.a),i.push(o)}),{rawBones:i,bones:[]}}parseMorphTargets(e,t){const i=[];for(let r=0;r<e.children.length;r++){const s=e.children[r],o=t[s.ID],a={name:o.attrName,initialWeight:o.DeformPercent,id:o.id,fullWeights:o.FullWeights.a};if(o.attrType!=="BlendShapeChannel")return;a.geoID=pn.get(parseInt(s.ID)).children.filter(function(l){return l.relationship===void 0})[0].ID,i.push(a)}return i}parseScene(e,t,i){mi=new _r;const r=this.parseModels(e.skeletons,t,i),s=bt.Objects.Model,o=this;r.forEach(function(l){const c=s[l.ID];o.setLookAtProperties(l,c),pn.get(l.ID).parents.forEach(function(u){const h=r.get(u.ID);h!==void 0&&h.add(l)}),l.parent===null&&mi.add(l)}),this.bindSkeleton(e.skeletons,t,r),this.createAmbientLight(),mi.traverse(function(l){if(l.userData.transformData){l.parent&&(l.userData.transformData.parentMatrix=l.parent.matrix,l.userData.transformData.parentMatrixWorld=l.parent.matrixWorld);const c=TP(l.userData.transformData);l.applyMatrix4(c),l.updateWorldMatrix()}});const a=new wY().parse();mi.children.length===1&&mi.children[0].isGroup&&(mi.children[0].animations=a,mi=mi.children[0]),mi.animations=a}parseModels(e,t,i){const r=new Map,s=bt.Objects.Model;for(const o in s){const a=parseInt(o),l=s[o],c=pn.get(a);let u=this.buildSkeleton(c,e,a,l.attrName);if(!u){switch(l.attrType){case"Camera":u=this.createCamera(c);break;case"Light":u=this.createLight(c);break;case"Mesh":u=this.createMesh(c,t,i);break;case"NurbsCurve":u=this.createCurve(c,t);break;case"LimbNode":case"Root":u=new uc;break;case"Null":default:u=new _r;break}u.name=l.attrName?_t.sanitizeNodeName(l.attrName):"",u.ID=a}this.getTransformData(u,l),r.set(a,u)}return r}buildSkeleton(e,t,i,r){let s=null;return e.parents.forEach(function(o){for(const a in t){const l=t[a];l.rawBones.forEach(function(c,u){if(c.ID===o.ID){const h=s;s=new uc,s.matrixWorld.copy(c.transformLink),s.name=r?_t.sanitizeNodeName(r):"",s.ID=i,l.bones[u]=s,h!==null&&s.add(h)}})}}),s}createCamera(e){let t,i;if(e.children.forEach(function(r){const s=bt.Objects.NodeAttribute[r.ID];s!==void 0&&(i=s)}),i===void 0)t=new pt;else{let r=0;i.CameraProjectionType!==void 0&&i.CameraProjectionType.value===1&&(r=1);let s=1;i.NearPlane!==void 0&&(s=i.NearPlane.value/1e3);let o=1e3;i.FarPlane!==void 0&&(o=i.FarPlane.value/1e3);let a=window.innerWidth,l=window.innerHeight;i.AspectWidth!==void 0&&i.AspectHeight!==void 0&&(a=i.AspectWidth.value,l=i.AspectHeight.value);const c=a/l;let u=45;i.FieldOfView!==void 0&&(u=i.FieldOfView.value);const h=i.FocalLength?i.FocalLength.value:null;switch(r){case 0:t=new Nt(u,c,s,o),h!==null&&t.setFocalLength(h);break;case 1:t=new Ni(-a/2,a/2,l/2,-l/2,s,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),t=new pt;break}}return t}createLight(e){let t,i;if(e.children.forEach(function(r){const s=bt.Objects.NodeAttribute[r.ID];s!==void 0&&(i=s)}),i===void 0)t=new pt;else{let r;i.LightType===void 0?r=0:r=i.LightType.value;let s=16777215;i.Color!==void 0&&(s=new Oe().fromArray(i.Color.value));let o=i.Intensity===void 0?1:i.Intensity.value/100;i.CastLightOnObject!==void 0&&i.CastLightOnObject.value===0&&(o=0);let a=0;i.FarAttenuationEnd!==void 0&&(i.EnableFarAttenuation!==void 0&&i.EnableFarAttenuation.value===0?a=0:a=i.FarAttenuationEnd.value);const l=1;switch(r){case 0:t=new _h(s,o,a,l);break;case 1:t=new bm(s,o);break;case 2:let c=Math.PI/3;i.InnerAngle!==void 0&&(c=jn.degToRad(i.InnerAngle.value));let u=0;i.OuterAngle!==void 0&&(u=jn.degToRad(i.OuterAngle.value),u=Math.max(u,1)),t=new ym(s,o,a,c,u,l);break;default:console.warn("THREE.FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a PointLight."),t=new _h(s,o);break}i.CastShadows!==void 0&&i.CastShadows.value===1&&(t.castShadow=!0)}return t}createMesh(e,t,i){let r,s=null,o=null;const a=[];return e.children.forEach(function(l){t.has(l.ID)&&(s=t.get(l.ID)),i.has(l.ID)&&a.push(i.get(l.ID))}),a.length>1?o=a:a.length>0?o=a[0]:(o=new Du({color:13421772}),a.push(o)),"color"in s.attributes&&a.forEach(function(l){l.vertexColors=!0}),s.FBX_Deformer?(r=new tm(s,o),r.normalizeSkinWeights()):r=new ke(s,o),r}createCurve(e,t){const i=e.children.reduce(function(s,o){return t.has(o.ID)&&(s=t.get(o.ID)),s},null),r=new Nn({color:3342591,linewidth:1});return new lt(i,r)}getTransformData(e,t){const i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),"RotationOrder"in t?i.eulerOrder=AP(t.RotationOrder.value):i.eulerOrder="ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i}setLookAtProperties(e,t){"LookAtProperty"in t&&pn.get(e.ID).children.forEach(function(i){if(i.relationship==="LookAtProperty"){const r=bt.Objects.Model[i.ID];if("Lcl_Translation"in r){const s=r.Lcl_Translation.value;e.target!==void 0?(e.target.position.fromArray(s),mi.add(e.target)):e.lookAt(new D().fromArray(s))}}})}bindSkeleton(e,t,i){const r=this.parsePoseNodes();for(const s in e){const o=e[s];pn.get(parseInt(o.ID)).parents.forEach(function(a){if(t.has(a.ID)){const l=a.ID;pn.get(l).parents.forEach(function(c){i.has(c.ID)&&i.get(c.ID).bind(new wc(o.bones),r[c.ID])})}})}}parsePoseNodes(){const e={};if("Pose"in bt.Objects){const t=bt.Objects.Pose;for(const i in t)if(t[i].attrType==="BindPose"&&t[i].NbPoseNodes>0){const r=t[i].PoseNode;Array.isArray(r)?r.forEach(function(s){e[s.Node]=new Be().fromArray(s.Matrix.a)}):e[r.Node]=new Be().fromArray(r.Matrix.a)}}return e}createAmbientLight(){if("GlobalSettings"in bt&&"AmbientColor"in bt.GlobalSettings){const e=bt.GlobalSettings.AmbientColor.value,t=e[0],i=e[1],r=e[2];if(t!==0||i!==0||r!==0){const s=new Oe(t,i,r);mi.add(new yy(s,1))}}}}class xY{parse(e){const t=new Map;if("Geometry"in bt.Objects){const i=bt.Objects.Geometry;for(const r in i){const s=pn.get(parseInt(r)),o=this.parseGeometry(s,i[r],e);t.set(parseInt(r),o)}}return t}parseGeometry(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}}parseMeshGeometry(e,t,i){const r=i.skeletons,s=[],o=e.parents.map(function(h){return bt.Objects.Model[h.ID]});if(o.length===0)return;const a=e.children.reduce(function(h,d){return r[d.ID]!==void 0&&(h=r[d.ID]),h},null);e.children.forEach(function(h){i.morphTargets[h.ID]!==void 0&&s.push(i.morphTargets[h.ID])});const l=o[0],c={};"RotationOrder"in l&&(c.eulerOrder=AP(l.RotationOrder.value)),"InheritType"in l&&(c.inheritType=parseInt(l.InheritType.value)),"GeometricTranslation"in l&&(c.translation=l.GeometricTranslation.value),"GeometricRotation"in l&&(c.rotation=l.GeometricRotation.value),"GeometricScaling"in l&&(c.scale=l.GeometricScaling.value);const u=TP(c);return this.genGeometry(t,a,s,u)}genGeometry(e,t,i,r){const s=new Ye;e.attrName&&(s.name=e.attrName);const o=this.parseGeoNode(e,t),a=this.genBuffers(o),l=new Ve(a.vertex,3);if(l.applyMatrix4(r),s.setAttribute("position",l),a.colors.length>0&&s.setAttribute("color",new Ve(a.colors,3)),t&&(s.setAttribute("skinIndex",new qp(a.weightsIndices,4)),s.setAttribute("skinWeight",new Ve(a.vertexWeights,4)),s.FBX_Deformer=t),a.normal.length>0){const c=new ct().getNormalMatrix(r),u=new Ve(a.normal,3);u.applyNormalMatrix(c),s.setAttribute("normal",u)}if(a.uvs.forEach(function(c,u){let h="uv"+(u+1).toString();u===0&&(h="uv"),s.setAttribute(h,new Ve(a.uvs[u],2))}),o.material&&o.material.mappingType!=="AllSame"){let c=a.materialIndex[0],u=0;if(a.materialIndex.forEach(function(h,d){h!==c&&(s.addGroup(u,d-u,c),c=h,u=d)}),s.groups.length>0){const h=s.groups[s.groups.length-1],d=h.start+h.count;d!==a.materialIndex.length&&s.addGroup(d,a.materialIndex.length-d,c)}s.groups.length===0&&s.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(s,e,i,r),s}parseGeoNode(e,t){const i={};if(i.vertexPositions=e.Vertices!==void 0?e.Vertices.a:[],i.vertexIndices=e.PolygonVertexIndex!==void 0?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];let r=0;for(;e.LayerElementUV[r];)e.LayerElementUV[r].UV&&i.uv.push(this.parseUVs(e.LayerElementUV[r])),r++}return i.weightTable={},t!==null&&(i.skeleton=t,t.rawBones.forEach(function(r,s){r.indices.forEach(function(o,a){i.weightTable[o]===void 0&&(i.weightTable[o]=[]),i.weightTable[o].push({id:s,weight:r.weights[a]})})})),i}genBuffers(e){const t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]};let i=0,r=0,s=!1,o=[],a=[],l=[],c=[],u=[],h=[];const d=this;return e.vertexIndices.forEach(function(f,p){let v,m=!1;f<0&&(f=f^-1,m=!0);let g=[],b=[];if(o.push(f*3,f*3+1,f*3+2),e.color){const y=ff(p,i,f,e.color);l.push(y[0],y[1],y[2])}if(e.skeleton){if(e.weightTable[f]!==void 0&&e.weightTable[f].forEach(function(y){b.push(y.weight),g.push(y.id)}),b.length>4){s||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),s=!0);const y=[0,0,0,0],_=[0,0,0,0];b.forEach(function(T,w){let S=T,x=g[w];_.forEach(function(M,E,C){if(S>M){C[E]=S,S=M;const O=y[E];y[E]=x,x=O}})}),g=y,b=_}for(;b.length<4;)b.push(0),g.push(0);for(let y=0;y<4;++y)u.push(b[y]),h.push(g[y])}if(e.normal){const y=ff(p,i,f,e.normal);a.push(y[0],y[1],y[2])}e.material&&e.material.mappingType!=="AllSame"&&(v=ff(p,i,f,e.material)[0]),e.uv&&e.uv.forEach(function(y,_){const T=ff(p,i,f,y);c[_]===void 0&&(c[_]=[]),c[_].push(T[0]),c[_].push(T[1])}),r++,m&&(d.genFace(t,e,o,v,a,l,c,u,h,r),i++,r=0,o=[],a=[],l=[],c=[],u=[],h=[])}),t}genFace(e,t,i,r,s,o,a,l,c,u){for(let h=2;h<u;h++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[(h-1)*3]]),e.vertex.push(t.vertexPositions[i[(h-1)*3+1]]),e.vertex.push(t.vertexPositions[i[(h-1)*3+2]]),e.vertex.push(t.vertexPositions[i[h*3]]),e.vertex.push(t.vertexPositions[i[h*3+1]]),e.vertex.push(t.vertexPositions[i[h*3+2]]),t.skeleton&&(e.vertexWeights.push(l[0]),e.vertexWeights.push(l[1]),e.vertexWeights.push(l[2]),e.vertexWeights.push(l[3]),e.vertexWeights.push(l[(h-1)*4]),e.vertexWeights.push(l[(h-1)*4+1]),e.vertexWeights.push(l[(h-1)*4+2]),e.vertexWeights.push(l[(h-1)*4+3]),e.vertexWeights.push(l[h*4]),e.vertexWeights.push(l[h*4+1]),e.vertexWeights.push(l[h*4+2]),e.vertexWeights.push(l[h*4+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[(h-1)*4]),e.weightsIndices.push(c[(h-1)*4+1]),e.weightsIndices.push(c[(h-1)*4+2]),e.weightsIndices.push(c[(h-1)*4+3]),e.weightsIndices.push(c[h*4]),e.weightsIndices.push(c[h*4+1]),e.weightsIndices.push(c[h*4+2]),e.weightsIndices.push(c[h*4+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[(h-1)*3]),e.colors.push(o[(h-1)*3+1]),e.colors.push(o[(h-1)*3+2]),e.colors.push(o[h*3]),e.colors.push(o[h*3+1]),e.colors.push(o[h*3+2])),t.material&&t.material.mappingType!=="AllSame"&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(s[0]),e.normal.push(s[1]),e.normal.push(s[2]),e.normal.push(s[(h-1)*3]),e.normal.push(s[(h-1)*3+1]),e.normal.push(s[(h-1)*3+2]),e.normal.push(s[h*3]),e.normal.push(s[h*3+1]),e.normal.push(s[h*3+2])),t.uv&&t.uv.forEach(function(d,f){e.uvs[f]===void 0&&(e.uvs[f]=[]),e.uvs[f].push(a[f][0]),e.uvs[f].push(a[f][1]),e.uvs[f].push(a[f][(h-1)*2]),e.uvs[f].push(a[f][(h-1)*2+1]),e.uvs[f].push(a[f][h*2]),e.uvs[f].push(a[f][h*2+1])})}addMorphTargets(e,t,i,r){if(i.length===0)return;e.morphTargetsRelative=!0,e.morphAttributes.position=[];const s=this;i.forEach(function(o){o.rawTargets.forEach(function(a){const l=bt.Objects.Geometry[a.geoID];l!==void 0&&s.genMorphGeometry(e,t,l,r,a.name)})})}genMorphGeometry(e,t,i,r,s){const o=t.PolygonVertexIndex!==void 0?t.PolygonVertexIndex.a:[],a=i.Vertices!==void 0?i.Vertices.a:[],l=i.Indexes!==void 0?i.Indexes.a:[],c=e.attributes.position.count*3,u=new Float32Array(c);for(let p=0;p<l.length;p++){const v=l[p]*3;u[v]=a[p*3],u[v+1]=a[p*3+1],u[v+2]=a[p*3+2]}const h={vertexIndices:o,vertexPositions:u},d=this.genBuffers(h),f=new Ve(d.vertex,3);f.name=s||i.attrName,f.applyMatrix4(r),e.morphAttributes.position.push(f)}parseNormals(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.Normals.a;let s=[];return i==="IndexToDirect"&&("NormalIndex"in e?s=e.NormalIndex.a:"NormalsIndex"in e&&(s=e.NormalsIndex.a)),{dataSize:3,buffer:r,indices:s,mappingType:t,referenceType:i}}parseUVs(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.UV.a;let s=[];return i==="IndexToDirect"&&(s=e.UVIndex.a),{dataSize:2,buffer:r,indices:s,mappingType:t,referenceType:i}}parseVertexColors(e){const t=e.MappingInformationType,i=e.ReferenceInformationType,r=e.Colors.a;let s=[];return i==="IndexToDirect"&&(s=e.ColorIndex.a),{dataSize:4,buffer:r,indices:s,mappingType:t,referenceType:i}}parseMaterialIndices(e){const t=e.MappingInformationType,i=e.ReferenceInformationType;if(t==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};const r=e.Materials.a,s=[];for(let o=0;o<r.length;++o)s.push(o);return{dataSize:1,buffer:r,indices:s,mappingType:t,referenceType:i}}parseNurbsGeometry(e){if(iE===void 0)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new Ye;const t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new Ye;const i=t-1,r=e.KnotVector.a,s=[],o=e.Points.a;for(let u=0,h=o.length;u<h;u+=4)s.push(new gt().fromArray(o,u));let a,l;if(e.Form==="Closed")s.push(s[0]);else if(e.Form==="Periodic"){a=i,l=r.length-1-a;for(let u=0;u<i;++u)s.push(s[u])}const c=new iE(i,r,s,a,l).getPoints(s.length*12);return new Ye().setFromPoints(c)}}class wY{parse(){const e=[],t=this.parseClips();if(t!==void 0)for(const i in t){const r=t[i],s=this.addClip(r);e.push(s)}return e}parseClips(){if(bt.Objects.AnimationCurve===void 0)return;const e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);const t=this.parseAnimationLayers(e);return this.parseAnimStacks(t)}parseAnimationCurveNodes(){const e=bt.Objects.AnimationCurveNode,t=new Map;for(const i in e){const r=e[i];if(r.attrName.match(/S|R|T|DeformPercent/)!==null){const s={id:r.id,attr:r.attrName,curves:{}};t.set(s.id,s)}}return t}parseAnimationCurves(e){const t=bt.Objects.AnimationCurve;for(const i in t){const r={id:t[i].id,times:t[i].KeyTime.a.map(AY),values:t[i].KeyValueFloat.a},s=pn.get(r.id);if(s!==void 0){const o=s.parents[0].ID,a=s.parents[0].relationship;a.match(/X/)?e.get(o).curves.x=r:a.match(/Y/)?e.get(o).curves.y=r:a.match(/Z/)?e.get(o).curves.z=r:a.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=r)}}}parseAnimationLayers(e){const t=bt.Objects.AnimationLayer,i=new Map;for(const r in t){const s=[],o=pn.get(parseInt(r));o!==void 0&&(o.children.forEach(function(a,l){if(e.has(a.ID)){const c=e.get(a.ID);if(c.curves.x!==void 0||c.curves.y!==void 0||c.curves.z!==void 0){if(s[l]===void 0){const u=pn.get(a.ID).parents.filter(function(h){return h.relationship!==void 0})[0].ID;if(u!==void 0){const h=bt.Objects.Model[u.toString()];if(h===void 0){console.warn("THREE.FBXLoader: Encountered a unused curve.",a);return}const d={modelName:h.attrName?_t.sanitizeNodeName(h.attrName):"",ID:h.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};mi.traverse(function(f){f.ID===h.id&&(d.transform=f.matrix,f.userData.transformData&&(d.eulerOrder=f.userData.transformData.eulerOrder))}),d.transform||(d.transform=new Be),"PreRotation"in h&&(d.preRotation=h.PreRotation.value),"PostRotation"in h&&(d.postRotation=h.PostRotation.value),s[l]=d}}s[l]&&(s[l][c.attr]=c)}else if(c.curves.morph!==void 0){if(s[l]===void 0){const u=pn.get(a.ID).parents.filter(function(m){return m.relationship!==void 0})[0].ID,h=pn.get(u).parents[0].ID,d=pn.get(h).parents[0].ID,f=pn.get(d).parents[0].ID,p=bt.Objects.Model[f],v={modelName:p.attrName?_t.sanitizeNodeName(p.attrName):"",morphName:bt.Objects.Deformer[u].attrName};s[l]=v}s[l][c.attr]=c}}}),i.set(parseInt(r),s))}return i}parseAnimStacks(e){const t=bt.Objects.AnimationStack,i={};for(const r in t){const s=pn.get(parseInt(r)).children;s.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");const o=e.get(s[0].ID);i[r]={name:t[r].attrName,layer:o}}return i}addClip(e){let t=[];const i=this;return e.layer.forEach(function(r){t=t.concat(i.generateTracks(r))}),new Ra(e.name,-1,t)}generateTracks(e){const t=[];let i=new D,r=new mt,s=new D;if(e.transform&&e.transform.decompose(i,r,s),i=i.toArray(),r=new tr().setFromQuaternion(r,e.eulerOrder).toArray(),s=s.toArray(),e.T!==void 0&&Object.keys(e.T.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");o!==void 0&&t.push(o)}if(e.R!==void 0&&Object.keys(e.R.curves).length>0){const o=this.generateRotationTrack(e.modelName,e.R.curves,r,e.preRotation,e.postRotation,e.eulerOrder);o!==void 0&&t.push(o)}if(e.S!==void 0&&Object.keys(e.S.curves).length>0){const o=this.generateVectorTrack(e.modelName,e.S.curves,s,"scale");o!==void 0&&t.push(o)}if(e.DeformPercent!==void 0){const o=this.generateMorphTrack(e);o!==void 0&&t.push(o)}return t}generateVectorTrack(e,t,i,r){const s=this.getTimesForAllAxes(t),o=this.getKeyframeTrackValues(s,t,i);return new Pa(e+"."+r,s,o)}generateRotationTrack(e,t,i,r,s,o){t.x!==void 0&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(jn.degToRad)),t.y!==void 0&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(jn.degToRad)),t.z!==void 0&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(jn.degToRad));const a=this.getTimesForAllAxes(t),l=this.getKeyframeTrackValues(a,t,i);r!==void 0&&(r=r.map(jn.degToRad),r.push(o),r=new tr().fromArray(r),r=new mt().setFromEuler(r)),s!==void 0&&(s=s.map(jn.degToRad),s.push(o),s=new tr().fromArray(s),s=new mt().setFromEuler(s).invert());const c=new mt,u=new tr,h=[];for(let d=0;d<l.length;d+=3)u.set(l[d],l[d+1],l[d+2],o),c.setFromEuler(u),r!==void 0&&c.premultiply(r),s!==void 0&&c.multiply(s),c.toArray(h,d/3*4);return new Rs(e+".quaternion",a,h)}generateMorphTrack(e){const t=e.DeformPercent.curves.morph,i=t.values.map(function(s){return s/100}),r=mi.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new Ca(e.modelName+".morphTargetInfluences["+r+"]",t.times,i)}getTimesForAllAxes(e){let t=[];if(e.x!==void 0&&(t=t.concat(e.x.times)),e.y!==void 0&&(t=t.concat(e.y.times)),e.z!==void 0&&(t=t.concat(e.z.times)),t=t.sort(function(i,r){return i-r}),t.length>1){let i=1,r=t[0];for(let s=1;s<t.length;s++){const o=t[s];o!==r&&(t[i]=o,r=o,i++)}t=t.slice(0,i)}return t}getKeyframeTrackValues(e,t,i){const r=i,s=[];let o=-1,a=-1,l=-1;return e.forEach(function(c){if(t.x&&(o=t.x.times.indexOf(c)),t.y&&(a=t.y.times.indexOf(c)),t.z&&(l=t.z.times.indexOf(c)),o!==-1){const u=t.x.values[o];s.push(u),r[0]=u}else s.push(r[0]);if(a!==-1){const u=t.y.values[a];s.push(u),r[1]=u}else s.push(r[1]);if(l!==-1){const u=t.z.values[l];s.push(u),r[2]=u}else s.push(r[2])}),s}interpolateRotations(e){for(let t=1;t<e.values.length;t++){const i=e.values[t-1],r=e.values[t]-i,s=Math.abs(r);if(s>=180){const o=s/180,a=r/o;let l=i+a;const c=e.times[t-1],u=(e.times[t]-c)/o;let h=c+u;const d=[],f=[];for(;h<e.times[t];)d.push(h),h+=u,f.push(l),l+=a;e.times=oE(e.times,t,d),e.values=oE(e.values,t,f)}}}}class MY{getPrevNode(){return this.nodeStack[this.currentIndent-2]}getCurrentNode(){return this.nodeStack[this.currentIndent-1]}getCurrentProp(){return this.currentProp}pushStack(e){this.nodeStack.push(e),this.currentIndent+=1}popStack(){this.nodeStack.pop(),this.currentIndent-=1}setCurrentProp(e,t){this.currentProp=e,this.currentPropName=t}parse(e){this.currentIndent=0,this.allNodes=new SP,this.nodeStack=[],this.currentProp=[],this.currentPropName="";const t=this,i=e.split(/[\r\n]+/);return i.forEach(function(r,s){const o=r.match(/^[\s\t]*;/),a=r.match(/^[\s\t]*$/);if(o||a)return;const l=r.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),c=r.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),u=r.match("^\\t{"+(t.currentIndent-1)+"}}");l?t.parseNodeBegin(r,l):c?t.parseNodeProperty(r,c,i[++s]):u?t.popStack():r.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(r)}),this.allNodes}parseNodeBegin(e,t){const i=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(l){return l.trim().replace(/^"/,"").replace(/"$/,"")}),s={name:i},o=this.parseNodeAttr(r),a=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(i,s):i in a?(i==="PoseNode"?a.PoseNode.push(s):a[i].id!==void 0&&(a[i]={},a[i][a[i].id]=a[i]),o.id!==""&&(a[i][o.id]=s)):typeof o.id=="number"?(a[i]={},a[i][o.id]=s):i!=="Properties70"&&(i==="PoseNode"?a[i]=[s]:a[i]=s),typeof o.id=="number"&&(s.id=o.id),o.name!==""&&(s.attrName=o.name),o.type!==""&&(s.attrType=o.type),this.pushStack(s)}parseNodeAttr(e){let t=e[0];e[0]!==""&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));let i="",r="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:i,type:r}}parseNodeProperty(e,t,i){let r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),s=t[2].replace(/^"/,"").replace(/"$/,"").trim();r==="Content"&&s===","&&(s=i.replace(/"/g,"").replace(/,$/,"").trim());const o=this.getCurrentNode();if(o.name==="Properties70"){this.parseNodeSpecialProperty(e,r,s);return}if(r==="C"){const a=s.split(",").slice(1),l=parseInt(a[0]),c=parseInt(a[1]);let u=s.split(",").slice(3);u=u.map(function(h){return h.trim().replace(/^"/,"")}),r="connections",s=[l,c],PY(s,u),o[r]===void 0&&(o[r]=[])}r==="Node"&&(o.id=s),r in o&&Array.isArray(o[r])?o[r].push(s):r!=="a"?o[r]=s:o.a=s,this.setCurrentProp(o,r),r==="a"&&s.slice(-1)!==","&&(o.a=$g(s))}parseNodePropertyContinued(e){const t=this.getCurrentNode();t.a+=e,e.slice(-1)!==","&&(t.a=$g(t.a))}parseNodeSpecialProperty(e,t,i){const r=i.split('",').map(function(u){return u.trim().replace(/^\"/,"").replace(/\s/,"_")}),s=r[0],o=r[1],a=r[2],l=r[3];let c=r[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=$g(c);break}this.getPrevNode()[s]={type:o,type2:a,flag:l,value:c},this.setCurrentProp(this.getPrevNode(),s)}}class EY{parse(e){const t=new rE(e);t.skip(23);const i=t.getUint32();if(i<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+i);const r=new SP;for(;!this.endOfContent(t);){const s=this.parseNode(t,i);s!==null&&r.add(s.name,s)}return r}endOfContent(e){return e.size()%16===0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()}parseNode(e,t){const i={},r=t>=7500?e.getUint64():e.getUint32(),s=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();const o=e.getUint8(),a=e.getString(o);if(r===0)return null;const l=[];for(let d=0;d<s;d++)l.push(this.parseProperty(e));const c=l.length>0?l[0]:"",u=l.length>1?l[1]:"",h=l.length>2?l[2]:"";for(i.singleProperty=s===1&&e.getOffset()===r;r>e.getOffset();){const d=this.parseNode(e,t);d!==null&&this.parseSubNode(a,i,d)}return i.propertyList=l,typeof c=="number"&&(i.id=c),u!==""&&(i.attrName=u),h!==""&&(i.attrType=h),a!==""&&(i.name=a),i}parseSubNode(e,t,i){if(i.singleProperty===!0){const r=i.propertyList[0];Array.isArray(r)?(t[i.name]=i,i.a=r):t[i.name]=r}else if(e==="Connections"&&i.name==="C"){const r=[];i.propertyList.forEach(function(s,o){o!==0&&r.push(s)}),t.connections===void 0&&(t.connections=[]),t.connections.push(r)}else if(i.name==="Properties70")Object.keys(i).forEach(function(r){t[r]=i[r]});else if(e==="Properties70"&&i.name==="P"){let r=i.propertyList[0],s=i.propertyList[1];const o=i.propertyList[2],a=i.propertyList[3];let l;r.indexOf("Lcl ")===0&&(r=r.replace("Lcl ","Lcl_")),s.indexOf("Lcl ")===0&&(s=s.replace("Lcl ","Lcl_")),s==="Color"||s==="ColorRGB"||s==="Vector"||s==="Vector3D"||s.indexOf("Lcl_")===0?l=[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:l=i.propertyList[4],t[r]={type:s,type2:o,flag:a,value:l}}else t[i.name]===void 0?typeof i.id=="number"?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:i.name==="PoseNode"?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):t[i.name][i.id]===void 0&&(t[i.name][i.id]=i)}parseProperty(e){const t=e.getString(1);let i;switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":return i=e.getUint32(),e.getArrayBuffer(i);case"S":return i=e.getUint32(),e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":const r=e.getUint32(),s=e.getUint32(),o=e.getUint32();if(s===0)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}const a=gX(new Uint8Array(e.getArrayBuffer(o))),l=new rE(a.buffer);switch(t){case"b":case"c":return l.getBooleanArray(r);case"d":return l.getFloat64Array(r);case"f":return l.getFloat32Array(r);case"i":return l.getInt32Array(r);case"l":return l.getInt64Array(r)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}}class rE{constructor(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=t!==void 0?t:!0}getOffset(){return this.offset}size(){return this.dv.buffer.byteLength}skip(e){this.offset+=e}getBoolean(){return(this.getUint8()&1)===1}getBooleanArray(e){const t=[];for(let i=0;i<e;i++)t.push(this.getBoolean());return t}getUint8(){const e=this.dv.getUint8(this.offset);return this.offset+=1,e}getInt16(){const e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}getInt32(){const e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}getInt32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt32());return t}getUint32(){const e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}getInt64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t&2147483648?(t=~t&4294967295,e=~e&4294967295,e===4294967295&&(t=t+1&4294967295),e=e+1&4294967295,-(t*4294967296+e)):t*4294967296+e}getInt64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getInt64());return t}getUint64(){let e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),t*4294967296+e}getFloat32(){const e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}getFloat32Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat32());return t}getFloat64(){const e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}getFloat64Array(e){const t=[];for(let i=0;i<e;i++)t.push(this.getFloat64());return t}getArrayBuffer(e){const t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}getString(e){let t=[];for(let r=0;r<e;r++)t[r]=this.getUint8();const i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),Bi.decodeText(new Uint8Array(t))}}class SP{add(e,t){this[e]=t}}function SY(n){const e="Kaydara FBX Binary  \0";return n.byteLength>=e.length&&e===CP(n,0,e.length)}function TY(n){const e=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"];let t=0;function i(r){const s=n[r-1];return n=n.slice(t+r),t++,s}for(let r=0;r<e.length;++r)if(i(1)===e[r])return!1;return!0}function sE(n){const e=/FBXVersion: (\d+)/,t=n.match(e);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function AY(n){return n/46186158e3}const CY=[];function ff(n,e,t,i){let r;switch(i.mappingType){case"ByPolygonVertex":r=n;break;case"ByPolygon":r=e;break;case"ByVertice":r=t;break;case"AllSame":r=i.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+i.mappingType)}i.referenceType==="IndexToDirect"&&(r=i.indices[r]);const s=r*i.dataSize,o=s+i.dataSize;return RY(CY,i.buffer,s,o)}const Wg=new tr,wl=new D;function TP(n){const e=new Be,t=new Be,i=new Be,r=new Be,s=new Be,o=new Be,a=new Be,l=new Be,c=new Be,u=new Be,h=new Be,d=new Be,f=n.inheritType?n.inheritType:0;if(n.translation&&e.setPosition(wl.fromArray(n.translation)),n.preRotation){const E=n.preRotation.map(jn.degToRad);E.push(n.eulerOrder),t.makeRotationFromEuler(Wg.fromArray(E))}if(n.rotation){const E=n.rotation.map(jn.degToRad);E.push(n.eulerOrder),i.makeRotationFromEuler(Wg.fromArray(E))}if(n.postRotation){const E=n.postRotation.map(jn.degToRad);E.push(n.eulerOrder),r.makeRotationFromEuler(Wg.fromArray(E)),r.invert()}n.scale&&s.scale(wl.fromArray(n.scale)),n.scalingOffset&&a.setPosition(wl.fromArray(n.scalingOffset)),n.scalingPivot&&o.setPosition(wl.fromArray(n.scalingPivot)),n.rotationOffset&&l.setPosition(wl.fromArray(n.rotationOffset)),n.rotationPivot&&c.setPosition(wl.fromArray(n.rotationPivot)),n.parentMatrixWorld&&(h.copy(n.parentMatrix),u.copy(n.parentMatrixWorld));const p=t.clone().multiply(i).multiply(r),v=new Be;v.extractRotation(u);const m=new Be;m.copyPosition(u);const g=m.clone().invert().multiply(u),b=v.clone().invert().multiply(g),y=s,_=new Be;if(f===0)_.copy(v).multiply(p).multiply(b).multiply(y);else if(f===1)_.copy(v).multiply(b).multiply(p).multiply(y);else{const E=new Be().scale(new D().setFromMatrixScale(h)).clone().invert(),C=b.clone().multiply(E);_.copy(v).multiply(p).multiply(C).multiply(y)}const T=c.clone().invert(),w=o.clone().invert();let S=e.clone().multiply(l).multiply(c).multiply(t).multiply(i).multiply(r).multiply(T).multiply(a).multiply(o).multiply(s).multiply(w);const x=new Be().copyPosition(S),M=u.clone().multiply(x);return d.copyPosition(M),S=d.clone().multiply(_),S.premultiply(u.invert()),S}function AP(n){n=n||0;const e=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return n===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),e[0]):e[n]}function $g(n){return n.split(",").map(function(e){return parseFloat(e)})}function CP(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=n.byteLength),Bi.decodeText(new Uint8Array(n,e,t))}function PY(n,e){for(let t=0,i=n.length,r=e.length;t<r;t++,i++)n[i]=e[t]}function RY(n,e,t,i){for(let r=t,s=0;r<i;r++,s++)n[s]=e[r];return n}function oE(n,e,t){return n.slice(0,e).concat(t).concat(n.slice(e))}var LY=Object.defineProperty,OY=(n,e,t)=>e in n?LY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Qy=(n,e,t)=>(OY(n,typeof e!="symbol"?e+"":e,t),t);class PP{constructor(e){Qy(this,"data"),this.data=e}generateShapes(e,t=100,i){const r=[],s=Ft({letterSpacing:0,lineHeight:1},i),o=IY(e,t,this.data,s);for(let a=0,l=o.length;a<l;a++)Array.prototype.push.apply(r,o[a].toShapes(!1));return r}}Qy(PP,"isFont");Qy(PP,"type");function IY(n,e,t,i){const r=Array.from(n),s=e/t.resolution,o=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*s,a=[];let l=0,c=0;for(let u=0;u<r.length;u++){const h=r[u];if(h==="\n")l=0,c-=o*i.lineHeight;else{const d=DY(h,s,l,c,t);d&&(l+=d.offsetX+i.letterSpacing,a.push(d.path))}}return a}function DY(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");return}const o=new r2;let a,l,c,u,h,d,f,p;if(s.o){const v=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let m=0,g=v.length;m<g;)switch(v[m++]){case"m":a=parseInt(v[m++])*e+t,l=parseInt(v[m++])*e+i,o.moveTo(a,l);break;case"l":a=parseInt(v[m++])*e+t,l=parseInt(v[m++])*e+i,o.lineTo(a,l);break;case"q":c=parseInt(v[m++])*e+t,u=parseInt(v[m++])*e+i,h=parseInt(v[m++])*e+t,d=parseInt(v[m++])*e+i,o.quadraticCurveTo(h,d,c,u);break;case"b":c=parseInt(v[m++])*e+t,u=parseInt(v[m++])*e+i,h=parseInt(v[m++])*e+t,d=parseInt(v[m++])*e+i,f=parseInt(v[m++])*e+t,p=parseInt(v[m++])*e+i,o.bezierCurveTo(h,d,f,p,c,u);break}}return{offsetX:s.ha*e,path:o}}const jg=new WeakMap;class UY extends Vn{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new Mi(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(r)},i,r)}decodeDracoFile(e,t,i,r){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const i=JSON.stringify(t);if(jg.has(e)){const l=jg.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,u)=>{r._callbacks[s]={resolve:c,reject:u},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),jg.set(e,{key:i,promise:a}),a}_createGeometry(e){const t=new Ye;e.index&&t.setIndex(new Tt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize;t.setAttribute(s,new Tt(o,a))}return t}_loadLibrary(e,t){const i=new Mi(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=NY.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function NY(){let n,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(n)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const h=u.draco,d=new h.Decoder,f=new h.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=t(h,d,f,c),v=p.attributes.map(m=>m.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{h.destroy(f),h.destroy(d)}});break}};function t(o,a,l,c){const u=c.attributeIDs,h=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const v={index:null,attributes:[]};for(const m in u){const g=self[h[m]];let b,y;if(c.useUniqueIDs)y=u[m],b=a.GetAttributeByUniqueId(d,y);else{if(y=a.GetAttributeId(d,o[u[m]]),y===-1)continue;b=a.GetAttribute(d,y)}v.attributes.push(r(o,a,d,m,g,b))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){const c=l.num_faces()*3,u=c*4,h=o._malloc(u);a.GetTrianglesUInt32Array(l,u,h);const d=new Uint32Array(o.HEAPF32.buffer,h,c).slice();return o._free(h),{array:d,itemSize:1}}function r(o,a,l,c,u,h){const d=h.num_components(),f=l.num_points()*d,p=f*u.BYTES_PER_ELEMENT,v=s(o,u),m=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,h,v,p,m);const g=new u(o.HEAPF32.buffer,m,f).slice();return o._free(m),{name:c,array:g,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}const OK=qe({__name:"Levioso",props:{speed:{default:1},rotationFactor:{default:1},floatFactor:{default:1},range:{default:()=>[-.1,.1]}},setup(n,{expose:e}){const t=n,i=qn();e({value:i});{const r=Math.random()*1e4,{onLoop:s}=lr();let o=r;s(({delta:a})=>{if(!i.value)return;o+=a*t.speed;const l=o*.25,c=i.value;c.rotation.x=Math.cos(l)*.125*t.rotationFactor,c.rotation.y=Math.sin(l)*.125*t.rotationFactor,c.rotation.z=Math.sin(l)*.05*t.rotationFactor,c.position.y=jn.mapLinear(Math.sin(l),-1,1,t.range[0],t.range[1])*t.floatFactor})}return(r,s)=>(rt(),Mt("TresGroup",wr(r.$attrs,{ref_key:"groupRef",ref:i}),[wi(r.$slots,"default")],16))}});function RP(n){return _p()?(H0(n),!0):!1}function Qi(n){return typeof n=="function"?n():we(n)}const FY=typeof window<"u"&&typeof document<"u",kY=Object.prototype.toString,BY=n=>kY.call(n)==="[object Object]",Ua=()=>{};function LP(n,e){function t(...i){return new Promise((r,s)=>{Promise.resolve(n(()=>e.apply(this,i),{fn:e,thisArg:this,args:i})).then(r).catch(s)})}return t}function zY(n,e={}){let t,i,r=Ua;const s=o=>{clearTimeout(o),r(),r=Ua};return o=>{const a=Qi(n),l=Qi(e.maxWait);return t&&s(t),a<=0||l!==void 0&&l<=0?(i&&(s(i),i=null),Promise.resolve(o())):new Promise((c,u)=>{r=e.rejectOnCancel?u:c,l&&!i&&(i=setTimeout(()=>{t&&s(t),i=null,c(o())},l)),t=setTimeout(()=>{i&&s(i),i=null,c(o())},a)})}}function VY(n,e=!0,t=!0,i=!1){let r=0,s,o=!0,a=Ua,l;const c=()=>{s&&(clearTimeout(s),s=void 0,a(),a=Ua)};return u=>{const h=Qi(n),d=Date.now()-r,f=()=>l=u();return c(),h<=0?(r=Date.now(),f()):(d>h&&(t||!o)?(r=Date.now(),f()):e&&(l=new Promise((p,v)=>{a=i?v:p,s=setTimeout(()=>{r=Date.now(),o=!0,p(f()),c()},Math.max(0,h-d))})),!t&&!s&&(s=setTimeout(()=>o=!0,h)),o=!1,l)}}function HY(n,e=200,t={}){return LP(zY(e,t),n)}function GY(n,e=200,t=!1,i=!0,r=!1){return LP(VY(e,t,i,r),n)}function WY(n,e=!0){En()?_n(n):e?n():$r(n)}function $Y(n){var e;const t=Qi(n);return(e=t==null?void 0:t.$el)!=null?e:t}const Lc=FY?window:void 0;function Bn(...n){let e,t,i,r;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,i,r]=n,e=Lc):[e,t,i,r]=n,!e)return Ua;Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);const s=[],o=()=>{s.forEach(u=>u()),s.length=0},a=(u,h,d,f)=>(u.addEventListener(h,d,f),()=>u.removeEventListener(h,d,f)),l=ft(()=>[$Y(e),Qi(r)],([u,h])=>{if(o(),!u)return;const d=BY(h)?Ft({},h):h;s.push(...t.flatMap(f=>i.map(p=>a(u,f,p,d))))},{immediate:!0,flush:"post"}),c=()=>{l(),o()};return RP(c),c}function jY(n){return typeof n=="function"?n:typeof n=="string"?e=>e.key===n:Array.isArray(n)?e=>n.includes(e.key):()=>!0}function Zo(...n){let e,t,i={};n.length===3?(e=n[0],t=n[1],i=n[2]):n.length===2?typeof n[1]=="object"?(e=!0,t=n[0],i=n[1]):(e=n[0],t=n[1]):(e=!0,t=n[0]);const{target:r=Lc,eventName:s="keydown",passive:o=!1,dedupe:a=!1}=i,l=jY(e);return Bn(r,s,c=>{c.repeat&&Qi(a)||l(c)&&t(c)},o)}function XY(){const n=be(!1);return En()&&_n(()=>{n.value=!0}),n}function YY(n){const e=XY();return Te(()=>(e.value,!!n()))}function qY(n,e={}){const{window:t=Lc}=e,i=YY(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let r;const s=be(!1),o=c=>{s.value=c.matches},a=()=>{r&&("removeEventListener"in r?r.removeEventListener("change",o):r.removeListener(o))},l=rr(()=>{i.value&&(a(),r=t.matchMedia(Qi(n)),"addEventListener"in r?r.addEventListener("change",o):r.addListener(o),s.value=r.matches)});return RP(()=>{l(),a(),r=void 0}),s}const aE=1;function KY(n,e={}){const{throttle:t=0,idle:i=200,onStop:r=Ua,onScroll:s=Ua,offset:o={left:0,right:0,top:0,bottom:0},eventListenerOptions:a={capture:!1,passive:!0},behavior:l="auto",window:c=Lc}=e,u=be(0),h=be(0),d=Te({get(){return u.value},set(w){p(w,void 0)}}),f=Te({get(){return h.value},set(w){p(void 0,w)}});function p(w,S){var x,M,E;if(!c)return;const C=Qi(n);C&&((E=C instanceof Document?c.document.body:C)==null||E.scrollTo({top:(x=Qi(S))!=null?x:f.value,left:(M=Qi(w))!=null?M:d.value,behavior:Qi(l)}))}const v=be(!1),m=li({left:!0,right:!1,top:!0,bottom:!1}),g=li({left:!1,right:!1,top:!1,bottom:!1}),b=w=>{v.value&&(v.value=!1,g.left=!1,g.right=!1,g.top=!1,g.bottom=!1,r(w))},y=HY(b,t+i),_=w=>{var S;if(!c)return;const x=w.document?w.document.documentElement:(S=w.documentElement)!=null?S:w,{display:M,flexDirection:E}=getComputedStyle(x),C=x.scrollLeft;g.left=C<u.value,g.right=C>u.value;const O=Math.abs(C)<=0+(o.left||0),$=Math.abs(C)+x.clientWidth>=x.scrollWidth-(o.right||0)-aE;M==="flex"&&E==="row-reverse"?(m.left=$,m.right=O):(m.left=O,m.right=$),u.value=C;let U=x.scrollTop;w===c.document&&!U&&(U=c.document.body.scrollTop),g.top=U<h.value,g.bottom=U>h.value;const j=Math.abs(U)<=0+(o.top||0),W=Math.abs(U)+x.clientHeight>=x.scrollHeight-(o.bottom||0)-aE;M==="flex"&&E==="column-reverse"?(m.top=W,m.bottom=j):(m.top=j,m.bottom=W),h.value=U},T=w=>{var S;if(!c)return;const x=(S=w.target.documentElement)!=null?S:w.target;_(x),v.value=!0,y(w),s(w)};return Bn(n,"scroll",t?GY(T,t,!0,!1):T,a),Bn(n,"scrollend",b,a),{x:d,y:f,isScrolling:v,arrivedState:m,directions:g,measure(){const w=Qi(n);c&&w&&_(w)}}}function ZY(n={}){const{window:e=Lc}=n;if(!e)return{x:be(0),y:be(0)};const t=be(e.scrollX),i=be(e.scrollY);return Bn(e,"scroll",()=>{t.value=e.scrollX,i.value=e.scrollY},{capture:!1,passive:!0}),{x:t,y:i}}function JY(n={}){const{window:e=Lc,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:i=Number.POSITIVE_INFINITY,listenOrientation:r=!0,includeScrollbar:s=!0}=n,o=be(t),a=be(i),l=()=>{e&&(s?(o.value=e.innerWidth,a.value=e.innerHeight):(o.value=e.document.documentElement.clientWidth,a.value=e.document.documentElement.clientHeight))};if(l(),WY(l),Bn("resize",l,{passive:!0}),r){const c=qY("(orientation: portrait)");ft(c,()=>l())}return{width:o,height:a}}class fp extends ke{constructor(){super(fp.Geometry,new Xn({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new D,t=new D,i=new m0(16,16),r=new m0(16,16);let s=br;const o=fp.Geometry,a=new Iu({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n				precision highp float;\n\n				uniform vec3 screenPosition;\n				uniform vec2 scale;\n\n				attribute vec3 position;\n\n				void main() {\n\n					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n				}",fragmentShader:"\n\n				precision highp float;\n\n				void main() {\n\n					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );\n\n				}",depthTest:!0,depthWrite:!1,transparent:!1}),l=new Iu({uniforms:{map:{value:i},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n				precision highp float;\n\n				uniform vec3 screenPosition;\n				uniform vec2 scale;\n\n				attribute vec3 position;\n				attribute vec2 uv;\n\n				varying vec2 vUV;\n\n				void main() {\n\n					vUV = uv;\n\n					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n				}",fragmentShader:"\n\n				precision highp float;\n\n				uniform sampler2D map;\n\n				varying vec2 vUV;\n\n				void main() {\n\n					gl_FragColor = texture2D( map, vUV );\n\n				}",depthTest:!1,depthWrite:!1,transparent:!1}),c=new ke(o,a),u=[],h=OP.Shader,d=new Iu({name:h.name,uniforms:{map:{value:null},occlusionMap:{value:r},color:{value:new Oe(16777215)},scale:{value:new me},screenPosition:{value:new D}},vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:np,transparent:!0,depthWrite:!1}),f=new ke(o,d);this.addElement=function(b){u.push(b)};const p=new me,v=new me,m=new t2,g=new gt;this.onBeforeRender=function(b,y,_){b.getCurrentViewport(g);const T=b.getRenderTarget(),w=T!==null?T.texture.type:br;s!==w&&(i.dispose(),r.dispose(),i.type=r.type=w,s=w);const S=g.w/g.z,x=g.z/2,M=g.w/2;let E=16/g.w;if(p.set(E*S,E),m.min.set(g.x,g.y),m.max.set(g.x+(g.z-16),g.y+(g.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(_.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(_.projectionMatrix),v.x=g.x+e.x*x+x-8,v.y=g.y+e.y*M+M-8,m.containsPoint(v))){b.copyFramebufferToTexture(v,i);let C=a.uniforms;C.scale.value=p,C.screenPosition.value=e,b.renderBufferDirect(_,null,o,a,c,null),b.copyFramebufferToTexture(v,r),C=l.uniforms,C.scale.value=p,C.screenPosition.value=e,b.renderBufferDirect(_,null,o,l,c,null);const O=-e.x*2,$=-e.y*2;for(let U=0,j=u.length;U<j;U++){const W=u[U],q=d.uniforms;q.color.value.copy(W.color),q.map.value=W.texture,q.screenPosition.value.x=e.x+O*W.distance,q.screenPosition.value.y=e.y+$*W.distance,E=W.size/g.w;const ie=g.w/g.z;q.scale.value.set(E*ie,E),d.uniformsNeedUpdate=!0,b.renderBufferDirect(_,null,o,d,f,null)}}},this.dispose=function(){a.dispose(),l.dispose(),d.dispose(),i.dispose(),r.dispose();for(let b=0,y=u.length;b<y;b++)u[b].texture.dispose()}}}class OP{constructor(e,t=1,i=0,r=new Oe(16777215)){this.texture=e,this.size=t,this.distance=i,this.color=r}}OP.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n		precision highp float;\n\n		uniform vec3 screenPosition;\n		uniform vec2 scale;\n\n		uniform sampler2D occlusionMap;\n\n		attribute vec3 position;\n		attribute vec2 uv;\n\n		varying vec2 vUV;\n		varying float vVisibility;\n\n		void main() {\n\n			vUV = uv;\n\n			vec2 pos = position.xy;\n\n			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\n			vVisibility =        visibility.r / 9.0;\n			vVisibility *= 1.0 - visibility.g / 9.0;\n			vVisibility *=       visibility.b / 9.0;\n\n			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n\n		}",fragmentShader:"\n\n		precision highp float;\n\n		uniform sampler2D map;\n		uniform vec3 color;\n\n		varying vec2 vUV;\n		varying float vVisibility;\n\n		void main() {\n\n			vec4 texture = texture2D( map, vUV );\n			texture.a *= vVisibility;\n			gl_FragColor = texture;\n			gl_FragColor.rgb *= color;\n\n		}"};fp.Geometry=function(){const n=new Ye,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),t=new xc(e,5);return n.setIndex([0,1,2,0,2,3]),n.setAttribute("position",new Jr(t,3,0,!1)),n.setAttribute("uv",new Jr(t,2,3,!1)),n}();jn.clamp;jn.lerp;let pf=null;function QY(n,e){return t=>{e&&e(t),n.draco&&(pf||(pf=new UY),pf.setDecoderPath(n.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),t.setDRACOLoader(pf))}}async function IK(n,e={draco:!1},t){return await f2(IX,n,QY(e,t))}async function DK(n){return await f2(yY,n)}const lE="[TresJS - Cientos ▲ ■ ♥] ";function IP(){function n(i,r){console.error("".concat(lE," ").concat(i),r||"")}function e(i){console.warn("".concat(lE," ").concat(i))}function t(i,r){}return{logError:n,logWarning:e,logMessage:t}}let Xg=0;function UK(){const n=be(!1),e=be(0),t=be([]),{logError:i}=IP();return new Promise(r=>{Dl.onStart=()=>{n.value=!1},Dl.onLoad=()=>{n.value=!0},Dl.onProgress=(s,o,a)=>{o===a&&(Xg=a,n.value=!0,t.value.push(s)),e.value=Math.round((o-Xg)/(a-Xg)*100||100,2)},Dl.onError=s=>{i("Error loading assets",new Error(s)),n.value=!0},r({items:t,hasFinishLoading:n,progress:e})})}const eq=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],NK=qe({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!1},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:1/0},minAzimuthAngle:{default:-1/0},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:1/0},minZoom:{default:0},maxZoom:{default:1/0},touches:{default:()=>({ONE:mr.ROTATE,TWO:mr.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(n,{expose:e,emit:t}){const i=n,r=t,{makeDefault:s,autoRotate:o,autoRotateSpeed:a,enableDamping:l,dampingFactor:c,enablePan:u,keyPanSpeed:h,maxAzimuthAngle:d,minAzimuthAngle:f,maxPolarAngle:p,minPolarAngle:v,minDistance:m,maxDistance:g,minZoom:b,maxZoom:y,enableZoom:_,zoomSpeed:T,enableRotate:w,touches:S,rotateSpeed:x,target:M}=Ar(i),{camera:E,renderer:C,extend:O,controls:$}=Tr(),U=be(null);O({OrbitControls:xP}),ft(U,q=>{j(),q&&s.value?$.value=q:$.value=null});function j(){Bn(U.value,"change",()=>r("change",U.value)),Bn(U.value,"start",()=>r("start",U.value)),Bn(U.value,"end",()=>r("end",U.value))}const{onLoop:W}=lr();return W(()=>{U.value&&(l.value||o.value)&&U.value.update()}),Si(()=>{U.value&&U.value.dispose()}),e({value:U}),(q,ie)=>(q.camera||we(E))&&(q.domElement||we(C))?(rt(),Mt("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:U,target:we(M),"auto-rotate":we(o),"auto-rotate-speed":we(a),"enable-damping":we(l),"damping-factor":we(c),"enable-pan":we(u),"key-pan-speed":we(h),keys:q.keys,"max-azimuth-angle":we(d),"min-azimuth-angle":we(f),"max-polar-angle":we(p),"min-polar-angle":we(v),"min-distance":we(m),"max-distance":we(g),"min-zoom":we(b),"max-zoom":we(y),touches:we(S),"enable-zoom":we(_),"zoom-speed":we(T),"enable-rotate":we(w),"rotate-speed":we(x),args:[q.camera||we(E),q.domElement||we(C).domElement]},null,8,eq)):Ii("",!0)}}),tq=5,nq=6,iq=.3,FK=qe({__name:"KeyboardControls",props:{forward:{default:()=>["w","W"]},back:{default:()=>["s","S"]},left:{default:()=>["a","A"]},right:{default:()=>["d","D"]},jump:{default:()=>[" "]},gravity:{default:9.8},moveSpeed:{default:.1},headBobbing:{type:Boolean,default:!1},is2D:{type:Boolean,default:!1}},setup(n){var e;const t=n,{forward:i,back:r,left:s,right:o,jump:a,gravity:l,moveSpeed:c,headBobbing:u,is2D:h}=Ar(t),{camera:d,controls:f}=Tr(),p=be(0),v=be(0),m=be(!1),g=be(!1),b=be(0),y=qn(),_=h.value?"y":"z",T=((e=d.value.position)==null?void 0:e.y)||0;Zo(i.value,()=>{m.value=!0,v.value=c.value},{eventName:"keydown"}),Zo(r.value,()=>{m.value=!0,v.value=-c.value},{eventName:"keydown"}),Zo([...i.value,...r.value],()=>{m.value=!1,v.value=0},{eventName:"keyup"}),Zo(s.value,()=>{m.value=!0,p.value=-c.value},{eventName:"keydown"}),Zo(o.value,()=>{m.value=!0,p.value=c.value},{eventName:"keydown"}),Zo([...s.value,...o.value],()=>{m.value=!1,p.value=0},{eventName:"keyup"}),Zo(a.value,()=>{g.value||(b.value=Date.now()),g.value=!0});const w=C=>m.value?Math.sin(C*tq)*iq+T:T,S=()=>(Date.now()-b.value)/1e3*3,x=C=>T+nq*C-.5*l.value*C**2,M=()=>{if(g.value){const C=x(S());return C<=T&&(g.value=!1),C}return 0},{onLoop:E}=lr();return E(({elapsed:C})=>{var O;f.value instanceof R0&&(O=f.value)!=null&&O.isLocked?(f.value.moveForward(v.value),f.value.moveRight(p.value),d.value.position&&(d.value.position.y=u.value?w(C):T,d.value.position.y+=M())):y.value.children.length>0&&!(f.value instanceof R0)&&(y.value.position.x+=p.value,y.value.position[_]+=h.value?v.value:-v.value)}),(C,O)=>(rt(),Mt("TresGroup",{ref_key:"wrapperRef",ref:y},[wi(C.$slots,"default")],512))}}),rq=["object","args","mode","enabled","axis","translation-snap","rotation-snap","scale-snap","space","size","show-x","show-y","show-z"],kK=qe({__name:"TransformControls",props:{object:{},mode:{default:"translate"},enabled:{type:Boolean,default:!0},axis:{default:"XYZ"},translationSnap:{},rotationSnap:{},scaleSnap:{},space:{default:"world"},size:{default:1},showX:{type:Boolean,default:!0},showY:{type:Boolean,default:!0},showZ:{type:Boolean,default:!0}},emits:["dragging","change","mouseDown","mouseUp","objectChange"],setup(n,{emit:e}){const t=n,i=e,{object:r,mode:s,enabled:o,axis:a,translationSnap:l,rotationSnap:c,scaleSnap:u,space:h,size:d,showX:f,showY:p,showZ:v}=Ar(t),m=qn(),{controls:g,camera:b,renderer:y,extend:_}=Tr();_({TransformControls:xX});const T=S=>{g.value&&(g.value.enabled=!S.value),i("dragging",S.value)};function w(){Bn(m.value,"change",()=>i("change")),Bn(m.value,"dragging-changed",T),Bn(m.value,"mouseDown",()=>i("mouseDown")),Bn(m.value,"mouseUp",()=>i("mouseUp")),Bn(m.value,"objectChange",()=>i("objectChange"))}return rr(()=>{m.value&&w()}),Si(()=>{m.value&&m.value.dispose()}),(S,x)=>we(b)&&we(y)?(rt(),Mt("TresTransformControls",{key:0,ref_key:"controlsRef",ref:m,object:we(r),args:[we(b),we(y).domElement],mode:we(s),enabled:we(o),axis:we(a),"translation-snap":we(l),"rotation-snap":we(c),"scale-snap":we(u),space:we(h),size:we(d),"show-x":we(f),"show-y":we(p),"show-z":we(v),visible:!0},null,8,rq)):Ii("",!0)}}),sq=["args"],BK=qe({__name:"PointerLockControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},selector:{}},emits:["isLock"],setup(n,{expose:e,emit:t}){const i=n,r=t,{camera:s,renderer:o,extend:a,controls:l}=Tr(),c=be(null);let u;a({PointerLockControls:R0});const h=d=>{r("isLock",d)};return ft(c,d=>{d&&i.makeDefault?l.value=d:l.value=null,u=document.getElementById(i.selector||"")||o.value.domElement,Bn(u,"click",()=>{var p,v,m;(p=l.value)==null||p.lock(),(v=l.value)==null||v.addEventListener("lock",()=>h(!0)),(m=l.value)==null||m.addEventListener("unlock",()=>h(!1))})}),Si(()=>{var d,f;(d=l.value)==null||d.removeEventListener("lock",()=>h(!0)),(f=l.value)==null||f.removeEventListener("unlock",()=>h(!1)),c.value&&c.value.dispose()}),e({value:l}),(d,f)=>(d.camera||we(s))&&(d.domElement||we(o))?(rt(),Mt("TresPointerLockControls",{key:0,ref_key:"controlsRef",ref:c,args:[d.camera||we(s),d.domElement||we(o).domElement]},null,8,sq)):Ii("",!0)}}),oq=["args"],zK=qe({__name:"MapControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{}},setup(n){const e=n,{camera:t,renderer:i,extend:r,controls:s}=Tr(),o=be(null);return r({MapControls:OX}),ft(s,a=>{a&&e.makeDefault?s.value=a:s.value=null}),Si(()=>{o.value&&o.value.dispose()}),(a,l)=>(a.camera||we(t))&&(a.domElement||we(i))?(rt(),Mt("TresMapControls",{key:0,ref_key:"controlsRef",ref:o,args:[a.camera||we(t),a.domElement||we(i).domElement]},null,8,oq)):Ii("",!0)}}),VK=qe({__name:"ScrollControls",props:{pages:{default:4},distance:{default:4},smoothScroll:{default:.1},horizontal:{type:Boolean,default:!1},htmlScroll:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,i=e,{logWarning:r}=Tc();t.smoothScroll<0&&r("SmoothControl must be greater than zero"),t.pages<0&&r("Pages must be greater than zero");const{camera:s,controls:o,renderer:a}=Tr(),l=qn(),c=document.createElement("div"),{y:u}=ZY(),{x:h,y:d,isScrolling:f}=KY(c),{height:p,width:v}=JY();let m=0;const g=be(!1),b=be(0),y=be(0),_=be(0),T=t.horizontal?"x":"y",w=ft(s,x=>{if(g.value){w();return}m=t.horizontal?(x==null?void 0:x.position.x)||0:(x==null?void 0:x.position.y)||0,g.value=!0},{immediate:!0});ft(f,x=>{o.value&&(o.value.enabled=!x)},{immediate:!0}),ft(u,x=>{!f.value&&!t.htmlScroll||(y.value=x/p.value/(_.value/p.value-1),b.value=-1*y.value,i("update:modelValue",y.value))}),ft(d,x=>{y.value=x/p.value/(_.value/p.value),b.value=-1*y.value,i("update:modelValue",y.value)}),ft(h,x=>{y.value=x/v.value/(_.value/v.value-1),b.value=+y.value,i("update:modelValue",y.value)}),ft(a,x=>{var M,E;const C=x==null?void 0:x.domElement;if(t.htmlScroll&&x!=null&&x.domElement)C!=null&&C.style.width&&C!=null&&C.style.position&&C!=null&&C.style.top&&C!=null&&C.style.left&&(C.style.width="100%",C.style.position="fixed",C.style.zIndex=" -99999",C.style.top="0",C.style.left="0"),_.value=document.body.scrollHeight;else{const O=document.createElement("div"),$=document.createElement("div");c.style[t.horizontal?"overflowX":"overflowY"]="auto",c.style[t.horizontal?"overflowY":"overflowX"]="hidden",c.style.position="absolute",c.style.width="100%",c.style.height=" 100%",c.style.top="0",c.style.left="0",c.classList.add("scrollContainer"),O.style.position="sticky",O.style.top="0px",O.style.left="0px",O.style.width="100%",O.style.height="100%",O.style.overflow="hidden",c.appendChild(O),$.style.height=t.horizontal?"100%":"".concat(p.value*t.pages,"px"),$.style.width=t.horizontal?"".concat(v.value*t.pages,"px"):"100vw",$.style.pointerEvents="none",C.style.position="fixed",C.style.zIndex="0",C!=null&&C.style.width&&(C.style.width="100%"),c.appendChild($),x.domElement.parentNode.style.position="relative",(E=(M=x==null?void 0:x.domElement)==null?void 0:M.parentNode)==null||E.appendChild(c),_.value=t.horizontal?v.value*t.pages:p.value*t.pages}},{immediate:!0});const{onLoop:S}=lr();return S(()=>{var x;if((x=s.value)!=null&&x.position){const M=(b.value*t.distance-s.value.position[T]+m)*t.smoothScroll;s.value.position[T]+=M,l.value.children.length>0&&(l.value.position[T]+=M)}}),(x,M)=>(rt(),Mt("TresGroup",{ref_key:"wrapperRef",ref:l},[wi(x.$slots,"default")],512))}});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const Ze={LEFT:1,RIGHT:2,MIDDLE:4},_e=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),Ml={NONE:0,IN:1,OUT:-1};function Jo(n){return n.isPerspectiveCamera}function to(n){return n.isOrthographicCamera}const El=Math.PI*2,cE=Math.PI/2,DP=1e-5,su=Math.PI/180;function fr(n,e,t){return Math.max(e,Math.min(t,n))}function kt(n,e=DP){return Math.abs(n)<e}function Lt(n,e,t=DP){return kt(n-e,t)}function uE(n,e){return Math.round(n/e)*e}function ou(n){return isFinite(n)?n:n<0?-Number.MAX_VALUE:Number.MAX_VALUE}function au(n){return Math.abs(n)<Number.MAX_VALUE?n:n*(1/0)}function mf(n,e,t,i,r=1/0,s){i=Math.max(1e-4,i);const o=2/i,a=o*s,l=1/(1+a+.48*a*a+.235*a*a*a);let c=n-e;const u=e,h=r*i;c=fr(c,-h,h),e=n-c;const d=(t.value+o*c)*s;t.value=(t.value-o*d)*l;let f=e+(c+d)*l;return u-n>0==f>u&&(f=u,t.value=(f-u)/s),f}function hE(n,e,t,i,r=1/0,s,o){i=Math.max(1e-4,i);const a=2/i,l=a*s,c=1/(1+l+.48*l*l+.235*l*l*l);let u=e.x,h=e.y,d=e.z,f=n.x-u,p=n.y-h,v=n.z-d;const m=u,g=h,b=d,y=r*i,_=y*y,T=f*f+p*p+v*v;if(T>_){const j=Math.sqrt(T);f=f/j*y,p=p/j*y,v=v/j*y}u=n.x-f,h=n.y-p,d=n.z-v;const w=(t.x+a*f)*s,S=(t.y+a*p)*s,x=(t.z+a*v)*s;t.x=(t.x-a*w)*c,t.y=(t.y-a*S)*c,t.z=(t.z-a*x)*c,o.x=u+(f+w)*c,o.y=h+(p+S)*c,o.z=d+(v+x)*c;const M=m-n.x,E=g-n.y,C=b-n.z,O=o.x-m,$=o.y-g,U=o.z-b;return M*O+E*$+C*U>0&&(o.x=m,o.y=g,o.z=b,t.x=(o.x-m)/s,t.y=(o.y-g)/s,t.z=(o.z-b)/s),o}function Yg(n,e){e.set(0,0),n.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=n.length,e.y/=n.length}function qg(n,e){return to(n)?(console.warn("".concat(e," is not supported in OrthographicCamera")),!0):!1}class aq{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const t=this._listeners[e.type];if(t!==void 0){e.target=this;const i=t.slice(0);for(let r=0,s=i.length;r<s;r++)i[r].call(this,e)}}}const lq="2.7.3",gf=1/8,UP=typeof window<"u",cq=UP&&/Mac/.test(navigator.platform),uq=!(UP&&"PointerEvent"in window);let Xe,dE,vf,Kg,hi,ot,Ct,Sl,lu,Ur,Nr,Qo,fE,pE,Xi,cu,Tl,mE,Zg,gE,Jg,Qg,_f;class Ch extends aq{static install(e){Xe=e.THREE,dE=Object.freeze(new Xe.Vector3(0,0,0)),vf=Object.freeze(new Xe.Vector3(0,1,0)),Kg=Object.freeze(new Xe.Vector3(0,0,1)),hi=new Xe.Vector2,ot=new Xe.Vector3,Ct=new Xe.Vector3,Sl=new Xe.Vector3,lu=new Xe.Vector3,Ur=new Xe.Vector3,Nr=new Xe.Vector3,Qo=new Xe.Vector3,fE=new Xe.Vector3,pE=new Xe.Vector3,Xi=new Xe.Spherical,cu=new Xe.Spherical,Tl=new Xe.Box3,mE=new Xe.Box3,Zg=new Xe.Sphere,gE=new Xe.Quaternion,Jg=new Xe.Quaternion,Qg=new Xe.Matrix4,_f=new Xe.Raycaster}static get ACTION(){return _e}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=_e.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Ml.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Xe.Vector3,this._focalOffsetVelocity=new Xe.Vector3,this._zoomVelocity={value:0},this._truckInternal=(_,T,w)=>{let S,x;if(Jo(this._camera)){const M=ot.copy(this._camera.position).sub(this._target),E=this._camera.getEffectiveFOV()*su,C=M.length()*Math.tan(E*.5);S=this.truckSpeed*_*C/this._elementRect.height,x=this.truckSpeed*T*C/this._elementRect.height}else if(to(this._camera)){const M=this._camera;S=_*(M.right-M.left)/M.zoom/this._elementRect.width,x=T*(M.top-M.bottom)/M.zoom/this._elementRect.height}else return;this.verticalDragToForward?(w?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(S,0,!0),this.forward(-x,!0)):w?this.setFocalOffset(this._focalOffsetEnd.x+S,this._focalOffsetEnd.y+x,this._focalOffsetEnd.z,!0):this.truck(S,x,!0)},this._rotateInternal=(_,T)=>{const w=El*this.azimuthRotateSpeed*_/this._elementRect.height,S=El*this.polarRotateSpeed*T/this._elementRect.height;this.rotate(w,S,!0)},this._dollyInternal=(_,T,w)=>{const S=Math.pow(.95,-_*this.dollySpeed),x=this._sphericalEnd.radius,M=this._sphericalEnd.radius*S,E=fr(M,this.minDistance,this.maxDistance),C=E-M;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(M,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(C,!0),this._dollyToNoClamp(E,!0)):this._dollyToNoClamp(E,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?M:E)-x,this._dollyControlCoord.set(T,w)),this._lastDollyDirection=Math.sign(-_)},this._zoomInternal=(_,T,w)=>{const S=Math.pow(.95,_*this.dollySpeed),x=this._zoom,M=this._zoom*S;this.zoomTo(M,!0),this.dollyToCursor&&(this._changedZoom+=M-x,this._dollyControlCoord.set(T,w))},typeof Xe>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new Xe.Quaternion().setFromUnitVectors(this._camera.up,vf),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=_e.NONE,this._target=new Xe.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Xe.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new Xe.Spherical().setFromVector3(ot.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Xe.Vector3,new Xe.Vector3,new Xe.Vector3,new Xe.Vector3],this._updateNearPlaneCorners(),this._boundary=new Xe.Box3(new Xe.Vector3(-1/0,-1/0,-1/0),new Xe.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Xe.Vector2,this.mouseButtons={left:_e.ROTATE,middle:_e.DOLLY,right:_e.TRUCK,wheel:Jo(this._camera)?_e.DOLLY:to(this._camera)?_e.ZOOM:_e.NONE},this.touches={one:_e.TOUCH_ROTATE,two:Jo(this._camera)?_e.TOUCH_DOLLY_TRUCK:to(this._camera)?_e.TOUCH_ZOOM_TRUCK:_e.NONE,three:_e.TOUCH_TRUCK};const i=new Xe.Vector2,r=new Xe.Vector2,s=new Xe.Vector2,o=_=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),x=_.clientX/S.width,M=_.clientY/S.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||M<this._interactiveArea.top||M>this._interactiveArea.bottom)return}const T=_.pointerType!=="mouse"?null:(_.buttons&Ze.LEFT)===Ze.LEFT?Ze.LEFT:(_.buttons&Ze.MIDDLE)===Ze.MIDDLE?Ze.MIDDLE:(_.buttons&Ze.RIGHT)===Ze.RIGHT?Ze.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}if((_.buttons&Ze.LEFT)===Ze.LEFT&&this._lockedPointer)return;const w={pointerId:_.pointerId,clientX:_.clientX,clientY:_.clientY,deltaX:0,deltaY:0,mouseButton:T};this._activePointers.push(w),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),this._isDragging=!0,v(_)},a=_=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const S=this._domElement.getBoundingClientRect(),x=_.clientX/S.width,M=_.clientY/S.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||M<this._interactiveArea.top||M>this._interactiveArea.bottom)return}const T=(_.buttons&Ze.LEFT)===Ze.LEFT?Ze.LEFT:(_.buttons&Ze.MIDDLE)===Ze.MIDDLE?Ze.MIDDLE:(_.buttons&Ze.RIGHT)===Ze.RIGHT?Ze.RIGHT:null;if(T!==null){const S=this._findPointerByMouseButton(T);S&&this._disposePointer(S)}const w={pointerId:1,clientX:_.clientX,clientY:_.clientY,deltaX:0,deltaY:0,mouseButton:(_.buttons&Ze.LEFT)===Ze.LEFT?Ze.LEFT:(_.buttons&Ze.MIDDLE)===Ze.LEFT?Ze.MIDDLE:(_.buttons&Ze.RIGHT)===Ze.LEFT?Ze.RIGHT:null};this._activePointers.push(w),this._domElement.ownerDocument.removeEventListener("mousemove",c),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.addEventListener("mousemove",c),this._domElement.ownerDocument.addEventListener("mouseup",h),this._isDragging=!0,v(_)},l=_=>{_.cancelable&&_.preventDefault();const T=_.pointerId,w=this._lockedPointer||this._findPointerById(T);if(w){if(w.clientX=_.clientX,w.clientY=_.clientY,w.deltaX=_.movementX,w.deltaY=_.movementY,this._state=0,_.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(_.buttons&Ze.LEFT)===Ze.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(_.buttons&Ze.MIDDLE)===Ze.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(_.buttons&Ze.RIGHT)===Ze.RIGHT&&(this._state=this._state|this.mouseButtons.right);m()}},c=_=>{const T=this._lockedPointer||this._findPointerById(1);T&&(T.clientX=_.clientX,T.clientY=_.clientY,T.deltaX=_.movementX,T.deltaY=_.movementY,this._state=0,(this._lockedPointer||(_.buttons&Ze.LEFT)===Ze.LEFT)&&(this._state=this._state|this.mouseButtons.left),(_.buttons&Ze.MIDDLE)===Ze.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(_.buttons&Ze.RIGHT)===Ze.RIGHT&&(this._state=this._state|this.mouseButtons.right),m())},u=_=>{const T=this._findPointerById(_.pointerId);if(!(T&&T===this._lockedPointer)){if(T&&this._disposePointer(T),_.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=_e.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=_e.NONE;g()}},h=()=>{const _=this._findPointerById(1);_&&_===this._lockedPointer||(_&&this._disposePointer(_),this._state=_e.NONE,g())};let d=-1;const f=_=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===_e.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const M=this._domElement.getBoundingClientRect(),E=_.clientX/M.width,C=_.clientY/M.height;if(E<this._interactiveArea.left||E>this._interactiveArea.right||C<this._interactiveArea.top||C>this._interactiveArea.bottom)return}if(_.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===_e.ROTATE||this.mouseButtons.wheel===_e.TRUCK){const M=performance.now();d-M<1e3&&this._getClientRect(this._elementRect),d=M}const T=cq?-1:-3,w=_.deltaMode===1?_.deltaY/T:_.deltaY/(T*10),S=this.dollyToCursor?(_.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,x=this.dollyToCursor?(_.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case _e.ROTATE:{this._rotateInternal(_.deltaX,_.deltaY),this._isUserControllingRotate=!0;break}case _e.TRUCK:{this._truckInternal(_.deltaX,_.deltaY,!1),this._isUserControllingTruck=!0;break}case _e.OFFSET:{this._truckInternal(_.deltaX,_.deltaY,!0),this._isUserControllingOffset=!0;break}case _e.DOLLY:{this._dollyInternal(-w,S,x),this._isUserControllingDolly=!0;break}case _e.ZOOM:{this._zoomInternal(-w,S,x),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},p=_=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Ch.ACTION.NONE){const T=_ instanceof PointerEvent?_.pointerId:0,w=this._findPointerById(T);w&&this._disposePointer(w),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mousemove",c),this._domElement.ownerDocument.removeEventListener("mouseup",h);return}_.preventDefault()}},v=_=>{if(this._enabled){if(Yg(this._activePointers,hi),this._getClientRect(this._elementRect),i.copy(hi),r.copy(hi),this._activePointers.length>=2){const T=hi.x-this._activePointers[1].clientX,w=hi.y-this._activePointers[1].clientY,S=Math.sqrt(T*T+w*w);s.set(0,S);const x=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,M=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;r.set(x,M)}if(this._state=0,!_)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in _&&_.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(_.buttons&Ze.LEFT)===Ze.LEFT&&(this._state=this._state|this.mouseButtons.left),(_.buttons&Ze.MIDDLE)===Ze.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(_.buttons&Ze.RIGHT)===Ze.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&_e.ROTATE)===_e.ROTATE||(this._state&_e.TOUCH_ROTATE)===_e.TOUCH_ROTATE||(this._state&_e.TOUCH_DOLLY_ROTATE)===_e.TOUCH_DOLLY_ROTATE||(this._state&_e.TOUCH_ZOOM_ROTATE)===_e.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&_e.TRUCK)===_e.TRUCK||(this._state&_e.TOUCH_TRUCK)===_e.TOUCH_TRUCK||(this._state&_e.TOUCH_DOLLY_TRUCK)===_e.TOUCH_DOLLY_TRUCK||(this._state&_e.TOUCH_ZOOM_TRUCK)===_e.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&_e.DOLLY)===_e.DOLLY||(this._state&_e.TOUCH_DOLLY)===_e.TOUCH_DOLLY||(this._state&_e.TOUCH_DOLLY_TRUCK)===_e.TOUCH_DOLLY_TRUCK||(this._state&_e.TOUCH_DOLLY_OFFSET)===_e.TOUCH_DOLLY_OFFSET||(this._state&_e.TOUCH_DOLLY_ROTATE)===_e.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&_e.ZOOM)===_e.ZOOM||(this._state&_e.TOUCH_ZOOM)===_e.TOUCH_ZOOM||(this._state&_e.TOUCH_ZOOM_TRUCK)===_e.TOUCH_ZOOM_TRUCK||(this._state&_e.TOUCH_ZOOM_OFFSET)===_e.TOUCH_ZOOM_OFFSET||(this._state&_e.TOUCH_ZOOM_ROTATE)===_e.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&_e.OFFSET)===_e.OFFSET||(this._state&_e.TOUCH_OFFSET)===_e.TOUCH_OFFSET||(this._state&_e.TOUCH_DOLLY_OFFSET)===_e.TOUCH_DOLLY_OFFSET||(this._state&_e.TOUCH_ZOOM_OFFSET)===_e.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Yg(this._activePointers,hi);const _=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,T=_?-_.deltaX:r.x-hi.x,w=_?-_.deltaY:r.y-hi.y;if(r.copy(hi),((this._state&_e.ROTATE)===_e.ROTATE||(this._state&_e.TOUCH_ROTATE)===_e.TOUCH_ROTATE||(this._state&_e.TOUCH_DOLLY_ROTATE)===_e.TOUCH_DOLLY_ROTATE||(this._state&_e.TOUCH_ZOOM_ROTATE)===_e.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(T,w),this._isUserControllingRotate=!0),(this._state&_e.DOLLY)===_e.DOLLY||(this._state&_e.ZOOM)===_e.ZOOM){const S=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,x=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,M=this.dollyDragInverted?-1:1;(this._state&_e.DOLLY)===_e.DOLLY?(this._dollyInternal(M*w*gf,S,x),this._isUserControllingDolly=!0):(this._zoomInternal(M*w*gf,S,x),this._isUserControllingZoom=!0)}if((this._state&_e.TOUCH_DOLLY)===_e.TOUCH_DOLLY||(this._state&_e.TOUCH_ZOOM)===_e.TOUCH_ZOOM||(this._state&_e.TOUCH_DOLLY_TRUCK)===_e.TOUCH_DOLLY_TRUCK||(this._state&_e.TOUCH_ZOOM_TRUCK)===_e.TOUCH_ZOOM_TRUCK||(this._state&_e.TOUCH_DOLLY_OFFSET)===_e.TOUCH_DOLLY_OFFSET||(this._state&_e.TOUCH_ZOOM_OFFSET)===_e.TOUCH_ZOOM_OFFSET||(this._state&_e.TOUCH_DOLLY_ROTATE)===_e.TOUCH_DOLLY_ROTATE||(this._state&_e.TOUCH_ZOOM_ROTATE)===_e.TOUCH_ZOOM_ROTATE){const S=hi.x-this._activePointers[1].clientX,x=hi.y-this._activePointers[1].clientY,M=Math.sqrt(S*S+x*x),E=s.y-M;s.set(0,M);const C=this.dollyToCursor?(r.x-this._elementRect.x)/this._elementRect.width*2-1:0,O=this.dollyToCursor?(r.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&_e.TOUCH_DOLLY)===_e.TOUCH_DOLLY||(this._state&_e.TOUCH_DOLLY_ROTATE)===_e.TOUCH_DOLLY_ROTATE||(this._state&_e.TOUCH_DOLLY_TRUCK)===_e.TOUCH_DOLLY_TRUCK||(this._state&_e.TOUCH_DOLLY_OFFSET)===_e.TOUCH_DOLLY_OFFSET?(this._dollyInternal(E*gf,C,O),this._isUserControllingDolly=!0):(this._zoomInternal(E*gf,C,O),this._isUserControllingZoom=!0)}((this._state&_e.TRUCK)===_e.TRUCK||(this._state&_e.TOUCH_TRUCK)===_e.TOUCH_TRUCK||(this._state&_e.TOUCH_DOLLY_TRUCK)===_e.TOUCH_DOLLY_TRUCK||(this._state&_e.TOUCH_ZOOM_TRUCK)===_e.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(T,w,!1),this._isUserControllingTruck=!0),((this._state&_e.OFFSET)===_e.OFFSET||(this._state&_e.TOUCH_OFFSET)===_e.TOUCH_OFFSET||(this._state&_e.TOUCH_DOLLY_OFFSET)===_e.TOUCH_DOLLY_OFFSET||(this._state&_e.TOUCH_ZOOM_OFFSET)===_e.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(T,w,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},g=()=>{Yg(this._activePointers,hi),r.copy(hi),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",c),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",b),this._domElement.ownerDocument.addEventListener("pointerlockerror",y),this._domElement.ownerDocument.addEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),v())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",b),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))};const b=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},y=()=>{this.unlockPointer()};this._addAllEventListeners=_=>{this._domElement=_,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),uq&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",u),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",p)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",u),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",p),this._domElement.ownerDocument.removeEventListener("pointermove",l,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",c),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",b),this._domElement.ownerDocument.removeEventListener("pointerlockerror",y))},this.cancel=()=>{this._state!==_e.NONE&&(this._state=_e.NONE,this._activePointers.length=0,g())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=fr(e.width,0,1),this._interactiveArea.height=fr(e.height,0,1),this._interactiveArea.x=fr(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=fr(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,i)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,i=!1){this._isUserControllingRotate=!1;const r=fr(e,this.minAzimuthAngle,this.maxAzimuthAngle),s=fr(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=r,this._sphericalEnd.phi=s,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!i||Lt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Lt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Ml.NONE,this._changedDolly=0,this._dollyToNoClamp(fr(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const s=this._collisionTest(),o=Lt(s,this._spherical.radius);if(!(i>e)&&o)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,s)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||Lt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(lu).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const i=!t||Lt(this._target.x,this._targetEnd.x,this.restThreshold)&&Lt(this._target.y,this._targetEnd.y,this.restThreshold)&&Lt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=fr(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const i=!t||Lt(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(e,t,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,i)}truck(e,t,i=!1){this._camera.updateMatrix(),Ur.setFromMatrixColumn(this._camera.matrix,0),Nr.setFromMatrixColumn(this._camera.matrix,1),Ur.multiplyScalar(e),Nr.multiplyScalar(-t);const r=ot.copy(Ur).add(Nr),s=Ct.copy(this._targetEnd).add(r);return this.moveTo(s.x,s.y,s.z,i)}forward(e,t=!1){ot.setFromMatrixColumn(this._camera.matrix,0),ot.crossVectors(this._camera.up,ot),ot.multiplyScalar(e);const i=Ct.copy(this._targetEnd).add(ot);return this.moveTo(i.x,i.y,i.z,t)}elevate(e,t=!1){return ot.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+ot.x,this._targetEnd.y+ot.y,this._targetEnd.z+ot.z,t)}moveTo(e,t,i,r=!1){this._isUserControllingTruck=!1;const s=ot.set(e,t,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,s,this.boundaryFriction),this._needsUpdate=!0,r||this._target.copy(this._targetEnd);const o=!r||Lt(this._target.x,this._targetEnd.x,this.restThreshold)&&Lt(this._target.y,this._targetEnd.y,this.restThreshold)&&Lt(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,i,r=!1){const s=ot.set(e,t,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(s.x,s.y,s.z,r)}fitToBox(e,t,{cover:i=!1,paddingLeft:r=0,paddingRight:s=0,paddingBottom:o=0,paddingTop:a=0}={}){const l=[],c=e.isBox3?Tl.copy(e):Tl.setFromObject(e);c.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const u=uE(this._sphericalEnd.theta,cE),h=uE(this._sphericalEnd.phi,cE);l.push(this.rotateTo(u,h,t));const d=ot.setFromSpherical(this._sphericalEnd).normalize(),f=gE.setFromUnitVectors(d,Kg),p=Lt(Math.abs(d.y),1);p&&f.multiply(Jg.setFromAxisAngle(vf,u)),f.multiply(this._yAxisUpSpaceInverse);const v=mE.makeEmpty();Ct.copy(c.min).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.min).setX(c.max.x).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.min).setY(c.max.y).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.max).setZ(c.min.z).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.min).setZ(c.max.z).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.max).setY(c.min.y).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.max).setX(c.min.x).applyQuaternion(f),v.expandByPoint(Ct),Ct.copy(c.max).applyQuaternion(f),v.expandByPoint(Ct),v.min.x-=r,v.min.y-=o,v.max.x+=s,v.max.y+=a,f.setFromUnitVectors(Kg,d),p&&f.premultiply(Jg.invert()),f.premultiply(this._yAxisUpSpace);const m=v.getSize(ot),g=v.getCenter(Ct).applyQuaternion(f);if(Jo(this._camera)){const b=this.getDistanceToFitBox(m.x,m.y,m.z,i);l.push(this.moveTo(g.x,g.y,g.z,t)),l.push(this.dollyTo(b,t)),l.push(this.setFocalOffset(0,0,0,t))}else if(to(this._camera)){const b=this._camera,y=b.right-b.left,_=b.top-b.bottom,T=i?Math.max(y/m.x,_/m.y):Math.min(y/m.x,_/m.y);l.push(this.moveTo(g.x,g.y,g.z,t)),l.push(this.zoomTo(T,t)),l.push(this.setFocalOffset(0,0,0,t))}return Promise.all(l)}fitToSphere(e,t){const i=[],r=e instanceof Xe.Sphere?Zg.copy(e):Ch.createBoundingSphere(e,Zg);if(i.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),Jo(this._camera)){const s=this.getDistanceToFitSphere(r.radius);i.push(this.dollyTo(s,t))}else if(to(this._camera)){const s=this._camera.right-this._camera.left,o=this._camera.top-this._camera.bottom,a=2*r.radius,l=Math.min(s/a,o/a);i.push(this.zoomTo(l,t))}return i.push(this.setFocalOffset(0,0,0,t)),Promise.all(i)}setLookAt(e,t,i,r,s,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Ml.NONE,this._changedDolly=0;const l=Ct.set(r,s,o),c=ot.set(e,t,i);this._targetEnd.copy(l),this._sphericalEnd.setFromVector3(c.sub(l).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const u=!a||Lt(this._target.x,this._targetEnd.x,this.restThreshold)&&Lt(this._target.y,this._targetEnd.y,this.restThreshold)&&Lt(this._target.z,this._targetEnd.z,this.restThreshold)&&Lt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Lt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Lt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,i,r,s,o,a,l,c,u,h,d,f,p=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Ml.NONE,this._changedDolly=0;const v=ot.set(r,s,o),m=Ct.set(e,t,i);Xi.setFromVector3(m.sub(v).applyQuaternion(this._yAxisUpSpace));const g=Sl.set(u,h,d),b=Ct.set(a,l,c);cu.setFromVector3(b.sub(g).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(v.lerp(g,f));const y=cu.theta-Xi.theta,_=cu.phi-Xi.phi,T=cu.radius-Xi.radius;this._sphericalEnd.set(Xi.radius+T*f,Xi.phi+_*f,Xi.theta+y*f),this.normalizeRotations(),this._needsUpdate=!0,p||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const w=!p||Lt(this._target.x,this._targetEnd.x,this.restThreshold)&&Lt(this._target.y,this._targetEnd.y,this.restThreshold)&&Lt(this._target.z,this._targetEnd.z,this.restThreshold)&&Lt(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Lt(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Lt(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(w)}setPosition(e,t,i,r=!1){return this.setLookAt(e,t,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,r)}setTarget(e,t,i,r=!1){const s=this.getPosition(ot),o=this.setLookAt(s.x,s.y,s.z,e,t,i,r);return this._sphericalEnd.phi=fr(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,i,r=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,i),this._needsUpdate=!0,r||this._focalOffset.copy(this._focalOffsetEnd);const s=!r||Lt(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Lt(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Lt(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}setOrbitPoint(e,t,i){this._camera.updateMatrixWorld(),Ur.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Nr.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Qo.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const r=ot.set(e,t,i),s=r.distanceTo(this._camera.position),o=r.sub(this._camera.position);Ur.multiplyScalar(o.x),Nr.multiplyScalar(o.y),Qo.multiplyScalar(o.z),ot.copy(Ur).add(Nr).add(Qo),ot.z=ot.z+s,this.dollyTo(s,!1),this.setFocalOffset(-ot.x,ot.y,-ot.z,!1),this.moveTo(e,t,i,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,i,r){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new Xe.Vector4,typeof e=="number"?this._viewport.set(e,t,i,r):this._viewport.copy(e)}getDistanceToFitBox(e,t,i,r=!1){if(qg(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const s=e/t,o=this._camera.getEffectiveFOV()*su,a=this._camera.aspect;return((r?s>a:s<a)?t:e/a)*.5/Math.tan(o*.5)+i*.5}getDistanceToFitSphere(e){if(qg(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*su,i=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,r=1<this._camera.aspect?t:i;return e/Math.sin(r*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Xe.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Xe.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof Xe.Spherical?e:new Xe.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Xe.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%El,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=El),this._spherical.theta+=El*Math.round((this._sphericalEnd.theta-this._spherical.theta)/El)}reset(e=!1){if(!Lt(this._camera.up.x,this._cameraUp0.x)||!Lt(this._camera.up.y,this._cameraUp0.y)||!Lt(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const i=this.getPosition(ot);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,vf),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=ot.subVectors(this._target,this._camera.position).normalize(),t=Ct.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(ot);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,r=this._sphericalEnd.radius-this._spherical.radius,s=fE.subVectors(this._targetEnd,this._target),o=pE.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(kt(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const u=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=mf(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,u,1/0,e),this._needsUpdate=!0}if(kt(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const u=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=mf(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,u,1/0,e),this._needsUpdate=!0}if(kt(r))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const u=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=mf(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,u,this.maxSpeed,e),this._needsUpdate=!0}if(kt(s.x)&&kt(s.y)&&kt(s.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const u=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;hE(this._target,this._targetEnd,this._targetVelocity,u,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(kt(o.x)&&kt(o.y)&&kt(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const u=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;hE(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,u,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(kt(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const u=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=mf(this._zoom,this._zoomEnd,this._zoomVelocity,u,1/0,e)}if(this.dollyToCursor){if(Jo(this._camera)&&this._changedDolly!==0){const u=this._spherical.radius-this._lastDistance,h=this._camera,d=this._getCameraDirection(lu),f=ot.copy(d).cross(h.up).normalize();f.lengthSq()===0&&(f.x=1);const p=Ct.crossVectors(f,d),v=this._sphericalEnd.radius*Math.tan(h.getEffectiveFOV()*su*.5),m=(this._sphericalEnd.radius-u-this._sphericalEnd.radius)/this._sphericalEnd.radius,g=Sl.copy(this._targetEnd).add(f.multiplyScalar(this._dollyControlCoord.x*v*h.aspect)).add(p.multiplyScalar(this._dollyControlCoord.y*v)),b=ot.copy(this._targetEnd).lerp(g,m),y=this._lastDollyDirection===Ml.IN&&this._spherical.radius<=this.minDistance,_=this._lastDollyDirection===Ml.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(y||_)){this._sphericalEnd.radius-=u,this._spherical.radius-=u;const w=Ct.copy(d).multiplyScalar(-u);b.add(w)}this._boundary.clampPoint(b,b);const T=Ct.subVectors(b,this._targetEnd);this._targetEnd.copy(b),this._target.add(T),this._changedDolly-=u,kt(this._changedDolly)&&(this._changedDolly=0)}else if(to(this._camera)&&this._changedZoom!==0){const u=this._zoom-this._lastZoom,h=this._camera,d=ot.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(h.near+h.far)/(h.near-h.far)).unproject(h),f=Ct.set(0,0,-1).applyQuaternion(h.quaternion),p=Sl.copy(d).add(f.multiplyScalar(-d.dot(h.up))),v=-(this._zoom-u-this._zoom)/this._zoom,m=this._getCameraDirection(lu),g=this._targetEnd.dot(m),b=ot.copy(this._targetEnd).lerp(p,v),y=b.dot(m),_=m.multiplyScalar(y-g);b.sub(_),this._boundary.clampPoint(b,b);const T=Ct.subVectors(b,this._targetEnd);this._targetEnd.copy(b),this._target.add(T),this._changedZoom-=u,kt(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const l=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,l),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!kt(this._focalOffset.x)||!kt(this._focalOffset.y)||!kt(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Ur.setFromMatrixColumn(this._camera.matrix,0),Nr.setFromMatrixColumn(this._camera.matrix,1),Qo.setFromMatrixColumn(this._camera.matrix,2),Ur.multiplyScalar(this._focalOffset.x),Nr.multiplyScalar(-this._focalOffset.y),Qo.multiplyScalar(this._focalOffset.z),ot.copy(Ur).add(Nr).add(Qo),this._camera.position.add(ot)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ot.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const c=this._needsUpdate;return c&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):c?(this.dispatchEvent({type:"update"}),kt(t,this.restThreshold)&&kt(i,this.restThreshold)&&kt(r,this.restThreshold)&&kt(s.x,this.restThreshold)&&kt(s.y,this.restThreshold)&&kt(s.z,this.restThreshold)&&kt(o.x,this.restThreshold)&&kt(o.y,this.restThreshold)&&kt(o.z,this.restThreshold)&&kt(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!c&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=c,this._needsUpdate=!1,c}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:ou(this.maxDistance),minZoom:this.minZoom,maxZoom:ou(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:ou(this.maxPolarAngle),minAzimuthAngle:ou(this.minAzimuthAngle),maxAzimuthAngle:ou(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:ot.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const i=JSON.parse(e);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=au(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=au(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=au(i.maxPolarAngle),this.minAzimuthAngle=au(i.minAzimuthAngle),this.maxAzimuthAngle=au(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],t),Xi.setFromVector3(ot.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Xi.theta,Xi.phi,t),this.dollyTo(Xi.radius,t),this.zoomTo(i.zoom,t),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",lq),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,i){const r=t.lengthSq();if(r===0)return e;const s=Ct.copy(t).add(e),o=this._boundary.clampPoint(s,Sl).sub(s),a=o.lengthSq();if(a===0)return e.add(t);if(a===r)return e;if(i===0)return e.add(t).add(o);{const l=1+i*a/t.dot(o);return e.add(Ct.copy(t).multiplyScalar(l)).add(o.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(Jo(this._camera)){const e=this._camera,t=e.near,i=e.getEffectiveFOV()*su,r=Math.tan(i*.5)*t,s=r*e.aspect;this._nearPlaneCorners[0].set(-s,-r,0),this._nearPlaneCorners[1].set(s,-r,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(-s,r,0)}else if(to(this._camera)){const e=this._camera,t=1/e.zoom,i=e.left*t,r=e.right*t,s=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(i,s,0),this._nearPlaneCorners[1].set(r,s,0),this._nearPlaneCorners[2].set(r,o,0),this._nearPlaneCorners[3].set(i,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||qg(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(lu);Qg.lookAt(dE,t,this._camera.up);for(let i=0;i<4;i++){const r=Ct.copy(this._nearPlaneCorners[i]);r.applyMatrix4(Qg);const s=Sl.addVectors(this._target,r);_f.set(s,t),_f.far=this._spherical.radius+1;const o=_f.intersectObjects(this.colliderMeshes);o.length!==0&&o[0].distance<e&&(e=o[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const i=()=>{this.removeEventListener("rest",i),t()};this.addEventListener("rest",i)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Xe.Sphere){const i=t,r=i.center;Tl.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&Tl.expandByObject(o)}),Tl.getCenter(r);let s=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const a=o,l=a.geometry.clone();l.applyMatrix4(a.matrixWorld);const c=l.attributes.position;for(let u=0,h=c.count;u<h;u++)ot.fromBufferAttribute(c,u),s=Math.max(s,r.distanceToSquared(ot))}),i.radius=Math.sqrt(s),i}}const hq=["min-polar-angle","max-polar-angle","min-azimuth-angle","max-azimuth-angle","distance","min-distance","max-distance","infinity-dolly","min-zoom","max-zoom","smooth-time","dragging-smooth-time","max-speed","azimuth-rotate-speed","polar-rotate-speed","dolly-speed","dolly-drag-inverted","truck-speed","dolly-to-cursor","drag-to-offset","vertical-drag-to-forward","boundary-friction","rest-threshold","collider-meshes","args"],HK=qe({__name:"CameraControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},minPolarAngle:{default:0},maxPolarAngle:{default:Math.PI},minAzimuthAngle:{default:-1/0},maxAzimuthAngle:{default:1/0},distance:{default:()=>Tr().camera.value.position.z},minDistance:{default:Number.EPSILON},maxDistance:{default:1/0},infinityDolly:{type:Boolean,default:!1},minZoom:{default:.01},maxZoom:{default:1/0},smoothTime:{default:.25},draggingSmoothTime:{default:.125},maxSpeed:{default:1/0},azimuthRotateSpeed:{default:1},polarRotateSpeed:{default:1},dollySpeed:{default:1},dollyDragInverted:{type:Boolean,default:!1},truckSpeed:{default:2},dollyToCursor:{type:Boolean,default:!1},dragToOffset:{type:Boolean,default:!1},verticalDragToForward:{type:Boolean,default:!1},boundaryFriction:{default:0},restThreshold:{default:.01},colliderMeshes:{default:()=>[]},mouseButtons:{},touches:{}},emits:["change","start","end"],setup(n,{expose:e,emit:t}){const i=n,r=t,{makeDefault:s,minPolarAngle:o,maxPolarAngle:a,minAzimuthAngle:l,maxAzimuthAngle:c,distance:u,minDistance:h,maxDistance:d,infinityDolly:f,minZoom:p,maxZoom:v,smoothTime:m,draggingSmoothTime:g,maxSpeed:b,azimuthRotateSpeed:y,polarRotateSpeed:_,dollySpeed:T,dollyDragInverted:w,truckSpeed:S,dollyToCursor:x,dragToOffset:M,verticalDragToForward:E,boundaryFriction:C,restThreshold:O,colliderMeshes:$}=Ar(i),U={Box3:Ti,MathUtils:{clamp:jn.clamp},Matrix4:Be,Quaternion:mt,Raycaster:wm,Sphere:Ai,Spherical:yh,Vector2:me,Vector3:D,Vector4:gt};Ch.install({THREE:U});const{camera:j,renderer:W,extend:q,controls:ie}=Tr(),Z=be(null);q({CameraControls:Ch}),rr(()=>{te(),Z.value&&s.value?ie.value=Z.value:ie.value=null});function te(){Bn(Z.value,"update",()=>r("change",Z.value)),Bn(Z.value,"controlend",()=>r("end",Z.value)),Bn(Z.value,"controlstart",()=>r("start",Z.value))}const{onLoop:X}=lr();return X(({delta:se})=>{var G,xe;(G=Z.value)!=null&&G.enabled&&((xe=Z.value)==null||xe.update(se))}),Si(()=>{Z.value&&Z.value.disconnect()}),e({value:Z}),(se,G)=>(se.camera||we(j))&&(se.domElement||we(W))?(rt(),Mt("TresCameraControls",{key:0,ref_key:"controlsRef",ref:Z,"min-polar-angle":we(o),"max-polar-angle":we(a),"min-azimuth-angle":we(l),"max-azimuth-angle":we(c),distance:we(u),"min-distance":we(h),"max-distance":we(d),"infinity-dolly":we(f),"min-zoom":we(p),"max-zoom":we(v),"smooth-time":we(m),"dragging-smooth-time":we(g),"max-speed":we(b),"azimuth-rotate-speed":we(y),"polar-rotate-speed":we(_),"dolly-speed":we(T),"dolly-drag-inverted":we(w),"truck-speed":we(S),"dolly-to-cursor":we(x),"drag-to-offset":we(M),"vertical-drag-to-forward":we(E),"boundary-friction":we(C),"rest-threshold":we(O),"collider-meshes":we($),args:[se.camera||we(j),se.domElement||we(W).domElement]},null,8,hq)):Ii("",!0)}});class dq extends za{constructor(e={}){super(e),wn(this,"_time"),wn(this,"_factor"),this.setValues(e),this._time={value:0},this._factor={value:1}}onBeforeCompile(e){e.uniforms||(e.uniforms={}),e.uniforms.time=this._time,e.uniforms.factor=this._factor,e.vertexShader="\n        uniform float time;\n        uniform float factor;\n        ".concat(e.vertexShader,"\n      "),e.vertexShader=e.vertexShader.replace("#include <begin_vertex>","float theta = sin( time + position.y ) / 2.0 * factor;\n          float c = cos( theta );\n          float s = sin( theta );\n          mat3 m = mat3( c, 0, s, 0, 1, 0, -s, 0, c );\n          vec3 transformed = vec3( position ) * m;\n          vNormal = vNormal * m;")}get time(){return this._time.value}set time(e){this._time.value=e}get factor(){return this._factor.value}set factor(e){this._factor.value=e}}const fq=["factor"],GK=qe({__name:"index",props:{speed:{default:1},factor:{default:1}},setup(n){const e=n,t=qn(),{extend:i}=Tr();i({MeshWobbleMaterial:dq});const{onLoop:r}=lr();return r(({elapsed:s})=>{t.value&&(t.value.time=s*(e==null?void 0:e.speed))}),(s,o)=>(rt(),Mt("TresMeshWobbleMaterial",wr({ref_key:"materialRef",ref:t,factor:s.factor},s.$attrs),null,16,fq))}});function oa(n,e,t){return Math.max(e,Math.min(t,n))}function pq(n,e){return(n%e+e)%e}function ev(n,e,t){return(1-t)*n+t*e}class eb{constructor(e=0,t=0){eb.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(oa(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}const mq="",no="srgb",tb="srgb-linear",gq="display-p3",NP="display-p3-linear",I0="linear",vE="srgb",_E="rec709",yE="p3";class Zh{constructor(e,t,i,r,s,o,a,l,c){Zh.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,c)}set(e,t,i,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=i,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],v=r[0],m=r[3],g=r[6],b=r[1],y=r[4],_=r[7],T=r[2],w=r[5],S=r[8];return s[0]=o*v+a*b+l*T,s[3]=o*m+a*y+l*w,s[6]=o*g+a*_+l*S,s[1]=c*v+u*b+h*T,s[4]=c*m+u*y+h*w,s[7]=c*g+u*_+h*S,s[2]=d*v+f*b+p*T,s[5]=d*m+f*y+p*w,s[8]=d*g+f*_+p*S,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-i*s*u+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=h*v,e[1]=(r*c-u*i)*v,e[2]=(a*i-r*o)*v,e[3]=d*v,e[4]=(u*t-r*l)*v,e[5]=(r*s-a*t)*v,e[6]=f*v,e[7]=(i*l-c*t)*v,e[8]=(o*t-i*s)*v,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(tv.makeScale(e,t)),this}rotate(e){return this.premultiply(tv.makeRotation(-e)),this}translate(e,t){return this.premultiply(tv.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const tv=new Zh,bE=new Zh().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),xE=new Zh().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),yf={[tb]:{transfer:I0,primaries:_E,toReference:n=>n,fromReference:n=>n},[no]:{transfer:vE,primaries:_E,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[NP]:{transfer:I0,primaries:yE,toReference:n=>n.applyMatrix3(xE),fromReference:n=>n.applyMatrix3(bE)},[gq]:{transfer:vE,primaries:yE,toReference:n=>n.convertSRGBToLinear().applyMatrix3(xE),fromReference:n=>n.applyMatrix3(bE).convertLinearToSRGB()}},vq=new Set([tb,NP]),dr={enabled:!0,_workingColorSpace:tb,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!vq.has(n))throw new Error('Unsupported working color space, "'.concat(n,'".'));this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=yf[e].toReference,r=yf[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return yf[n].primaries},getTransfer:function(n){return n===mq?I0:yf[n].transfer}};function nv(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function iv(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const FP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Qs={h:0,s:0,l:0},bf={h:0,s:0,l:0};function rv(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class pp{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=no){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,dr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=dr.workingColorSpace){return this.r=e,this.g=t,this.b=i,dr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=dr.workingColorSpace){if(e=pq(e,1),t=oa(t,0,1),i=oa(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=rv(o,s,e+1/3),this.g=rv(o,s,e),this.b=rv(o,s,e-1/3)}return dr.toWorkingColorSpace(this,r),this}setStyle(e,t=no){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=no){const i=FP[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=nv(e.r),this.g=nv(e.g),this.b=nv(e.b),this}copyLinearToSRGB(e){return this.r=iv(e.r),this.g=iv(e.g),this.b=iv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=no){return dr.fromWorkingColorSpace(Wn.copy(this),e),Math.round(oa(Wn.r*255,0,255))*65536+Math.round(oa(Wn.g*255,0,255))*256+Math.round(oa(Wn.b*255,0,255))}getHexString(e=no){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=dr.workingColorSpace){dr.fromWorkingColorSpace(Wn.copy(this),t);const i=Wn.r,r=Wn.g,s=Wn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const h=o-a;switch(c=u<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=dr.workingColorSpace){return dr.fromWorkingColorSpace(Wn.copy(this),t),e.r=Wn.r,e.g=Wn.g,e.b=Wn.b,e}getStyle(e=no){dr.fromWorkingColorSpace(Wn.copy(this),e);const t=Wn.r,i=Wn.g,r=Wn.b;return e!==no?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(i.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(t*255),",").concat(Math.round(i*255),",").concat(Math.round(r*255),")")}offsetHSL(e,t,i){return this.getHSL(Qs),this.setHSL(Qs.h+e,Qs.s+t,Qs.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Qs),e.getHSL(bf);const i=ev(Qs.h,bf.h,t),r=ev(Qs.s,bf.s,t),s=ev(Qs.l,bf.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Wn=new pp;pp.NAMES=FP;class _q extends za{constructor(e={}){super(),wn(this,"isMeshPhysicalMaterial"),wn(this,"clearcoatMap"),wn(this,"clearcoatRoughness"),wn(this,"clearcoatRoughnessMap"),wn(this,"clearcoatNormalScale"),wn(this,"clearcoatNormalMap"),wn(this,"ior"),wn(this,"transmissionMap"),wn(this,"thickness"),wn(this,"thicknessMap"),wn(this,"attenuationDistance"),wn(this,"attenuationColor"),wn(this,"specularIntensity"),wn(this,"specularIntensityMap"),wn(this,"specularColor"),wn(this,"specularColorMap"),wn(this,"_clearcoat"),wn(this,"_transmission"),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new eb(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get(){return oa(2.5*(this.ior-1)/(this.ior+1),0,1)},set(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.roughness=0,this.transmissionMap=null,this.thickness=.5,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new pp(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new pp(1,1,1),this.specularColorMap=null,this._clearcoat=.5,this._transmission=1,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const yq=_q,WK=qe({__name:"index",setup(n,{expose:e}){const t=qn(),{extend:i}=Tr();return i({MeshGlassMaterial:yq}),e({MeshGlassMaterialClass:t}),(r,s)=>(rt(),Mt("TresMeshGlassMaterial",{ref_key:"MeshGlassMaterialClass",ref:t},null,512))}});var bq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xq(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function xf(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wq={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(i,r,s){function o(c,u){if(!r[c]){if(!i[c]){var h=typeof xf=="function"&&xf;if(!u&&h)return h(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}u=r[c]={exports:{}},i[c][0].call(u.exports,function(d){var f=i[c][1][d];return o(f||d)},u,u.exports,t,i,r,s)}return r[c].exports}for(var a=typeof xf=="function"&&xf,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){var p=t("crypto");function v(w,S){S=b(w,S);var x;return(x=S.algorithm!=="passthrough"?p.createHash(S.algorithm):new T).write===void 0&&(x.write=x.update,x.end=x.update),_(S,x).dispatch(w),x.update||x.end(""),x.digest?x.digest(S.encoding==="buffer"?void 0:S.encoding):(w=x.read(),S.encoding!=="buffer"?w.toString(S.encoding):w)}(r=i.exports=v).sha1=function(w){return v(w)},r.keys=function(w){return v(w,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},r.MD5=function(w){return v(w,{algorithm:"md5",encoding:"hex"})},r.keysMD5=function(w){return v(w,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var m=p.getHashes?p.getHashes().slice():["sha1","md5"],g=(m.push("passthrough"),["buffer","hex","binary","base64"]);function b(w,S){var x={};if(x.algorithm=(S=S||{}).algorithm||"sha1",x.encoding=S.encoding||"hex",x.excludeValues=!!S.excludeValues,x.algorithm=x.algorithm.toLowerCase(),x.encoding=x.encoding.toLowerCase(),x.ignoreUnknown=S.ignoreUnknown===!0,x.respectType=S.respectType!==!1,x.respectFunctionNames=S.respectFunctionNames!==!1,x.respectFunctionProperties=S.respectFunctionProperties!==!1,x.unorderedArrays=S.unorderedArrays===!0,x.unorderedSets=S.unorderedSets!==!1,x.unorderedObjects=S.unorderedObjects!==!1,x.replacer=S.replacer||void 0,x.excludeKeys=S.excludeKeys||void 0,w===void 0)throw new Error("Object argument required.");for(var M=0;M<m.length;++M)m[M].toLowerCase()===x.algorithm.toLowerCase()&&(x.algorithm=m[M]);if(m.indexOf(x.algorithm)===-1)throw new Error('Algorithm "'+x.algorithm+'"  not supported. supported values: '+m.join(", "));if(g.indexOf(x.encoding)===-1&&x.algorithm!=="passthrough")throw new Error('Encoding "'+x.encoding+'"  not supported. supported values: '+g.join(", "));return x}function y(w){if(typeof w=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(w))!=null}function _(w,S,x){x=x||[];function M(E){return S.update?S.update(E,"utf8"):S.write(E,"utf8")}return{dispatch:function(E){return this["_"+((E=w.replacer?w.replacer(E):E)===null?"null":typeof E)](E)},_object:function(E){var C,O=Object.prototype.toString.call(E),$=/\[object (.*)\]/i.exec(O);if($=($=$?$[1]:"unknown:["+O+"]").toLowerCase(),0<=(O=x.indexOf(E)))return this.dispatch("[CIRCULAR:"+O+"]");if(x.push(E),a!==void 0&&a.isBuffer&&a.isBuffer(E))return M("buffer:"),M(E);if($==="object"||$==="function"||$==="asyncfunction")return O=Object.keys(E),w.unorderedObjects&&(O=O.sort()),w.respectType===!1||y(E)||O.splice(0,0,"prototype","__proto__","constructor"),w.excludeKeys&&(O=O.filter(function(U){return!w.excludeKeys(U)})),M("object:"+O.length+":"),C=this,O.forEach(function(U){C.dispatch(U),M(":"),w.excludeValues||C.dispatch(E[U]),M(",")});if(!this["_"+$]){if(w.ignoreUnknown)return M("["+$+"]");throw new Error('Unknown object type "'+$+'"')}this["_"+$](E)},_array:function(E,U){U=U!==void 0?U:w.unorderedArrays!==!1;var O=this;if(M("array:"+E.length+":"),!U||E.length<=1)return E.forEach(function(j){return O.dispatch(j)});var $=[],U=E.map(function(j){var W=new T,q=x.slice();return _(w,W,q).dispatch(j),$=$.concat(q.slice(x.length)),W.read().toString()});return x=x.concat($),U.sort(),this._array(U,!1)},_date:function(E){return M("date:"+E.toJSON())},_symbol:function(E){return M("symbol:"+E.toString())},_error:function(E){return M("error:"+E.toString())},_boolean:function(E){return M("bool:"+E.toString())},_string:function(E){M("string:"+E.length+":"),M(E.toString())},_function:function(E){M("fn:"),y(E)?this.dispatch("[native]"):this.dispatch(E.toString()),w.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(E.name)),w.respectFunctionProperties&&this._object(E)},_number:function(E){return M("number:"+E.toString())},_xml:function(E){return M("xml:"+E.toString())},_null:function(){return M("Null")},_undefined:function(){return M("Undefined")},_regexp:function(E){return M("regex:"+E.toString())},_uint8array:function(E){return M("uint8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint8clampedarray:function(E){return M("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(E))},_int8array:function(E){return M("int8array:"),this.dispatch(Array.prototype.slice.call(E))},_uint16array:function(E){return M("uint16array:"),this.dispatch(Array.prototype.slice.call(E))},_int16array:function(E){return M("int16array:"),this.dispatch(Array.prototype.slice.call(E))},_uint32array:function(E){return M("uint32array:"),this.dispatch(Array.prototype.slice.call(E))},_int32array:function(E){return M("int32array:"),this.dispatch(Array.prototype.slice.call(E))},_float32array:function(E){return M("float32array:"),this.dispatch(Array.prototype.slice.call(E))},_float64array:function(E){return M("float64array:"),this.dispatch(Array.prototype.slice.call(E))},_arraybuffer:function(E){return M("arraybuffer:"),this.dispatch(new Uint8Array(E))},_url:function(E){return M("url:"+E.toString())},_map:function(E){return M("map:"),E=Array.from(E),this._array(E,w.unorderedSets!==!1)},_set:function(E){return M("set:"),E=Array.from(E),this._array(E,w.unorderedSets!==!1)},_file:function(E){return M("file:"),this.dispatch([E.name,E.size,E.type,E.lastModfied])},_blob:function(){if(w.ignoreUnknown)return M("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return M("domwindow")},_bigint:function(E){return M("bigint:"+E.toString())},_process:function(){return M("process")},_timer:function(){return M("timer")},_pipe:function(){return M("pipe")},_tcp:function(){return M("tcp")},_udp:function(){return M("udp")},_tty:function(){return M("tty")},_statwatcher:function(){return M("statwatcher")},_securecontext:function(){return M("securecontext")},_connection:function(){return M("connection")},_zlib:function(){return M("zlib")},_context:function(){return M("context")},_nodescript:function(){return M("nodescript")},_httpparser:function(){return M("httpparser")},_dataview:function(){return M("dataview")},_signal:function(){return M("signal")},_fsevent:function(){return M("fsevent")},_tlswrap:function(){return M("tlswrap")}}}function T(){return{buf:"",write:function(w){this.buf+=w},end:function(w){this.buf+=w},read:function(){return this.buf}}}r.writeToStream=function(w,S,x){return x===void 0&&(x=S,S={}),_(S=b(w,S),x).dispatch(w)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){(function(p){var v=typeof Uint8Array<"u"?Uint8Array:Array,m="+".charCodeAt(0),g="/".charCodeAt(0),b="0".charCodeAt(0),y="a".charCodeAt(0),_="A".charCodeAt(0),T="-".charCodeAt(0),w="_".charCodeAt(0);function S(x){return x=x.charCodeAt(0),x===m||x===T?62:x===g||x===w?63:x<b?-1:x<b+10?x-b+26+26:x<_+26?x-_:x<y+26?x-y+26:void 0}p.toByteArray=function(x){var M,E;if(0<x.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var C=x.length,C=x.charAt(C-2)==="="?2:x.charAt(C-1)==="="?1:0,O=new v(3*x.length/4-C),$=0<C?x.length-4:x.length,U=0;function j(W){O[U++]=W}for(M=0;M<$;M+=4,0)j((16711680&(E=S(x.charAt(M))<<18|S(x.charAt(M+1))<<12|S(x.charAt(M+2))<<6|S(x.charAt(M+3))))>>16),j((65280&E)>>8),j(255&E);return C==2?j(255&(E=S(x.charAt(M))<<2|S(x.charAt(M+1))>>4)):C==1&&(j((E=S(x.charAt(M))<<10|S(x.charAt(M+1))<<4|S(x.charAt(M+2))>>2)>>8&255),j(255&E)),O},p.fromByteArray=function(x){var M,E,C,O,$=x.length%3,U="";function j(W){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(W)}for(M=0,C=x.length-$;M<C;M+=3)E=(x[M]<<16)+(x[M+1]<<8)+x[M+2],U+=j((O=E)>>18&63)+j(O>>12&63)+j(O>>6&63)+j(63&O);switch($){case 1:U=(U+=j((E=x[x.length-1])>>2))+j(E<<4&63)+"==";break;case 2:U=(U=(U+=j((E=(x[x.length-2]<<8)+x[x.length-1])>>10))+j(E>>4&63))+j(E<<2&63)+"="}return U}})(r===void 0?this.base64js={}:r)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,i,r){(function(s,o,m,l,c,u,h,d,f){var p=t("base64-js"),v=t("ieee754");function m(P,F,k){if(!(this instanceof m))return new m(P,F,k);var A,R,I,V,H=typeof P;if(F==="base64"&&H=="string")for(P=(V=P).trim?V.trim():V.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(H=="number")A=ie(P);else if(H=="string")A=m.byteLength(P,F);else{if(H!="object")throw new Error("First argument needs to be a number, array or string.");A=ie(P.length)}if(m._useTypedArrays?R=m._augment(new Uint8Array(A)):((R=this).length=A,R._isBuffer=!0),m._useTypedArrays&&typeof P.byteLength=="number")R._set(P);else if(Z(V=P)||m.isBuffer(V)||V&&typeof V=="object"&&typeof V.length=="number")for(I=0;I<A;I++)m.isBuffer(P)?R[I]=P.readUInt8(I):R[I]=P[I];else if(H=="string")R.write(P,0,F);else if(H=="number"&&!m._useTypedArrays&&!k)for(I=0;I<A;I++)R[I]=0;return R}function g(P,F,k,A){return m._charsWritten=G(function(R){for(var I=[],V=0;V<R.length;V++)I.push(255&R.charCodeAt(V));return I}(F),P,k,A)}function b(P,F,k,A){return m._charsWritten=G(function(R){for(var I,V,H=[],ee=0;ee<R.length;ee++)V=R.charCodeAt(ee),I=V>>8,V=V%256,H.push(V),H.push(I);return H}(F),P,k,A)}function y(P,F,k){var A="";k=Math.min(P.length,k);for(var R=F;R<k;R++)A+=String.fromCharCode(P[R]);return A}function _(P,F,k,I){I||(K(typeof k=="boolean","missing or invalid endian"),K(F!=null,"missing offset"),K(F+1<P.length,"Trying to read beyond buffer length"));var R,I=P.length;if(!(I<=F))return k?(R=P[F],F+1<I&&(R|=P[F+1]<<8)):(R=P[F]<<8,F+1<I&&(R|=P[F+1])),R}function T(P,F,k,I){I||(K(typeof k=="boolean","missing or invalid endian"),K(F!=null,"missing offset"),K(F+3<P.length,"Trying to read beyond buffer length"));var R,I=P.length;if(!(I<=F))return k?(F+2<I&&(R=P[F+2]<<16),F+1<I&&(R|=P[F+1]<<8),R|=P[F],F+3<I&&(R+=P[F+3]<<24>>>0)):(F+1<I&&(R=P[F+1]<<16),F+2<I&&(R|=P[F+2]<<8),F+3<I&&(R|=P[F+3]),R+=P[F]<<24>>>0),R}function w(P,F,k,A){if(A||(K(typeof k=="boolean","missing or invalid endian"),K(F!=null,"missing offset"),K(F+1<P.length,"Trying to read beyond buffer length")),!(P.length<=F))return A=_(P,F,k,!0),32768&A?-1*(65535-A+1):A}function S(P,F,k,A){if(A||(K(typeof k=="boolean","missing or invalid endian"),K(F!=null,"missing offset"),K(F+3<P.length,"Trying to read beyond buffer length")),!(P.length<=F))return A=T(P,F,k,!0),2147483648&A?-1*(4294967295-A+1):A}function x(P,F,k,A){return A||(K(typeof k=="boolean","missing or invalid endian"),K(F+3<P.length,"Trying to read beyond buffer length")),v.read(P,F,k,23,4)}function M(P,F,k,A){return A||(K(typeof k=="boolean","missing or invalid endian"),K(F+7<P.length,"Trying to read beyond buffer length")),v.read(P,F,k,52,8)}function E(P,F,k,A,R){if(R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+1<P.length,"trying to write beyond buffer length"),Re(F,65535)),R=P.length,!(R<=k))for(var I=0,V=Math.min(R-k,2);I<V;I++)P[k+I]=(F&255<<8*(A?I:1-I))>>>8*(A?I:1-I)}function C(P,F,k,A,R){if(R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+3<P.length,"trying to write beyond buffer length"),Re(F,4294967295)),R=P.length,!(R<=k))for(var I=0,V=Math.min(R-k,4);I<V;I++)P[k+I]=F>>>8*(A?I:3-I)&255}function O(P,F,k,A,R){R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+1<P.length,"Trying to write beyond buffer length"),Ie(F,32767,-32768)),P.length<=k||E(P,0<=F?F:65535+F+1,k,A,R)}function $(P,F,k,A,R){R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+3<P.length,"Trying to write beyond buffer length"),Ie(F,2147483647,-2147483648)),P.length<=k||C(P,0<=F?F:4294967295+F+1,k,A,R)}function U(P,F,k,A,R){R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+3<P.length,"Trying to write beyond buffer length"),Q(F,34028234663852886e22,-34028234663852886e22)),P.length<=k||v.write(P,F,k,A,23,4)}function j(P,F,k,A,R){R||(K(F!=null,"missing value"),K(typeof A=="boolean","missing or invalid endian"),K(k!=null,"missing offset"),K(k+7<P.length,"Trying to write beyond buffer length"),Q(F,17976931348623157e292,-17976931348623157e292)),P.length<=k||v.write(P,F,k,A,52,8)}r.Buffer=m,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,m.poolSize=8192,m._useTypedArrays=function(){try{var P=new ArrayBuffer(0),F=new Uint8Array(P);return F.foo=function(){return 42},F.foo()===42&&typeof F.subarray=="function"}catch(k){return!1}}(),m.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.isBuffer=function(P){return!(P==null||!P._isBuffer)},m.byteLength=function(P,F){var k;switch(P+="",F||"utf8"){case"hex":k=P.length/2;break;case"utf8":case"utf-8":k=X(P).length;break;case"ascii":case"binary":case"raw":k=P.length;break;case"base64":k=se(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":k=2*P.length;break;default:throw new Error("Unknown encoding")}return k},m.concat=function(P,F){if(K(Z(P),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),P.length===0)return new m(0);if(P.length===1)return P[0];if(typeof F!="number")for(R=F=0;R<P.length;R++)F+=P[R].length;for(var k=new m(F),A=0,R=0;R<P.length;R++){var I=P[R];I.copy(k,A),A+=I.length}return k},m.prototype.write=function(P,F,k,A){isFinite(F)?isFinite(k)||(A=k,k=void 0):(ee=A,A=F,F=k,k=ee),F=Number(F)||0;var R,I,V,H,ee=this.length-F;switch((!k||ee<(k=Number(k)))&&(k=ee),A=String(A||"utf8").toLowerCase()){case"hex":R=function(oe,re,ue,ae){ue=Number(ue)||0;var Ee=oe.length-ue;(!ae||Ee<(ae=Number(ae)))&&(ae=Ee),K((Ee=re.length)%2==0,"Invalid hex string"),Ee/2<ae&&(ae=Ee/2);for(var N=0;N<ae;N++){var L=parseInt(re.substr(2*N,2),16);K(!isNaN(L),"Invalid hex string"),oe[ue+N]=L}return m._charsWritten=2*N,N}(this,P,F,k);break;case"utf8":case"utf-8":I=this,V=F,H=k,R=m._charsWritten=G(X(P),I,V,H);break;case"ascii":case"binary":R=g(this,P,F,k);break;case"base64":I=this,V=F,H=k,R=m._charsWritten=G(se(P),I,V,H);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":R=b(this,P,F,k);break;default:throw new Error("Unknown encoding")}return R},m.prototype.toString=function(P,F,k){var A,R,I,V,H=this;if(P=String(P||"utf8").toLowerCase(),F=Number(F)||0,(k=k!==void 0?Number(k):H.length)===F)return"";switch(P){case"hex":A=function(ee,oe,re){var ue=ee.length;(!oe||oe<0)&&(oe=0),(!re||re<0||ue<re)&&(re=ue);for(var ae="",Ee=oe;Ee<re;Ee++)ae+=te(ee[Ee]);return ae}(H,F,k);break;case"utf8":case"utf-8":A=function(ee,oe,re){var ue="",ae="";re=Math.min(ee.length,re);for(var Ee=oe;Ee<re;Ee++)ee[Ee]<=127?(ue+=xe(ae)+String.fromCharCode(ee[Ee]),ae=""):ae+="%"+ee[Ee].toString(16);return ue+xe(ae)}(H,F,k);break;case"ascii":case"binary":A=y(H,F,k);break;case"base64":R=H,V=k,A=(I=F)===0&&V===R.length?p.fromByteArray(R):p.fromByteArray(R.slice(I,V));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":A=function(ee,oe,re){for(var ue=ee.slice(oe,re),ae="",Ee=0;Ee<ue.length;Ee+=2)ae+=String.fromCharCode(ue[Ee]+256*ue[Ee+1]);return ae}(H,F,k);break;default:throw new Error("Unknown encoding")}return A},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},m.prototype.copy=function(P,F,k,A){if(F=F||0,(A=A||A===0?A:this.length)!==(k=k||0)&&P.length!==0&&this.length!==0){K(k<=A,"sourceEnd < sourceStart"),K(0<=F&&F<P.length,"targetStart out of bounds"),K(0<=k&&k<this.length,"sourceStart out of bounds"),K(0<=A&&A<=this.length,"sourceEnd out of bounds"),A>this.length&&(A=this.length);var R=(A=P.length-F<A-k?P.length-F+k:A)-k;if(R<100||!m._useTypedArrays)for(var I=0;I<R;I++)P[I+F]=this[I+k];else P._set(this.subarray(k,k+R),F)}},m.prototype.slice=function(P,F){var k=this.length;if(P=q(P,k,0),F=q(F,k,k),m._useTypedArrays)return m._augment(this.subarray(P,F));for(var A=F-P,R=new m(A,void 0,!0),I=0;I<A;I++)R[I]=this[I+P];return R},m.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},m.prototype.set=function(P,F){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,F)},m.prototype.readUInt8=function(P,F){if(F||(K(P!=null,"missing offset"),K(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},m.prototype.readUInt16LE=function(P,F){return _(this,P,!0,F)},m.prototype.readUInt16BE=function(P,F){return _(this,P,!1,F)},m.prototype.readUInt32LE=function(P,F){return T(this,P,!0,F)},m.prototype.readUInt32BE=function(P,F){return T(this,P,!1,F)},m.prototype.readInt8=function(P,F){if(F||(K(P!=null,"missing offset"),K(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},m.prototype.readInt16LE=function(P,F){return w(this,P,!0,F)},m.prototype.readInt16BE=function(P,F){return w(this,P,!1,F)},m.prototype.readInt32LE=function(P,F){return S(this,P,!0,F)},m.prototype.readInt32BE=function(P,F){return S(this,P,!1,F)},m.prototype.readFloatLE=function(P,F){return x(this,P,!0,F)},m.prototype.readFloatBE=function(P,F){return x(this,P,!1,F)},m.prototype.readDoubleLE=function(P,F){return M(this,P,!0,F)},m.prototype.readDoubleBE=function(P,F){return M(this,P,!1,F)},m.prototype.writeUInt8=function(P,F,k){k||(K(P!=null,"missing value"),K(F!=null,"missing offset"),K(F<this.length,"trying to write beyond buffer length"),Re(P,255)),F>=this.length||(this[F]=P)},m.prototype.writeUInt16LE=function(P,F,k){E(this,P,F,!0,k)},m.prototype.writeUInt16BE=function(P,F,k){E(this,P,F,!1,k)},m.prototype.writeUInt32LE=function(P,F,k){C(this,P,F,!0,k)},m.prototype.writeUInt32BE=function(P,F,k){C(this,P,F,!1,k)},m.prototype.writeInt8=function(P,F,k){k||(K(P!=null,"missing value"),K(F!=null,"missing offset"),K(F<this.length,"Trying to write beyond buffer length"),Ie(P,127,-128)),F>=this.length||(0<=P?this.writeUInt8(P,F,k):this.writeUInt8(255+P+1,F,k))},m.prototype.writeInt16LE=function(P,F,k){O(this,P,F,!0,k)},m.prototype.writeInt16BE=function(P,F,k){O(this,P,F,!1,k)},m.prototype.writeInt32LE=function(P,F,k){$(this,P,F,!0,k)},m.prototype.writeInt32BE=function(P,F,k){$(this,P,F,!1,k)},m.prototype.writeFloatLE=function(P,F,k){U(this,P,F,!0,k)},m.prototype.writeFloatBE=function(P,F,k){U(this,P,F,!1,k)},m.prototype.writeDoubleLE=function(P,F,k){j(this,P,F,!0,k)},m.prototype.writeDoubleBE=function(P,F,k){j(this,P,F,!1,k)},m.prototype.fill=function(P,F,k){if(F=F||0,k=k||this.length,K(typeof(P=typeof(P=P||0)=="string"?P.charCodeAt(0):P)=="number"&&!isNaN(P),"value is not a number"),K(F<=k,"end < start"),k!==F&&this.length!==0){K(0<=F&&F<this.length,"start out of bounds"),K(0<=k&&k<=this.length,"end out of bounds");for(var A=F;A<k;A++)this[A]=P}},m.prototype.inspect=function(){for(var P=[],F=this.length,k=0;k<F;k++)if(P[k]=te(this[k]),k===r.INSPECT_MAX_BYTES){P[k+1]="...";break}return"<Buffer "+P.join(" ")+">"},m.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(m._useTypedArrays)return new m(this).buffer;for(var P=new Uint8Array(this.length),F=0,k=P.length;F<k;F+=1)P[F]=this[F];return P.buffer};var W=m.prototype;function q(P,F,k){return typeof P!="number"?k:F<=(P=~~P)?F:0<=P||0<=(P+=F)?P:0}function ie(P){return(P=~~Math.ceil(+P))<0?0:P}function Z(P){return(Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"})(P)}function te(P){return P<16?"0"+P.toString(16):P.toString(16)}function X(P){for(var F=[],k=0;k<P.length;k++){var A=P.charCodeAt(k);if(A<=127)F.push(P.charCodeAt(k));else for(var R=k,I=(55296<=A&&A<=57343&&k++,encodeURIComponent(P.slice(R,k+1)).substr(1).split("%")),V=0;V<I.length;V++)F.push(parseInt(I[V],16))}return F}function se(P){return p.toByteArray(P)}function G(P,F,k,A){for(var R=0;R<A&&!(R+k>=F.length||R>=P.length);R++)F[R+k]=P[R];return R}function xe(P){try{return decodeURIComponent(P)}catch(F){return String.fromCharCode(65533)}}function Re(P,F){K(typeof P=="number","cannot write a non-number as a number"),K(0<=P,"specified a negative value for writing an unsigned value"),K(P<=F,"value is larger than maximum value for type"),K(Math.floor(P)===P,"value has a fractional component")}function Ie(P,F,k){K(typeof P=="number","cannot write a non-number as a number"),K(P<=F,"value larger than maximum allowed value"),K(k<=P,"value smaller than minimum allowed value"),K(Math.floor(P)===P,"value has a fractional component")}function Q(P,F,k){K(typeof P=="number","cannot write a non-number as a number"),K(P<=F,"value larger than maximum allowed value"),K(k<=P,"value smaller than minimum allowed value")}function K(P,F){if(!P)throw new Error(F||"Failed assertion")}m._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=W.get,P.set=W.set,P.write=W.write,P.toString=W.toString,P.toLocaleString=W.toString,P.toJSON=W.toJSON,P.copy=W.copy,P.slice=W.slice,P.readUInt8=W.readUInt8,P.readUInt16LE=W.readUInt16LE,P.readUInt16BE=W.readUInt16BE,P.readUInt32LE=W.readUInt32LE,P.readUInt32BE=W.readUInt32BE,P.readInt8=W.readInt8,P.readInt16LE=W.readInt16LE,P.readInt16BE=W.readInt16BE,P.readInt32LE=W.readInt32LE,P.readInt32BE=W.readInt32BE,P.readFloatLE=W.readFloatLE,P.readFloatBE=W.readFloatBE,P.readDoubleLE=W.readDoubleLE,P.readDoubleBE=W.readDoubleBE,P.writeUInt8=W.writeUInt8,P.writeUInt16LE=W.writeUInt16LE,P.writeUInt16BE=W.writeUInt16BE,P.writeUInt32LE=W.writeUInt32LE,P.writeUInt32BE=W.writeUInt32BE,P.writeInt8=W.writeInt8,P.writeInt16LE=W.writeInt16LE,P.writeInt16BE=W.writeInt16BE,P.writeInt32LE=W.writeInt32LE,P.writeInt32BE=W.writeInt32BE,P.writeFloatLE=W.writeFloatLE,P.writeFloatBE=W.writeFloatBE,P.writeDoubleLE=W.writeDoubleLE,P.writeDoubleBE=W.writeDoubleBE,P.fill=W.fill,P.inspect=W.inspect,P.toArrayBuffer=W.toArrayBuffer,P}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,i,r){(function(s,o,p,l,c,u,h,d,f){var p=t("buffer").Buffer,v=4,m=new p(v);m.fill(0),i.exports={hash:function(g,b,y,_){for(var T=b(function(E,C){E.length%v!=0&&(O=E.length+(v-E.length%v),E=p.concat([E,m],O));for(var O,$=[],U=C?E.readInt32BE:E.readInt32LE,j=0;j<E.length;j+=v)$.push(U.call(E,j));return $}(g=p.isBuffer(g)?g:new p(g),_),8*g.length),b=_,w=new p(y),S=b?w.writeInt32BE:w.writeInt32LE,x=0;x<T.length;x++)S.call(w,T[x],4*x,!0);return w}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,i,r){(function(s,o,p,l,c,u,h,d,f){var p=t("buffer").Buffer,v=t("./sha"),m=t("./sha256"),g=t("./rng"),b={sha1:v,sha256:m,md5:t("./md5")},y=64,_=new p(y);function T(E,C){var O=b[E=E||"sha1"],$=[];return O||w("algorithm:",E,"is not yet supported"),{update:function(U){return p.isBuffer(U)||(U=new p(U)),$.push(U),U.length,this},digest:function(U){var j=p.concat($),j=C?function(W,q,ie){p.isBuffer(q)||(q=new p(q)),p.isBuffer(ie)||(ie=new p(ie)),q.length>y?q=W(q):q.length<y&&(q=p.concat([q,_],y));for(var Z=new p(y),te=new p(y),X=0;X<y;X++)Z[X]=54^q[X],te[X]=92^q[X];return ie=W(p.concat([Z,ie])),W(p.concat([te,ie]))}(O,C,j):O(j);return $=null,U?j.toString(U):j}}}function w(){var E=[].slice.call(arguments).join(" ");throw new Error([E,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}_.fill(0),r.createHash=function(E){return T(E)},r.createHmac=T,r.randomBytes=function(E,C){if(!C||!C.call)return new p(g(E));try{C.call(this,void 0,new p(g(E)))}catch(O){C(O)}};var S,x=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],M=function(E){r[E]=function(){w("sorry,",E,"is not implemented yet")}};for(S in x)M(x[S])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){var p=t("./helpers");function v(w,S){w[S>>5]|=128<<S%32,w[14+(S+64>>>9<<4)]=S;for(var x=1732584193,M=-271733879,E=-1732584194,C=271733878,O=0;O<w.length;O+=16){var $=x,U=M,j=E,W=C,x=g(x,M,E,C,w[O+0],7,-680876936),C=g(C,x,M,E,w[O+1],12,-389564586),E=g(E,C,x,M,w[O+2],17,606105819),M=g(M,E,C,x,w[O+3],22,-1044525330);x=g(x,M,E,C,w[O+4],7,-176418897),C=g(C,x,M,E,w[O+5],12,1200080426),E=g(E,C,x,M,w[O+6],17,-1473231341),M=g(M,E,C,x,w[O+7],22,-45705983),x=g(x,M,E,C,w[O+8],7,1770035416),C=g(C,x,M,E,w[O+9],12,-1958414417),E=g(E,C,x,M,w[O+10],17,-42063),M=g(M,E,C,x,w[O+11],22,-1990404162),x=g(x,M,E,C,w[O+12],7,1804603682),C=g(C,x,M,E,w[O+13],12,-40341101),E=g(E,C,x,M,w[O+14],17,-1502002290),x=b(x,M=g(M,E,C,x,w[O+15],22,1236535329),E,C,w[O+1],5,-165796510),C=b(C,x,M,E,w[O+6],9,-1069501632),E=b(E,C,x,M,w[O+11],14,643717713),M=b(M,E,C,x,w[O+0],20,-373897302),x=b(x,M,E,C,w[O+5],5,-701558691),C=b(C,x,M,E,w[O+10],9,38016083),E=b(E,C,x,M,w[O+15],14,-660478335),M=b(M,E,C,x,w[O+4],20,-405537848),x=b(x,M,E,C,w[O+9],5,568446438),C=b(C,x,M,E,w[O+14],9,-1019803690),E=b(E,C,x,M,w[O+3],14,-187363961),M=b(M,E,C,x,w[O+8],20,1163531501),x=b(x,M,E,C,w[O+13],5,-1444681467),C=b(C,x,M,E,w[O+2],9,-51403784),E=b(E,C,x,M,w[O+7],14,1735328473),x=y(x,M=b(M,E,C,x,w[O+12],20,-1926607734),E,C,w[O+5],4,-378558),C=y(C,x,M,E,w[O+8],11,-2022574463),E=y(E,C,x,M,w[O+11],16,1839030562),M=y(M,E,C,x,w[O+14],23,-35309556),x=y(x,M,E,C,w[O+1],4,-1530992060),C=y(C,x,M,E,w[O+4],11,1272893353),E=y(E,C,x,M,w[O+7],16,-155497632),M=y(M,E,C,x,w[O+10],23,-1094730640),x=y(x,M,E,C,w[O+13],4,681279174),C=y(C,x,M,E,w[O+0],11,-358537222),E=y(E,C,x,M,w[O+3],16,-722521979),M=y(M,E,C,x,w[O+6],23,76029189),x=y(x,M,E,C,w[O+9],4,-640364487),C=y(C,x,M,E,w[O+12],11,-421815835),E=y(E,C,x,M,w[O+15],16,530742520),x=_(x,M=y(M,E,C,x,w[O+2],23,-995338651),E,C,w[O+0],6,-198630844),C=_(C,x,M,E,w[O+7],10,1126891415),E=_(E,C,x,M,w[O+14],15,-1416354905),M=_(M,E,C,x,w[O+5],21,-57434055),x=_(x,M,E,C,w[O+12],6,1700485571),C=_(C,x,M,E,w[O+3],10,-1894986606),E=_(E,C,x,M,w[O+10],15,-1051523),M=_(M,E,C,x,w[O+1],21,-2054922799),x=_(x,M,E,C,w[O+8],6,1873313359),C=_(C,x,M,E,w[O+15],10,-30611744),E=_(E,C,x,M,w[O+6],15,-1560198380),M=_(M,E,C,x,w[O+13],21,1309151649),x=_(x,M,E,C,w[O+4],6,-145523070),C=_(C,x,M,E,w[O+11],10,-1120210379),E=_(E,C,x,M,w[O+2],15,718787259),M=_(M,E,C,x,w[O+9],21,-343485551),x=T(x,$),M=T(M,U),E=T(E,j),C=T(C,W)}return Array(x,M,E,C)}function m(w,S,x,M,E,C){return T((S=T(T(S,w),T(M,C)))<<E|S>>>32-E,x)}function g(w,S,x,M,E,C,O){return m(S&x|~S&M,w,S,E,C,O)}function b(w,S,x,M,E,C,O){return m(S&M|x&~M,w,S,E,C,O)}function y(w,S,x,M,E,C,O){return m(S^x^M,w,S,E,C,O)}function _(w,S,x,M,E,C,O){return m(x^(S|~M),w,S,E,C,O)}function T(w,S){var x=(65535&w)+(65535&S);return(w>>16)+(S>>16)+(x>>16)<<16|65535&x}i.exports=function(w){return p.hash(w,v,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){i.exports=function(p){for(var v,m=new Array(p),g=0;g<p;g++)!(3&g)&&(v=4294967296*Math.random()),m[g]=v>>>((3&g)<<3)&255;return m}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){var p=t("./helpers");function v(b,y){b[y>>5]|=128<<24-y%32,b[15+(y+64>>9<<4)]=y;for(var _,T,w,S=Array(80),x=1732584193,M=-271733879,E=-1732584194,C=271733878,O=-1009589776,$=0;$<b.length;$+=16){for(var U=x,j=M,W=E,q=C,ie=O,Z=0;Z<80;Z++){S[Z]=Z<16?b[$+Z]:g(S[Z-3]^S[Z-8]^S[Z-14]^S[Z-16],1);var te=m(m(g(x,5),(te=M,T=E,w=C,(_=Z)<20?te&T|~te&w:!(_<40)&&_<60?te&T|te&w|T&w:te^T^w)),m(m(O,S[Z]),(_=Z)<20?1518500249:_<40?1859775393:_<60?-1894007588:-899497514)),O=C,C=E,E=g(M,30),M=x,x=te}x=m(x,U),M=m(M,j),E=m(E,W),C=m(C,q),O=m(O,ie)}return Array(x,M,E,C,O)}function m(b,y){var _=(65535&b)+(65535&y);return(b>>16)+(y>>16)+(_>>16)<<16|65535&_}function g(b,y){return b<<y|b>>>32-y}i.exports=function(b){return p.hash(b,v,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){function p(y,_){var T=(65535&y)+(65535&_);return(y>>16)+(_>>16)+(T>>16)<<16|65535&T}function v(y,_){var T,w=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),S=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),x=new Array(64);y[_>>5]|=128<<24-_%32,y[15+(_+64>>9<<4)]=_;for(var M,E,C=0;C<y.length;C+=16){for(var O=S[0],$=S[1],U=S[2],j=S[3],W=S[4],q=S[5],ie=S[6],Z=S[7],te=0;te<64;te++)x[te]=te<16?y[te+C]:p(p(p((E=x[te-2],g(E,17)^g(E,19)^b(E,10)),x[te-7]),(E=x[te-15],g(E,7)^g(E,18)^b(E,3))),x[te-16]),T=p(p(p(p(Z,g(E=W,6)^g(E,11)^g(E,25)),W&q^~W&ie),w[te]),x[te]),M=p(g(M=O,2)^g(M,13)^g(M,22),O&$^O&U^$&U),Z=ie,ie=q,q=W,W=p(j,T),j=U,U=$,$=O,O=p(T,M);S[0]=p(O,S[0]),S[1]=p($,S[1]),S[2]=p(U,S[2]),S[3]=p(j,S[3]),S[4]=p(W,S[4]),S[5]=p(q,S[5]),S[6]=p(ie,S[6]),S[7]=p(Z,S[7])}return S}var m=t("./helpers"),g=function(y,_){return y>>>_|y<<32-_},b=function(y,_){return y>>>_};i.exports=function(y){return m.hash(y,v,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){r.read=function(p,v,m,g,C){var y,_,T=8*C-g-1,w=(1<<T)-1,S=w>>1,x=-7,M=m?C-1:0,E=m?-1:1,C=p[v+M];for(M+=E,y=C&(1<<-x)-1,C>>=-x,x+=T;0<x;y=256*y+p[v+M],M+=E,x-=8);for(_=y&(1<<-x)-1,y>>=-x,x+=g;0<x;_=256*_+p[v+M],M+=E,x-=8);if(y===0)y=1-S;else{if(y===w)return _?NaN:1/0*(C?-1:1);_+=Math.pow(2,g),y-=S}return(C?-1:1)*_*Math.pow(2,y-g)},r.write=function(p,v,m,g,b,O){var _,T,w=8*O-b-1,S=(1<<w)-1,x=S>>1,M=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=g?0:O-1,C=g?1:-1,O=v<0||v===0&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(T=isNaN(v)?1:0,_=S):(_=Math.floor(Math.log(v)/Math.LN2),v*(g=Math.pow(2,-_))<1&&(_--,g*=2),2<=(v+=1<=_+x?M/g:M*Math.pow(2,1-x))*g&&(_++,g/=2),S<=_+x?(T=0,_=S):1<=_+x?(T=(v*g-1)*Math.pow(2,b),_+=x):(T=v*Math.pow(2,x-1)*Math.pow(2,b),_=0));8<=b;p[m+E]=255&T,E+=C,T/=256,b-=8);for(_=_<<b|T,w+=b;0<w;p[m+E]=255&_,E+=C,_/=256,w-=8);p[m+E-C]|=128*O}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,i,r){(function(s,o,a,l,c,u,h,d,f){var p,v,m;function g(){}(s=i.exports={}).nextTick=(v=typeof window<"u"&&window.setImmediate,m=typeof window<"u"&&window.postMessage&&window.addEventListener,v?function(b){return window.setImmediate(b)}:m?(p=[],window.addEventListener("message",function(b){var y=b.source;y!==window&&y!==null||b.data!=="process-tick"||(b.stopPropagation(),0<p.length&&p.shift()())},!0),function(b){p.push(b),window.postMessage("process-tick","*")}):function(b){setTimeout(b,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.binding=function(b){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(b){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(wq);var Mq=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],D0=Mq;D0=D0.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)});D0.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function Eq(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Sq(n){var e=Eq(n,"string");return typeof e=="symbol"?e:String(e)}function Ut(n,e,t){return e=Sq(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var tt={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},di,Al;di={},Ut(di,"".concat(tt.normal),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(tt.normal,";\n    #ifdef USE_TANGENT\n	    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),Ut(di,"".concat(tt.position),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(tt.position,";\n  ")}),Ut(di,"".concat(tt.positionRaw),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(tt.positionRaw,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),Ut(di,"".concat(tt.pointSize),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(tt.pointSize,";\n    ")}),Ut(di,"".concat(tt.diffuseColor),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(tt.diffuseColor,";\n  ")}),Ut(di,"".concat(tt.fragColor),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(tt.fragColor,";\n  ")}),Ut(di,"".concat(tt.emissive),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(tt.emissive,";\n    ")}),Ut(di,"".concat(tt.roughness),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(tt.roughness,";\n    ")}),Ut(di,"".concat(tt.metalness),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(tt.metalness,";\n    ")}),Ut(di,"".concat(tt.ao),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(tt.ao,";\n    ")}),Ut(di,"".concat(tt.bump),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(tt.bump," - (dot(").concat(tt.bump,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),Ut(di,"".concat(tt.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(tt.depthAlpha," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(tt.depthAlpha,";\n    ")});Al={},Ut(Al,"".concat(tt.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(tt.position,", 1.0 );\n  ")}),Ut(Al,"".concat(tt.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(tt.position,";\n  ")}),Ut(Al,"".concat(tt.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(tt.diffuseColor,";\n  ")}),Ut(Al,"".concat(tt.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(tt.fragColor,";\n  ")});var fi;fi={},Ut(fi,"".concat(tt.position),"*"),Ut(fi,"".concat(tt.positionRaw),"*"),Ut(fi,"".concat(tt.normal),"*"),Ut(fi,"".concat(tt.pointSize),["PointsMaterial"]),Ut(fi,"".concat(tt.diffuseColor),"*"),Ut(fi,"".concat(tt.fragColor),"*"),Ut(fi,"".concat(tt.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ut(fi,"".concat(tt.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ut(fi,"".concat(tt.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ut(fi,"".concat(tt.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Ut(fi,"".concat(tt.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Ut(fi,"".concat(tt.depthAlpha),"*");const Tq=["args"],Aq=["color"],$K=qe({__name:"Box",props:{args:{default:()=>[1,1,1]},color:{default:"#ffffff"}},setup(n,{expose:e}){const t=n,{args:i,color:r}=Ar(t),s=qn();return e({value:s}),(o,a)=>(rt(),Mt("TresMesh",wr({ref_key:"boxRef",ref:s},o.$attrs),[Kn("TresBoxGeometry",{args:we(i)},null,8,Tq),wi(o.$slots,"default",{},()=>[Kn("TresMeshBasicMaterial",{color:we(r)},null,8,Aq)])],16))}});new Ti;new D;De.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new me(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Zi.line={uniforms:Kp.merge([De.common,De.fog,De.line]),vertexShader:"\n		#include <common>\n		#include <color_pars_vertex>\n		#include <fog_pars_vertex>\n		#include <logdepthbuf_pars_vertex>\n		#include <clipping_planes_pars_vertex>\n\n		uniform float linewidth;\n		uniform vec2 resolution;\n\n		attribute vec3 instanceStart;\n		attribute vec3 instanceEnd;\n\n		attribute vec3 instanceColorStart;\n		attribute vec3 instanceColorEnd;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#ifdef USE_DASH\n\n			uniform float dashScale;\n			attribute float instanceDistanceStart;\n			attribute float instanceDistanceEnd;\n			varying float vLineDistance;\n\n		#endif\n\n		void trimSegment( const in vec4 start, inout vec4 end ) {\n\n			// trim end segment so it terminates between the camera plane and the near plane\n\n			// conservative estimate of the near plane\n			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n			float nearEstimate = - 0.5 * b / a;\n\n			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n			end.xyz = mix( start.xyz, end.xyz, alpha );\n\n		}\n\n		void main() {\n\n			#ifdef USE_COLOR\n\n				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n			#endif\n\n			#ifdef USE_DASH\n\n				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n				vUv = uv;\n\n			#endif\n\n			float aspect = resolution.x / resolution.y;\n\n			// camera space\n			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n			#ifdef WORLD_UNITS\n\n				worldStart = start.xyz;\n				worldEnd = end.xyz;\n\n			#else\n\n				vUv = uv;\n\n			#endif\n\n			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n			// perhaps there is a more elegant solution -- WestLangley\n\n			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n			if ( perspective ) {\n\n				if ( start.z < 0.0 && end.z >= 0.0 ) {\n\n					trimSegment( start, end );\n\n				} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n					trimSegment( end, start );\n\n				}\n\n			}\n\n			// clip space\n			vec4 clipStart = projectionMatrix * start;\n			vec4 clipEnd = projectionMatrix * end;\n\n			// ndc space\n			vec3 ndcStart = clipStart.xyz / clipStart.w;\n			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n			// direction\n			vec2 dir = ndcEnd.xy - ndcStart.xy;\n\n			// account for clip-space aspect ratio\n			dir.x *= aspect;\n			dir = normalize( dir );\n\n			#ifdef WORLD_UNITS\n\n				// get the offset direction as perpendicular to the view vector\n				vec3 worldDir = normalize( end.xyz - start.xyz );\n				vec3 offset;\n				if ( position.y < 0.5 ) {\n\n					offset = normalize( cross( start.xyz, worldDir ) );\n\n				} else {\n\n					offset = normalize( cross( end.xyz, worldDir ) );\n\n				}\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n				// don't extend the line if we're rendering dashes because we\n				// won't be rendering the endcaps\n				#ifndef USE_DASH\n\n					// extend the line bounds to encompass  endcaps\n					start.xyz += - worldDir * linewidth * 0.5;\n					end.xyz += worldDir * linewidth * 0.5;\n\n					// shift the position of the quad so it hugs the forward edge of the line\n					offset.xy -= dir * forwardOffset;\n					offset.z += 0.5;\n\n				#endif\n\n				// endcaps\n				if ( position.y > 1.0 || position.y < 0.0 ) {\n\n					offset.xy += dir * 2.0 * forwardOffset;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth * 0.5;\n\n				// set the world position\n				worldPos = ( position.y < 0.5 ) ? start : end;\n				worldPos.xyz += offset;\n\n				// project the worldpos\n				vec4 clip = projectionMatrix * worldPos;\n\n				// shift the depth of the projected points so the line\n				// segments overlap neatly\n				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n				clip.z = clipPose.z * clip.w;\n\n			#else\n\n				vec2 offset = vec2( dir.y, - dir.x );\n				// undo aspect ratio adjustment\n				dir.x /= aspect;\n				offset.x /= aspect;\n\n				// sign flip\n				if ( position.x < 0.0 ) offset *= - 1.0;\n\n				// endcaps\n				if ( position.y < 0.0 ) {\n\n					offset += - dir;\n\n				} else if ( position.y > 1.0 ) {\n\n					offset += dir;\n\n				}\n\n				// adjust for linewidth\n				offset *= linewidth;\n\n				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n				offset /= resolution.y;\n\n				// select end\n				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n				// back to clip space\n				offset *= clip.w;\n\n				clip.xy += offset;\n\n			#endif\n\n			gl_Position = clip;\n\n			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n			#include <logdepthbuf_vertex>\n			#include <clipping_planes_vertex>\n			#include <fog_vertex>\n\n		}\n		",fragmentShader:"\n		uniform vec3 diffuse;\n		uniform float opacity;\n		uniform float linewidth;\n\n		#ifdef USE_DASH\n\n			uniform float dashOffset;\n			uniform float dashSize;\n			uniform float gapSize;\n\n		#endif\n\n		varying float vLineDistance;\n\n		#ifdef WORLD_UNITS\n\n			varying vec4 worldPos;\n			varying vec3 worldStart;\n			varying vec3 worldEnd;\n\n			#ifdef USE_DASH\n\n				varying vec2 vUv;\n\n			#endif\n\n		#else\n\n			varying vec2 vUv;\n\n		#endif\n\n		#include <common>\n		#include <color_pars_fragment>\n		#include <fog_pars_fragment>\n		#include <logdepthbuf_pars_fragment>\n		#include <clipping_planes_pars_fragment>\n\n		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n			float mua;\n			float mub;\n\n			vec3 p13 = p1 - p3;\n			vec3 p43 = p4 - p3;\n\n			vec3 p21 = p2 - p1;\n\n			float d1343 = dot( p13, p43 );\n			float d4321 = dot( p43, p21 );\n			float d1321 = dot( p13, p21 );\n			float d4343 = dot( p43, p43 );\n			float d2121 = dot( p21, p21 );\n\n			float denom = d2121 * d4343 - d4321 * d4321;\n\n			float numer = d1343 * d4321 - d1321 * d4343;\n\n			mua = numer / denom;\n			mua = clamp( mua, 0.0, 1.0 );\n			mub = ( d1343 + d4321 * ( mua ) ) / d4343;\n			mub = clamp( mub, 0.0, 1.0 );\n\n			return vec2( mua, mub );\n\n		}\n\n		void main() {\n\n			#include <clipping_planes_fragment>\n\n			#ifdef USE_DASH\n\n				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n			#endif\n\n			float alpha = opacity;\n\n			#ifdef WORLD_UNITS\n\n				// Find the closest points on the view ray and the line segment\n				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n				vec3 lineDir = worldEnd - worldStart;\n				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n				vec3 p1 = worldStart + lineDir * params.x;\n				vec3 p2 = rayEnd * params.y;\n				vec3 delta = p1 - p2;\n				float len = length( delta );\n				float norm = len / linewidth;\n\n				#ifndef USE_DASH\n\n					#ifdef USE_ALPHA_TO_COVERAGE\n\n						float dnorm = fwidth( norm );\n						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n					#else\n\n						if ( norm > 0.5 ) {\n\n							discard;\n\n						}\n\n					#endif\n\n				#endif\n\n			#else\n\n				#ifdef USE_ALPHA_TO_COVERAGE\n\n					// artifacts appear on some hardware if a derivative is taken within a conditional\n					float a = vUv.x;\n					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n					float len2 = a * a + b * b;\n					float dlen = fwidth( len2 );\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n					}\n\n				#else\n\n					if ( abs( vUv.y ) > 1.0 ) {\n\n						float a = vUv.x;\n						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n						float len2 = a * a + b * b;\n\n						if ( len2 > 1.0 ) discard;\n\n					}\n\n				#endif\n\n			#endif\n\n			vec4 diffuseColor = vec4( diffuse, alpha );\n\n			#include <logdepthbuf_fragment>\n			#include <color_fragment>\n\n			gl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n			#include <tonemapping_fragment>\n			#include <colorspace_fragment>\n			#include <fog_fragment>\n			#include <premultiplied_alpha_fragment>\n\n		}\n		"};new D;new D;new gt;new gt;new gt;new D;new Be;new n2;new D;new Ti;new Ai;new gt;const Cq=["args"],Pq=["color"],jK=qe({__name:"Sphere",props:{args:{default:()=>[2,32,16]},color:{default:"#ffffff"}},setup(n,{expose:e}){const t=n,{args:i,color:r}=Ar(t),s=qn();return e({value:s}),(o,a)=>(rt(),Mt("TresMesh",wr({ref_key:"sphereRef",ref:s},o.$attrs),[Kn("TresSphereGeometry",{args:we(i)},null,8,Cq),wi(o.$slots,"default",{},()=>[Kn("TresMeshBasicMaterial",{color:we(r)},null,8,Pq)])],16))}}),Rq=["size","color","alpha-map","map","opacity","alpha-test","depth-write","transparent","size-attenuation"],Lq=["position","velocity"],XK=qe({__name:"Precipitation",props:{size:{default:.1},area:{default:()=>[10,10,20]},color:{default:16777215},map:{},alphaMap:{},alphaTest:{default:.01},opacity:{default:.8},count:{default:5e3},speed:{default:.1},randomness:{default:.5},depthWrite:{type:Boolean,default:!1},transparent:{type:Boolean,default:!0},sizeAttenuation:{type:Boolean,default:!0}},setup(n){const e=n,{size:t,area:i,color:r,alphaMap:s,map:o,opacity:a,alphaTest:l,depthWrite:c,transparent:u,sizeAttenuation:h,count:d,speed:f,randomness:p}=Ar(e),v=qn();let m=[],g=[];const b=()=>{m=new Float32Array(d.value*3);for(let T=0;T<d.value;T++){const w=T*3;m[w]=(Math.random()-.5)*i.value[0],m[w+1]=(Math.random()-.5)*i.value[1],m[w+2]=(Math.random()-.5)*i.value[2]}},y=()=>{g=new Float32Array(d.value*2);for(let T=0;T<d.value*2;T+=2)g[T]=(Math.random()-.5)/5*f.value*p.value,g[T+1]=Math.random()/5*f.value+.01};y(),b(),rr(()=>{y(),b()});const{onLoop:_}=lr();return _(()=>{var T,w;if((T=v.value)!=null&&T.attributes.position.array&&(w=v.value)!=null&&w.attributes.position.count){const S=v.value.attributes.position.array;for(let x=0;x<v.value.attributes.position.count;x++){const M=g[x*2],E=g[x*2+1];S[x*3]+=M,S[x*3+1]-=E,(S[x*3]<=-i.value[0]/2||S[x*3]>=i.value[0]/2)&&(S[x*3]=S[x*3]*-1),(S[x*3+1]<=-i.value[1]/2||S[x*3+1]>=i.value[1]/2)&&(S[x*3+1]=S[x*3+1]*-1)}v.value.attributes.position.needsUpdate=!0}}),(T,w)=>(rt(),Mt("TresPoints",null,[Kn("TresPointsMaterial",{size:we(t),color:we(r),"alpha-map":we(s),map:we(o),opacity:we(a),"alpha-test":we(l),"depth-write":we(c),transparent:we(u),"size-attenuation":we(h)},null,8,Rq),Kn("TresBufferGeometry",{ref_key:"geometryRef",ref:v,position:[we(m),3],velocity:[we(g)]},null,8,Lq)]))}});class nb extends ke{constructor(){const e=nb.SkyShader,t=new or({name:e.name,uniforms:Kp.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:Yn,depthWrite:!1});super(new si(1,1,1),t),this.isSky=!0}}nb.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new D},up:{value:new D(0,1,0)}},vertexShader:"\n		uniform vec3 sunPosition;\n		uniform float rayleigh;\n		uniform float turbidity;\n		uniform float mieCoefficient;\n		uniform vec3 up;\n\n		varying vec3 vWorldPosition;\n		varying vec3 vSunDirection;\n		varying float vSunfade;\n		varying vec3 vBetaR;\n		varying vec3 vBetaM;\n		varying float vSunE;\n\n		// constants for atmospheric scattering\n		const float e = 2.71828182845904523536028747135266249775724709369995957;\n		const float pi = 3.141592653589793238462643383279502884197169;\n\n		// wavelength of used primaries, according to preetham\n		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n		// mie stuff\n		// K coefficient for the primaries\n		const float v = 4.0;\n		const vec3 K = vec3( 0.686, 0.678, 0.666 );\n		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n		// earth shadow hack\n		// cutoffAngle = pi / 1.95;\n		const float cutoffAngle = 1.6110731556870734;\n		const float steepness = 1.5;\n		const float EE = 1000.0;\n\n		float sunIntensity( float zenithAngleCos ) {\n			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n		}\n\n		vec3 totalMie( float T ) {\n			float c = ( 0.2 * T ) * 10E-18;\n			return 0.434 * c * MieConst;\n		}\n\n		void main() {\n\n			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n			vWorldPosition = worldPosition.xyz;\n\n			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n			gl_Position.z = gl_Position.w; // set z to camera.far\n\n			vSunDirection = normalize( sunPosition );\n\n			vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n			// extinction (absorbtion + out scattering)\n			// rayleigh coefficients\n			vBetaR = totalRayleigh * rayleighCoefficient;\n\n			// mie coefficients\n			vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n		}",fragmentShader:"\n		varying vec3 vWorldPosition;\n		varying vec3 vSunDirection;\n		varying float vSunfade;\n		varying vec3 vBetaR;\n		varying vec3 vBetaM;\n		varying float vSunE;\n\n		uniform float mieDirectionalG;\n		uniform vec3 up;\n\n		// constants for atmospheric scattering\n		const float pi = 3.141592653589793238462643383279502884197169;\n\n		const float n = 1.0003; // refractive index of air\n		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n		// optical length at zenith for molecules\n		const float rayleighZenithLength = 8.4E3;\n		const float mieZenithLength = 1.25E3;\n		// 66 arc seconds -> degrees, and the cosine of that\n		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n		// 3.0 / ( 16.0 * pi )\n		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n		// 1.0 / ( 4.0 * pi )\n		const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n		float rayleighPhase( float cosTheta ) {\n			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n		}\n\n		float hgPhase( float cosTheta, float g ) {\n			float g2 = pow( g, 2.0 );\n			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n		}\n\n		void main() {\n\n			vec3 direction = normalize( vWorldPosition - cameraPosition );\n\n			// optical length\n			// cutoff angle at 90 to avoid singularity in next formula.\n			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n			float sR = rayleighZenithLength * inverse;\n			float sM = mieZenithLength * inverse;\n\n			// combined extinction factor\n			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n			// in scattering\n			float cosTheta = dot( direction, vSunDirection );\n\n			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n			vec3 betaRTheta = vBetaR * rPhase;\n\n			float mPhase = hgPhase( cosTheta, mieDirectionalG );\n			vec3 betaMTheta = vBetaM * mPhase;\n\n			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n			// nightsky\n			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\n			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\n			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n			vec3 L0 = vec3( 0.1 ) * Fex;\n\n			// composition + solar disc\n			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n			gl_FragColor = vec4( retColor, 1.0 );\n\n			#include <tonemapping_fragment>\n			#include <colorspace_fragment>\n\n		}"};const Oq=["position","a-scale"],Iq=["size","size-attenuation","transparent","alpha-test","alpha-map"],YK=qe({__name:"Stars",props:{size:{default:.1},sizeAttenuation:{type:Boolean,default:!0},transparent:{type:Boolean,default:!0},alphaTest:{default:.01},count:{default:5e3},depth:{default:50},radius:{default:100},alphaMap:{default:null}},setup(n,{expose:e}){const t=n,i=be(),r=be(),{radius:s,depth:o,count:a,size:l,sizeAttenuation:c,transparent:u,alphaMap:h,alphaTest:d}=Ar(t),f=()=>{let v=s.value+o.value;const m=Te(()=>o.value/a.value),g=[],b=Array.from({length:a.value},()=>(.5+.5*Math.random())*4),y=_=>new D().setFromSpherical(new yh(_,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)).toArray();for(let _=0;_<a.value;_++)v-=m.value*Math.random(),g.push(...y(v));i.value=new Float32Array(g),r.value=new Float32Array(b)};rr(()=>{f()});const p=qn();return e({value:p}),(v,m)=>(rt(),Mt("TresPoints",{ref_key:"starsRef",ref:p},[Kn("TresBufferGeometry",{position:[i.value,3],"a-scale":[r.value,1]},null,8,Oq),Kn("TresPointsMaterial",{size:we(l),"size-attenuation":we(c),transparent:we(u),"alpha-test":we(d),"alpha-map":we(h)},null,8,Iq)],512))}});let ds;const qK=(n="body")=>{ds||(ds=new tX({container:document.querySelector(n)}),ds.element.style.position="absolute",ds.element.style.top="1rem",ds.element.style.right="1rem",ds.element.style.zIndex="9999");const{logWarning:e}=IP();e("useTweakPane is going to be deprecated soon and will no longer be part of this package, please start migrating to @tresjs/leches package https://github.com/Tresjs/leches or v-tweakpane https://github.com/vinayakkulkarni/v-tweakpane instead.");function t(){ds&&ds.dispose()}return _n(()=>{const{resume:i}=lr();i()}),Si(()=>{t()}),{pane:ds,disposeTweakPane:t}};var kP={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(bq,function(){var t=function(){function i(f){return o.appendChild(f.dom),f}function r(f){for(var p=0;p<o.children.length;p++)o.children[p].style.display=p===f?"block":"none";s=f}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(f){f.preventDefault(),r(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,c=0,u=i(new t.Panel("FPS","#0ff","#002")),h=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=i(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:o,addPanel:i,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){c++;var f=(performance||Date).now();if(h.update(f-a,200),f>l+1e3&&(u.update(1e3*c/(f-l),100),l=f,c=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return f},update:function(){a=this.end()},domElement:o,setMode:r}};return t.Panel=function(i,r,s){var o=1/0,a=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,h=48*c,d=3*c,f=2*c,p=3*c,v=15*c,m=74*c,g=30*c,b=document.createElement("canvas");b.width=u,b.height=h,b.style.cssText="width:80px;height:48px";var y=b.getContext("2d");return y.font="bold "+9*c+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=s,y.fillRect(0,0,u,h),y.fillStyle=r,y.fillText(i,d,f),y.fillRect(p,v,m,g),y.fillStyle=s,y.globalAlpha=.9,y.fillRect(p,v,m,g),{dom:b,update:function(_,T){o=Math.min(o,_),a=Math.max(a,_),y.fillStyle=s,y.globalAlpha=1,y.fillRect(0,0,u,v),y.fillStyle=r,y.fillText(l(_)+" "+i+" ("+l(o)+"-"+l(a)+")",d,f),y.drawImage(b,p+c,v,m-c,g,p,v,m-c,g),y.fillRect(p+m-c,v,c,g),y.fillStyle=s,y.globalAlpha=.9,y.fillRect(p+m-c,v,c,l((1-_/T)*g))}}},t})})(kP);var Dq=kP.exports;const Uq=xq(Dq),KK=qe({name:"Stats",props:{showPanel:{type:Number,default:0}},setup(n,{expose:e}){const t=new Uq;e({stats:t});const i=document.body;t.showPanel(n.showPanel||0),i==null||i.appendChild(t.dom);const{onBeforeLoop:r,onAfterLoop:s,resume:o}=lr();return o(),r(()=>t.begin()),s(()=>t.end()),Si(()=>{i==null||i.removeChild(t.dom)}),null}});var Nq="#include <common>\n\nvoid main() {\n  vec2 center = vec2(0., 1.);\n  float rotation = 0.0;\n\n  \n  \n  float size = 0.03;\n\n  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n  vec2 scale;\n  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n  bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n  if ( isPerspective ) scale *= - mvPosition.z;\n\n  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;\n  vec2 rotatedPosition;\n  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n  mvPosition.xy += rotatedPosition;\n\n  gl_Position = projectionMatrix * mvPosition;\n}",Fq="void main() {\n  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n}";const Jh=new D(0,0,0),ib=new D(0,0,0),kq=new D(0,0,0);function wE(n,e,t){const i=Jh.setFromMatrixPosition(n.matrixWorld);i.project(e);const r=t.width/2,s=t.height/2;return[(Number.isNaN(i.x)?0:i.x)*r+r,-(i.y*s)+s]}function Bq(n,e){const t=Jh.setFromMatrixPosition(n.matrixWorld),i=ib.setFromMatrixPosition(e.matrixWorld),r=t.sub(i),s=e.getWorldDirection(kq);return r.angleTo(s)>Math.PI/2}function zq(n,e,t,i){const r=Jh.setFromMatrixPosition(n.matrixWorld),s=r.clone();s.project(e),t.setFromCamera(new me(s.x,s.y),e);const o=t.intersectObjects(i,!0);if(o.length>0){const a=o[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}function Vq(n,e){if(e instanceof Ni)return e.zoom;if(e instanceof Nt){const t=Jh.setFromMatrixPosition(n.matrixWorld),i=ib.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function Hq(n,e,t){if(e instanceof Nt||e instanceof Ni){const i=Jh.setFromMatrixPosition(n.matrixWorld),r=ib.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const U0=n=>Math.abs(n)<1e-10?0:n;function BP(n,e,t=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=U0(e[r]*n.elements[r])+(r!==15?",":")");return t+i}const Gq=(n=>e=>BP(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Wq=(n=>(e,t)=>BP(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]),$q=["geometry","material"],ZK=qe({__name:"HTML",props:{geometry:{default:new Oi},material:{},as:{default:"div"},transform:{type:Boolean,default:!1},portal:{},wrapperClass:{},eps:{default:1e-4},distanceFactor:{},fullscreen:{type:Boolean},center:{type:Boolean},pointerEvents:{default:"auto"},sprite:{type:Boolean,default:!1},zIndexRange:{default:()=>[16777271,0]},occlude:{type:[Array,Boolean,String]}},emits:["onOcclude"],setup(n,{emit:e}){const t=n,i=e,r=MR(),s=lS(),o=be(),a=be(),{geometry:l,material:c,as:u,transform:h,portal:d,wrapperClass:f,eps:p,distanceFactor:v,fullscreen:m,center:g,pointerEvents:b,sprite:y,occlude:_,zIndexRange:T}=Ar(t),{renderer:w,scene:S,camera:x,raycaster:M,sizes:E}=Tr(),C=Te(()=>document.createElement(u.value)),O=be([0,0]),$=be(0),U=be(),j=Te(()=>h.value?{position:"absolute",top:0,left:0,width:"".concat(E.width.value,"px"),height:"".concat(E.height.value,"px"),transformStyle:"preserve-3d",pointerEvents:"none",zIndex:2,willChange:"transform"}:ti(Ft(ti(Ft({position:"absolute",transform:g.value?"translate3d(-50%,-50%,0)":"none"},m.value&&{top:-E.height.value/2,left:-E.width.value/2,width:"".concat(E.width.value,"px"),height:"".concat(E.height.value,"px")}),{zIndex:2}),r.style),{willChange:"transform"})),W=Te(()=>({position:"absolute",pointerEvents:b.value})),q=be(null),ie=be(!1),Z=Te(()=>(_==null?void 0:_.value)&&(_==null?void 0:_.value)!=="blending"||Array.isArray(_==null?void 0:_.value)&&(_==null?void 0:_.value.length)&&gn(_.value[0]));ft(()=>_,xe=>{xe&&xe==="blending"?(C.value.style.zIndex="".concat(Math.floor(T.value[0]/2)),C.value.style.position="absolute",C.value.style.pointerEvents="none"):(C.value.style.zIndex=null,C.value.style.position=null,C.value.style.pointerEvents=null)}),ft(()=>{var xe;return[o.value,w.value,E.width.value,E.height.value,(xe=s.default)==null?void 0:xe.call(s)]},([xe,Re])=>{var Ie,Q,K,P,F,k;if(xe&&Re){const A=(d==null?void 0:d.value)||Re.domElement;if((Ie=S.value)==null||Ie.updateMatrixWorld(),h.value)C.value.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const R=wE(xe,x.value,{width:E.width.value,height:E.height.value});C.value.style.cssText="position:absolute;top:0;left:0;transform:translate3d(".concat(R[0],"px,").concat(R[1],"px,0);transform-origin:0 0;")}A&&!C.value.parentNode&&((Q=A.parentNode)==null||Q.appendChild(C.value)),h.value?U.value=ne("div",{id:"outer",style:j.value},[ne("div",{id:"inner",style:W.value},[ne("div",{key:(K=a.value)==null?void 0:K.uuid,id:S==null?void 0:S.value.uuid,class:r.class,style:r.style},(P=s.default)==null?void 0:P.call(s))])]):U.value=ne("div",{key:(F=a.value)==null?void 0:F.uuid,id:S==null?void 0:S.value.uuid,style:j.value},(k=s.default)==null?void 0:k.call(s)),CL(U.value,C.value)}}),rr(()=>{f!=null&&f.value&&(C.value.className=f.value)});const te=be(!0),{onLoop:X}=lr();X(()=>{var xe,Re,Ie,Q,K,P,F;if(o.value&&x.value&&w.value){(xe=x.value)==null||xe.updateMatrixWorld(),o.value.updateWorldMatrix(!0,!1);const k=h.value?O.value:wE(o.value,x.value,{width:E.width.value||0,height:E.height.value||0});if(h.value||Math.abs($.value-x.value.zoom)>p.value||Math.abs(O.value[0]-k[0])>p.value||Math.abs(O.value[1]-k[1])>p.value){const A=Bq(o.value,x.value);let R=!1;Z.value&&(Array.isArray(_==null?void 0:_.value)?R=_==null?void 0:_.value:(_==null?void 0:_.value)!=="blending"&&(R=[S.value]));const I=te.value;if(R){const ee=zq(o.value,x.value,M.value,R);te.value=ee&&!A}else te.value=!A;I!==te.value&&(i("onOcclude",!te.value),C.value.style.display=te.value?"block":"none");const V=Math.floor(T.value[0]/2),H=_!=null&&_.value?Z.value?[T.value[0],V]:[V-1,0]:T.value;if(C.value.style.zIndex="".concat(Hq(o.value,x.value,H)),C.value.style.willChange="transform",h.value){const[ee,oe]=[E.width.value/2,E.height.value/2],re=x.value.projectionMatrix.elements[5]*oe,{isOrthographicCamera:ue,top:ae,left:Ee,bottom:N,right:L}=x.value,J=Gq(x.value.matrixWorldInverse),pe=ue?"scale(".concat(re,")translate(").concat(U0(-(L+Ee)/2),"px,").concat(U0((ae+N)/2),"px)"):"translateZ(".concat(re,"px)");let he=o.value.matrixWorld;y.value&&(he=x.value.matrixWorldInverse.clone().transpose().copyPosition(he).scale(o.value.scale),he.elements[3]=he.elements[7]=he.elements[11]=0,he.elements[15]=1),C.value.style.width="".concat(E.width.value,"px"),C.value.style.height="".concat(E.height.value,"px"),C.value.style.perspective=ue?"":"".concat(re,"px"),(Re=U.value)!=null&&Re.el&&(Ie=U.value)!=null&&Ie.children&&(U.value.el.style.willChange="transform",U.value.el.style.transform="".concat(pe).concat(J,"translate(").concat(ee,"px,").concat(oe,"px)"),U.value.children[0].willChange="transform",U.value.children[0].el.style.transform=Wq(he,1/(((v==null?void 0:v.value)||10)/400)))}else{const ee=(v==null?void 0:v.value)===void 0?1:Vq(o.value,x.value)*(v==null?void 0:v.value);C.value.style.transform="translate3d(".concat(k[0],"px,").concat(k[1],"px,0) scale(").concat(ee,")")}}O.value=k,$.value=x.value.zoom}if(!Z.value&&a.value&&!ie.value)if(h.value){if((Q=U.value)!=null&&Q.el&&(K=U.value)!=null&&K.children){const k=(P=U.value)==null?void 0:P.children[0];if(k!=null&&k.clientWidth&&k!=null&&k.clientHeight){const{isOrthographicCamera:A}=x.value;if(A||l)r.scale&&(Array.isArray(r.scale)?r.scale instanceof D?a.value.scale.copy(r.scale.clone().divideScalar(1)):a.value.scale.set(1/r.scale[0],1/r.scale[1],1/r.scale[2]):a.value.scale.setScalar(1/r.scale));else{const R=((v==null?void 0:v.value)||10)/400,I=k.clientWidth*R,V=k.clientHeight*R;a.value.scale.set(I,V,1)}ie.value=!0}}}else{const k=C.value.children[0];if(k!=null&&k.clientWidth&&k!=null&&k.clientHeight){const A=k.clientWidth*1,R=k.clientHeight*1;a.value.scale.set(A,R,1),ie.value=!0}q.value.lookAt((F=x.value)==null?void 0:F.position)}});const se=Te(()=>({vertexShader:h.value?void 0:Nq,fragmentShader:Fq})),G=Te(()=>{const xe=se.value;return c.value||new or({vertexShader:xe.vertexShader,fragmentShader:xe.fragmentShader,side:vi})});return Si(()=>{G.value&&G.value.dispose()}),(xe,Re)=>(rt(),Mt("TresGroup",{ref_key:"groupRef",ref:o},[we(_)&&!Z.value?(rt(),Mt("TresMesh",{key:0,ref_key:"meshRef",ref:a,geometry:we(l),material:G.value},null,8,$q)):Ii("",!0)],512))}});export{A4 as $,oo as A,Mp as B,Kt as C,Zq as D,c_ as E,SK as F,Hu as G,$u as H,we as I,rK as J,sK as K,_K as L,uK as M,xK as N,bK as O,iK as P,wK as Q,dK as R,yK as S,$r as T,Kn as U,Ii as V,Dn as W,wi as X,qe as Y,li as Z,wF as _,ne as a,Kp as a$,Mn as a0,xs as a1,qn as a2,lr as a3,rr as a4,_n as a5,wr as a6,LK as a7,Xq as a8,GR as a9,IK as aA,OK as aB,Kq as aC,WK as aD,vi as aE,GK as aF,Tt as aG,Yt as aH,Oe as aI,Be as aJ,CC as aK,D as aL,PK as aM,XK as aN,Ar as aO,DK as aP,Pn as aQ,Ti as aR,qC as aS,Ve as aT,U7 as aU,Jr as aV,DC as aW,Ai as aX,De as aY,me as aZ,Zi as a_,NK as aa,pK as ab,LO as ac,IS as ad,tX as ae,ZK as af,EK as ag,np as ah,En as ai,Si as aj,Du as ak,qK as al,jn as am,HK as an,KK as ao,BK as ap,FK as aq,zK as ar,jK as as,Yq as at,qq as au,YK as av,VK as aw,$K as ax,kK as ay,Jq as az,MK as b,or as b0,gt as b1,n2 as b2,ke as b3,RC as b4,F_ as b5,gc as b6,UK as b7,PT as b8,Qp as b9,Qq as bA,lK as bB,hK as bC,cK as bD,em as ba,Mc as bb,_m as bc,An as bd,pt as be,yh as bf,om as bg,Xn as bh,Ye as bi,oy as bj,Oi as bk,nm as bl,Yr as bm,ay as bn,RK as bo,an as bp,Vn as bq,Mi as br,_r as bs,Nn as bt,Or as bu,Tr as bv,J7 as bw,gK as bx,CK as by,mK as bz,Mt as c,aK as d,eK as e,bF as f,WS as g,nK as h,tK as i,be as j,mR as k,xa as l,UO as m,DO as n,rt as o,Fc as p,Te as q,vu as r,Br as s,l3 as t,oK as u,wo as v,ft as w,TK as x,AK as y,vK as z};
